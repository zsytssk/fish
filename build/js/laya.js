(self.webpackChunkwebpack_test=self.webpackChunkwebpack_test||[]).push([[921],{80340:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Config=void 0;var i=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)};e.Config=i,i.animationInterval=50,i.isAntialias=!0,i.isAlpha=!1,i.premultipliedAlpha=!0,i.isStencil=!0,i.preserveDrawingBuffer=!1,i.webGL2D_MeshAllocMaxMem=!0,i.is2DPixelArtGame=!1,i.useWebGL2=!0,i.printWebglOrder=!1,i.allowGPUInstanceDynamicBatch=!0,i.enableStaticBatch=!0,i.useRetinalCanvas=!1,window.Config=i},92493:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.ILaya=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i};function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"regClass",value:function(e){t.__classMap[e.name]=e}}],(n=null)&&a(e.prototype,n),i&&a(e,i),t}();e.ILaya=o,o.Laya=null,o.Timer=null,o.WorkerLoader=null,o.Dragging=null,o.GraphicsBounds=null,o.Sprite=null,o.TextRender=null,o.TextAtlas=null,o.timer=null,o.systemTimer=null,o.startTimer=null,o.updateTimer=null,o.lateTimer=null,o.physicsTimer=null,o.stage=null,o.Loader=null,o.loader=null,o.TTFLoader=null,o.SoundManager=null,o.WebAudioSound=null,o.AudioSound=null,o.ShaderCompile=null,o.ClassUtils=null,o.SceneUtils=null,o.Context=null,o.Render=null,o.MouseManager=null,o.Text=null,o.Browser=null,o.WebGL=null,o.Pool=null,o.Utils=null,o.Graphics=null,o.Submit=null,o.Stage=null,o.Resource=null,o.__classMap={}},24629:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.__init=e.Laya=void 0,e._static=function(t,e){for(var n=0,i=e.length;n<i;n+=2)if("length"==e[n])t.length=e[n+1].call(t);else{!function(){var i=e[n],r=e[n+1];(0,a.default)(t,i,{get:function(){return delete this[i],this[i]=r.call(this)},set:function(t){delete this[i],this[i]=t},enumerable:!0,configurable:!0})}()}},e.version=e.updateTimer=e.timer=e.systemTimer=e.startTimer=e.stage=e.render=e.physicsTimer=e.loader=e.lateTimer=e.isWXPosMsg=e.isWXOpenDataContext=e.init=e.enableDebugPanel=e.alertGlobalError=void 0;var i=vt(n(78914)),r=vt(n(3649)),a=vt(n(63978)),o=vt(n(47302)),s=vt(n(51942)),u=n(92493),l=n(72276),h=n(93697),c=n(61891),f=n(54190),_=n(78362),d=n(77590),p=n(81870),y=n(78499),v=n(47002),g=n(33873),m=n(16313),b=n(17886),T=n(30690),x=n(85096),w=n(33063),k=n(20966),C=n(65356),E=n(84935),S=n(85136),M=n(8272),L=n(79741),R=n(26776),I=n(93894),A=n(25883),D=n(93568),B=n(17939),P=n(23835),O=n(13104),F=n(97617),U=n(64210),N=n(21383),G=n(683),H=n(14334),W=n(52842),V=n(56083),Y=n(76006),X=n(43989),z=n(2717),j=n(11984),K=n(56978),q=n(22245),Z=n(17),Q=n(36296),$=n(30875),J=n(56161),tt=n(97441),et=n(62285),nt=n(61266),it=n(37397),rt=n(32996),at=n(86044),ot=n(34415),st=n(94286),ut=n(30966),lt=n(96088),ht=n(48856),ct=n(41107),ft=n(14400),_t=n(18008),dt=n(64178),pt=n(89662),yt=n(80340);function vt(t){return t&&t.__esModule?t:{default:t}}function gt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,a.default)(t,i.key,i)}}var mt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var n,o,s;return n=t,s=[{key:"__init",value:function(t){(0,i.default)(t).call(t,(function(t){t.__init$&&t.__init$()}))}},{key:"init",value:function(n,i){if(!t._isinit){t._isinit=!0,(0,r.default)(ArrayBuffer.prototype)||(ArrayBuffer.prototype.slice=t._arrayBufferSlice),D.Browser.__init__();var a=D.Browser.mainCanvas=new R.HTMLCanvas(!0),o=a.source.style;o.position="absolute",o.top=o.left="0px",o.background="#000000",D.Browser.onKGMiniGame||D.Browser.onAlipayMiniGame||D.Browser.container.appendChild(a.source),D.Browser.canvas=new R.HTMLCanvas(!0),D.Browser.context=D.Browser.canvas.getContext("2d"),D.Browser.supportWebAudio=b.SoundManager.__init__(),D.Browser.supportLocalStorage=k.LocalStorage.__init__(),t.systemTimer=new W.Timer(!1),e.systemTimer=Ct=W.Timer.gSysTimer=t.systemTimer,t.startTimer=new W.Timer(!1),t.physicsTimer=new W.Timer(!1),t.updateTimer=new W.Timer(!1),t.lateTimer=new W.Timer(!1),t.timer=new W.Timer(!1),e.startTimer=Et=u.ILaya.startTimer=t.startTimer,e.lateTimer=Lt=u.ILaya.lateTimer=t.lateTimer,e.updateTimer=Mt=u.ILaya.updateTimer=t.updateTimer,u.ILaya.systemTimer=t.systemTimer,e.timer=Rt=u.ILaya.timer=t.timer,e.physicsTimer=St=u.ILaya.physicsTimer=t.physicsTimer,t.loader=new w.LoaderManager,u.ILaya.Laya=t,e.loader=It=u.ILaya.loader=t.loader,Y.WeakObject.__init__(),N.SceneUtils.__init(),rt.Mouse.__init__(),et.WebGL.inner_enable();for(var s=arguments.length,l=new Array(s>2?s-2:0),h=2;h<s;h++)l[h-2]=arguments[h];if(l)for(var f=0,_=l.length;f<_;f++)l[f]&&l[f].enable&&l[f].enable();return u.ILaya.Render.isConchApp&&t.enableNative(),t.enableWebGLPlus(),B.CacheManger.beginCheck(),e.stage=kt=t.stage=new d.Stage,u.ILaya.stage=t.stage,V.Utils.gStage=t.stage,E.URL.rootPath=E.URL._basePath=t._getUrlPath(),st.MeshQuadTexture.__int__(),at.MeshVG.__init__(),ut.MeshTexture.__init__(),t.render=new S.Render(0,0,D.Browser.mainCanvas),e.render=Dt=t.render,t.stage.size(n,i),window.stage=t.stage,nt.WebGLContext.__init__(),ot.MeshParticle2D.__init__(),tt.ShaderCompile.__init__(),M.RenderSprite.__init__(),y.KeyBoardManager.__init__(),v.MouseManager.instance.__init__(t.stage,S.Render.canvas),c.Input.__init__(),b.SoundManager.autoStopMusic=!0,G.Stat._StatRender=new H.StatUI,q.Value2D._initone(X.ShaderDefines2D.TEXTURE2D,K.TextureSV),q.Value2D._initone(X.ShaderDefines2D.TEXTURE2D|X.ShaderDefines2D.FILTERGLOW,K.TextureSV),q.Value2D._initone(X.ShaderDefines2D.PRIMITIVE,j.PrimitiveSV),q.Value2D._initone(X.ShaderDefines2D.SKINMESH,z.SkinSV),S.Render.canvas}}},{key:"_getUrlPath",value:function(){return E.URL.getPath(location.protocol+"//"+location.host+location.pathname)}},{key:"_arrayBufferSlice",value:function(t,e){var n=new Uint8Array(this,t,e-t),i=new Uint8Array(n.length);return i.set(n),i.buffer}},{key:"alertGlobalError",value:function(t){var e=0;D.Browser.window.onerror=t?function(t,n,i,r,a){e++<5&&a&&this.alert("出错啦，请把此信息截图给研发商\n"+t+"\n"+a.stack)}:null}},{key:"_runScript",value:function(e){return D.Browser.window[t._evcode](e)}},{key:"enableDebugPanel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"libs/laya.debugtool.js";if(window.Laya.DebugPanel)window.Laya.DebugPanel.enable();else{var e=D.Browser.createElement("script");e.onload=function(){window.Laya.DebugPanel.enable()},e.src=t,D.Browser.document.body.appendChild(e)}}},{key:"enableWebGLPlus",value:function(){nt.WebGLContext.__init_native()}},{key:"enableNative",value:function(){t.isNativeRender_enable||(t.isNativeRender_enable=!0,S.Render.supportWebGLPlusRendering&&(Z.Shader.prototype.uploadTexture2D=function(t){var e=g.LayaGL.instance;e.bindTexture(e.TEXTURE_2D,t)}),J.RenderState2D.width=D.Browser.window.innerWidth,J.RenderState2D.height=D.Browser.window.innerHeight,D.Browser.measureText=function(t,e){return window.conchTextCanvas.font=e,window.conchTextCanvas.measureText(t)},d.Stage.clear=function(t){L.Context.set2DRenderConfig();var e=O.ColorUtils.create(t).arrColor,n=g.LayaGL.instance;e&&n.clearColor(e[0],e[1],e[2],e[3]),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT|n.STENCIL_BUFFER_BIT),J.RenderState2D.clear()},_.Sprite.drawToCanvas=function(t,e,n,i,r,a){r-=t.x,a-=t.y,r|=0,a|=0,n|=0,i|=0;var o=new R.HTMLCanvas(!1),s=o.getContext("2d");return o.size(n,i),s.asBitmap=!0,s._targets.start(),M.RenderSprite.renders[e]._fun(t,s,r,a),s.flush(),s._targets.end(),s._targets.restore(),o},(0,a.default)(I.RenderTexture2D.prototype,"uv",{get:function(){return this._uv},set:function(t){this._uv=t}}),R.HTMLCanvas.prototype.getTexture=function(){return this._texture||(this._texture=this.context._targets,this._texture.uv=I.RenderTexture2D.flipyuv,this._texture.bitmap=this._texture),this._texture})}}],(o=null)&&gt(n.prototype,o),s&&gt(n,s),t}();e.Laya=mt,mt.stage=null,mt.systemTimer=null,mt.startTimer=null,mt.physicsTimer=null,mt.updateTimer=null,mt.lateTimer=null,mt.timer=null,mt.loader=null,mt.version="2.12.2",mt._isinit=!1,mt.isWXOpenDataContext=!1,mt.isWXPosMsg=!1,mt.__classmap=null,mt.Config=yt.Config,mt.TextRender=$.TextRender,mt.EventDispatcher=ht.EventDispatcher,mt.SoundChannel=lt.SoundChannel,mt.Stage=d.Stage,mt.Render=S.Render,mt.Browser=D.Browser,mt.Sprite=_.Sprite,mt.Node=f.Node,mt.Context=L.Context,mt.WebGL=et.WebGL,mt.Handler=ct.Handler,mt.RunDriver=ft.RunDriver,mt.Utils=V.Utils,mt.Input=c.Input,mt.Loader=x.Loader,mt.LocalStorage=k.LocalStorage,mt.SoundManager=b.SoundManager,mt.URL=E.URL,mt.Event=pt.Event,mt.Matrix=_t.Matrix,mt.HTMLImage=dt.HTMLImage,mt.Laya=mt,mt._evcode="eval",mt.isNativeRender_enable=!1,mt.__classmap=u.ILaya.__classMap,u.ILaya.Timer=W.Timer,u.ILaya.Dragging=F.Dragging,u.ILaya.GraphicsBounds=h.GraphicsBounds,u.ILaya.Sprite=_.Sprite,u.ILaya.TextRender=$.TextRender,u.ILaya.Loader=x.Loader,u.ILaya.TTFLoader=C.TTFLoader,u.ILaya.WebAudioSound=T.WebAudioSound,u.ILaya.SoundManager=b.SoundManager,u.ILaya.ShaderCompile=tt.ShaderCompile,u.ILaya.ClassUtils=P.ClassUtils,u.ILaya.SceneUtils=N.SceneUtils,u.ILaya.Context=L.Context,u.ILaya.Render=S.Render,u.ILaya.MouseManager=v.MouseManager,u.ILaya.Text=p.Text,u.ILaya.Browser=D.Browser,u.ILaya.WebGL=et.WebGL,u.ILaya.AudioSound=m.AudioSound,u.ILaya.Pool=U.Pool,u.ILaya.Utils=V.Utils,u.ILaya.Graphics=l.Graphics,u.ILaya.Submit=Q.Submit,u.ILaya.Stage=d.Stage,u.ILaya.Resource=A.Resource,u.ILaya.WorkerLoader=it.WorkerLoader;var bt=window._layalibs;if(bt){(0,o.default)(bt).call(bt,(function(t,e){return t.i-e.i}));for(var Tt=0;Tt<bt.length;Tt++)bt[Tt].f(window,window.document,mt)}var xt=window;xt.Laya?(xt.Laya.Laya=mt,(0,s.default)(xt.Laya,mt)):xt.Laya=mt;var wt=mt.__init;e.__init=wt;var kt,Ct,Et,St,Mt,Lt,Rt,It,At=mt.init;e.init=At,e.stage=kt,e.systemTimer=Ct,e.startTimer=Et,e.physicsTimer=St,e.updateTimer=Mt,e.lateTimer=Lt,e.timer=Rt,e.loader=It;var Dt,Bt=mt.version;e.version=Bt,e.render=Dt,e.isWXOpenDataContext=undefined,e.isWXPosMsg=undefined;var Pt=mt.alertGlobalError;e.alertGlobalError=Pt;var Ot=mt.enableDebugPanel;e.enableDebugPanel=Ot},14529:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.UIConfig=void 0;var i=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)};e.UIConfig=i,i.touchScrollEnable=!0,i.mouseWheelEnable=!0,i.showButtons=!0,i.popupBgColor="#000000",i.popupBgAlpha=.5,i.closeDialogOnSide=!0,window.UIConfig=i},13407:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Const=void 0;var i=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)};e.Const=i,i.NOT_ACTIVE=1,i.ACTIVE_INHIERARCHY=2,i.AWAKED=4,i.NOT_READY=8,i.DISPLAY=16,i.HAS_ZORDER=32,i.HAS_MOUSE=64,i.DISPLAYED_INSTAGE=128,i.DRAWCALL_OPTIMIZE=256},49029:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.IAniLib=void 0;var i=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)};e.IAniLib=i,i.Skeleton=null,i.AnimationTemplet=null,i.Templet=null},44799:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.AnimationContent=void 0;e.AnimationContent=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}},50355:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.AnimationNodeContent=void 0;e.AnimationNodeContent=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}},44611:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.AnimationParser01=void 0;var i=h(n(3649)),r=h(n(63978)),a=n(44799),o=n(50355),s=n(90984),u=n(49029),l=n(14002);function h(t){return t&&t.__esModule?t:{default:t}}function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var f=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,r=[{key:"parse",value:function(t,e){var n,r,h,c,f,_,d,p=e.__getBuffer(),y=e.readUTFString();t._aniClassName=y;var v,g=e.readUTFString().split("\n"),m=e.getUint8(),b=e.getUint32(),T=e.getUint32();b>0&&(v=(0,i.default)(p).call(p,b,T));var x=new l.Byte(v);for(T>0&&(t._publicExtData=(0,i.default)(p).call(p,T,p.byteLength)),t._useParent=!!e.getUint8(),t._anis.length=m,n=0;n<m;n++){var w=t._anis[n]=new a.AnimationContent;w.nodes=[];var k=w.name=g[e.getUint16()];t._aniMap[k]=n,w.bone3DMap={},w.playTime=e.getFloat32();var C=w.nodes.length=e.getUint8();for(w.totalKeyframeDatasLength=0,r=0;r<C;r++){var E=w.nodes[r]=new o.AnimationNodeContent;E.childs=[];var S=e.getInt16();S>=0&&(E.name=g[S],w.bone3DMap[E.name]=r),E.keyFrame=[],E.parentIndex=e.getInt16(),-1==E.parentIndex?E.parent=null:E.parent=w.nodes[E.parentIndex],E.lerpType=e.getUint8();var M=e.getUint32();x.pos=M;var L=E.keyframeWidth=x.getUint16();if(w.totalKeyframeDatasLength+=L,0===E.lerpType||1===E.lerpType)for(E.interpolationMethod=[],E.interpolationMethod.length=L,h=0;h<L;h++)E.interpolationMethod[h]=u.IAniLib.AnimationTemplet.interpolation[x.getUint8()];null!=E.parent&&E.parent.childs.push(E);var R=e.getUint16();R>0&&(E.extenData=(0,i.default)(p).call(p,e.pos,e.pos+R),e.pos+=R);var I=e.getUint16();E.keyFrame.length=I;var A,D=0;for(h=0,c=I;h<c;h++){if((A=E.keyFrame[h]=new s.KeyFramesContent).duration=e.getFloat32(),A.startTime=D,2===E.lerpType){A.interpolationData=[];var B,P=e.getUint8();switch(B=e.getFloat32()){case 254:for(A.interpolationData.length=L,d=0;d<L;d++)A.interpolationData[d]=0;break;case 255:for(A.interpolationData.length=L,d=0;d<L;d++)A.interpolationData[d]=5;break;default:for(A.interpolationData.push(B),_=1;_<P;_++)A.interpolationData.push(e.getFloat32())}}for(A.data=new Float32Array(L),A.dData=new Float32Array(L),A.nextData=new Float32Array(L),f=0;f<L;f++)A.data[f]=e.getFloat32(),A.data[f]>-1e-8&&A.data[f]<1e-8&&(A.data[f]=0);D+=A.duration}A.startTime=w.playTime,E.playTime=w.playTime,t._calculateKeyFrame(E,I,L)}}}}],(n=null)&&c(e.prototype,n),r&&c(e,r),t}();e.AnimationParser01=f},39340:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.AnimationParser02=void 0;var i=l(n(3649)),r=l(n(63978)),a=n(44799),o=n(50355),s=n(90984),u=n(49029);function l(t){return t&&t.__esModule?t:{default:t}}function h(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var c=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,r=[{key:"READ_DATA",value:function(){t._DATA.offset=t._reader.getUint32(),t._DATA.size=t._reader.getUint32()}},{key:"READ_BLOCK",value:function(){for(var e=t._BLOCK.count=t._reader.getUint16(),n=t._BLOCK.blockStarts=[],i=t._BLOCK.blockLengths=[],r=0;r<e;r++)n.push(t._reader.getUint32()),i.push(t._reader.getUint32())}},{key:"READ_STRINGS",value:function(){var e=t._reader.getUint32(),n=t._reader.getUint16(),i=t._reader.pos;t._reader.pos=e+t._DATA.offset;for(var r=0;r<n;r++)t._strings[r]=t._reader.readUTFString();t._reader.pos=i}},{key:"parse",value:function(e,n){t._templet=e,t._reader=n,n.__getBuffer(),t.READ_DATA(),t.READ_BLOCK(),t.READ_STRINGS();for(var i=0,r=t._BLOCK.count;i<r;i++){var a=n.getUint16(),o=t._strings[a],s=t["READ_"+o];if(null==s)throw new Error("model file err,no this function:"+a+" "+o);s.call(null)}}},{key:"READ_ANIMATIONS",value:function(){var e,n,r,l,h=t._reader,c=h.__getBuffer(),f=h.getUint16(),_=[];for(_.length=f,e=0;e<f;e++)_[e]=u.IAniLib.AnimationTemplet.interpolation[h.getByte()];var d=h.getUint8();for(t._templet._anis.length=d,e=0;e<d;e++){var p=t._templet._anis[e]=new a.AnimationContent;p.nodes=[];var y=p.name=t._strings[h.getUint16()];t._templet._aniMap[y]=e,p.bone3DMap={},p.playTime=h.getFloat32();var v=p.nodes.length=h.getInt16();for(p.totalKeyframeDatasLength=0,n=0;n<v;n++){var g=p.nodes[n]=new o.AnimationNodeContent;g.keyframeWidth=f,g.childs=[];var m=h.getUint16();m>=0&&(g.name=t._strings[m],p.bone3DMap[g.name]=n),g.keyFrame=[],g.parentIndex=h.getInt16(),-1==g.parentIndex?g.parent=null:g.parent=p.nodes[g.parentIndex],p.totalKeyframeDatasLength+=f,g.interpolationMethod=_,null!=g.parent&&g.parent.childs.push(g);var b=h.getUint16();g.keyFrame.length=b;var T=null,x=null;for(r=0,l=b;r<l;r++){(T=g.keyFrame[r]=new s.KeyFramesContent).startTime=h.getFloat32(),x&&(x.duration=T.startTime-x.startTime),T.dData=new Float32Array(f),T.nextData=new Float32Array(f);var w=t._DATA.offset,k=h.getUint32(),C=4*f,E=(0,i.default)(c).call(c,w+k,w+k+C);T.data=new Float32Array(E),x=T}T.duration=0,g.playTime=p.playTime,t._templet._calculateKeyFrame(g,b,f)}}}}],(n=null)&&h(e.prototype,n),r&&h(e,r),t}();e.AnimationParser02=c,c._strings=[],c._BLOCK={count:0},c._DATA={offset:0,size:0}},48796:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.AnimationPlayer=void 0;var h=p(n(85507)),c=p(n(21611)),f=n(48220),_=n(683),d=n(89662);function p(t){return t&&t.__esModule?t:{default:t}}function y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function v(t,e){return v=a||function(t,e){return t.__proto__=e,t},v(t,e)}function g(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b(t);if(e){var a=b(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return m(this,n)}}function m(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function b(t){return b=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},b(t)}var T=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(a,t);var e,n,i,r=g(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this)).isCache=!0,t.playbackRate=1,t._destroyed=!1,t._currentAnimationClipIndex=-1,t._currentKeyframeIndex=-1,t._currentTime=0,t._overallDuration=Number.MAX_VALUE,t._stopWhenCircleFinish=!1,t._elapsedPlaybackTime=0,t._startUpdateLoopCount=-1,t._cachePlayRate=1,t.cacheFrameRate=60,t.returnToZeroStopped=!1,t}return e=a,n=[{key:"templet",get:function(){return this._templet},set:function(t){this.state!==f.AnimationState.stopped&&this.stop(!0),this._templet!==t&&(this._templet=t,this._computeFullKeyframeIndices())}},{key:"playStart",get:function(){return this._playStart}},{key:"playEnd",get:function(){return this._playEnd}},{key:"playDuration",get:function(){return this._playDuration}},{key:"overallDuration",get:function(){return this._overallDuration}},{key:"currentAnimationClipIndex",get:function(){return this._currentAnimationClipIndex}},{key:"currentKeyframeIndex",get:function(){return this._currentKeyframeIndex}},{key:"currentPlayTime",get:function(){return this._currentTime+this._playStart}},{key:"currentFrameTime",get:function(){return this._currentFrameTime}},{key:"cachePlayRate",get:function(){return this._cachePlayRate},set:function(t){this._cachePlayRate!==t&&(this._cachePlayRate=t,this._templet&&this._computeFullKeyframeIndices())}},{key:"cacheFrameRate",get:function(){return this._cacheFrameRate},set:function(t){this._cacheFrameRate!==t&&(this._cacheFrameRate=t,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&this._computeFullKeyframeIndices())}},{key:"currentTime",set:function(t){if(-1!==this._currentAnimationClipIndex&&this._templet){if(t<this._playStart||t>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=_.Stat.loopCount;var e=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=t,this._currentKeyframeIndex=Math.floor(this.currentPlayTime/e),this._currentFrameTime=this._currentKeyframeIndex*e}}},{key:"paused",get:function(){return this._paused},set:function(t){this._paused=t,t&&this.event(d.Event.PAUSED)}},{key:"cacheFrameRateInterval",get:function(){return this._cacheFrameRateInterval}},{key:"state",get:function(){return-1===this._currentAnimationClipIndex?f.AnimationState.stopped:this._paused?f.AnimationState.paused:f.AnimationState.playing}},{key:"destroyed",get:function(){return this._destroyed}},{key:"_onTempletLoadedComputeFullKeyframeIndices",value:function(t,e,n){this._templet===n&&this._cachePlayRate===t&&this._cacheFrameRate===e&&this._computeFullKeyframeIndices()}},{key:"_computeFullKeyframeIndices",value:function(){}},{key:"_onAnimationTempletLoaded",value:function(){this.destroyed||this._calculatePlayDuration()}},{key:"_calculatePlayDuration",value:function(){if(this.state!==f.AnimationState.stopped){var t=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=t),this._playEnd>t&&(this._playEnd=t),this._playDuration=this._playEnd-this._playStart}}},{key:"_setPlayParams",value:function(t,e){this._currentTime=t,this._currentKeyframeIndex=Math.floor(this.currentPlayTime/e+.01),this._currentFrameTime=this._currentKeyframeIndex*e}},{key:"_setPlayParamsWhenStop",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;this._currentTime=t;var i=n>0?n:t;this._currentKeyframeIndex=Math.floor(i/e+.01),this._currentKeyframeIndex=Math.floor(t/e+.01),this._currentFrameTime=this._currentKeyframeIndex*e,this._currentAnimationClipIndex=-1}},{key:"_update",value:function(t){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet){var e=this._cacheFrameRateInterval*this._cachePlayRate,n=0;this._startUpdateLoopCount!==_.Stat.loopCount&&(n=t*this.playbackRate,this._elapsedPlaybackTime+=n);var i=this.playDuration;if(n+=this._currentTime,0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=i||0===this._overallDuration&&n>=this.playEnd)return this._setPlayParamsWhenStop(i,e,this.playEnd),void this.event(d.Event.STOPPED);if(i>0){if(n>=i)return this._stopWhenCircleFinish?(this._setPlayParamsWhenStop(i,e),this._stopWhenCircleFinish=!1,void this.event(d.Event.STOPPED)):(n%=i,this._setPlayParams(n,e),void this.event(d.Event.COMPLETE));this._setPlayParams(n,e)}else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(i,e),this._stopWhenCircleFinish=!1,void this.event(d.Event.STOPPED);this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event(d.Event.COMPLETE)}}}},{key:"_destroy",value:function(){this.offAll(),this._templet=null,this._destroyed=!0}},{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2147483647,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(n<0||i<0||r<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==r&&i>r)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=e,this._overallDuration=n,this._playStart=i,this._playEnd=r,this._paused=!1,this._currentAnimationClipIndex=t,this._currentKeyframeIndex=0,this._startUpdateLoopCount=_.Stat.loopCount,this.event(d.Event.PLAYED),this._calculatePlayDuration(),this._update(0)}},{key:"playByFrame",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2147483647,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:30,o=1e3/a;this.play(t,e,n,i*o,r*o)}},{key:"stop",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event(d.Event.STOPPED)):this._stopWhenCircleFinish=!0}},{key:"destroy",value:function(){}}],n&&y(e.prototype,n),i&&y(e,i),a}(n(48856).EventDispatcher);e.AnimationPlayer=T},48220:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.AnimationState=void 0;var i=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)};e.AnimationState=i,i.stopped=0,i.paused=1,i.playing=2},23038:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.AnimationTemplet=void 0;var h=m(n(85507)),c=m(n(21611)),f=n(44611),_=n(39340),d=n(25883),p=n(64968),y=n(49029),v=n(14002),g=n(67988);function m(t){return t&&t.__esModule?t:{default:t}}function b(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function T(t,e){return T=a||function(t,e){return t.__proto__=e,t},T(t,e)}function x(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=k(t);if(e){var a=k(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return w(this,n)}}function w(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function k(t){return k=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},k(t)}var C=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&T(t,e)}(a,t);var e,n,i,r=x(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this))._anis=[],t._aniMap={},t.unfixedLastAniIndex=-1,t._fullFrames=null,t._boneCurKeyFrm=[],t}return e=a,i=[{key:"_LinearInterpolation_0",value:function(t,e,n,i,r,a,o,s,u){return n[i]=r[e]+a*o[e],1}},{key:"_QuaternionInterpolation_1",value:function(t,e,n,i,r,a,o,s,u){var l=0===s?0:a/s;return p.MathUtil.slerpQuaternionArray(r,e,u,e,l,n,i),4}},{key:"_AngleInterpolation_2",value:function(t,e,n,i,r,a,o,s,u){return 0}},{key:"_RadiansInterpolation_3",value:function(t,e,n,i,r,a,o,s,u){return 0}},{key:"_Matrix4x4Interpolation_4",value:function(t,e,n,i,r,a,o,s,u){for(var l=0;l<16;l++,e++)n[i+l]=r[e]+a*o[e];return 16}},{key:"_NoInterpolation_5",value:function(t,e,n,i,r,a,o,s,u){return n[i]=r[e],1}},{key:"_BezierInterpolation_6",value:function(t,e,n,i,r,a,o,s,u){var l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0;return n[i]=r[e]+(u[e]-r[e])*g.BezierLerp.getBezierRate(a/s,l[h],l[h+1],l[h+2],l[h+3]),5}},{key:"_BezierInterpolation_7",value:function(t,e,n,i,r,a,o,s,u){var l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0;return n[i]=l[h+4]+l[h+5]*g.BezierLerp.getBezierRate((.001*a+l[h+6])/l[h+7],l[h],l[h+1],l[h+2],l[h+3]),9}}],(n=[{key:"parse",value:function(t){var e=new v.Byte(t);this._aniVersion=e.readUTFString(),f.AnimationParser01.parse(this,e)}},{key:"_calculateKeyFrame",value:function(t,e,n){var i=t.keyFrame;i[e]=i[0];for(var r=0;r<e;r++)for(var a=i[r],o=0;o<n;o++)a.dData[o]=0===a.duration?0:(i[r+1].data[o]-a.data[o])/a.duration,a.nextData[o]=i[r+1].data[o];i.length--}},{key:"_onAsynLoaded",value:function(t){var e=new v.Byte(t);this._aniVersion=e.readUTFString(),"LAYAANIMATION:02"===this._aniVersion?_.AnimationParser02.parse(this,e):f.AnimationParser01.parse(this,e)}},{key:"getAnimationCount",value:function(){return this._anis.length}},{key:"getAnimation",value:function(t){return this._anis[t]}},{key:"getAniDuration",value:function(t){return this._anis[t].playTime}},{key:"getNodes",value:function(t){return this._anis[t].nodes}},{key:"getNodeIndexWithName",value:function(t,e){return this._anis[t].bone3DMap[e]}},{key:"getNodeCount",value:function(t){return this._anis[t].nodes.length}},{key:"getTotalkeyframesLength",value:function(t){return this._anis[t].totalKeyframeDatasLength}},{key:"getPublicExtData",value:function(){return this._publicExtData}},{key:"getAnimationDataWithCache",value:function(t,e,n,i){var r=e[n];if(r){var a=r[t];return a?a[i]:null}return null}},{key:"setAnimationDataWithCache",value:function(t,e,n,i,r){var a=e[n]||(e[n]={});(a[t]||(a[t]=[]))[i]=r}},{key:"getNodeKeyFrame",value:function(t,e,n){var i=this._boneCurKeyFrm[e],r=t.length;(null==i||i>=r)&&(i=this._boneCurKeyFrm[e]=0);var a=t[i],o=n-a.startTime;if(0==o||o>0&&a.duration>o)return i;var s=0;if(o>0){for(n+=.01,s=i+1;s<r;s++)if((a=t[s]).startTime<=n&&a.startTime+a.duration>n)return this._boneCurKeyFrm[e]=s,s;return r-1}for(s=0;s<i;s++)if((a=t[s]).startTime<=n&&a.startTime+a.duration>n)return this._boneCurKeyFrm[e]=s,s;return i}},{key:"getOriginalData",value:function(t,e,n,i,r){var o=this._anis[t].nodes,s=this._boneCurKeyFrm;s.length<o.length&&(s.length=o.length);for(var u=0,l=0,h=o.length,c=0;l<h;l++){var f,_=o[l],d=_.keyFrame;f=d[this.getNodeKeyFrame(d,l,r)],_.dataOffset=c;var p=r-f.startTime,y=_.lerpType;if(y)switch(y){case 0:case 1:for(u=0;u<_.keyframeWidth;)u+=_.interpolationMethod[u](_,u,e,c+u,f.data,p,f.dData,f.duration,f.nextData);break;case 2:var v=f.interpolationData,g=v.length,m=0;for(u=0;u<g;){var b=v[u];switch(b){case 6:case 7:u+=a.interpolation[b](_,m,e,c+m,f.data,p,f.dData,f.duration,f.nextData,v,u+1);break;default:u+=a.interpolation[b](_,m,e,c+m,f.data,p,f.dData,f.duration,f.nextData)}m++}}else for(u=0;u<_.keyframeWidth;)u+=_.interpolationMethod[u](_,u,e,c+u,f.data,p,f.dData,f.duration,f.nextData);c+=_.keyframeWidth}}},{key:"getNodesCurrentFrameIndex",value:function(t,e){var n=this._anis[t].nodes;t!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(n.length),this.unfixedCurrentTimes=new Float32Array(n.length),this.unfixedLastAniIndex=t);for(var i=0,r=n.length;i<r;i++){var a=n[i];for(e<this.unfixedCurrentTimes[i]&&(this.unfixedCurrentFrameIndexes[i]=0),this.unfixedCurrentTimes[i]=e;this.unfixedCurrentFrameIndexes[i]<a.keyFrame.length&&!(a.keyFrame[this.unfixedCurrentFrameIndexes[i]].startTime>this.unfixedCurrentTimes[i]);)this.unfixedCurrentFrameIndexes[i]++;this.unfixedCurrentFrameIndexes[i]--}return this.unfixedCurrentFrameIndexes}},{key:"getOriginalDataUnfixedRate",value:function(t,e,n){var i=this._anis[t].nodes;t!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(i.length),this.unfixedCurrentTimes=new Float32Array(i.length),this.unfixedKeyframes=[],this.unfixedLastAniIndex=t);for(var r=0,o=0,s=i.length,u=0;o<s;o++){var l=i[o];for(n<this.unfixedCurrentTimes[o]&&(this.unfixedCurrentFrameIndexes[o]=0),this.unfixedCurrentTimes[o]=n;this.unfixedCurrentFrameIndexes[o]<l.keyFrame.length&&!(l.keyFrame[this.unfixedCurrentFrameIndexes[o]].startTime>this.unfixedCurrentTimes[o]);)this.unfixedKeyframes[o]=l.keyFrame[this.unfixedCurrentFrameIndexes[o]],this.unfixedCurrentFrameIndexes[o]++;var h=this.unfixedKeyframes[o];l.dataOffset=u;var c=n-h.startTime;if(l.lerpType)switch(l.lerpType){case 0:case 1:for(r=0;r<l.keyframeWidth;)r+=l.interpolationMethod[r](l,r,e,u+r,h.data,c,h.dData,h.duration,h.nextData);break;case 2:var f=h.interpolationData,_=f.length,d=0;for(r=0;r<_;){var p=f[r];switch(p){case 6:case 7:r+=a.interpolation[p](l,d,e,u+d,h.data,c,h.dData,h.duration,h.nextData,f,r+1);break;default:r+=a.interpolation[p](l,d,e,u+d,h.data,c,h.dData,h.duration,h.nextData)}d++}}else for(r=0;r<l.keyframeWidth;)r+=l.interpolationMethod[r](l,r,e,u+r,h.data,c,h.dData,h.duration,h.nextData);u+=l.keyframeWidth}}}])&&b(e.prototype,n),i&&b(e,i),a}(d.Resource);e.AnimationTemplet=C,C.interpolation=[C._LinearInterpolation_0,C._QuaternionInterpolation_1,C._AngleInterpolation_2,C._RadiansInterpolation_3,C._Matrix4x4Interpolation_4,C._NoInterpolation_5,C._BezierInterpolation_6,C._BezierInterpolation_7],y.IAniLib.AnimationTemplet=C},2689:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.GraphicsAni=void 0;var h=_(n(85507)),c=_(n(21611)),f=n(18008);function _(t){return t&&t.__esModule?t:{default:t}}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function y(t,e){return y=a||function(t,e){return t.__proto__=e,t},y(t,e)}function v(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=m(t);if(e){var a=m(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return g(this,n)}}function g(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function m(t){return m=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},m(t)}var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(a,t);var e,n,i,r=v(a);function a(){return d(this,a),r.apply(this,arguments)}return e=a,i=[{key:"create",value:function(){return a._caches.pop()||new a}},{key:"recycle",value:function(t){t.clear(),a._caches.push(t)}}],(n=[{key:"drawSkin",value:function(t,e){this.drawTriangles(t.texture,0,0,t.vertices,t.uvs,t.indexes,t.transform||f.Matrix.EMPTY,e)}}])&&p(e.prototype,n),i&&p(e,i),a}(n(72276).Graphics);e.GraphicsAni=b,b._caches=[]},90984:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.KeyFramesContent=void 0;e.KeyFramesContent=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}},62775:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Bone=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(81097),o=n(78362),s=n(18008),u=n(92493);function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var h=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.length=10,this.resultTransform=new a.Transform,this.resultMatrix=new s.Matrix,this.inheritScale=!0,this.inheritRotation=!0,this.d=-1,this._children=[]}var e,n,i;return e=t,n=[{key:"setTempMatrix",value:function(t){this._tempMatrix=t;var e,n=0;for(n=0,e=this._children.length;n<e;n++)this._children[n].setTempMatrix(this._tempMatrix)}},{key:"update",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.rotation=this.transform.skX,e)t=this.resultTransform.getMatrix(),s.Matrix.mul(t,e,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)t=this.resultTransform.getMatrix(),s.Matrix.mul(t,this.parentBone.resultMatrix,this.resultMatrix);else{var n,i,r,a=this.parentBone,o=this.parentBone.resultMatrix;t=this.resultTransform.getMatrix();var u=o.a*t.tx+o.c*t.ty+o.tx,l=o.b*t.tx+o.d*t.ty+o.ty,h=new s.Matrix;this.inheritRotation?(n=Math.atan2(a.resultMatrix.b,a.resultMatrix.a),i=Math.cos(n),r=Math.sin(n),h.setTo(i,r,-r,i,0,0),s.Matrix.mul(this._tempMatrix,h,s.Matrix.TEMP),s.Matrix.TEMP.copyTo(h),t=this.resultTransform.getMatrix(),s.Matrix.mul(t,h,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI),this.resultMatrix.tx=u,this.resultMatrix.ty=l):(this.inheritScale,t=this.resultTransform.getMatrix(),s.Matrix.TEMP.identity(),s.Matrix.TEMP.d=this.d,s.Matrix.mul(t,s.Matrix.TEMP,this.resultMatrix),this.resultMatrix.tx=u,this.resultMatrix.ty=l)}else(t=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var c=0,f=0;for(c=0,f=this._children.length;c<f;c++)this._children[c].update()}},{key:"updateChild",value:function(){var t,e=0;for(e=0,t=this._children.length;e<t;e++)this._children[e].update()}},{key:"setRotation",value:function(t){this._sprite&&(this._sprite.rotation=180*t/Math.PI)}},{key:"updateDraw",value:function(e,n){t.ShowBones&&!t.ShowBones[this.name]||(this._sprite?(this._sprite.x=e+this.resultMatrix.tx,this._sprite.y=n+this.resultMatrix.ty):(this._sprite=new o.Sprite,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),u.ILaya.stage.addChild(this._sprite),this._sprite.x=e+this.resultMatrix.tx,this._sprite.y=n+this.resultMatrix.ty));var i,r=0;for(r=0,i=this._children.length;r<i;r++)this._children[r].updateDraw(e,n)}},{key:"addChild",value:function(t){this._children.push(t),t.parentBone=this}},{key:"findBone",value:function(t){if(this.name==t)return this;var e,n,i;for(e=0,n=this._children.length;e<n;e++)if(i=this._children[e].findBone(t))return i;return null}},{key:"localToWorld",value:function(t){var e=t[0],n=t[1];t[0]=e*this.resultMatrix.a+n*this.resultMatrix.c+this.resultMatrix.tx,t[1]=e*this.resultMatrix.b+n*this.resultMatrix.d+this.resultMatrix.ty}}],n&&l(e.prototype,n),i&&l(e,i),t}();e.Bone=h,h.ShowBones={}},18460:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.BoneSlot=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(69616),o=n(59514),s=n(92493),u=n(18008);function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var h=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.srcDisplayIndex=-1,this.type="src",this.displayIndex=-1,this.originalIndex=-1,this._replaceDic={}}var e,n,i;return e=t,n=[{key:"showSlotData",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.currSlotData=t,e&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null}},{key:"showDisplayByName",value:function(t){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(t))}},{key:"replaceDisplayByName",value:function(t,e){var n,i;this.currSlotData&&(n=this.currSlotData.getDisplayByName(t),i=this.currSlotData.getDisplayByName(e),this.replaceDisplayByIndex(n,i))}},{key:"replaceDisplayByIndex",value:function(t,e){this.currSlotData&&(this._replaceDic[t]=e,this.originalIndex==t&&this.showDisplayByIndex(t))}},{key:"showDisplayByIndex",value:function(t){if(this.originalIndex=t,null!=this._replaceDic[t]&&(t=this._replaceDic[t]),this.currSlotData&&t>-1&&t<this.currSlotData.displayArr.length){if(this.displayIndex=t,this.currDisplayData=this.currSlotData.displayArr[t],this.currDisplayData){var e=this.currDisplayData.name;this.currTexture=this.templet.getTexture(e),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null}},{key:"replaceSkin",value:function(t){this._diyTexture=t,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)}},{key:"setParentMatrix",value:function(t){this._parentMatrix=t}},{key:"getSaveVerticle",value:function(e){return t.useSameMatrixAndVerticle&&this._preGraphicVerticle&&t.isSameArr(e,this._preGraphicVerticle)?e=this._preGraphicVerticle:(e=s.ILaya.Utils.copyArray([],e),this._preGraphicVerticle=e),e}},{key:"getSaveMatrix",value:function(e){if(t.useSameMatrixAndVerticle&&this._preGraphicMatrix&&t.isSameMatrix(e,this._preGraphicMatrix))e=this._preGraphicMatrix;else{var n=e.clone();e=n,this._preGraphicMatrix=e}return e}},{key:"draw",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if((null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var o,s=this.currTexture;switch(this._diyTexture&&(s=this._diyTexture),this.currDisplayData.type){case 0:if(e){var l=this.getDisplayMatrix();if(this._parentMatrix){var h=!1;if(l){var c;if(u.Matrix.mul(l,this._parentMatrix,u.Matrix.TEMP),i?(null==this._resultMatrix&&(this._resultMatrix=new u.Matrix),c=this._resultMatrix):c=t._tempResultMatrix,this._diyTexture&&this.currDisplayData.uvs){var f=t._tempMatrix;f.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(f.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(h=!0,f.rotate(-Math.PI/2)),u.Matrix.mul(f,u.Matrix.TEMP,c)}else u.Matrix.TEMP.copyTo(c);i||(c=this.getSaveMatrix(c)),c._checkTransform(),h?e.drawTexture(s,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,c,r):e.drawTexture(s,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,c,r)}}}break;case 1:if(i?(null==this._skinSprite&&(this._skinSprite=t.createSkinMesh()),o=this._skinSprite):o=t.createSkinMesh(),null==o)return;var _;if(null==this.currDisplayData.bones){var d,p=this.currDisplayData.weights;this.deformData&&(p=this.deformData),this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=a.UVTools.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=a.UVTools.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),d=this._curDiyUV):d=this.currDisplayData.uvs,this._mVerticleArr=p,this.currDisplayData.triangles.length,_=this.currDisplayData.triangles,this.deformData&&(i||(this._mVerticleArr=this.getSaveVerticle(this._mVerticleArr))),o.init2(s,_,this._mVerticleArr,d);var y,v=this.getDisplayMatrix();this._parentMatrix&&v&&(u.Matrix.mul(v,this._parentMatrix,u.Matrix.TEMP),i?(null==this._resultMatrix&&(this._resultMatrix=new u.Matrix),y=this._resultMatrix):y=t._tempResultMatrix,u.Matrix.TEMP.copyTo(y),i||(y=this.getSaveMatrix(y)),o.transform=y)}else this.skinMesh(n,o);e.drawSkin(o,r);break;case 2:if(i?(null==this._skinSprite&&(this._skinSprite=t.createSkinMesh()),o=this._skinSprite):o=t.createSkinMesh(),null==o)return;this.skinMesh(n,o),e.drawSkin(o,r)}}}},{key:"skinMesh",value:function(e,n){var i,r=this.currTexture,o=this.currDisplayData.bones;this._diyTexture?(r=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=a.UVTools.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=a.UVTools.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),i=this._curDiyUV):i=this.currDisplayData.uvs;var s,u,l,h,c,f=this.currDisplayData.weights,_=this.currDisplayData.triangles,d=0,p=0,y=0,v=0,g=0,m=0,b=0;if(t._tempVerticleArr.length=0,c=t._tempVerticleArr,this.deformData&&this.deformData.length>0){var T=0;for(m=0,b=o.length;m<b;){for(y=o[m++]+m,d=0,p=0;m<y;m++)u=e[o[m]],l=f[v]+this.deformData[T++],h=f[v+1]+this.deformData[T++],g=f[v+2],d+=(l*u.a+h*u.c+u.tx)*g,p+=(l*u.b+h*u.d+u.ty)*g,v+=3;c.push(d,p)}}else for(m=0,b=o.length;m<b;){for(y=o[m++]+m,d=0,p=0;m<y;m++)u=e[o[m]],l=f[v],h=f[v+1],g=f[v+2],d+=(l*u.a+h*u.c+u.tx)*g,p+=(l*u.b+h*u.d+u.ty)*g,v+=3;c.push(d,p)}this._mVerticleArr=c,s=_,this._mVerticleArr=this.getSaveVerticle(this._mVerticleArr),n.init2(r,s,this._mVerticleArr,i)}},{key:"drawBonePoint",value:function(t){t&&this._parentMatrix&&t.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")}},{key:"getDisplayMatrix",value:function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null}},{key:"getMatrix",value:function(){return this._resultMatrix}},{key:"copy",value:function(){var e=new t;return e.type="copy",e.name=this.name,e.attachmentName=this.attachmentName,e.srcDisplayIndex=this.srcDisplayIndex,e.parent=this.parent,e.displayIndex=this.displayIndex,e.templet=this.templet,e.currSlotData=this.currSlotData,e.currTexture=this.currTexture,e.currDisplayData=this.currDisplayData,e}}],i=[{key:"createSkinMesh",value:function(){return new o.SkinMeshForGraphic}},{key:"isSameArr",value:function(t,e){if(t.length!=e.length)return!1;var n,i;for(i=t.length,n=0;n<i;n++)if(t[n]!=e[n])return!1;return!0}},{key:"isSameMatrix",value:function(t,e){return t.a==e.a&&t.b==e.b&&t.c==e.c&&t.d==e.d&&Math.abs(t.tx-e.tx)<1e-5&&Math.abs(t.ty-e.ty)<1e-5}}],n&&l(e.prototype,n),i&&l(e,i),t}();e.BoneSlot=h,h._tempMatrix=new u.Matrix,h._tempResultMatrix=new u.Matrix,h.useSameMatrixAndVerticle=!0,h._tempVerticleArr=[]},39512:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.DeformAniData=void 0;e.DeformAniData=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.deformSlotDataList=[]}},28973:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.DeformSlotData=void 0;e.DeformSlotData=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.deformSlotDisplayList=[]}},50403:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.DeformSlotDisplayData=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i};function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.slotIndex=-1,this.timeList=[],this.vectices=[],this.tweenKeyList=[],this.frameIndex=0}var e,n,i;return e=t,n=[{key:"binarySearch1",value:function(t,e){var n=0,i=t.length-2;if(0==i)return 1;for(var r=i>>>1;;){if(t[Math.floor(r+1)]<=e?n=r+1:i=r,n==i)return n+1;r=n+i>>>1}return 0}},{key:"apply",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(t+=.05,!(this.timeList.length<=0)){var i=0,r=this.timeList[0];if(!(t<r)){var a=this.vectices[0].length,o=[],s=this.binarySearch1(this.timeList,t);if(this.frameIndex=s,t>=this.timeList[this.timeList.length-1]){var u=this.vectices[this.vectices.length-1];if(n<1)for(i=0;i<a;i++)o[i]+=(u[i]-o[i])*n;else for(i=0;i<a;i++)o[i]=u[i];this.deformData=o}else{var l,h=this.vectices[this.frameIndex-1],c=this.vectices[this.frameIndex],f=this.timeList[this.frameIndex-1],_=this.timeList[this.frameIndex];for(n=this.tweenKeyList[s-1]?(t-f)/(_-f):0,i=0;i<a;i++)l=h[i],o[i]=l+(c[i]-l)*n;this.deformData=o}}}}}],n&&a(e.prototype,n),i&&a(e,i),t}();e.DeformSlotDisplayData=o},29564:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.DrawOrderData=void 0;e.DrawOrderData=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.drawOrder=[]}},15571:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.EventData=void 0;e.EventData=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}},11142:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.IkConstraint=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(18008),o=n(78362),s=n(92493);function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var l=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.isSpine=!0,this.isDebug=!1,this._targetBone=n[e.targetBoneIndex],this.isSpine=e.isSpine,null==this._bones&&(this._bones=[]),this._bones.length=0;for(var i=0,r=e.boneIndexs.length;i<r;i++)this._bones.push(n[e.boneIndexs[i]]);this.name=e.name,this.mix=e.mix,this.bendDirection=e.bendDirection}var e,n,i;return e=t,(n=[{key:"apply",value:function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}}},{key:"_applyIk1",value:function(e,n,i,r){var a=e.parentBone,o=1/(a.resultMatrix.a*a.resultMatrix.d-a.resultMatrix.b*a.resultMatrix.c),s=n-a.resultMatrix.tx,u=i-a.resultMatrix.ty,l=(s*a.resultMatrix.d-u*a.resultMatrix.c)*o-e.transform.x,h=(u*a.resultMatrix.a-s*a.resultMatrix.b)*o-e.transform.y,c=Math.atan2(h,l)*t.radDeg-0-e.transform.skX;e.transform.scX<0&&(c+=180),c>180?c-=360:c<-180&&(c+=360),e.transform.skX=e.transform.skY=e.transform.skX+c*r,e.update()}},{key:"updatePos",value:function(t,e){this._sp&&this._sp.pos(t,e)}},{key:"_applyIk2",value:function(e,n,i,r,a,u){if(0!=u){var l,h,c,f=e.resultTransform.x,_=e.resultTransform.y,d=e.transform.scX,p=e.transform.scY,y=n.transform.scX;d<0?(d=-d,l=180,c=-1):(l=0,c=1),p<0&&(p=-p,c=-c),y<0?(y=-y,h=180):h=0;var v,g,m,b=n.resultTransform.x,T=e.resultMatrix.a,x=e.resultMatrix.c,w=e.resultMatrix.b,k=e.resultMatrix.d,C=Math.abs(d-p)<=1e-4;C?(g=T*b+x*(v=n.resultTransform.y)+e.resultMatrix.tx,m=w*b+k*v+e.resultMatrix.ty):(v=0,g=T*b+e.resultMatrix.tx,m=w*b+e.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new o.Sprite,s.ILaya.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(i,r,15,"#ffff00"),this._sp.graphics.drawCircle(g,m,15,"#ff00ff")),e.setRotation(Math.atan2(m-e.resultMatrix.ty,g-e.resultMatrix.tx));var E=e.parentBone;T=E.resultMatrix.a,x=E.resultMatrix.c,w=E.resultMatrix.b;var S,M,L=1/(T*(k=E.resultMatrix.d)-x*w),R=i-E.resultMatrix.tx,I=r-E.resultMatrix.ty,A=(R*k-I*x)*L-f,D=(I*T-R*w)*L-_,B=((R=g-E.resultMatrix.tx)*k-(I=m-E.resultMatrix.ty)*x)*L-f,P=(I*T-R*w)*L-_,O=Math.sqrt(B*B+P*P),F=n.length*y;if(C){var U=(A*A+D*D-O*O-(F*=d)*F)/(2*O*F);U<-1?U=-1:U>1&&(U=1),M=Math.acos(U)*a,T=O+F*U,x=F*Math.sin(M),S=Math.atan2(D*T-A*x,A*T+D*x)}else{var N=(T=d*F)*T,G=(x=p*F)*x,H=A*A+D*D,W=Math.atan2(D,A),V=-2*G*O,Y=G-N;if((k=V*V-4*Y*(w=G*O*O+N*H-N*G))>0){var X=Math.sqrt(k);V<0&&(X=-X);var z=(X=-(V+X)/2)/Y,j=w/X,K=Math.abs(z)<Math.abs(j)?z:j;K*K<=H&&(I=Math.sqrt(H-K*K)*a,S=W-Math.atan2(I,K),M=Math.atan2(I/p,(K-O)/d))}var q=0,Z=Number.MAX_VALUE,Q=0,$=0,J=0,tt=0,et=0,nt=0;(k=(R=O+T)*R)>tt&&(J=0,tt=k,et=R),(k=(R=O-T)*R)<Z&&(q=Math.PI,Z=k,Q=R);var it=Math.acos(-T*O/(N-G));(k=(R=T*Math.cos(it)+O)*R+(I=x*Math.sin(it))*I)<Z&&(q=it,Z=k,Q=R,$=I),k>tt&&(J=it,tt=k,et=R,nt=I),H<=(Z+tt)/2?(S=W-Math.atan2($*a,Q),M=q*a):(S=W-Math.atan2(nt*a,et),M=J*a)}var rt=Math.atan2(v,b)*c,at=e.resultTransform.skX;(S=(S-rt)*t.radDeg+l-at)>180?S-=360:S<-180&&(S+=360),e.resultTransform.x=f,e.resultTransform.y=_,e.resultTransform.skX=e.resultTransform.skY=at+S*u,at=n.resultTransform.skX,at%=360,(M=((M+rt)*t.radDeg-0)*c+h-at)>180?M-=360:M<-180&&(M+=360),n.resultTransform.x=b,n.resultTransform.y=v,n.resultTransform.skX=n.resultTransform.skY=n.resultTransform.skY+M*u,e.update()}}},{key:"_applyIk3",value:function(e,n,i,r,a,u){if(0!=u){var l,h,c,f,_,d,p=n.resultMatrix.a*n.length,y=n.resultMatrix.b*n.length,v=p*p+y*y,g=Math.sqrt(v),m=e.resultMatrix.tx,b=e.resultMatrix.ty,T=n.resultMatrix.tx,x=n.resultMatrix.ty,w=T-m,k=x-b,C=w*w+k*k,E=Math.sqrt(C),S=(w=i-e.resultMatrix.tx)*w+(k=r-e.resultMatrix.ty)*k,M=Math.sqrt(S);if(g+E<=M||M+g<=E||M+E<=g){var L;T=m+(L=g+E<=M?1:-1)*(i-m)*E/M,x=b+L*(r-b)*E/M}else{var R=(C-v+S)/(2*S),I=Math.sqrt(C-R*R*S)/M,A=m+w*R,D=b+k*R,B=-k*I,P=w*I;a>0?(T=A-B,x=D-P):(T=A+B,x=D+P)}l=T,h=x,this.isDebug&&(this._sp||(this._sp=new o.Sprite,s.ILaya.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(m,b,15,"#ff00ff"),this._sp.graphics.drawCircle(i,r,15,"#ffff00"),this._sp.graphics.drawCircle(l,h,15,"#ff00ff")),c=Math.atan2(h-e.resultMatrix.ty,l-e.resultMatrix.tx),e.setRotation(c),(f=t._tempMatrix).identity(),f.rotate(c),f.scale(e.resultMatrix.getScaleX(),e.resultMatrix.getScaleY()),f.translate(e.resultMatrix.tx,e.resultMatrix.ty),f.copyTo(e.resultMatrix),e.updateChild(),_=Math.atan2(r-h,i-l),n.setRotation(_),(d=t._tempMatrix).identity(),d.rotate(_),d.scale(n.resultMatrix.getScaleX(),n.resultMatrix.getScaleY()),d.translate(l,h),f.copyTo(n.resultMatrix),n.updateChild()}}}])&&u(e.prototype,n),i&&u(e,i),t}();e.IkConstraint=l,l.radDeg=180/Math.PI,l.degRad=Math.PI/180,l._tempMatrix=new a.Matrix},36514:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.IkConstraintData=void 0;e.IkConstraintData=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.boneNames=[],this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneIndexs=[]}},42869:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.PathConstraint=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(18008);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._debugKey=!1,this._segments=[],this._curves=[],this.data=e,this.position=e.position,this.spacing=e.spacing,this.rotateMix=e.rotateMix,this.translateMix=e.translateMix,this.bones=[];for(var i=this.data.bones,r=0,a=i.length;r<a;r++)this.bones.push(n[i[r]])}var e,n,i;return e=t,(n=[{key:"apply",value:function(t,e){if(this.target){var n=this.translateMix,i=this.translateMix,r=i>0,a=this.data.spacingMode,o="length"==a,s=this.data.rotateMode,u="tangent"==s,l="chainScale"==s,h=[],c=this.bones.length,f=u?c:c+1,_=[];this._spaces=_,_[0]=this.position;var d=this.spacing;if(l||o)for(var p=0,y=f-1;p<y;){var v=this.bones[p],g=v.length,m=g*v.resultMatrix.a,b=g*v.resultMatrix.b;g=Math.sqrt(m*m+b*b),l&&(h[p]=g),_[++p]=o?Math.max(0,g+d):d}else for(p=1;p<f;p++)_[p]=d;var T=this.computeWorldPositions(this.target,t,e,f,u,"percent"==this.data.positionMode,"percent"==a);if(this._debugKey){for(p=0;p<T.length;p++)e.drawCircle(T[p++],T[p++],5,"#00ff00");var x=[];for(p=0;p<T.length;p++)x.push(T[p++],T[p++]);e.drawLines(0,0,x,"#ff0000")}var w,k=T[0],C=T[1],E=this.data.offsetRotation,S="chain"==s&&0==E;for(p=0,w=3;p<c;p++,w+=3){(v=this.bones[p]).resultMatrix.tx+=(k-v.resultMatrix.tx)*n,v.resultMatrix.ty+=(C-v.resultMatrix.ty)*n;var M=(m=T[w])-k,L=(b=T[w+1])-C;if(l&&0!=(g=h[p])){var R=(Math.sqrt(M*M+L*L)/g-1)*i+1;v.resultMatrix.a*=R,v.resultMatrix.c*=R}if(k=m,C=b,r){var I,A,D,B=v.resultMatrix.a,P=v.resultMatrix.c,O=v.resultMatrix.b,F=v.resultMatrix.d;I=u?T[w-1]:0==_[p+1]?T[w+2]:Math.atan2(L,M),I-=Math.atan2(O,B)-E/180*Math.PI,S&&(A=Math.cos(I),D=Math.sin(I),k+=((g=v.length)*(A*B-D*O)-M)*i,C+=(g*(D*B+A*O)-L)*i),I>Math.PI?I-=2*Math.PI:I<-Math.PI&&(I+=2*Math.PI),I*=i,A=Math.cos(I),D=Math.sin(I),v.resultMatrix.a=A*B-D*O,v.resultMatrix.c=A*P-D*F,v.resultMatrix.b=D*B+A*O,v.resultMatrix.d=D*P+A*F}}}}},{key:"computeWorldVertices2",value:function(e,n,i,r,a,o){var s,u,l,h=e.currDisplayData.bones,c=e.currDisplayData.weights,f=e.currDisplayData.triangles,_=0,d=0,p=0,y=0,v=0,g=0,m=0,b=0,T=0,x=0;if(null!=h){for(_=0;_<i;_+=2)d+=(y=h[d])+1,p+=y;var w=n;for(v=o,g=3*p;v<r;v+=2){for(m=0,b=0,y=h[d++],y+=d;d<y;d++,g+=3){s=w[h[d]].resultMatrix,T=c[g],x=c[g+1];var k=c[g+2];m+=(T*s.a+x*s.c+s.tx)*k,b+=(T*s.b+x*s.d+s.ty)*k}a[v]=m,a[v+1]=b}}else{var C,E;if(f||(f=c),e.deformData&&(f=e.deformData),C=e.parent,n)for(l=n.length,_=0;_<l;_++)if(n[_].name==C){u=n[_];break}u&&(E=u.resultMatrix),E||(E=t._tempMt);var S=E.tx,M=E.ty,L=E.a,R=E.b,I=E.c,A=E.d;for(u&&(A*=u.d),d=i,v=o;v<r;d+=2,v+=2)T=f[d],x=f[d+1],a[v]=T*L+x*R+S,a[v+1]=-(T*I+x*A+M)}}},{key:"computeWorldPositions",value:function(t,e,n,i,r,a,o){t.currDisplayData.bones,t.currDisplayData.weights,t.currDisplayData.triangles;var s,u,l,h,c,f,_,d=[],p=0,y=t.currDisplayData.verLen,v=this.position,g=this._spaces,m=[],b=[],T=y/6,x=-1;if(T--,y-=4,this.computeWorldVertices2(t,e,2,y,d,0),this._debugKey)for(p=0;p<d.length;)n.drawCircle(d[p++],d[p++],10,"#ff0000");m=d,this._curves.length=T;var w=this._curves;s=0;var k,C,E,S,M,L,R,I,A,D=m[0],B=m[1],P=0,O=0,F=0,U=0,N=0,G=0;for(p=0,A=2;p<T;p++,A+=6)P=m[A],O=m[A+1],F=m[A+2],U=m[A+3],M=2*(k=.1875*(D-2*P+F))+(E=.09375*(3*(P-F)-D+(N=m[A+4]))),L=2*(C=.1875*(B-2*O+U))+(S=.09375*(3*(O-U)-B+(G=m[A+5]))),R=.75*(P-D)+k+.16666667*E,I=.75*(O-B)+C+.16666667*S,s+=Math.sqrt(R*R+I*I),R+=M,I+=L,M+=E,L+=S,s+=Math.sqrt(R*R+I*I),R+=M,I+=L,s+=Math.sqrt(R*R+I*I),R+=M+E,I+=L+S,s+=Math.sqrt(R*R+I*I),w[p]=s,D=N,B=G;if(a&&(v*=s),o)for(p=0;p<i;p++)g[p]*=s;var H,W=this._segments,V=0;for(p=0,u=0,l=0,H=0;p<i;p++,u+=3)if((h=v+=c=g[p])<0)this.addBeforePosition(h,m,0,b,u);else if(h>s)this.addAfterPosition(h-s,m,y-4,b,u);else{for(;;l++)if(!(h>(_=w[l]))){0==l?h/=_:h=(h-(f=w[l-1]))/(_-f);break}if(l!=x){x=l;var Y=6*l;for(D=m[Y],B=m[Y+1],P=m[Y+2],O=m[Y+3],F=m[Y+4],U=m[Y+5],M=2*(k=.03*(D-2*P+F))+(E=.006*(3*(P-F)-D+(N=m[Y+6]))),L=2*(C=.03*(B-2*O+U))+(S=.006*(3*(O-U)-B+(G=m[Y+7]))),R=.3*(P-D)+k+.16666667*E,I=.3*(O-B)+C+.16666667*S,V=Math.sqrt(R*R+I*I),W[0]=V,Y=1;Y<8;Y++)R+=M,I+=L,M+=E,L+=S,V+=Math.sqrt(R*R+I*I),W[Y]=V;R+=M,I+=L,V+=Math.sqrt(R*R+I*I),W[8]=V,R+=M+E,I+=L+S,V+=Math.sqrt(R*R+I*I),W[9]=V,H=0}for(h*=V;;H++)if(!(h>(_=W[H]))){0==H?h/=_:h=H+(h-(f=W[H-1]))/(_-f);break}this.addCurvePosition(.1*h,D,B,P,O,F,U,N,G,b,u,r||p>0&&0==c)}return b}},{key:"addBeforePosition",value:function(t,e,n,i,r){var a=e[n],o=e[n+1],s=e[n+2]-a,u=e[n+3]-o,l=Math.atan2(u,s);i[r]=a+t*Math.cos(l),i[r+1]=o+t*Math.sin(l),i[r+2]=l}},{key:"addAfterPosition",value:function(t,e,n,i,r){var a=e[n+2],o=e[n+3],s=a-e[n],u=o-e[n+1],l=Math.atan2(u,s);i[r]=a+t*Math.cos(l),i[r+1]=o+t*Math.sin(l),i[r+2]=l}},{key:"addCurvePosition",value:function(t,e,n,i,r,a,o,s,u,l,h,c){0==t&&(t=1e-4);var f=t*t,_=f*t,d=1-t,p=d*d,y=p*d,v=d*t,g=3*v,m=d*g,b=g*t,T=e*y+i*m+a*b+s*_,x=n*y+r*m+o*b+u*_;l[h]=T,l[h+1]=x,l[h+2]=c?Math.atan2(x-(n*p+r*v*2+o*f),T-(e*p+i*v*2+a*f)):0}}])&&o(e.prototype,n),i&&o(e,i),t}();e.PathConstraint=s,s.BEFORE=-2,s.AFTER=-3,s._tempMt=new a.Matrix},17847:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.PathConstraintData=void 0;e.PathConstraintData=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.bones=[]}},37564:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.Skeleton=void 0;var f=L(n(92762)),_=L(n(85507)),d=L(n(21611)),p=n(11142),y=n(42869),v=n(950),g=n(48796),m=n(2689),b=n(78362),T=n(41107),x=n(18008),w=n(89662),k=n(17886),C=n(14002),E=n(49029),S=n(92493),M=n(23835);function L(t){return t&&t.__esModule?t:{default:t}}function R(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function I(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function A(){return A="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=D(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},A.apply(this,arguments)}function D(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=F(t)););return t}function B(t,e){return B=a||function(t,e){return t.__proto__=e,t},B(t,e)}function P(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=F(t);if(e){var a=F(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return O(this,n)}}function O(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function F(t){return F=_.default?d.default:function(t){return t.__proto__||(0,d.default)(t)},F(t)}var U=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&B(t,e)}(a,t);var e,n,i,r=P(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return R(this,a),(t=r.call(this))._boneMatrixArray=[],t._lastTime=0,t._currAniIndex=-1,t._pause=!0,t._aniClipIndex=-1,t._clipIndex=-1,t._skinIndex=0,t._skinName="default",t._aniMode=0,t._index=-1,t._total=-1,t._indexControl=!1,t._eventIndex=0,t._drawOrderIndex=0,t._drawOrder=null,t._lastAniClipIndex=-1,t._lastUpdateAniClipIndex=-1,t._playAudio=!0,t._soundChannelArr=[],e&&t.init(e,n),t}return e=a,n=[{key:"init",value:function(t){var e,n,i,r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=0;if(1==a)for(this._graphicsCache=[],o=0,e=t.getAnimationCount();o<e;o++)this._graphicsCache.push([]);if(this._yReverseMatrix=t.yReverseMatrix,this._aniMode=a,this._templet=t,this._templet._addReference(1),this._player=new g.AnimationPlayer,this._player.cacheFrameRate=t.rate,this._player.templet=t,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=t.mBoneArr,this._rootBone=t.mRootBone,this._aniSectionDic=t.aniSectionDic,t.ikArr.length>0)for(this._ikArr=[],o=0,e=t.ikArr.length;o<e;o++)this._ikArr.push(new p.IkConstraint(t.ikArr[o],this._boneList));if(t.pathArr.length>0)for(null==this._pathDic&&(this._pathDic={}),o=0,e=t.pathArr.length;o<e;o++)n=t.pathArr[o],i=new y.PathConstraint(n,this._boneList),(r=this._boneSlotDic[n.name])&&((i=new y.PathConstraint(n,this._boneList)).target=r),this._pathDic[n.name]=i;if(t.tfArr.length>0)for(this._tfArr=[],o=0,e=t.tfArr.length;o<e;o++)this._tfArr.push(new v.TfConstraint(t.tfArr[o],this._boneList));if(t.skinDataArray.length>0){var s=this._templet.skinDataArray[this._skinIndex];this._skinName=s.name}this._player.on(w.Event.PLAYED,this,this._onPlay),this._player.on(w.Event.STOPPED,this,this._onStop),this._player.on(w.Event.PAUSED,this,this._onPause)}},{key:"url",get:function(){return this._aniPath},set:function(t){this.load(t)}},{key:"load",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._aniPath=t,this._complete=e,this._loadAniMode=n,S.ILaya.loader.load([{url:t,type:S.ILaya.Loader.BUFFER}],T.Handler.create(this,this._onLoaded))}},{key:"_onLoaded",value:function(){var t,e=S.ILaya.Loader.getRes(this._aniPath);null!=e&&(null==E.IAniLib.Templet.TEMPLET_DICTIONARY&&(E.IAniLib.Templet.TEMPLET_DICTIONARY={}),(t=E.IAniLib.Templet.TEMPLET_DICTIONARY[this._aniPath])?t.isParseFail?this._parseFail():t.isParserComplete?this._parseComplete():(t.on(w.Event.COMPLETE,this,this._parseComplete),t.on(w.Event.ERROR,this,this._parseFail)):((t=new E.IAniLib.Templet)._setCreateURL(this._aniPath),E.IAniLib.Templet.TEMPLET_DICTIONARY[this._aniPath]=t,t.on(w.Event.COMPLETE,this,this._parseComplete),t.on(w.Event.ERROR,this,this._parseFail),t.isParserComplete=!1,t.parseData(null,e)))}},{key:"_parseComplete",value:function(){var t=E.IAniLib.Templet.TEMPLET_DICTIONARY[this._aniPath];t&&(this.init(t,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)}},{key:"_parseFail",value:function(){console.log("[Error]:"+this._aniPath+"解析失败")}},{key:"_onPlay",value:function(){this.event(w.Event.PLAYED)}},{key:"_onStop",value:function(){var t,e=this._templet.eventAniArr[this._aniClipIndex];if(e&&this._eventIndex<e.length)for(;this._eventIndex<e.length;this._eventIndex++)(t=e[this._eventIndex]).time>=this._player.playStart&&t.time<=this._player.playEnd&&this.event(w.Event.LABEL,t);this._drawOrder=null,this.event(w.Event.STOPPED)}},{key:"_onPause",value:function(){this.event(w.Event.PAUSED)}},{key:"_parseSrcBoneMatrix",value:function(){var t=0,e=0;for(e=this._templet.srcBoneMatrixArr.length,t=0;t<e;t++)this._boneMatrixArray.push(new x.Matrix);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var n,i,r=this._templet.boneSlotArray;for(t=0,e=r.length;t<e;t++)n=r[t],null==(i=this._bindBoneBoneSlotDic[n.parent])&&(this._bindBoneBoneSlotDic[n.parent]=i=[]),this._boneSlotDic[n.name]=n=n.copy(),i.push(n),this._boneSlotArray.push(n)}}},{key:"_emitMissedEvents",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this._templet.eventAniArr,r=i[this._player.currentAnimationClipIndex];if(r){var a,o,s=0;for(a=r.length,s=n;s<a;s++)(o=r[s]).time>=this._player.playStart&&o.time<=this._player.playEnd&&this.event(w.Event.LABEL,o)}}},{key:"_update",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!(t&&this._pause||t&&this._indexControl)){var e=this.timer.currTimer,n=this._player.currentKeyframeIndex,i=e-this._lastTime;if(t?this._player._update(i):n=-1,this._lastTime=e,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||i>0&&this._clipIndex==n&&this._lastUpdateAniClipIndex==this._aniClipIndex))){this._lastUpdateAniClipIndex=this._aniClipIndex,n>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var r,a,o=this._templet.eventAniArr[this._aniClipIndex];if(o&&this._eventIndex<o.length){var s=o[this._eventIndex];s.time>=this._player.playStart&&s.time<=this._player.playEnd?this._player.currentPlayTime>=s.time&&(this.event(w.Event.LABEL,s),this._eventIndex++,this._playAudio&&s.audioValue&&"null"!==s.audioValue&&"undefined"!==s.audioValue&&(r=k.SoundManager.playSound(this._player.templet._path+s.audioValue,1,T.Handler.create(this,this._onAniSoundStoped)),k.SoundManager.playbackRate=this._player.playbackRate,r&&this._soundChannelArr.push(r))):s.time<this._player.playStart&&this._playAudio&&s.audioValue&&"null"!==s.audioValue&&"undefined"!==s.audioValue?(this._eventIndex++,r=k.SoundManager.playSound(this._player.templet._path+s.audioValue,1,T.Handler.create(this,this._onAniSoundStoped),null,(this._player.currentPlayTime-s.time)/1e3),k.SoundManager.playbackRate=this._player.playbackRate,r&&this._soundChannelArr.push(r)):this._eventIndex++}0==this._aniMode?(a=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex)||this._createGraphics())&&this.graphics!=a&&(this.graphics=a):1==this._aniMode?(a=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex)||this._createGraphics())&&this.graphics!=a&&(this.graphics=a):this._createGraphics()}}}},{key:"_onAniSoundStoped",value:function(t){for(var e,n=this._soundChannelArr.length,i=0;i<n;i++){var r;((e=this._soundChannelArr[i]).isStopped||t)&&(!e.isStopped&&e.stop(),(0,f.default)(r=this._soundChannelArr).call(r,i,1),n--,i--)}}},{key:"_createGraphics",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;-1==t&&(t=this._clipIndex);var e,n=t*this._player.cacheFrameRateInterval,i=this._templet.drawOrderAniArr,r=i[this._aniClipIndex];if(r&&r.length>0)for(this._drawOrderIndex=0,e=r[this._drawOrderIndex];n>=e.time&&(this._drawOrder=e.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=r.length));)e=r[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=m.GraphicsAni.create():this.graphics instanceof m.GraphicsAni?this.graphics.clear():this.graphics=m.GraphicsAni.create();var a=this.graphics,o=this._templet.getNodes(this._aniClipIndex),s=0==this._player.state;this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,null,t,s?n+this._player.cacheFrameRateInterval:n);var u,l,h,c,f=this._aniSectionDic[this._aniClipIndex],_=0,d=0,p=0,y=0,v=0,g=this._templet.srcBoneMatrixArr.length,b=this._curOriginalData;for(d=0,v=f[0];d<g;d++){var T=(c=this._boneList[d]).resultTransform;h=this._templet.srcBoneMatrixArr[d],T.scX=h.scX*b[_++],T.skX=h.skX+b[_++],T.skY=h.skY+b[_++],T.scY=h.scY*b[_++],T.x=h.x+b[_++],T.y=h.y+b[_++],8===this._templet.tMatrixDataLen&&(T.skewX=h.skewX+b[_++],T.skewY=h.skewY+b[_++])}var w,k={},E={};for(v+=f[1];d<v;d++)k[(w=o[d]).name]=b[_++],E[w.name]=b[_++],_+=4;var S,M,L={},R={};for(v+=f[2];d<v;d++)L[(w=o[d]).name]=b[_++],R[w.name]=b[_++],_+=4;if(this._pathDic)for(v+=f[3];d<v;d++)if(w=o[d],S=this._pathDic[w.name]){var I=new C.Byte(w.extenData);switch(I.getByte()){case 1:S.position=b[_++];break;case 2:S.spacing=b[_++];break;case 3:S.rotateMix=b[_++],S.translateMix=b[_++]}}if(this._rootBone.update(this._yReverseMatrix||x.Matrix.TEMP.identity()),this._ikArr)for(d=0,v=this._ikArr.length;d<v;d++)(M=this._ikArr[d]).name in L&&(M.bendDirection=L[M.name]),M.name in R&&(M.mix=R[M.name]),M.apply();if(this._pathDic)for(var A in this._pathDic)(S=this._pathDic[A]).apply(this._boneList,a);if(this._tfArr)for(d=0,y=this._tfArr.length;d<y;d++)this._tfArr[d].apply();for(d=0,y=this._boneList.length;d<y;d++)if(c=this._boneList[d],l=this._bindBoneBoneSlotDic[c.name],c.resultMatrix.copyTo(this._boneMatrixArray[d]),l)for(p=0,v=l.length;p<v;p++)(u=l[p])&&u.setParentMatrix(c.resultMatrix);var D,B,P,O,F={},U=this._templet.deformAniArr;if(U&&U.length>0){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,d=0,v=this._boneSlotArray.length;d<v;d++)(u=this._boneSlotArray[d]).deformData=null;var N,G=U[this._aniClipIndex];for(N in D=G.default,this._setDeform(D,F,this._boneSlotArray,n),G)"default"!=N&&N!=this._skinName&&(D=G[N],this._setDeform(D,F,this._boneSlotArray,n));D=G[this._skinName],this._setDeform(D,F,this._boneSlotArray,n)}if(this._drawOrder)for(d=0,v=this._drawOrder.length;d<v;d++)B=k[(u=this._boneSlotArray[this._drawOrder[d]]).name],P=E[u.name],isNaN(P),isNaN(B)||-2==B||(this._templet.attachmentNames?u.showDisplayByName(this._templet.attachmentNames[B]):u.showDisplayByIndex(B)),F[this._drawOrder[d]]?(O=F[this._drawOrder[d]],u.currDisplayData&&O[u.currDisplayData.attachmentName]?u.deformData=O[u.currDisplayData.attachmentName]:u.deformData=null):u.deformData=null,isNaN(P)?u.draw(a,this._boneMatrixArray,2==this._aniMode):u.draw(a,this._boneMatrixArray,2==this._aniMode,P),isNaN(P);else for(d=0,v=this._boneSlotArray.length;d<v;d++)B=k[(u=this._boneSlotArray[d]).name],P=E[u.name],isNaN(P),isNaN(B)||-2==B||(this._templet.attachmentNames?u.showDisplayByName(this._templet.attachmentNames[B]):u.showDisplayByIndex(B)),F[d]?(O=F[d],u.currDisplayData&&O[u.currDisplayData.attachmentName]?u.deformData=O[u.currDisplayData.attachmentName]:u.deformData=null):u.deformData=null,isNaN(P)?u.draw(a,this._boneMatrixArray,2==this._aniMode):u.draw(a,this._boneMatrixArray,2==this._aniMode,P),isNaN(P);return 0==this._aniMode?(this._templet.setGrahicsDataWithCache(this._aniClipIndex,t,a),this._checkIsAllParsed(this._aniClipIndex)):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,t,a),a}},{key:"_checkIsAllParsed",value:function(t){var e,n;for(n=Math.floor(.01+this._templet.getAniDuration(t)/1e3*this._player.cacheFrameRate),e=0;e<n;e++)if(!this._templet.getGrahicsDataWithCache(t,e))return;this._templet.getGrahicsDataWithCache(t,n)?this._templet.deleteAniData(t):this._createGraphics(n)}},{key:"_setDeform",value:function(t,e,n,i){var r,a,o,s,u,l;if(t&&t)for(s=0,u=t.deformSlotDataList.length;s<u;s++)for(r=t.deformSlotDataList[s],l=0;l<r.deformSlotDisplayList.length;l++)o=n[(a=r.deformSlotDisplayList[l]).slotIndex],a.apply(i,o),e[a.slotIndex]||(e[a.slotIndex]={}),e[a.slotIndex][a.attachment]=a.deformData}},{key:"getAnimNum",value:function(){return this._templet.getAnimationCount()}},{key:"getAniNameByIndex",value:function(t){return this._templet.getAniNameByIndex(t)}},{key:"getSlotByName",value:function(t){return this._boneSlotDic[t]}},{key:"showSkinByName",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.showSkinByIndex(this._templet.getSkinIndexByName(t),e)}},{key:"showSkinByIndex",value:function(t){for(var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=0;n<this._boneSlotArray.length;n++)this._boneSlotArray[n].showSlotData(null,e);if(this._templet.showSkinByIndex(this._boneSlotDic,t,e)){var i=this._templet.skinDataArray[t];this._skinIndex=t,this._skinName=i.name}this._clearCache()}},{key:"showSlotSkinByIndex",value:function(t,e){if(0!=this._aniMode){var n=this.getSlotByName(t);n&&n.showDisplayByIndex(e),this._clearCache()}}},{key:"showSlotSkinByName",value:function(t,e){if(0!=this._aniMode){var n=this.getSlotByName(t);n&&n.showDisplayByName(e),this._clearCache()}}},{key:"replaceSlotSkinName",value:function(t,e,n){if(0!=this._aniMode){var i=this.getSlotByName(t);i&&i.replaceDisplayByName(e,n),this._clearCache()}}},{key:"replaceSlotSkinByIndex",value:function(t,e,n){if(0!=this._aniMode){var i=this.getSlotByName(t);i&&i.replaceDisplayByIndex(e,n),this._clearCache()}}},{key:"setSlotSkin",value:function(t,e){if(0!=this._aniMode){var n=this.getSlotByName(t);n&&n.replaceSkin(e),this._clearCache()}}},{key:"_clearCache",value:function(){if(1==this._aniMode)for(var t=0,e=this._graphicsCache.length;t<e;t++){for(var n=0,i=this._graphicsCache[t].length;n<i;n++){var r=this._graphicsCache[t][n];r&&r!=this.graphics&&m.GraphicsAni.recycle(r)}this._graphicsCache[t].length=0}}},{key:"play",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];this._playAudio=o,this._indexControl=!1;var s,u=-1;if(s=e?2147483647:0,"string"==typeof t)for(var l=0,h=this._templet.getAnimationCount();l<h;l++){var c=this._templet.getAnimation(l);if(c&&t==c.name){u=l;break}}else u=t;u>-1&&u<this.getAnimNum()&&(this._aniClipIndex=u,(n||this._pause||this._currAniIndex!=u)&&(this._currAniIndex=u,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(u)),this._drawOrder=null,this._eventIndex=0,this._player.play(u,this._player.playbackRate,s,i,r),a&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=S.ILaya.Browser.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))}},{key:"stop",value:function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this._soundChannelArr.length>0&&this._onAniSoundStoped(!0),this.timer.clear(this,this._update))}},{key:"playbackRate",value:function(t){this._player&&(this._player.playbackRate=t)}},{key:"paused",value:function(){if(!this._pause){if(this._pause=!0,this._player&&(this._player.paused=!0),this._soundChannelArr.length>0)for(var t,e=this._soundChannelArr.length,n=0;n<e;n++)(t=this._soundChannelArr[n]).isStopped||t.pause();this.timer.clear(this,this._update)}}},{key:"resume",value:function(){if(this._indexControl=!1,this._pause){if(this._pause=!1,this._player&&(this._player.paused=!1),this._soundChannelArr.length>0)for(var t,e=this._soundChannelArr.length,n=0;n<e;n++)(t=this._soundChannelArr[n]).audioBuffer&&t.resume();this._lastTime=S.ILaya.Browser.now(),this.timer.frameLoop(1,this,this._update,null,!0)}}},{key:"_getGrahicsDataWithCache",value:function(t,e){return this._graphicsCache[t][e]}},{key:"_setGrahicsDataWithCache",value:function(t,e,n){this._graphicsCache[t][e]=n}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];A(F(a.prototype),"destroy",this).call(this,t),this._templet._removeReference(1),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update),this._soundChannelArr.length>0&&this._onAniSoundStoped(!0)}},{key:"index",get:function(){return this._index},set:function(t){this.player&&(this._index=t,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,(this._aniClipIndex<0||this._aniClipIndex>=this.getAnimNum())&&(this._aniClipIndex=0,this._currAniIndex=0,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(this._currAniIndex)),this._drawOrder=null,this._eventIndex=0),this._update(!1))}},{key:"total",get:function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}},{key:"player",get:function(){return this._player}},{key:"templet",get:function(){return this._templet}}],n&&I(e.prototype,n),i&&I(e,i),a}(b.Sprite);e.Skeleton=U,U.useSimpleMeshInCanvas=!1,E.IAniLib.Skeleton=U,S.ILaya.regClass(U),M.ClassUtils.regClass("laya.ani.bone.Skeleton",U),M.ClassUtils.regClass("Laya.Skeleton",U)},92487:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.SkinData=void 0;e.SkinData=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.slotArr=[]}},4286:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.SkinSlotDisplayData=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(54598);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,(n=[{key:"createTexture",value:function(t){return this.texture||(this.texture=new a.Texture(t.bitmap,this.uvs),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=t.height,this.texture.height=t.width,this.texture.offsetX=-t.offsetX,this.texture.offsetY=-t.offsetY,this.texture.sourceWidth=t.sourceHeight,this.texture.sourceHeight=t.sourceWidth):(this.texture.width=t.width,this.texture.height=t.height,this.texture.offsetX=-t.offsetX,this.texture.offsetY=-t.offsetY,this.texture.sourceWidth=t.sourceWidth,this.texture.sourceHeight=t.sourceHeight)),this.texture}},{key:"destory",value:function(){this.texture&&this.texture.destroy()}}])&&o(e.prototype,n),i&&o(e,i),t}();e.SkinSlotDisplayData=s},8359:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.SlotData=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i};function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.displayArr=[]}var e,n,i;return e=t,(n=[{key:"getDisplayByName",value:function(t){for(var e=0,n=this.displayArr.length;e<n;e++)if(this.displayArr[e].attachmentName==t)return e;return-1}}])&&a(e.prototype,n),i&&a(e,i),t}();e.SlotData=o},48365:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.Templet=void 0;var f=G(n(3649)),_=G(n(23054)),d=G(n(81643)),p=G(n(85507)),y=G(n(21611)),v=n(62775),g=n(87338),m=n(17847),b=n(39512),T=n(28973),x=n(50403),w=n(29564),k=n(15571),C=n(23038),E=n(18460),S=n(92487),M=n(4286),L=n(8359),R=n(81097),I=n(36514),A=n(54598),D=n(18008),B=n(41107),P=n(89662),O=n(14002),F=n(49029),U=n(37564),N=n(92493);function G(t){return t&&t.__esModule?t:{default:t}}function H(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function W(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function V(){return V="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=Y(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},V.apply(this,arguments)}function Y(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=K(t)););return t}function X(t,e){return X=a||function(t,e){return t.__proto__=e,t},X(t,e)}function z(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=K(t);if(e){var a=K(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return j(this,n)}}function j(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function K(t){return K=p.default?y.default:function(t){return t.__proto__||(0,y.default)(t)},K(t)}var q=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&X(t,e)}(a,t);var e,n,i,r=z(a);function a(){var t;return H(this,a),(t=r.apply(this,arguments))._graphicsCache=[],t.srcBoneMatrixArr=[],t.ikArr=[],t.tfArr=[],t.pathArr=[],t.boneSlotDic={},t.bindBoneBoneSlotDic={},t.boneSlotArray=[],t.skinDataArray=[],t.skinDic={},t.subTextureDic={},t.isParseFail=!1,t.drawOrderAniArr=[],t.eventAniArr=[],t.attachmentNames=null,t.deformAniArr=[],t.skinSlotDisplayDataArr=[],t._isParseAudio=!1,t._isDestroyed=!1,t._rate=30,t.isParserComplete=!1,t.aniSectionDic={},t._textureDic={},t.mBoneArr=[],t}return e=a,n=[{key:"loadAni",value:function(t){this._skBufferUrl=t,N.ILaya.loader.load(t,B.Handler.create(this,this.onComplete),null,N.ILaya.Loader.BUFFER)}},{key:"onComplete",value:function(){var t,e;if(this._isDestroyed)this.destroy();else{var n=N.ILaya.Loader.getRes(this._skBufferUrl);n?(this._path=(0,f.default)(t=this._skBufferUrl).call(t,0,(0,_.default)(e=this._skBufferUrl).call(e,"/"))+"/",this.parseData(null,n)):this.event(P.Event.ERROR,"load failed:"+this._skBufferUrl)}}},{key:"parseData",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30;if(!this._path){var i=this._relativeUrl||this.url;if(i){var r=(0,_.default)(i).call(i,"/");this._path=r>0?(0,f.default)(i).call(i,0,r)+"/":""}}this._mainTexture=t,this._rate=n,this.parse(e)}},{key:"buildArmature",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new U.Skeleton(this,t)}},{key:"parse",value:function(t){V(K(a.prototype),"parse",this).call(this,t),this.event(P.Event.LOADED,this),this._aniVersion===a.LAYA_ANIMATION_VISION?this._isParseAudio=!0:this._aniVersion!=a.LAYA_ANIMATION_160_VISION&&console.log("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+a.LAYA_ANIMATION_VISION),this._mainTexture?this._parsePublicExtData():this._parseTexturePath()}},{key:"_parseTexturePath",value:function(){if(this._isDestroyed)this.destroy();else{var t=0;this._loadList=[];var e,n=new O.Byte(this.getPublicExtData()),i=0,r=n.getInt32(),a=n.readUTFString(),o=a.split("\n");for(t=0;t<r;t++){var s;e=this._path+o[2*t],a=o[2*t+1],n.getFloat32(),n.getFloat32(),n.getFloat32(),n.getFloat32(),i=n.getFloat32(),isNaN(i),i=n.getFloat32(),isNaN(i),i=n.getFloat32(),isNaN(i),i=n.getFloat32(),isNaN(i),-1==(0,d.default)(s=this._loadList).call(s,e)&&this._loadList.push(e)}N.ILaya.loader.load(this._loadList,B.Handler.create(this,this._textureComplete))}}},{key:"_textureComplete",value:function(){for(var t,e=0,n=this._loadList.length;e<n;e++)t=this._loadList[e],this._textureDic[t]=N.ILaya.Loader.getRes(t);this._parsePublicExtData()}},{key:"_parsePublicExtData",value:function(){var t,e=0,n=0,i=0,r=0,a=0;for(e=0,a=this.getAnimationCount();e<a;e++)this._graphicsCache.push([]);t="Dragon"!=this._aniClassName;var o,s,u=new O.Byte(this.getPublicExtData()),l=0,h=0,c=0,f=0,_=0,d=0,p=0,y=0,C=0,B=u.getInt32(),F=u.readUTFString(),U=F.split("\n");for(e=0;e<B;e++){if(o=this._mainTexture,s=this._path+U[2*e],F=U[2*e+1],null==this._mainTexture&&(o=this._textureDic[s]),!o)return this.event(P.Event.ERROR,this),void(this.isParseFail=!0);l=u.getFloat32(),h=u.getFloat32(),c=u.getFloat32(),f=u.getFloat32(),C=u.getFloat32(),_=isNaN(C)?0:C,C=u.getFloat32(),d=isNaN(C)?0:C,C=u.getFloat32(),p=isNaN(C)?c:C,C=u.getFloat32(),y=isNaN(C)?f:C,this.subTextureDic[F]=A.Texture.create(o,l,h,c,f,-_,-d,p,y)}this._mainTexture=o;var N,G,H,W,V,Y=u.getUint16();for(e=0;e<Y;e++)(N=[]).push(u.getUint16()),N.push(u.getUint16()),N.push(u.getUint16()),N.push(u.getUint16()),this.aniSectionDic[e]=N;var X,z=u.getInt16(),j={};for(e=0;e<z;e++)G=new v.Bone,0==e?X=G:G.root=X,G.d=t?-1:1,W=u.readUTFString(),V=u.readUTFString(),G.length=u.getFloat32(),1==u.getByte()&&(G.inheritRotation=!1),1==u.getByte()&&(G.inheritScale=!1),G.name=W,V&&((H=j[V])?H.addChild(G):this.mRootBone=G),j[W]=G,this.mBoneArr.push(G);this.tMatrixDataLen=u.getUint16();var K,q,Z=u.getUint16(),Q=Math.floor(Z/this.tMatrixDataLen),$=this.srcBoneMatrixArr;for(e=0;e<Q;e++)(K=new R.Transform).scX=u.getFloat32(),K.skX=u.getFloat32(),K.skY=u.getFloat32(),K.scY=u.getFloat32(),K.x=u.getFloat32(),K.y=u.getFloat32(),8===this.tMatrixDataLen&&(K.skewX=u.getFloat32(),K.skewY=u.getFloat32()),$.push(K),(G=this.mBoneArr[e]).transform=K;var J,tt,et=u.getUint16();for(e=0;e<et;e++){for(q=new I.IkConstraintData,J=u.getUint16(),n=0;n<J;n++)q.boneNames.push(u.readUTFString()),q.boneIndexs.push(u.getInt16());q.name=u.readUTFString(),q.targetBoneName=u.readUTFString(),q.targetBoneIndex=u.getInt16(),q.bendDirection=u.getFloat32(),q.mix=u.getFloat32(),q.isSpine=t,this.ikArr.push(q)}var nt,it,rt=u.getUint16();for(e=0;e<rt;e++){for(tt=new g.TfConstraintData,nt=u.getUint16(),n=0;n<nt;n++)tt.boneIndexs.push(u.getInt16());tt.name=u.getUTFString(),tt.targetIndex=u.getInt16(),tt.rotateMix=u.getFloat32(),tt.translateMix=u.getFloat32(),tt.scaleMix=u.getFloat32(),tt.shearMix=u.getFloat32(),tt.offsetRotation=u.getFloat32(),tt.offsetX=u.getFloat32(),tt.offsetY=u.getFloat32(),tt.offsetScaleX=u.getFloat32(),tt.offsetScaleY=u.getFloat32(),tt.offsetShearY=u.getFloat32(),this.tfArr.push(tt)}var at,ot,st,ut,lt,ht,ct,ft,_t,dt,pt=u.getUint16();for(e=0;e<pt;e++){for((it=new m.PathConstraintData).name=u.readUTFString(),at=u.getUint16(),n=0;n<at;n++)it.bones.push(u.getInt16());it.target=u.readUTFString(),it.positionMode=u.readUTFString(),it.spacingMode=u.readUTFString(),it.rotateMode=u.readUTFString(),it.offsetRotation=u.getFloat32(),it.position=u.getFloat32(),it.spacing=u.getFloat32(),it.rotateMix=u.getFloat32(),it.translateMix=u.getFloat32(),this.pathArr.push(it)}var yt,vt=u.getInt16();for(e=0;e<vt;e++){var gt=u.getUint8(),mt={};this.deformAniArr.push(mt);for(var bt=0;bt<gt;bt++)for((ct=new b.DeformAniData).skinName=u.getUTFString(),mt[ct.skinName]=ct,ot=u.getInt16(),n=0;n<ot;n++)for(ft=new T.DeformSlotData,ct.deformSlotDataList.push(ft),st=u.getInt16(),i=0;i<st;i++)for(_t=new x.DeformSlotDisplayData,ft.deformSlotDisplayList.push(_t),_t.slotIndex=u.getInt16(),_t.attachment=u.getUTFString(),ut=u.getInt16(),r=0;r<ut;r++)for(1==u.getByte()?_t.tweenKeyList.push(!0):_t.tweenKeyList.push(!1),lt=u.getFloat32(),_t.timeList.push(lt),dt=[],_t.vectices.push(dt),ht=u.getInt16(),a=0;a<ht;a++)dt.push(u.getFloat32())}var Tt,xt,wt,kt,Ct=u.getInt16();for(e=0;e<Ct;e++){for(Tt=u.getInt16(),yt=[],n=0;n<Tt;n++){for((xt=new w.DrawOrderData).time=u.getFloat32(),wt=u.getInt16(),i=0;i<wt;i++)xt.drawOrder.push(u.getInt16());yt.push(xt)}this.drawOrderAniArr.push(yt)}var Et,St,Mt=u.getInt16();for(e=0;e<Mt;e++){for(Et=u.getInt16(),kt=[],n=0;n<Et;n++)(St=new k.EventData).name=u.getUTFString(),this._isParseAudio&&(St.audioValue=u.getUTFString()),St.intValue=u.getInt32(),St.floatValue=u.getFloat32(),St.stringValue=u.getUTFString(),St.time=u.getFloat32(),kt.push(St);this.eventAniArr.push(kt)}var Lt=u.getInt16();if(Lt>0)for(this.attachmentNames=[],e=0;e<Lt;e++)this.attachmentNames.push(u.getUTFString());var Rt,It,At=u.getInt16();for(e=0;e<At;e++)(Rt=new E.BoneSlot).name=u.readUTFString(),Rt.parent=u.readUTFString(),Rt.attachmentName=u.readUTFString(),Rt.srcDisplayIndex=Rt.displayIndex=u.getInt16(),Rt.templet=this,this.boneSlotDic[Rt.name]=Rt,null==(It=this.bindBoneBoneSlotDic[Rt.parent])&&(this.bindBoneBoneSlotDic[Rt.parent]=It=[]),It.push(Rt),this.boneSlotArray.push(Rt);var Dt,Bt,Pt,Ot,Ft,Ut,Nt,Gt,Ht,Wt,Vt=u.readUTFString().split("\n"),Yt=0,Xt=u.getUint8();for(e=0;e<Xt;e++){for((Dt=new S.SkinData).name=Vt[Yt++],Ot=u.getUint8(),n=0;n<Ot;n++){for((Bt=new L.SlotData).name=Vt[Yt++],Rt=this.boneSlotDic[Bt.name],Ft=u.getUint8(),i=0;i<Ft;i++){if(Pt=new M.SkinSlotDisplayData,this.skinSlotDisplayDataArr.push(Pt),Pt.name=Vt[Yt++],Pt.attachmentName=Vt[Yt++],Pt.transform=new R.Transform,Pt.transform.scX=u.getFloat32(),Pt.transform.skX=u.getFloat32(),Pt.transform.skY=u.getFloat32(),Pt.transform.scY=u.getFloat32(),Pt.transform.x=u.getFloat32(),Pt.transform.y=u.getFloat32(),Bt.displayArr.push(Pt),Pt.width=u.getFloat32(),Pt.height=u.getFloat32(),Pt.type=u.getUint8(),Pt.verLen=u.getUint16(),(z=u.getUint16())>0)for(Pt.bones=[],r=0;r<z;r++){var zt=u.getUint16();Pt.bones.push(zt)}if((Ut=u.getUint16())>0)for(Pt.uvs=[],r=0;r<Ut;r++)Pt.uvs.push(u.getFloat32());if((Nt=u.getUint16())>0)for(Pt.weights=[],r=0;r<Nt;r++)Pt.weights.push(u.getFloat32());if((Gt=u.getUint16())>0)for(Pt.triangles=[],r=0;r<Gt;r++)Pt.triangles.push(u.getUint16());if((Ht=u.getUint16())>0)for(Pt.vertices=[],r=0;r<Ht;r++)Pt.vertices.push(u.getFloat32());if((Wt=u.getUint16())>0)for(Pt.lengths=[],r=0;r<Wt;r++)Pt.lengths.push(u.getFloat32())}Dt.slotArr.push(Bt)}this.skinDic[Dt.name]=Dt,this.skinDataArray.push(Dt)}1==u.getUint8()?(this.yReverseMatrix=new D.Matrix(1,0,0,-1,0,0),X&&X.setTempMatrix(this.yReverseMatrix)):X&&X.setTempMatrix(new D.Matrix),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event(P.Event.COMPLETE,this)}},{key:"getTexture",value:function(t){var e=this.subTextureDic[t];return e||(e=this.subTextureDic[t.substr(0,t.length-1)]),null==e?this._mainTexture:e}},{key:"showSkinByIndex",value:function(t,e){var n,i,r,a,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e<0&&e>=this.skinDataArray.length)return!1;var s=this.skinDataArray[e];if(s){for(n=0,i=s.slotArr.length;n<i;n++)(a=s.slotArr[n])&&(r=t[a.name])&&(r.showSlotData(a,o),o&&"undefined"!=r.attachmentName&&"null"!=r.attachmentName?r.showDisplayByName(r.attachmentName):r.showDisplayByIndex(r.displayIndex));return!0}return!1}},{key:"getSkinIndexByName",value:function(t){for(var e=0,n=this.skinDataArray.length;e<n;e++)if(this.skinDataArray[e].name==t)return e;return-1}},{key:"getGrahicsDataWithCache",value:function(t,e){return this._graphicsCache[t]&&this._graphicsCache[t][e]?this._graphicsCache[t][e]:null}},{key:"_setCreateURL",value:function(t){this._skBufferUrl=this._relativeUrl=t,V(K(a.prototype),"_setCreateURL",this).call(this,t)}},{key:"setGrahicsDataWithCache",value:function(t,e,n){this._graphicsCache[t][e]=n}},{key:"deleteAniData",value:function(t){if(this._anis[t]){var e=this._anis[t];e.bone3DMap=null,e.nodes=null}}},{key:"destroy",value:function(){var t;for(t in this._isDestroyed=!0,this.subTextureDic)t&&this.subTextureDic[t].destroy();for(t in this._textureDic)t&&this._textureDic[t].destroy();for(var e=0,n=this.skinSlotDisplayDataArr.length;e<n;e++)this.skinSlotDisplayDataArr[e].destory();this.skinSlotDisplayDataArr.length=0,this._relativeUrl&&delete a.TEMPLET_DICTIONARY[this._relativeUrl],V(K(a.prototype),"destroy",this).call(this),N.ILaya.loader.clearRes(this._skBufferUrl)}},{key:"getAniNameByIndex",value:function(t){var e=this.getAnimation(t);return e?e.name:null}},{key:"rate",get:function(){return this._rate},set:function(t){this._rate=t}}],n&&W(e.prototype,n),i&&W(e,i),a}(C.AnimationTemplet);e.Templet=q,q.LAYA_ANIMATION_160_VISION="LAYAANIMATION:1.6.0",q.LAYA_ANIMATION_VISION="LAYAANIMATION:1.7.0",F.IAniLib.Templet=q},950:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.TfConstraint=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i};function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var o=function(){function t(e,n){var i,r;for(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._temp=[],this._data=e,null==this._bones&&(this._bones=[]),this.target=n[e.targetIndex],i=0,r=e.boneIndexs.length;i<r;i++)this._bones.push(n[e.boneIndexs[i]]);this.rotateMix=e.rotateMix,this.translateMix=e.translateMix,this.scaleMix=e.scaleMix,this.shearMix=e.shearMix}var e,n,i;return e=t,(n=[{key:"apply",value:function(){for(var t,e=this.target.resultMatrix.a,n=this.target.resultMatrix.b,i=this.target.resultMatrix.c,r=this.target.resultMatrix.d,a=0,o=this._bones.length;a<o;a++){if(t=this._bones[a],this.rotateMix>0){var s=t.resultMatrix.a,u=t.resultMatrix.b,l=t.resultMatrix.c,h=t.resultMatrix.d,c=Math.atan2(i,e)-Math.atan2(l,s)+this._data.offsetRotation*Math.PI/180;c>Math.PI?c-=2*Math.PI:c<-Math.PI&&(c+=2*Math.PI),c*=this.rotateMix;var f=Math.cos(c),_=Math.sin(c);t.resultMatrix.a=f*s-_*l,t.resultMatrix.b=f*u-_*h,t.resultMatrix.c=_*s+f*l,t.resultMatrix.d=_*u+f*h}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),t.resultMatrix.tx+=(this._temp[0]-t.resultMatrix.tx)*this.translateMix,t.resultMatrix.ty+=(this._temp[1]-t.resultMatrix.ty)*this.translateMix,t.updateChild()),this.scaleMix>0){var d=Math.sqrt(t.resultMatrix.a*t.resultMatrix.a+t.resultMatrix.c*t.resultMatrix.c),p=Math.sqrt(e*e+i*i),y=d>1e-5?(d+(p-d+this._data.offsetScaleX)*this.scaleMix)/d:0;t.resultMatrix.a*=y,t.resultMatrix.c*=y,d=Math.sqrt(t.resultMatrix.b*t.resultMatrix.b+t.resultMatrix.d*t.resultMatrix.d),p=Math.sqrt(n*n+r*r),y=d>1e-5?(d+(p-d+this._data.offsetScaleY)*this.scaleMix)/d:0,t.resultMatrix.b*=y,t.resultMatrix.d*=y}if(this.shearMix>0){u=t.resultMatrix.b,h=t.resultMatrix.d;var v=Math.atan2(h,u);(c=Math.atan2(r,n)-Math.atan2(i,e)-(v-Math.atan2(t.resultMatrix.c,t.resultMatrix.a)))>Math.PI?c-=2*Math.PI:c<-Math.PI&&(c+=2*Math.PI),c=v+(c+this._data.offsetShearY*Math.PI/180)*this.shearMix,y=Math.sqrt(u*u+h*h),t.resultMatrix.b=Math.cos(c)*y,t.resultMatrix.d=Math.sin(c)*y}}}}])&&a(e.prototype,n),i&&a(e,i),t}();e.TfConstraint=o},87338:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.TfConstraintData=void 0;e.TfConstraintData=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.boneIndexs=[]}},81097:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Transform=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(18008);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0}var e,n,i;return e=t,(n=[{key:"initData",value:function(t){null!=t.x&&(this.x=t.x),null!=t.y&&(this.y=t.y),null!=t.skX&&(this.skX=t.skX),null!=t.skY&&(this.skY=t.skY),null!=t.scX&&(this.scX=t.scX),null!=t.scY&&(this.scY=t.scY)}},{key:"getMatrix",value:function(){var t;return(t=this.mMatrix?this.mMatrix:this.mMatrix=new a.Matrix).identity(),t.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(t,this.skewX*Math.PI/180,this.skewY*Math.PI/180),t.rotate(this.skX*Math.PI/180),t.translate(this.x,this.y),t}},{key:"skew",value:function(t,e,n){var i=Math.sin(n),r=Math.cos(n),a=Math.sin(e),o=Math.cos(e);return t.setTo(t.a*o-t.b*i,t.a*a+t.b*r,t.c*o-t.d*i,t.c*a+t.d*r,t.tx*o-t.ty*i,t.tx*a+t.ty*r),t}}])&&o(e.prototype,n),i&&o(e,i),t}();e.Transform=s},69616:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.UVTools=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(56083);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"getRelativeUV",value:function(t,e){var n,i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=t[0],o=t[2]-t[0],s=t[1],u=t[5]-t[1];r||(r=[]),r.length=e.length,i=r.length;var l=1/o,h=1/u;for(n=0;n<i;n+=2)r[n]=(e[n]-a)*l,r[n+1]=(e[n+1]-s)*h;return r}},{key:"getAbsoluteUV",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0==t[0]&&0==t[1]&&1==t[4]&&1==t[5])return n?(a.Utils.copyArray(n,e),n):e;var i,r,o=t[0],s=t[2]-t[0],u=t[1],l=t[5]-t[1];for(n||(n=[]),n.length=e.length,r=n.length,i=0;i<r;i+=2)n[i]=e[i]*s+o,n[i+1]=e[i+1]*l+u;return n}}],(n=null)&&o(e.prototype,n),i&&o(e,i),t}();e.UVTools=s},48160:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.MeshData=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(98693);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertices=new Float32Array([0,0,100,0,100,100,0,100]),this.indexes=new Uint16Array([0,1,3,3,1,2]),this.useUvTransform=!1,this.canvasPadding=1}var e,n,i;return e=t,(n=[{key:"getBounds",value:function(){return a.Rectangle._getWrapRec(this.vertices)}}])&&o(e.prototype,n),i&&o(e,i),t}();e.MeshData=s},59514:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.SkinMeshForGraphic=void 0;var h=f(n(85507)),c=f(n(21611));function f(t){return t&&t.__esModule?t:{default:t}}function _(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function d(t,e){return d=a||function(t,e){return t.__proto__=e,t},d(t,e)}function p(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=v(t);if(e){var a=v(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}function y(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function v(t){return v=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},v(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(a,t);var e,n,i,r=p(a);function a(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),r.call(this)}return e=a,(n=[{key:"init2",value:function(t,e,n,i){this.transform&&(this.transform=null);var r=e||[0,1,3,3,1,2];this.texture=t,this.indexes=new Uint16Array(r),this.vertices=new Float32Array(n),this.uvs=new Float32Array(i)}}])&&_(e.prototype,n),i&&_(e,i),a}(n(48160).MeshData);e.SkinMeshForGraphic=g},67988:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.BezierLerp=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(93062);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"getBezierRate",value:function(e,n,i,r,a){var o=t._getBezierParamKey(n,i,r,a),s=100*o+e;if(t._bezierResultCache[s])return t._bezierResultCache[s];var u,l,h=t._getBezierPoints(n,i,r,a,o);for(l=h.length,u=0;u<l;u+=2)if(e<=h[u])return t._bezierResultCache[s]=h[u+1],h[u+1];return t._bezierResultCache[s]=1,1}},{key:"_getBezierParamKey",value:function(t,e,n,i){return 100*(100*(100*(100*t+e)+n)+i)}},{key:"_getBezierPoints",value:function(e,n,i,r,o){return t._bezierPointsCache[o]?t._bezierPointsCache[o]:(s=[0,0,e,n,i,r,1,1],u=(new a.Bezier).getBezierPoints(s,100,3),t._bezierPointsCache[o]=u,u);var s,u}}],(n=null)&&o(e.prototype,n),i&&o(e,i),t}();e.BezierLerp=s,s._bezierResultCache={},s._bezierPointsCache={}},42255:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Component=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210),o=n(56083);function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._id=o.Utils.getGID(),this._resetComp()}var e,n,i;return e=t,(n=[{key:"id",get:function(){return this._id}},{key:"enabled",get:function(){return this._enabled},set:function(t){this._enabled!=t&&(this._enabled=t,this.owner&&(t?this.owner.activeInHierarchy&&this._onEnable():this.owner.activeInHierarchy&&this._onDisable()))}},{key:"isSingleton",get:function(){return!0}},{key:"destroyed",get:function(){return this._destroyed}},{key:"_isScript",value:function(){return!1}},{key:"_resetComp",value:function(){this._indexInList=-1,this._enabled=!0,this._awaked=!1,this.owner=null}},{key:"_getIndexInList",value:function(){return this._indexInList}},{key:"_setIndexInList",value:function(t){this._indexInList=t}},{key:"_onAdded",value:function(){}},{key:"_onAwake",value:function(){}},{key:"_onEnable",value:function(){}},{key:"_onDisable",value:function(){}},{key:"_onDestroy",value:function(){}},{key:"onReset",value:function(){}},{key:"_parse",value:function(t){}},{key:"_parseInteractive",value:function(){}},{key:"_cloneTo",value:function(t){}},{key:"_setActive",value:function(t){t?(this._awaked||(this._awaked=!0,this._onAwake()),this._enabled&&this._onEnable()):this._enabled&&this._onDisable()}},{key:"destroy",value:function(){this.owner&&this.owner._destroyComponent(this)}},{key:"_destroy",value:function(){this.owner.activeInHierarchy&&this._enabled&&this._setActive(!1),this._onDestroy(),this._destroyed=!0,this.onReset!==t.prototype.onReset?(this.onReset(),this._resetComp(),a.Pool.recoverByClass(this)):this._resetComp()}}])&&s(e.prototype,n),i&&s(e,i),t}();e.Component=u},72643:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Prefab=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(92493);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,(n=[{key:"create",value:function(){return this.json?a.ILaya.SceneUtils.createByData(null,this.json):null}}])&&o(e.prototype,n),i&&o(e,i),t}();e.Prefab=s},31249:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.Animation=void 0;var f=w(n(81643)),_=w(n(85507)),d=w(n(21611)),p=n(68817),y=n(72276),v=n(85096),g=n(22847),m=n(41107),b=n(56083),T=n(92493),x=n(23835);function w(t){return t&&t.__esModule?t:{default:t}}function k(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function C(){return C="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=E(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},C.apply(this,arguments)}function E(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=I(t)););return t}function S(t,e){return S=a||function(t,e){return t.__proto__=e,t},S(t,e)}function M(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=I(t);if(e){var a=I(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return L(this,n)}}function L(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return R(t)}function R(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function I(t){return I=_.default?d.default:function(t){return t.__proto__||(0,d.default)(t)},I(t)}var A=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&S(t,e)}(a,t);var e,n,i,r=M(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this))._setControlNode(R(t)),t}return e=a,n=[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.stop(),C(I(a.prototype),"destroy",this).call(this,t),this._frames=null,this._labels=null}},{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";n&&this._setFramesFromCache(n,!0),C(I(a.prototype),"play",this).call(this,t,e,n)}},{key:"_setFramesFromCache",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._url&&(t=this._url+"#"+t),t&&a.framesMap[t]){var n=a.framesMap[t];return n instanceof Array?(this._frames=a.framesMap[t],this._count=this._frames.length):(n.nodeRoot&&(a.framesMap[t]=g.GraphicAnimation.parseAnimationByData(n),n=a.framesMap[t]),this._frames=n.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=n.interval),this._labels=this._copyLabels(n.labels)),!0}return e&&console.log("ani not found:",t),!1}},{key:"_copyLabels",value:function(t){if(!t)return null;var e,n;for(n in e={},t)e[n]=b.Utils.copyArray([],t[n]);return e}},{key:"_frameLoop",value:function(){this._visible&&this._style.alpha>.01&&this._frames&&C(I(a.prototype),"_frameLoop",this).call(this)}},{key:"_displayToIndex",value:function(t){this._frames&&(this.graphics=this._frames[t])}},{key:"frames",get:function(){return this._frames},set:function(t){this._frames=t,t&&(this._count=t.length,this._actionName&&this._setFramesFromCache(this._actionName,!0),this.index=this._index)}},{key:"source",set:function(t){(0,f.default)(t).call(t,".ani")>-1?this.loadAnimation(t):(0,f.default)(t).call(t,".json")>-1||(0,f.default)(t).call(t,"als")>-1||(0,f.default)(t).call(t,"atlas")>-1?this.loadAtlas(t):this.loadImages(t.split(","))}},{key:"autoAnimation",set:function(t){this.play(0,!0,t)}},{key:"autoPlay",set:function(t){t?this.play():this.stop()}},{key:"clear",value:function(){return C(I(a.prototype),"clear",this).call(this),this.stop(),this.graphics=null,this._frames=null,this._labels=null,this}},{key:"loadImages",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this._url="",this._setFramesFromCache(e)||(this.frames=a.framesMap[e]?a.framesMap[e]:a.createFrames(t,e)),this}},{key:"loadAtlas",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this._url="";var i=this;if(!i._setFramesFromCache(n)){var r=function(r){t===r&&(i.frames=a.framesMap[n]?a.framesMap[n]:a.createFrames(t,n),e&&e.run())};v.Loader.getAtlas(t)?r(t):T.ILaya.loader.load(t,m.Handler.create(null,r,[t]),null,v.Loader.ATLAS)}return this}},{key:"loadAnimation",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._url=t;var i=this;return this._actionName||(this._actionName=""),i._setFramesFromCache(this._actionName)?(i._setFramesFromCache(this._actionName,!0),this.index=0,e&&e.run()):!n||v.Loader.getAtlas(n)?this._loadAnimationData(t,e,n):T.ILaya.loader.load(n,m.Handler.create(this,this._loadAnimationData,[t,e,n]),null,v.Loader.ATLAS),this}},{key:"_loadAnimationData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!n||v.Loader.getAtlas(n)){var i=this;v.Loader.getRes(t)?r(t):T.ILaya.loader.load(t,m.Handler.create(null,r,[t]),null,v.Loader.JSON)}else console.warn("atlas load fail:"+n);function r(n){if(v.Loader.getRes(n)){if(t===n){var r;if(a.framesMap[t+"#"])i._setFramesFromCache(i._actionName,!0),i.index=0,i._resumePlay();else{var o=g.GraphicAnimation.parseAnimationData(v.Loader.getRes(t));if(!o)return;var s,u,l=o.animationList,h=l.length;for(s=0;s<h;s++)r=l[s],a.framesMap[t+"#"+r.name]=r,u||(u=r);u&&(a.framesMap[t+"#"]=u,i._setFramesFromCache(i._actionName,!0),i.index=0),i._resumePlay()}e&&e.run()}v.Loader.clearRes(t)}else a.framesMap[t+"#"]&&(i._setFramesFromCache(i._actionName,!0),i.index=0,i._resumePlay(),e&&e.run())}}}],i=[{key:"createFrames",value:function(t,e){var n;if("string"==typeof t){var i=v.Loader.getAtlas(t);if(i&&i.length){n=[];for(var r=0,o=i.length;r<o;r++){var s=new y.Graphics;s.drawImage(v.Loader.getRes(i[r]),0,0),n.push(s)}}}else if(t instanceof Array)for(n=[],r=0,o=t.length;r<o;r++)(s=new y.Graphics).loadImage(t[r],0,0),n.push(s);return e&&(a.framesMap[e]=n),n}},{key:"clearCache",value:function(t){var e,n=a.framesMap,i=t+"#";for(e in n)e!==t&&0!==(0,f.default)(e).call(e,i)||delete a.framesMap[e]}}],n&&k(e.prototype,n),i&&k(e,i),a}(p.AnimationBase);e.Animation=A,A.framesMap={},T.ILaya.regClass(A),x.ClassUtils.regClass("laya.display.Animation",A),x.ClassUtils.regClass("Laya.Animation",A)},68817:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.AnimationBase=void 0;var f=T(n(81643)),_=T(n(92762)),d=T(n(85507)),p=T(n(21611)),y=n(78362),v=n(80340),g=n(13407),m=n(89662),b=n(23835);function T(t){return t&&t.__esModule?t:{default:t}}function x(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function w(){return w="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=k(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},w.apply(this,arguments)}function k(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=M(t)););return t}function C(t,e){return C=a||function(t,e){return t.__proto__=e,t},C(t,e)}function E(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=M(t);if(e){var a=M(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return S(this,n)}}function S(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function M(t){return M=d.default?p.default:function(t){return t.__proto__||(0,p.default)(t)},M(t)}var L=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&C(t,e)}(a,t);var e,n,i,r=E(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this)).wrapMode=0,t._interval=v.Config.animationInterval,t._isReverse=!1,t._frameRateChanged=!1,t._setBitUp(g.Const.DISPLAY),t}return e=a,n=[{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this._isPlaying=!0,this._actionName=n,this.index="string"==typeof t?this._getFrameByLabel(t):t,this.loop=e,this._isReverse=this.wrapMode===a.WRAP_REVERSE,0==this.index&&this._isReverse&&(this.index=this.count-1),this.interval>0&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)}},{key:"interval",get:function(){return this._interval},set:function(t){this._interval!=t&&(this._frameRateChanged=!0,this._interval=t,this._isPlaying&&t>0&&this.timerLoop(t,this,this._frameLoop,null,!0,!0))}},{key:"_getFrameByLabel",value:function(t){for(var e=0;e<this._count;e++){var n=this._labels[e];if(n&&(0,f.default)(n).call(n,t)>-1)return e}return 0}},{key:"_frameLoop",value:function(){if(this._controlNode&&!this._controlNode.destroyed){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event(m.Event.COMPLETE);this.wrapMode==a.WRAP_PINGPONG?(this._index=this._count>0?1:0,this._isReverse=!1):this._index=this._count-1,this.event(m.Event.COMPLETE)}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event(m.Event.COMPLETE);this.wrapMode==a.WRAP_PINGPONG?(this._index=this._count-2>=0?this._count-2:0,this._isReverse=!0):this._index=0,this.event(m.Event.COMPLETE)}this.index=this._index}else this.clearTimer(this,this._frameLoop)}},{key:"_setControlNode",value:function(t){this._controlNode&&(this._controlNode.off(m.Event.DISPLAY,this,this._resumePlay),this._controlNode.off(m.Event.UNDISPLAY,this,this._resumePlay)),this._controlNode=t,t&&t!=this&&(t.on(m.Event.DISPLAY,this,this._resumePlay),t.on(m.Event.UNDISPLAY,this,this._resumePlay))}},{key:"_setDisplay",value:function(t){w(M(a.prototype),"_setDisplay",this).call(this,t),this._resumePlay()}},{key:"_resumePlay",value:function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))}},{key:"stop",value:function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)}},{key:"isPlaying",get:function(){return this._isPlaying}},{key:"addLabel",value:function(t,e){this._labels||(this._labels={}),this._labels[e]||(this._labels[e]=[]),this._labels[e].push(t)}},{key:"removeLabel",value:function(t){if(t){if(this._labels)for(var e in this._labels)this._removeLabelFromList(this._labels[e],t)}else this._labels=null}},{key:"_removeLabelFromList",value:function(t,e){if(t)for(var n=t.length-1;n>=0;n--)t[n]==e&&(0,_.default)(t).call(t,n,1)}},{key:"gotoAndStop",value:function(t){this.index="string"==typeof t?this._getFrameByLabel(t):t,this.stop()}},{key:"index",get:function(){return this._index},set:function(t){if(this._index=t,this._displayToIndex(t),this._labels&&this._labels[t])for(var e=this._labels[t],n=0,i=e.length;n<i;n++)this.event(m.Event.LABEL,e[n])}},{key:"_displayToIndex",value:function(t){}},{key:"count",get:function(){return this._count}},{key:"clear",value:function(){return this.stop(),this._labels=null,this}}],n&&x(e.prototype,n),i&&x(e,i),a}(y.Sprite);e.AnimationBase=L,L.WRAP_POSITIVE=0,L.WRAP_REVERSE=1,L.WRAP_PINGPONG=2,b.ClassUtils.regClass("laya.display.AnimationBase",L),b.ClassUtils.regClass("Laya.AnimationBase",L)},60397:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.BitmapFont=void 0;var i=c(n(81643)),r=c(n(94198)),a=c(n(63978)),o=n(98693),s=n(54598),u=n(41107),l=n(92493),h=n(23835);function c(t){return t&&t.__esModule?t:{default:t}}function f(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,a.default)(t,i.key,i)}}var _=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._fontCharDic={},this._fontWidthMap={},this._maxWidth=0,this._spaceWidth=10,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}var e,n,a;return e=t,(n=[{key:"loadFont",value:function(t,e){this._path=t,this._complete=e,t&&-1!==(0,i.default)(t).call(t,".fnt")?l.ILaya.loader.load([{url:t,type:l.ILaya.Loader.XML},{url:t.replace(".fnt",".png"),type:l.ILaya.Loader.IMAGE}],u.Handler.create(this,this._onLoaded)):console.error('Bitmap font configuration information must be a ".fnt" file')}},{key:"_onLoaded",value:function(){this.parseFont(l.ILaya.Loader.getRes(this._path),l.ILaya.Loader.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.run()}},{key:"parseFont",value:function(t,e){if(null!=t&&null!=e){this._texture=e;var n=t.getElementsByTagName("info");if(!n[0].getAttributeNode)return this.parseFont2(t,e);this.fontSize=(0,r.default)(n[0].getAttributeNode("size").nodeValue);var i=n[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[(0,r.default)(i[0]),(0,r.default)(i[1]),(0,r.default)(i[2]),(0,r.default)(i[3])];var a=t.getElementsByTagName("char"),u=0;for(u=0;u<a.length;u++){var l=a[u],h=(0,r.default)(l.getAttributeNode("id").nodeValue),c=(0,r.default)(l.getAttributeNode("xoffset").nodeValue)/1,f=(0,r.default)(l.getAttributeNode("yoffset").nodeValue)/1,_=(0,r.default)(l.getAttributeNode("xadvance").nodeValue)/1,d=new o.Rectangle;d.x=(0,r.default)(l.getAttributeNode("x").nodeValue),d.y=(0,r.default)(l.getAttributeNode("y").nodeValue),d.width=(0,r.default)(l.getAttributeNode("width").nodeValue),d.height=(0,r.default)(l.getAttributeNode("height").nodeValue);var p=s.Texture.create(e,d.x,d.y,d.width,d.height,c,f);this._maxWidth=Math.max(this._maxWidth,_+this.letterSpacing),this._fontCharDic[h]=p,this._fontWidthMap[h]=_}}}},{key:"parseFont2",value:function(t,e){if(null!=t&&null!=e){this._texture=e;var n=t.getElementsByTagName("info");this.fontSize=(0,r.default)(n[0].attributes.size.nodeValue);var i=n[0].attributes.padding.nodeValue.split(",");this._padding=[(0,r.default)(i[0]),(0,r.default)(i[1]),(0,r.default)(i[2]),(0,r.default)(i[3])];var a=t.getElementsByTagName("char"),u=0;for(u=0;u<a.length;u++){var l=a[u].attributes,h=(0,r.default)(l.id.nodeValue),c=(0,r.default)(l.xoffset.nodeValue)/1,f=(0,r.default)(l.yoffset.nodeValue)/1,_=(0,r.default)(l.xadvance.nodeValue)/1,d=new o.Rectangle;d.x=(0,r.default)(l.x.nodeValue),d.y=(0,r.default)(l.y.nodeValue),d.width=(0,r.default)(l.width.nodeValue),d.height=(0,r.default)(l.height.nodeValue);var p=s.Texture.create(e,d.x,d.y,d.width,d.height,c,f);this._maxWidth=Math.max(this._maxWidth,_+this.letterSpacing),this._fontCharDic[h]=p,this._fontWidthMap[h]=_}}}},{key:"getCharTexture",value:function(t){return this._fontCharDic[t.charCodeAt(0)]}},{key:"destroy",value:function(){if(this._texture){for(var t in this._fontCharDic){var e=this._fontCharDic[t];e&&e.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null,this._complete=null,this._padding=null}}},{key:"setSpaceWidth",value:function(t){this._spaceWidth=t}},{key:"getCharWidth",value:function(t){var e=t.charCodeAt(0);return this._fontWidthMap[e]?this._fontWidthMap[e]+this.letterSpacing:" "===t?this._spaceWidth+this.letterSpacing:0}},{key:"getTextWidth",value:function(t){for(var e=0,n=0,i=t.length;n<i;n++)e+=this.getCharWidth(t.charAt(n));return e}},{key:"getMaxWidth",value:function(){return this._maxWidth}},{key:"getMaxHeight",value:function(){return this.fontSize}},{key:"_drawText",value:function(t,e,n,i,r,a){var o,s=this.getTextWidth(t),u=0;"center"===r&&(u=(a-s)/2),"right"===r&&(u=a-s);for(var l=0,h=0,c=t.length;h<c;h++)(o=this.getCharTexture(t.charAt(h)))&&(e.graphics.drawImage(o,n+l+u,i),l+=this.getCharWidth(t.charAt(h)))}}])&&f(e.prototype,n),a&&f(e,a),t}();e.BitmapFont=_,h.ClassUtils.regClass("laya.display.BitmapFont",_),h.ClassUtils.regClass("Laya.BitmapFont",_)},24288:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.FrameAnimation=void 0;var f=T(n(69301)),_=T(n(81643)),d=T(n(47302)),p=T(n(85507)),y=T(n(21611)),v=n(68817),g=n(64968),m=n(45840),b=n(23835);function T(t){return t&&t.__esModule?t:{default:t}}function x(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function w(){return w="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=k(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},w.apply(this,arguments)}function k(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=M(t)););return t}function C(t,e){return C=a||function(t,e){return t.__proto__=e,t},C(t,e)}function E(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=M(t);if(e){var a=M(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return S(this,n)}}function S(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function M(t){return M=p.default?y.default:function(t){return t.__proto__||(0,y.default)(t)},M(t)}var L=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&C(t,e)}(a,t);var e,n,i,r=E(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),t=r.call(this),void 0===a._sortIndexFun&&(a._sortIndexFun=g.MathUtil.sortByKey("index",!1,!0)),t}return e=a,n=[{key:"_setUp",value:function(t,e){this._targetDic=t,this._animationData=e,this.interval=1e3/e.frameRate,e.parsed?(this._count=e.count,this._labels=e.labels,this._usedFrames=e.animationNewFrames):(this._usedFrames=[],this._calculateDatas(),e.parsed=!0,e.labels=this._labels,e.count=this._count,e.animationNewFrames=this._usedFrames)}},{key:"clear",value:function(){return w(M(a.prototype),"clear",this).call(this),this._targetDic=null,this._animationData=null,this}},{key:"_displayToIndex",value:function(t){if(this._animationData){t<0&&(t=0),t>this._count&&(t=this._count);var e,n=this._animationData.nodes,i=n.length;for(e=0;e<i;e++)this._displayNodeToFrame(n[e],t)}}},{key:"_displayNodeToFrame",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n||(n=this._targetDic);var i=n[t.target];if(i){var r,a,o,s,u=t.frames,l=(0,f.default)(t),h=l.length;for(s=0;s<h;s++)o=(a=u[r=l[s]]).length>e?a[e]:a[a.length-1],i[r]=o;var c,_=t.funkeys;if(0!=(h=_.length))for(s=0;s<h;s++)void 0!==(c=u[r=_[s]])[e]&&i[r]&&i[r].apply(i,c[e])}}},{key:"_calculateDatas",value:function(){if(this._animationData){var t,e,n=this._animationData.nodes,i=n.length;for(this._count=0,t=0;t<i;t++)e=n[t],this._calculateKeyFrames(e);this._count+=1}}},{key:"_calculateKeyFrames",value:function(t){var e,n,i=t.keyframes,r=t.target;for(e in t.frames||(t.frames={}),(0,f.default)(t)?(0,f.default)(t).length=0:t.keys=[],t.funkeys?t.funkeys.length=0:t.funkeys=[],t.initValues||(t.initValues={}),i){var o=-1!=(0,_.default)(e).call(e,"()");if(n=i[e],o&&(e=e.substr(0,e.length-2)),t.frames[e]||(t.frames[e]=[]),o){t.funkeys.push(e);for(var s=t.frames[e],u=0;u<n.length;u++){var l=n[u];s[l.index]=l.value,l.index>this._count&&(this._count=l.index)}}else this._targetDic&&this._targetDic[r]&&(t.initValues[e]=this._targetDic[r][e]),(0,d.default)(n).call(n,a._sortIndexFun),(0,f.default)(t).push(e),this._calculateNodePropFrames(n,t.frames[e],e,r)}}},{key:"resetNodes",value:function(){if(this._targetDic&&this._animationData){var t,e,n,i=this._animationData.nodes,r=i.length;for(t=0;t<r;t++)if(n=(e=i[t]).initValues){var a,o=this._targetDic[e.target];if(o)for(a in n)o[a]=n[a]}}}},{key:"_calculateNodePropFrames",value:function(t,e,n,i){var r,a=t.length-1;for(e.length=t[a].index+1,r=0;r<a;r++)this._dealKeyFrame(t[r]),this._calculateFrameValues(t[r],t[r+1],e);0==a&&(e[0]=t[0].value,this._usedFrames&&(this._usedFrames[t[0].index]=!0)),this._dealKeyFrame(t[r])}},{key:"_dealKeyFrame",value:function(t){t.label&&""!=t.label&&this.addLabel(t.label,t.index)}},{key:"_calculateFrameValues",value:function(t,e,n){var i,r,a=t.index,o=e.index,s=t.value,u=e.value-t.value,l=o-a,h=this._usedFrames;if(o>this._count&&(this._count=o),t.tween)for(null==(r=m.Ease[t.tweenMethod])&&(r=m.Ease.linearNone),i=a;i<o;i++)n[i]=r(i-a,s,u,l),h&&(h[i]=!0);else for(i=a;i<o;i++)n[i]=s;h&&(h[t.index]=!0,h[e.index]=!0),n[e.index]=e.value}}],i=[{key:"_sortIndexFun",value:function(t,e){return t.index-e.index}}],n&&x(e.prototype,n),i&&x(e,i),a}(v.AnimationBase);e.FrameAnimation=L,b.ClassUtils.regClass("laya.display.FrameAnimation",L),b.ClassUtils.regClass("Laya.FrameAnimation",L)},72276:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Graphics=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(93697),o=n(43745),s=n(23578),u=n(95518),l=n(94317),h=n(26531),c=n(95923),f=n(40120),_=n(65419),d=n(57073),p=n(9897),y=n(81844),v=n(91813),g=n(65955),m=n(82994),b=n(65849),T=n(47303),x=n(4501),w=n(99777),k=n(88720),C=n(7862),E=n(95538),S=n(37187),M=n(9047),L=n(44449),R=n(89662),I=n(85399),A=n(85136),D=n(54598),B=n(56083),P=n(25670),O=n(92493);function F(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var U=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._sp=null,this._one=null,this._render=this._renderEmpty,this._cmds=null,this._vectorgraphArray=null,this._graphicBounds=null,this.autoDestroy=!1,this._createData()}var e,n,i;return e=t,n=[{key:"_createData",value:function(){}},{key:"_clearData",value:function(){}},{key:"_destroyData",value:function(){}},{key:"destroy",value:function(){this.clear(!0),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0,this._sp._setRenderType(0),this._sp=null),this._destroyData()}},{key:"clear",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(t){var e=this._one;if(this._cmds){var n,i=this._cmds.length;for(n=0;n<i;n++)(e=this._cmds[n]).recover();this._cmds.length=0}else e&&e.recover()}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._clearData(),this._sp&&(this._sp._renderType&=~o.SpriteConst.GRAPHICS,this._sp._setRenderType(this._sp._renderType)),this._repaint(),this._vectorgraphArray){for(n=0,i=this._vectorgraphArray.length;n<i;n++)P.VectorGraphManager.getInstance().deleteShape(this._vectorgraphArray[n]);this._vectorgraphArray.length=0}}},{key:"_clearBoundsCache",value:function(){this._graphicBounds&&this._graphicBounds.reset()}},{key:"_initGraphicBounds",value:function(){this._graphicBounds||(this._graphicBounds=a.GraphicsBounds.create(),this._graphicBounds._graphics=this)}},{key:"_repaint",value:function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()}},{key:"_isOnlyOne",value:function(){return!this._cmds||0===this._cmds.length}},{key:"cmds",get:function(){return this._cmds},set:function(t){this._sp&&(this._sp._renderType|=o.SpriteConst.GRAPHICS,this._sp._setRenderType(this._sp._renderType)),this._cmds=t,this._render=this._renderAll,this._repaint()}},{key:"getBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._initGraphicBounds(),this._graphicBounds.getBounds(t)}},{key:"getBoundPoints",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._initGraphicBounds(),this._graphicBounds.getBoundPoints(t)}},{key:"drawImage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!t)return null;if(i||(i=t.sourceWidth),r||(r=t.sourceHeight),t.getIsReady()){var a=i/t.sourceWidth,s=r/t.sourceHeight;if(i=t.width*a,r=t.height*s,i<=0||r<=0)return null;e+=t.offsetX*a,n+=t.offsetY*s}this._sp&&(this._sp._renderType|=o.SpriteConst.GRAPHICS,this._sp._setRenderType(this._sp._renderType));var u=f.DrawImageCmd.create.call(this,t,e,n,i,r);return null==this._one?(this._one=u,this._render=this._renderOneImg):this._saveToCmd(null,u),this._repaint(),u}},{key:"drawTexture",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,h=arguments.length>9?arguments[9]:void 0;if(!t||s<.01)return null;if(!t.getIsReady())return null;if(i||(i=t.sourceWidth),r||(r=t.sourceHeight),t.getIsReady()){var c=i/t.sourceWidth,f=r/t.sourceHeight;if(i=t.width*c,r=t.height*f,i<=0||r<=0)return null;e+=t.offsetX*c,n+=t.offsetY*f}this._sp&&(this._sp._renderType|=o.SpriteConst.GRAPHICS,this._sp._setRenderType(this._sp._renderType));var _=m.DrawTextureCmd.create.call(this,t,e,n,i,r,a,s,u,l,h);return this._repaint(),this._saveToCmd(null,_)}},{key:"drawTextures",value:function(t,e){return t?this._saveToCmd(A.Render._context.drawTextures,b.DrawTexturesCmd.create.call(this,t,e)):null}},{key:"drawTriangles",value:function(t,e,n,i,r,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:4294967295;return this._saveToCmd(A.Render._context.drawTriangles,T.DrawTrianglesCmd.create.call(this,t,e,n,i,r,a,o,s,u,l,h))}},{key:"fillTexture",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"repeat",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return t&&t.getIsReady()?this._saveToCmd(A.Render._context._fillTexture,w.FillTextureCmd.create.call(this,t,e,n,i,r,a,o||I.Point.EMPTY,{})):null}},{key:"_saveToCmd",value:function(t,e){return this._sp&&(this._sp._renderType|=o.SpriteConst.GRAPHICS,this._sp._setRenderType(this._sp._renderType)),null==this._one?(this._one=e,this._render=this._renderOne):(this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(e)),this._repaint(),e}},{key:"clipRect",value:function(t,e,n,i){return this._saveToCmd(A.Render._context.clipRect,u.ClipRectCmd.create.call(this,t,e,n,i))}},{key:"fillText",value:function(t,e,n,i,r,a){return this._saveToCmd(A.Render._context.fillText,x.FillTextCmd.create.call(this,t,null,e,n,i||O.ILaya.Text.defaultFontStr(),r,a,0,""))}},{key:"fillBorderText",value:function(t,e,n,i,r,a,o,s){return this._saveToCmd(A.Render._context.fillText,x.FillTextCmd.create.call(this,t,null,e,n,i||O.ILaya.Text.defaultFontStr(),r,a,o,s))}},{key:"fillWords",value:function(t,e,n,i,r){return this._saveToCmd(A.Render._context.fillText,x.FillTextCmd.create.call(this,null,t,e,n,i||O.ILaya.Text.defaultFontStr(),r,"",0,null))}},{key:"fillBorderWords",value:function(t,e,n,i,r,a,o){return this._saveToCmd(A.Render._context.fillText,x.FillTextCmd.create.call(this,null,t,e,n,i||O.ILaya.Text.defaultFontStr(),r,"",o,a))}},{key:"strokeText",value:function(t,e,n,i,r,a,o){return this._saveToCmd(A.Render._context.fillText,x.FillTextCmd.create.call(this,t,null,e,n,i||O.ILaya.Text.defaultFontStr(),null,o,a,r))}},{key:"alpha",value:function(t){return this._saveToCmd(A.Render._context.alpha,s.AlphaCmd.create.call(this,t))}},{key:"transform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this._saveToCmd(A.Render._context._transform,M.TransformCmd.create.call(this,t,e,n))}},{key:"rotate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this._saveToCmd(A.Render._context._rotate,C.RotateCmd.create.call(this,t,e,n))}},{key:"scale",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this._saveToCmd(A.Render._context._scale,S.ScaleCmd.create.call(this,t,e,n,i))}},{key:"translate",value:function(t,e){return this._saveToCmd(A.Render._context.translate,L.TranslateCmd.create.call(this,t,e))}},{key:"save",value:function(){return this._saveToCmd(A.Render._context._save,E.SaveCmd.create.call(this))}},{key:"restore",value:function(){return this._saveToCmd(A.Render._context.restore,k.RestoreCmd.create.call(this))}},{key:"replaceText",value:function(t){this._repaint();var e=this._cmds;if(e){for(var n=e.length-1;n>-1;n--)if(this._isTextCmd(e[n]))return e[n].text=t,!0}else if(this._one&&this._isTextCmd(this._one))return this._one.text=t,!0;return!1}},{key:"_isTextCmd",value:function(t){return t.cmdID==x.FillTextCmd.ID}},{key:"replaceTextColor",value:function(t){this._repaint();var e=this._cmds;if(e)for(var n=e.length-1;n>-1;n--)this._isTextCmd(e[n])&&this._setTextCmdColor(e[n],t);else this._one&&this._isTextCmd(this._one)&&this._setTextCmdColor(this._one,t)}},{key:"_setTextCmdColor",value:function(t,e){t.cmdID===x.FillTextCmd.ID&&(t.color=e)}},{key:"loadImage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=O.ILaya.Loader.getRes(t);o?o.getIsReady()?this.drawImage(o,e,n,i,r):o.once(R.Event.READY,this,this.drawImage,[o,e,n,i,r]):((o=new D.Texture).load(t),O.ILaya.Loader.cacheTexture(t,o),o.once(R.Event.READY,this,this.drawImage,[o,e,n,i,r])),null!=a&&(o.getIsReady()?a.call(this._sp):o.on(R.Event.READY,this._sp,a))}},{key:"_renderEmpty",value:function(t,e,n,i){}},{key:"_renderAll",value:function(t,e,n,i){for(var r=this._cmds,a=0,o=r.length;a<o;a++)r[a].run(e,n,i)}},{key:"_renderOne",value:function(t,e,n,i){e.sprite=t,this._one.run(e,n,i)}},{key:"_renderOneImg",value:function(t,e,n,i){e.sprite=t,this._one.run(e,n,i)}},{key:"drawLine",value:function(t,e,n,i,r){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=a<1||a%2==0?0:.5;return this._saveToCmd(A.Render._context._drawLine,_.DrawLineCmd.create.call(this,t+o,e+o,n+o,i+o,r,a,0))}},{key:"drawLines",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;if(!n||n.length<4)return null;var a=r<1||r%2==0?0:.5;return this._saveToCmd(A.Render._context._drawLines,d.DrawLinesCmd.create.call(this,t+a,e+a,n,i,r,0))}},{key:"drawCurves",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return this._saveToCmd(A.Render._context.drawCurves,c.DrawCurvesCmd.create.call(this,t,e,n,i,r))}},{key:"drawRect",value:function(t,e,n,i,r){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=o>=1&&a?o/2:0,u=a?o:0;return this._saveToCmd(A.Render._context.drawRect,g.DrawRectCmd.create.call(this,t+s,e+s,n-u,i-u,r,a,o))}},{key:"drawCircle",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=a>=1&&r?a/2:0;return this._saveToCmd(A.Render._context._drawCircle,h.DrawCircleCmd.create.call(this,t,e,n-o,i,r,a,0))}},{key:"drawPie",value:function(t,e,n,i,r,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,u=s>=1&&o?s/2:0,l=o?s:0;return this._saveToCmd(A.Render._context._drawPie,y.DrawPieCmd.create.call(this,t+u,e+u,n-l,B.Utils.toRadian(i),B.Utils.toRadian(r),a,o,s,0))}},{key:"drawPoly",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=!1;o=!(n.length>6);var s=a>=1&&r?a%2==0?0:.5:0;return this._saveToCmd(A.Render._context._drawPoly,v.DrawPolyCmd.create.call(this,t+s,e+s,n,i,r,a,o,0))}},{key:"drawPath",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return this._saveToCmd(A.Render._context._drawPath,p.DrawPathCmd.create.call(this,t,e,n,i,r))}},{key:"draw9Grid",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5?arguments[5]:void 0;this._saveToCmd(null,l.Draw9GridTexture.create(t,e,n,i,r,a))}}],n&&F(e.prototype,n),i&&F(e,i),t}();e.Graphics=U},93697:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.GraphicsBounds=void 0;var i=D(n(77766)),r=D(n(63978)),a=n(23578),o=n(26531),s=n(95923),u=n(40120),l=n(65419),h=n(57073),c=n(9897),f=n(81844),_=n(91813),d=n(65955),p=n(82994),y=n(99777),v=n(88720),g=n(7862),m=n(37187),b=n(9047),T=n(44449),x=n(93062),w=n(9686),k=n(18008),C=n(85399),E=n(98693),S=n(85136),M=n(64210),L=n(56083),R=n(47303),I=n(94317),A=n(95538);function D(t){return t&&t.__esModule?t:{default:t}}function B(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var P=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._cacheBoundsType=!1}var e,n,r;return e=t,n=[{key:"destroy",value:function(){this._graphics=null,this._cacheBoundsType=!1,this._temp&&(this._temp.length=0),this._rstBoundPoints&&(this._rstBoundPoints.length=0),this._bounds&&this._bounds.recover(),this._bounds=null,M.Pool.recover("GraphicsBounds",this)}},{key:"reset",value:function(){this._temp&&(this._temp.length=0)}},{key:"getBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(!this._bounds||!this._temp||this._temp.length<1||t!=this._cacheBoundsType)&&(this._bounds=E.Rectangle._getWrapRec(this.getBoundPoints(t),this._bounds)),this._cacheBoundsType=t,this._bounds}},{key:"getBoundPoints",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(!this._temp||this._temp.length<1||t!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(t)),this._cacheBoundsType=t,this._rstBoundPoints=L.Utils.copyArray(this._rstBoundPoints,this._temp)}},{key:"_getCmdPoints",value:function(){var e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=(S.Render._context,this._graphics.cmds);if((e=this._temp||(this._temp=[])).length=0,r||null==this._graphics._one||(t._tempCmds.length=0,t._tempCmds.push(this._graphics._one),r=t._tempCmds),!r)return e;var k=t._tempMatrixArrays;k.length=0;var C=t._initMatrix;C.identity();for(var M,D,B=t._tempMatrix,P=0,O=r.length;P<O;P++)switch((M=r[P]).cmdID){case a.AlphaCmd.ID:case A.SaveCmd.ID:k.push(C),C=C.clone();break;case v.RestoreCmd.ID:C=k.pop();break;case m.ScaleCmd.ID:B.identity(),B.translate(-M.pivotX,-M.pivotY),B.scale(M.scaleX,M.scaleY),B.translate(M.pivotX,M.pivotY),this._switchMatrix(C,B);break;case g.RotateCmd.ID:B.identity(),B.translate(-M.pivotX,-M.pivotY),B.rotate(M.angle),B.translate(M.pivotX,M.pivotY),this._switchMatrix(C,B);break;case T.TranslateCmd.ID:B.identity(),B.translate(M.tx,M.ty),this._switchMatrix(C,B);break;case b.TransformCmd.ID:B.identity(),B.translate(-M.pivotX,-M.pivotY),(0,i.default)(B).call(B,M.matrix),B.translate(M.pivotX,M.pivotY),this._switchMatrix(C,B);break;case u.DrawImageCmd.ID:case y.FillTextureCmd.ID:t._addPointArrToRst(e,E.Rectangle._getBoundPointS(M.x,M.y,M.width,M.height),C);break;case p.DrawTextureCmd.ID:C.copyTo(B),M.matrix&&(0,i.default)(B).call(B,M.matrix),t._addPointArrToRst(e,E.Rectangle._getBoundPointS(M.x,M.y,M.width,M.height),B);break;case u.DrawImageCmd.ID:if(D=M.texture,n)M.width&&M.height?t._addPointArrToRst(e,E.Rectangle._getBoundPointS(M.x,M.y,M.width,M.height),C):t._addPointArrToRst(e,E.Rectangle._getBoundPointS(M.x,M.y,D.width,D.height),C);else{var F=(M.width||D.sourceWidth)/D.width,U=(M.height||D.sourceHeight)/D.height,N=F*D.sourceWidth,G=U*D.sourceHeight,H=D.offsetX>0?D.offsetX:0,W=D.offsetY>0?D.offsetY:0;H*=F,W*=U,t._addPointArrToRst(e,E.Rectangle._getBoundPointS(M.x-H,M.y-W,N,G),C)}break;case y.FillTextureCmd.ID:M.width&&M.height?t._addPointArrToRst(e,E.Rectangle._getBoundPointS(M.x,M.y,M.width,M.height),C):(D=M.texture,t._addPointArrToRst(e,E.Rectangle._getBoundPointS(M.x,M.y,D.width,D.height),C));break;case p.DrawTextureCmd.ID:var V;M.matrix?(C.copyTo(B),(0,i.default)(B).call(B,M.matrix),V=B):V=C,n?M.width&&M.height?t._addPointArrToRst(e,E.Rectangle._getBoundPointS(M.x,M.y,M.width,M.height),V):(D=M.texture,t._addPointArrToRst(e,E.Rectangle._getBoundPointS(M.x,M.y,D.width,D.height),V)):(D=M.texture,F=(M.width||D.sourceWidth)/D.width,U=(M.height||D.sourceHeight)/D.height,N=F*D.sourceWidth,G=U*D.sourceHeight,H=D.offsetX>0?D.offsetX:0,W=D.offsetY>0?D.offsetY:0,H*=F,W*=U,t._addPointArrToRst(e,E.Rectangle._getBoundPointS(M.x-H,M.y-W,N,G),V));break;case d.DrawRectCmd.ID:t._addPointArrToRst(e,E.Rectangle._getBoundPointS(M.x,M.y,M.width,M.height),C);break;case o.DrawCircleCmd.ID:t._addPointArrToRst(e,E.Rectangle._getBoundPointS(M.x-M.radius,M.y-M.radius,M.radius+M.radius,M.radius+M.radius),C);break;case l.DrawLineCmd.ID:var Y;t._tempPoints.length=0,Y=.5*M.lineWidth,M.fromX==M.toX?t._tempPoints.push(M.fromX+Y,M.fromY,M.toX+Y,M.toY,M.fromX-Y,M.fromY,M.toX-Y,M.toY):M.fromY==M.toY?t._tempPoints.push(M.fromX,M.fromY+Y,M.toX,M.toY+Y,M.fromX,M.fromY-Y,M.toX,M.toY-Y):t._tempPoints.push(M.fromX,M.fromY,M.toX,M.toY),t._addPointArrToRst(e,t._tempPoints,C);break;case s.DrawCurvesCmd.ID:t._addPointArrToRst(e,x.Bezier.I.getBezierPoints(M.points),C,M.x,M.y);break;case h.DrawLinesCmd.ID:case _.DrawPolyCmd.ID:t._addPointArrToRst(e,M.points,C,M.x,M.y);break;case c.DrawPathCmd.ID:t._addPointArrToRst(e,this._getPathPoints(M.paths),C,M.x,M.y);break;case f.DrawPieCmd.ID:t._addPointArrToRst(e,this._getPiePoints(M.x,M.y,M.radius,M.startAngle,M.endAngle),C);break;case R.DrawTrianglesCmd.ID:t._addPointArrToRst(e,this._getTriAngBBXPoints(M.vertices),C);break;case I.Draw9GridTexture.ID:t._addPointArrToRst(e,this._getDraw9GridBBXPoints(M),C)}return e.length>200?e=L.Utils.copyArray(e,E.Rectangle._getWrapRec(e)._getBoundPoints()):e.length>8&&(e=w.GrahamScan.scanPList(e)),e}},{key:"_switchMatrix",value:function(t,e){(0,i.default)(e).call(e,t),e.copyTo(t)}},{key:"_getPiePoints",value:function(e,n,i,r,a){var o=t._tempPoints;t._tempPoints.length=0;var s=Math.PI/180,u=a-r;if(u>=360||u<=-360)return o.push(e-i,n-i),o.push(e+i,n-i),o.push(e+i,n+i),o.push(e-i,n+i),o;o.push(e,n);var l=u%360;l<0&&(l+=360);var h=r+l,c=r*s,f=h*s;o.push(e+i*Math.cos(c),n+i*Math.sin(c)),o.push(e+i*Math.cos(f),n+i*Math.sin(f));for(var _=90*Math.ceil(r/90),d=90*Math.floor(h/90),p=_;p<=d;p+=90){var y=p*s;o.push(e+i*Math.cos(y),n+i*Math.sin(y))}return o}},{key:"_getTriAngBBXPoints",value:function(t){var e=t.length;if(e<2)return[];for(var n=t[0],i=t[1],r=n,a=i,o=2;o<e;){var s=t[o++],u=t[o++];n>s&&(n=s),i>u&&(i=u),r<s&&(r=s),a<u&&(a=u)}return[n,i,r,i,r,a,n,a]}},{key:"_getDraw9GridBBXPoints",value:function(t){var e=t.width,n=t.height;return[0,0,e,0,e,n,0,n]}},{key:"_getPathPoints",value:function(e){var n,i,r,a=t._tempPoints;for(a.length=0,i=e.length,n=0;n<i;n++)(r=e[n]).length>1&&(a.push(r[1],r[2]),r.length>3&&a.push(r[3],r[4]));return a}}],r=[{key:"create",value:function(){return M.Pool.getItemByClass("GraphicsBounds",t)}},{key:"_addPointArrToRst",value:function(e,n,i){var r,a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;for(a=n.length,r=0;r<a;r+=2)t._addPointToRst(e,n[r]+o,n[r+1]+s,i)}},{key:"_addPointToRst",value:function(t,e,n,i){var r=C.Point.TEMP;r.setTo(e||0,n||0),i.transformPoint(r),t.push(r.x,r.y)}}],n&&B(e.prototype,n),r&&B(e,r),t}();e.GraphicsBounds=P,P._tempMatrix=new k.Matrix,P._initMatrix=new k.Matrix,P._tempPoints=[],P._tempMatrixArrays=[],P._tempCmds=[]},61891:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.Input=void 0;var f=b(n(81643)),_=b(n(85507)),d=b(n(21611)),p=n(81870),y=n(89662),v=n(56083),g=n(92493),m=n(23835);function b(t){return t&&t.__esModule?t:{default:t}}function T(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function x(){return x="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=w(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},x.apply(this,arguments)}function w(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=M(t)););return t}function k(t,e){return k=a||function(t,e){return t.__proto__=e,t},k(t,e)}function C(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=M(t);if(e){var a=M(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return E(this,n)}}function E(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return S(t)}function S(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function M(t){return M=_.default?d.default:function(t){return t.__proto__||(0,d.default)(t)},M(t)}var L=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&k(t,e)}(a,t);var e,n,i,r=C(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this))._multiline=!1,t._editable=!0,t._maxChars=1e5,t._type="text",t._prompt="",t._promptColor="#A9A9A9",t._originColor="#000000",t._content="",a.IOS_IFRAME=g.ILaya.Browser.onIOS&&g.ILaya.Browser.window.top!=g.ILaya.Browser.window.self,t._width=100,t._height=20,t.multiline=!1,t.overflow=p.Text.SCROLL,t.on(y.Event.MOUSE_DOWN,S(t),t._onMouseDown),t.on(y.Event.UNDISPLAY,S(t),t._onUnDisplay),t}return e=a,i=[{key:"__init__",value:function(){if(a._createInputElement(),g.ILaya.Browser.onMobile){var t=!1;(g.ILaya.Browser.onMiniGame||g.ILaya.Browser.onBDMiniGame||g.ILaya.Browser.onQGMiniGame||g.ILaya.Browser.onKGMiniGame||g.ILaya.Browser.onVVMiniGame||g.ILaya.Browser.onAlipayMiniGame||g.ILaya.Browser.onQQMiniGame||g.ILaya.Browser.onBLMiniGame||g.ILaya.Browser.onTTMiniGame||g.ILaya.Browser.onHWMiniGame||g.ILaya.Browser.onTBMiniGame)&&(t=!0),g.ILaya.Render.canvas.addEventListener(a.IOS_IFRAME?t?"touchend":"click":"touchend",a._popupInputMethod)}}},{key:"_popupInputMethod",value:function(t){a.isInputting&&a.inputElement.focus()}},{key:"_createInputElement",value:function(){a._initInput(a.area=g.ILaya.Browser.createElement("textarea")),a._initInput(a.input=g.ILaya.Browser.createElement("input")),a.inputContainer=g.ILaya.Browser.createElement("div"),a.inputContainer.style.position="absolute",a.inputContainer.style.zIndex="1E5",g.ILaya.Browser.container.appendChild(a.inputContainer),a.inputContainer.setPos=function(t,e){a.inputContainer.style.left=t+"px",a.inputContainer.style.top=e+"px"}}},{key:"_initInput",value:function(t){var e=t.style;e.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",e.resize="none",e.backgroundColor="transparent",e.border="none",e.outline="none",e.zIndex="1",t.addEventListener("input",a._processInputting),t.addEventListener("mousemove",a._stopEvent),t.addEventListener("mousedown",a._stopEvent),t.addEventListener("touchmove",a._stopEvent),t.setFontFace=function(e){t.style.fontFamily=e},g.ILaya.Render.isConchApp||(t.setColor=function(e){t.style.color=e},t.setFontSize=function(e){t.style.fontSize=e+"px"})}},{key:"_processInputting",value:function(t){var e=a.inputElement.target;if(e){var n=a.inputElement.value;e._restrictPattern&&(n=n.replace(/\u2006|\x27/g,""),e._restrictPattern.test(n)&&(n=n.replace(e._restrictPattern,""),a.inputElement.value=n)),e._text=n,e.event(y.Event.INPUT)}}},{key:"_stopEvent",value:function(t){"touchmove"==t.type&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()}}],(n=[{key:"setSelection",value:function(t,e){this.focus=!0,a.inputElement.selectionStart=t,a.inputElement.selectionEnd=e}},{key:"multiline",get:function(){return this._multiline},set:function(t){this._multiline=t,this.valign=t?"top":"middle"}},{key:"nativeInput",get:function(){return this._multiline?a.area:a.input}},{key:"_onUnDisplay",value:function(){this.focus=!1}},{key:"_onMouseDown",value:function(t){this.focus=!0}},{key:"_syncInputTransform",value:function(){var t=this.nativeInput,e=v.Utils.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),n=this._width-this.padding[1]-this.padding[3],i=this._height-this.padding[0]-this.padding[2];g.ILaya.Render.isConchApp?(t.setScale(e.scaleX,e.scaleY),t.setSize(n,i),t.setPos(e.x,e.y)):(a.inputContainer.style.transform=a.inputContainer.style.webkitTransform="scale("+e.scaleX+","+e.scaleY+") rotate("+g.ILaya.stage.canvasDegree+"deg)",t.style.width=n+"px",t.style.height=i+"px",a.inputContainer.style.left=e.x+"px",a.inputContainer.style.top=e.y+"px")}},{key:"select",value:function(){this.nativeInput.select()}},{key:"focus",get:function(){return this._focus},set:function(t){var e=this.nativeInput;this._focus!==t&&(t?(e.target?e.target._focusOut():this._setInputMethod(),(e=this.nativeInput).target=this,this._focusIn()):(e.target=null,this._focusOut(),g.ILaya.Browser.document.body.scrollTop=0,e.blur(),g.ILaya.Render.isConchApp?e.setPos(-1e4,-1e4):a.inputContainer.contains(e)&&a.inputContainer.removeChild(e)))}},{key:"_setInputMethod",value:function(){a.input.parentElement&&a.inputContainer.removeChild(a.input),a.area.parentElement&&a.inputContainer.removeChild(a.area),g.ILaya.Browser.onAndroid&&(a.input=a.inputElement=g.ILaya.Browser.createElement("input"),a._initInput(a.input)),a.inputElement=this._multiline?a.area:a.input,a.inputContainer.appendChild(a.inputElement),p.Text.RightToLeft&&(a.inputElement.style.direction="rtl")}},{key:"_focusIn",value:function(){a.isInputting=!0;var t=this.nativeInput;a.input&&(a.input.type=this._type),this._focus=!0;var e=t.style;e.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),t.readOnly=!this._editable,g.ILaya.Render.isConchApp&&(t.setType(this._type),t.setForbidEdit(!this._editable)),t.maxLength=this._maxChars,t.value=this._content,t.placeholder=this._prompt,g.ILaya.stage.off(y.Event.KEY_DOWN,this,this._onKeyDown),g.ILaya.stage.on(y.Event.KEY_DOWN,this,this._onKeyDown),g.ILaya.stage.focus=this,this.event(y.Event.FOCUS),g.ILaya.Browser.onPC&&t.focus(),g.ILaya.Browser.onMiniGame||g.ILaya.Browser.onBDMiniGame||g.ILaya.Browser.onQGMiniGame||g.ILaya.Browser.onKGMiniGame||g.ILaya.Browser.onVVMiniGame||g.ILaya.Browser.onAlipayMiniGame||g.ILaya.Browser.onQQMiniGame||g.ILaya.Browser.onBLMiniGame||g.ILaya.Browser.onTTMiniGame||g.ILaya.Browser.onHWMiniGame||g.ILaya.Browser.onTBMiniGame||(this._text=null),this.typeset(),t.setColor(this._originColor),t.setFontSize(this.fontSize),t.setFontFace(g.ILaya.Browser.onIPhone&&p.Text.fontFamilyMap[this.font]||this.font),g.ILaya.Render.isConchApp&&t.setMultiAble&&t.setMultiAble(this._multiline),e.lineHeight=this.leading+this.fontSize+"px",e.fontStyle=this.italic?"italic":"normal",e.fontWeight=this.bold?"bold":"normal",e.textAlign=this.align,e.padding="0 0",this._syncInputTransform(),!g.ILaya.Render.isConchApp&&g.ILaya.Browser.onPC&&g.ILaya.systemTimer.frameLoop(1,this,this._syncInputTransform)}},{key:"_setPromptColor",value:function(){a.promptStyleDOM=g.ILaya.Browser.getElementById("promptStyle"),a.promptStyleDOM||(a.promptStyleDOM=g.ILaya.Browser.createElement("style"),a.promptStyleDOM.setAttribute("id","promptStyle"),g.ILaya.Browser.document.head.appendChild(a.promptStyleDOM)),a.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"}},{key:"_focusOut",value:function(){a.isInputting&&(a.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(x(M(a.prototype),"set_text",this).call(this,this._content),x(M(a.prototype),"set_color",this).call(this,this._originColor)):(x(M(a.prototype),"set_text",this).call(this,this._prompt),x(M(a.prototype),"set_color",this).call(this,this._promptColor)),g.ILaya.stage.off(y.Event.KEY_DOWN,this,this._onKeyDown),g.ILaya.stage.focus=null,this.event(y.Event.BLUR),this.event(y.Event.CHANGE),g.ILaya.Render.isConchApp&&this.nativeInput.blur(),g.ILaya.Browser.onPC&&g.ILaya.systemTimer.clear(this,this._syncInputTransform))}},{key:"_onKeyDown",value:function(t){13===t.keyCode&&(g.ILaya.Browser.onMobile&&!this._multiline&&(this.focus=!1),this.event(y.Event.ENTER))}},{key:"miniGameTxt",value:function(t){x(M(a.prototype),"set_color",this).call(this,this._originColor),t+="",this._multiline||(t=t.replace(/\r?\n/g,"")),this._content=t,t?x(M(a.prototype),"set_text",this).call(this,t):(x(M(a.prototype),"set_text",this).call(this,this._prompt),x(M(a.prototype),"set_color",this).call(this,this.promptColor))}},{key:"text",get:function(){return this._focus?this.nativeInput.value:this._content||""},set:function(t){x(M(a.prototype),"set_color",this).call(this,this._originColor),t+="",this._focus?(this.nativeInput.value=t||"",this.event(y.Event.CHANGE)):(this._multiline||(t=t.replace(/\r?\n/g,"")),this._content=t,t?x(M(a.prototype),"set_text",this).call(this,t):(x(M(a.prototype),"set_text",this).call(this,this._prompt),x(M(a.prototype),"set_color",this).call(this,this.promptColor)))}},{key:"changeText",value:function(t){this._content=t,this._focus?(this.nativeInput.value=t||"",this.event(y.Event.CHANGE)):x(M(a.prototype),"changeText",this).call(this,t)}},{key:"color",get:function(){return x(M(a.prototype),"color",this)},set:function(t){this._focus&&this.nativeInput.setColor(t),x(M(a.prototype),"set_color",this).call(this,this._content?t:this._promptColor),this._originColor=t}},{key:"bgColor",get:function(){return x(M(a.prototype),"bgColor",this)},set:function(t){x(M(a.prototype),"set_bgColor",this).call(this,t),g.ILaya.Render.isConchApp&&this.nativeInput.setBgColor(t)}},{key:"restrict",get:function(){return this._restrictPattern?this._restrictPattern.source:""},set:function(t){t?(t="[^"+t+"]",(0,f.default)(t).call(t,"^^")>-1&&(t=t.replace("^^","")),this._restrictPattern=new RegExp(t,"g")):this._restrictPattern=null}},{key:"editable",get:function(){return this._editable},set:function(t){this._editable=t,g.ILaya.Render.isConchApp&&a.input.setForbidEdit(!t)}},{key:"maxChars",get:function(){return this._maxChars},set:function(t){t<=0&&(t=1e5),this._maxChars=t}},{key:"prompt",get:function(){return this._prompt},set:function(t){!this._text&&t&&x(M(a.prototype),"set_color",this).call(this,this._promptColor),this.promptColor=this._promptColor,this._text?x(M(a.prototype),"set_text",this).call(this,this._text==this._prompt?t:this._text):x(M(a.prototype),"set_text",this).call(this,t),this._prompt=p.Text.langPacks&&p.Text.langPacks[t]?p.Text.langPacks[t]:t}},{key:"promptColor",get:function(){return this._promptColor},set:function(t){this._promptColor=t,this._content||x(M(a.prototype),"set_color",this).call(this,t)}},{key:"type",get:function(){return this._type},set:function(t){this._getTextStyle().asPassword="password"===t,this._type=t}}])&&T(e.prototype,n),i&&T(e,i),a}(p.Text);e.Input=L,L.TYPE_TEXT="text",L.TYPE_PASSWORD="password",L.TYPE_EMAIL="email",L.TYPE_URL="url",L.TYPE_NUMBER="number",L.TYPE_RANGE="range",L.TYPE_DATE="date",L.TYPE_MONTH="month",L.TYPE_WEEK="week",L.TYPE_TIME="time",L.TYPE_DATE_TIME="datetime",L.TYPE_DATE_TIME_LOCAL="datetime-local",L.TYPE_SEARCH="search",L.IOS_IFRAME=!1,L.inputHeight=45,L.isInputting=!1,m.ClassUtils.regClass("laya.display.Input",L),m.ClassUtils.regClass("Laya.Input",L)},54190:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.Node=void 0;var h=T(n(92762)),c=T(n(81643)),f=T(n(85507)),_=T(n(21611)),d=n(13407),p=n(89662),y=n(48856),v=n(64210),g=n(683),m=n(92493),b=n(23835);function T(t){return t&&t.__esModule?t:{default:t}}function x(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function w(t,e){return w=a||function(t,e){return t.__proto__=e,t},w(t,e)}function k(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=E(t);if(e){var a=E(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return C(this,n)}}function C(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function E(t){return E=f.default?_.default:function(t){return t.__proto__||(0,_.default)(t)},E(t)}var S=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}(a,t);var e,n,i,r=k(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this))._bits=0,t._children=a.ARRAY_EMPTY,t._extUIChild=a.ARRAY_EMPTY,t._parent=null,t.name="",t.destroyed=!1,t.createGLBuffer(),t}return e=a,n=[{key:"createGLBuffer",value:function(){}},{key:"_setBit",value:function(t,e){t===d.Const.DISPLAY&&this._getBit(t)!=e&&this._updateDisplayedInstage(),e?this._bits|=t:this._bits&=~t}},{key:"_getBit",value:function(t){return 0!=(this._bits&t)}},{key:"_setUpNoticeChain",value:function(){this._getBit(d.Const.DISPLAY)&&this._setBitUp(d.Const.DISPLAY)}},{key:"_setBitUp",value:function(t){var e=this;for(e._setBit(t,!0),e=e._parent;e;){if(e._getBit(t))return;e._setBit(t,!0),e=e._parent}}},{key:"on",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return t!==p.Event.DISPLAY&&t!==p.Event.UNDISPLAY||this._getBit(d.Const.DISPLAY)||this._setBitUp(d.Const.DISPLAY),this._createListener(t,e,n,i,!1)}},{key:"once",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return t!==p.Event.DISPLAY&&t!==p.Event.UNDISPLAY||this._getBit(d.Const.DISPLAY)||this._setBitUp(d.Const.DISPLAY),this._createListener(t,e,n,i,!0)}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.destroyed=!0,this._destroyAllComponent(),this._parent&&this._parent.removeChild(this),this._children&&(t?this.destroyChildren():this.removeChildren()),this.onDestroy(),this._children=null,this.offAll()}},{key:"onDestroy",value:function(){}},{key:"destroyChildren",value:function(){if(this._children)for(var t=0,e=this._children.length;t<e;t++)this._children[0].destroy(!0)}},{key:"addChild",value:function(t){if(!t||this.destroyed||t===this)return t;if(t._zOrder&&this._setBit(d.Const.HAS_ZORDER,!0),t._parent===this){var e,n=this.getChildIndex(t);n!==this._children.length-1&&((0,h.default)(e=this._children).call(e,n,1),this._children.push(t),this._childChanged())}else t._parent&&t._parent.removeChild(t),this._children===a.ARRAY_EMPTY&&(this._children=[]),this._children.push(t),t._setParent(this),this._childChanged();return t}},{key:"addInputChild",value:function(t){if(this._extUIChild==a.ARRAY_EMPTY)this._extUIChild=[t];else{var e;if((0,c.default)(e=this._extUIChild).call(e,t)>=0)return null;this._extUIChild.push(t)}return null}},{key:"removeInputChild",value:function(t){var e,n,i=(0,c.default)(e=this._extUIChild).call(e,t);i>=0&&(0,h.default)(n=this._extUIChild).call(n,i,1)}},{key:"addChildren",value:function(){for(var t=0,e=arguments.length;t<e;){var n;this.addChild((n=t++)<0||arguments.length<=n?void 0:arguments[n])}}},{key:"addChildAt",value:function(t,e){if(!t||this.destroyed||t===this)return t;if(t._zOrder&&this._setBit(d.Const.HAS_ZORDER,!0),e>=0&&e<=this._children.length){if(t._parent===this){var n,i,r=this.getChildIndex(t);(0,h.default)(n=this._children).call(n,r,1),(0,h.default)(i=this._children).call(i,e,0,t),this._childChanged()}else{var o;t._parent&&t._parent.removeChild(t),this._children===a.ARRAY_EMPTY&&(this._children=[]),(0,h.default)(o=this._children).call(o,e,0,t),t._setParent(this)}return t}throw new Error("appendChildAt:The index is out of bounds")}},{key:"getChildIndex",value:function(t){var e;return(0,c.default)(e=this._children).call(e,t)}},{key:"getChildByName",value:function(t){var e=this._children;if(e)for(var n=0,i=e.length;n<i;n++){var r=e[n];if(r.name===t)return r}return null}},{key:"getChildAt",value:function(t){return this._children[t]||null}},{key:"setChildIndex",value:function(t,e){var n=this._children;if(e<0||e>=n.length)throw new Error("setChildIndex:The index is out of bounds.");var i=this.getChildIndex(t);if(i<0)throw new Error("setChildIndex:node is must child of this object.");return(0,h.default)(n).call(n,i,1),(0,h.default)(n).call(n,e,0,t),this._childChanged(),t}},{key:"_childChanged",value:function(){}},{key:"removeChild",value:function(t){var e;if(!this._children)return t;var n=(0,c.default)(e=this._children).call(e,t);return this.removeChildAt(n)}},{key:"removeSelf",value:function(){return this._parent&&this._parent.removeChild(this),this}},{key:"removeChildByName",value:function(t){var e=this.getChildByName(t);return e&&this.removeChild(e),e}},{key:"removeChildAt",value:function(t){var e,n=this.getChildAt(t);return n&&((0,h.default)(e=this._children).call(e,t,1),n._setParent(null)),n}},{key:"removeChildren",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2147483647;if(this._children&&this._children.length>0){var n=this._children;if(0===t&&e>=n.length-1){var i=n;this._children=a.ARRAY_EMPTY}else i=(0,h.default)(n).call(n,t,e-t+1);for(var r=0,o=i.length;r<o;r++)i[r]._setParent(null)}return this}},{key:"replaceChild",value:function(t,e){var n,i,r=(0,c.default)(n=this._children).call(n,e);return r>-1?((0,h.default)(i=this._children).call(i,r,1,t),e._setParent(null),t._setParent(this),t):null}},{key:"numChildren",get:function(){return this._children.length}},{key:"parent",get:function(){return this._parent}},{key:"_setParent",value:function(t){this._parent!==t&&(t?(this._parent=t,this._onAdded(),this.event(p.Event.ADDED),this._getBit(d.Const.DISPLAY)&&(this._setUpNoticeChain(),t.displayedInStage&&this._displayChild(this,!0)),t._childChanged(this)):(this._onRemoved(),this.event(p.Event.REMOVED),this._parent._childChanged(),this._getBit(d.Const.DISPLAY)&&this._displayChild(this,!1),this._parent=t))}},{key:"displayedInStage",get:function(){return this._getBit(d.Const.DISPLAY)||this._setBitUp(d.Const.DISPLAY),this._getBit(d.Const.DISPLAYED_INSTAGE)}},{key:"_updateDisplayedInstage",value:function(){var t;t=this;for(var e=m.ILaya.stage,n=!1;t;){if(t._getBit(d.Const.DISPLAY)){n=t._getBit(d.Const.DISPLAYED_INSTAGE);break}if(t===e||t._getBit(d.Const.DISPLAYED_INSTAGE)){n=!0;break}t=t._parent}this._setBit(d.Const.DISPLAYED_INSTAGE,n)}},{key:"_setDisplay",value:function(t){this._getBit(d.Const.DISPLAYED_INSTAGE)!==t&&(this._setBit(d.Const.DISPLAYED_INSTAGE,t),t?this.event(p.Event.DISPLAY):this.event(p.Event.UNDISPLAY))}},{key:"_displayChild",value:function(t,e){var n=t._children;if(n)for(var i=0,r=n.length;i<r;i++){var a=n[i];a._getBit(d.Const.DISPLAY)&&(a._children.length>0?this._displayChild(a,e):a._setDisplay(e))}t._setDisplay(e)}},{key:"contains",value:function(t){if(t===this)return!0;for(;t;){if(t._parent===this)return!0;t=t._parent}return!1}},{key:"timerLoop",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=this.scene?this.scene.timer:m.ILaya.timer;o.loop(t,e,n,i,r,a)}},{key:"timerOnce",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=this.scene?this.scene.timer:m.ILaya.timer;a._create(!1,!1,t,e,n,i,r)}},{key:"frameLoop",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=this.scene?this.scene.timer:m.ILaya.timer;a._create(!0,!0,t,e,n,i,r)}},{key:"frameOnce",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=this.scene?this.scene.timer:m.ILaya.timer;a._create(!0,!1,t,e,n,i,r)}},{key:"clearTimer",value:function(t,e){(this.scene?this.scene.timer:m.ILaya.timer).clear(t,e)}},{key:"callLater",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.scene?this.scene.timer:m.ILaya.timer;n.callLater(this,t,e)}},{key:"runCallLater",value:function(t){(this.scene?this.scene.timer:m.ILaya.timer).runCallLater(this,t)}},{key:"scene",get:function(){return this._scene}},{key:"active",get:function(){return!this._getBit(d.Const.NOT_READY)&&!this._getBit(d.Const.NOT_ACTIVE)},set:function(t){if(t=!!t,!this._getBit(d.Const.NOT_ACTIVE)!==t){if(this._activeChangeScripts&&0!==this._activeChangeScripts.length)throw t?"Node: can't set the main inActive node active in hierarchy,if the operate is in main inActive node or it's children script's onDisable Event.":"Node: can't set the main active node inActive in hierarchy,if the operate is in main active node or it's children script's onEnable Event.";this._setBit(d.Const.NOT_ACTIVE,!t),this._parent&&this._parent.activeInHierarchy&&(t?this._processActive():this._processInActive())}}},{key:"activeInHierarchy",get:function(){return this._getBit(d.Const.ACTIVE_INHIERARCHY)}},{key:"_onActive",value:function(){g.Stat.spriteCount++}},{key:"_onInActive",value:function(){g.Stat.spriteCount--}},{key:"_onActiveInScene",value:function(){}},{key:"_onInActiveInScene",value:function(){}},{key:"_parse",value:function(t,e){}},{key:"_setBelongScene",value:function(t){if(!this._scene){this._scene=t,this._onActiveInScene();for(var e=0,n=this._children.length;e<n;e++)this._children[e]._setBelongScene(t)}}},{key:"_setUnBelongScene",value:function(){if(this._scene!==this){this._onInActiveInScene(),this._scene=null;for(var t=0,e=this._children.length;t<e;t++)this._children[t]._setUnBelongScene()}}},{key:"onAwake",value:function(){}},{key:"onEnable",value:function(){}},{key:"_processActive",value:function(){this._activeChangeScripts||(this._activeChangeScripts=[]),this._activeHierarchy(this._activeChangeScripts),this._activeScripts()}},{key:"_activeHierarchy",value:function(t){if(this._setBit(d.Const.ACTIVE_INHIERARCHY,!0),this._components)for(var e=0,n=this._components.length;e<n;e++){var i=this._components[e];i._isScript()?i._enabled&&t.push(i):i._setActive(!0)}for(this._onActive(),e=0,n=this._children.length;e<n;e++){var r=this._children[e];!r._getBit(d.Const.NOT_ACTIVE)&&!r._getBit(d.Const.NOT_READY)&&r._activeHierarchy(t)}this._getBit(d.Const.AWAKED)||(this._setBit(d.Const.AWAKED,!0),this.onAwake()),this.onEnable()}},{key:"_activeScripts",value:function(){for(var t=0,e=this._activeChangeScripts.length;t<e;t++){var n=this._activeChangeScripts[t];n._awaked||(n._awaked=!0,n._onAwake()),n._onEnable()}this._activeChangeScripts.length=0}},{key:"_processInActive",value:function(){this._activeChangeScripts||(this._activeChangeScripts=[]),this._inActiveHierarchy(this._activeChangeScripts),this._inActiveScripts()}},{key:"_inActiveHierarchy",value:function(t){if(this._onInActive(),this._components)for(var e=0,n=this._components.length;e<n;e++){var i=this._components[e];!i._isScript()&&i._setActive(!1),i._isScript()&&i._enabled&&t.push(i)}for(this._setBit(d.Const.ACTIVE_INHIERARCHY,!1),e=0,n=this._children.length;e<n;e++){var r=this._children[e];r&&!r._getBit(d.Const.NOT_ACTIVE)&&r._inActiveHierarchy(t)}this.onDisable()}},{key:"_inActiveScripts",value:function(){for(var t=0,e=this._activeChangeScripts.length;t<e;t++)this._activeChangeScripts[t].owner&&this._activeChangeScripts[t]._onDisable();this._activeChangeScripts.length=0}},{key:"onDisable",value:function(){}},{key:"_onAdded",value:function(){if(this._activeChangeScripts&&0!==this._activeChangeScripts.length)throw"Node: can't set the main inActive node active in hierarchy,if the operate is in main inActive node or it's children script's onDisable Event.";var t=this._parent.scene;t&&this._setBelongScene(t),this._parent.activeInHierarchy&&this.active&&this._processActive()}},{key:"_onRemoved",value:function(){if(this._activeChangeScripts&&0!==this._activeChangeScripts.length)throw"Node: can't set the main active node inActive in hierarchy,if the operate is in main active node or it's children script's onEnable Event.";this._parent.activeInHierarchy&&this.active&&this._processInActive(),this._parent.scene&&this._setUnBelongScene()}},{key:"_addComponentInstance",value:function(t){this._components=this._components||[],this._components.push(t),t.owner=this,t._onAdded(),this.activeInHierarchy&&t._setActive(!0)}},{key:"_destroyComponent",value:function(t){if(this._components)for(var e=0,n=this._components.length;e<n;e++){var i=this._components[e];if(i===t){var r;i._destroy(),(0,h.default)(r=this._components).call(r,e,1);break}}}},{key:"_destroyAllComponent",value:function(){if(this._components){for(var t=0,e=this._components.length;t<e;t++){var n=this._components[t];n&&n._destroy()}this._components.length=0}}},{key:"_cloneTo",value:function(t,e,n){var i=t;if(this._components)for(var r=0,a=this._components.length;r<a;r++){var o=i.addComponent(this._components[r].constructor);this._components[r]._cloneTo(o)}}},{key:"addComponentIntance",value:function(t){if(t.owner)throw"Node:the component has belong to other node.";if(t.isSingleton&&this.getComponent(t.constructor))throw"Node:the component is singleton,can't add the second one.";return this._addComponentInstance(t),t}},{key:"addComponent",value:function(t){var e=v.Pool.createByClass(t);if(!e)throw t.toString()+"组件不存在";if(e._destroyed=!1,e.isSingleton&&this.getComponent(t))throw"无法实例"+t+"组件，"+t+"组件已存在！";return this._addComponentInstance(e),e}},{key:"getComponent",value:function(t){if(this._components)for(var e=0,n=this._components.length;e<n;e++){var i=this._components[e];if(i instanceof t)return i}return null}},{key:"getComponents",value:function(t){var e;if(this._components)for(var n=0,i=this._components.length;n<i;n++){var r=this._components[n];r instanceof t&&(e=e||[]).push(r)}return e}},{key:"timer",get:function(){return this.scene?this.scene.timer:m.ILaya.timer}}],n&&x(e.prototype,n),i&&x(e,i),a}(y.EventDispatcher);e.Node=S,S.ARRAY_EMPTY=[],b.ClassUtils.regClass("laya.display.Node",S),b.ClassUtils.regClass("Laya.Node",S)},28294:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.Scene=void 0;var f=M(n(81643)),_=M(n(92762)),d=M(n(77766)),p=M(n(85507)),y=M(n(21611)),v=n(54190),g=n(13407),m=n(78362),b=n(89662),T=n(8863),x=n(25883),w=n(41107),k=n(21383),C=n(92493),E=n(23835),S=n(84935);function M(t){return t&&t.__esModule?t:{default:t}}function L(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function R(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function I(){return I="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=A(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},I.apply(this,arguments)}function A(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=F(t)););return t}function D(t,e){return D=a||function(t,e){return t.__proto__=e,t},D(t,e)}function B(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=F(t);if(e){var a=F(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return P(this,n)}}function P(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return O(t)}function O(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function F(t){return F=p.default?y.default:function(t){return t.__proto__||(0,y.default)(t)},F(t)}var U=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&D(t,e)}(a,t);var e,n,i,r=B(a);function a(){var t,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return L(this,a),(t=r.call(this)).autoDestroyAtClosed=!1,t.url=null,t._viewCreated=!1,t._idMap=null,t._$componentType="Scene",a.unDestroyedScenes.push(O(t)),t._scene=O(t),e&&t.createChildren(),t}return e=a,n=[{key:"createChildren",value:function(){}},{key:"loadScene",value:function(t){var e=(0,f.default)(t).call(t,".")>-1?t:t+".scene",n=C.ILaya.loader.getRes(e);if(n)this.createView(n);else{this._setBit(g.Const.NOT_READY,!0),C.ILaya.loader.resetProgress();var i=new T.SceneLoader;i.on(b.Event.COMPLETE,this,this._onSceneLoaded,[e]),i.load(e)}}},{key:"_onSceneLoaded",value:function(t){this.createView(C.ILaya.Loader.getRes(t))}},{key:"createView",value:function(t){t&&!this._viewCreated&&(this._viewCreated=!0,k.SceneUtils.createByData(this,t))}},{key:"getNodeByID",value:function(t){return this._idMap?this._idMap[t]:null}},{key:"open",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t&&a.closeAll(),a.root.addChild(this),this.onOpened(e)}},{key:"onOpened",value:function(t){}},{key:"close",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.onClosed(t),this.autoDestroyAtClosed?this.destroy():this.removeSelf()}},{key:"onClosed",value:function(){}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._idMap=null,I(F(a.prototype),"destroy",this).call(this,t);for(var e=a.unDestroyedScenes,n=e.length-1;n>-1;n--)if(e[n]===this)return void(0,_.default)(e).call(e,n,1)}},{key:"scaleX",get:function(){return I(F(a.prototype),"scaleX",this)},set:function(t){I(F(a.prototype),"get_scaleX",this).call(this)!=t&&(I(F(a.prototype),"set_scaleX",this).call(this,t),this.event(b.Event.RESIZE))}},{key:"scaleY",get:function(){return I(F(a.prototype),"scaleY",this)},set:function(t){I(F(a.prototype),"get_scaleY",this).call(this)!=t&&(I(F(a.prototype),"set_scaleY",this).call(this,t),this.event(b.Event.RESIZE))}},{key:"width",get:function(){if(this._width)return this._width;for(var t=0,e=this.numChildren-1;e>-1;e--){var n=this.getChildAt(e);n._visible&&(t=Math.max(n._x+n.width*n.scaleX,t))}return t},set:function(t){I(F(a.prototype),"get_width",this).call(this)!=t&&(I(F(a.prototype),"set_width",this).call(this,t),this.callLater(this._sizeChanged))}},{key:"height",get:function(){if(this._height)return this._height;for(var t=0,e=this.numChildren-1;e>-1;e--){var n=this.getChildAt(e);n._visible&&(t=Math.max(n._y+n.height*n.scaleY,t))}return t},set:function(t){I(F(a.prototype),"get_height",this).call(this)!=t&&(I(F(a.prototype),"set_height",this).call(this,t),this.callLater(this._sizeChanged))}},{key:"_sizeChanged",value:function(){this.event(b.Event.RESIZE)}},{key:"timer",get:function(){return this._timer||C.ILaya.timer},set:function(t){this._timer=t}}],i=[{key:"setUIMap",value:function(t){var e=C.ILaya.loader.getRes(t);if(!e)throw"请提前加载uimap的json，再使用该接口设置！";for(var n in e)C.ILaya.Loader.loadedMap[S.URL.formatURL(n+".scene")]=e[n]}},{key:"root",get:function(){return a._root||(a._root=C.ILaya.stage.addChild(new m.Sprite),a._root.name="root",C.ILaya.stage.on("resize",null,(function(){a._root.size(C.ILaya.stage.width,C.ILaya.stage.height),a._root.event(b.Event.RESIZE)})),a._root.size(C.ILaya.stage.width,C.ILaya.stage.height),a._root.event(b.Event.RESIZE)),a._root}},{key:"load",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;C.ILaya.loader.resetProgress();var i=new T.SceneLoader;function r(t){a._loadPage&&a._loadPage.event("progress",t),n&&n.runWith(t)}function o(){i.off(b.Event.PROGRESS,null,r);var n=C.ILaya.Loader.getRes(t);if(!n)throw"Can not find scene:"+t;if(!n.props)throw"Scene data is error:"+t;var o=n.props.runtime?n.props.runtime:n.type,s=C.ILaya.ClassUtils.getClass(o);if("instance"==n.props.renderType)var u=s.instance||(s.instance=new s);else u=new s;if(!(u&&u instanceof v.Node))throw"Can not find scene:"+o;u.url=t,u._viewCreated?e&&e.runWith(u):(u.on("onViewCreated",null,(function(){e&&e.runWith(u)})),u.createView(n)),a.hideLoadingPage()}i.on(b.Event.PROGRESS,null,r),i.once(b.Event.COMPLETE,null,o),i.load(t)}},{key:"open",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(n instanceof w.Handler){var o=i;i=n,n=o}a.showLoadingPage(),a.load(t,w.Handler.create(null,this._onSceneLoaded,[e,i,n]),r)}},{key:"_onSceneLoaded",value:function(t,e,n,i){i.open(t,n),e&&e.runWith(i)}},{key:"close",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=!1,i=a.unDestroyedScenes,r=0,o=i.length;r<o;r++){var s=i[r];s&&s.parent&&s.url===t&&s.name==e&&(s.close(),n=!0)}return n}},{key:"closeAll",value:function(){for(var t=a.root,e=0,n=t.numChildren;e<n;e++){var i=t.getChildAt(0);i instanceof a?i.close():i.removeSelf()}}},{key:"destroy",value:function(t){for(var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=!1,r=(0,d.default)(e=[]).call(e,a.unDestroyedScenes),o=0,s=r.length;o<s;o++){var u=r[o];u.url!==t||u.name!=n||u.destroyed||(u.destroy(),i=!0)}return i}},{key:"gc",value:function(){x.Resource.destroyUnusedResources()}},{key:"setLoadingPage",value:function(t){a._loadPage!=t&&(a._loadPage=t)}},{key:"showLoadingPage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;a._loadPage&&(C.ILaya.systemTimer.clear(null,a._showLoading),C.ILaya.systemTimer.clear(null,a._hideLoading),C.ILaya.systemTimer.once(e,null,a._showLoading,[t],!1))}},{key:"_showLoading",value:function(t){C.ILaya.stage.addChild(a._loadPage),a._loadPage.onOpened(t)}},{key:"_hideLoading",value:function(){a._loadPage.close()}},{key:"hideLoadingPage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500;a._loadPage&&(C.ILaya.systemTimer.clear(null,a._showLoading),C.ILaya.systemTimer.clear(null,a._hideLoading),C.ILaya.systemTimer.once(t,null,a._hideLoading))}}],n&&R(e.prototype,n),i&&R(e,i),a}(m.Sprite);e.Scene=U,U.unDestroyedScenes=[],C.ILaya.regClass(U),E.ClassUtils.regClass("laya.display.Scene",U),E.ClassUtils.regClass("Laya.Scene",U)},78362:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.Sprite=void 0;var f=U(n(3649)),_=U(n(31238)),d=U(n(85507)),p=U(n(21611)),y=n(92493),v=n(13407),g=n(89662),m=n(20084),b=n(81114),T=n(9686),x=n(18008),w=n(85399),k=n(98693),C=n(8272),E=n(79741),S=n(26776),M=n(54598),L=n(23835),R=n(56083),I=n(22805),A=n(6872),D=n(54216),B=n(72276),P=n(54190),O=n(43745),F=n(84935);function U(t){return t&&t.__esModule?t:{default:t}}function N(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function G(){return G="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=H(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},G.apply(this,arguments)}function H(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=X(t)););return t}function W(t,e){return W=a||function(t,e){return t.__proto__=e,t},W(t,e)}function V(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=X(t);if(e){var a=X(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return Y(this,n)}}function Y(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function X(t){return X=d.default?p.default:function(t){return t.__proto__||(0,p.default)(t)},X(t)}var z=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&W(t,e)}(a,t);var e,n,i,r=V(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this))._x=0,t._y=0,t._width=0,t._height=0,t._visible=!0,t._mouseState=0,t._zOrder=0,t._renderType=0,t._transform=null,t._tfChanged=!1,t._repaint=O.SpriteConst.REPAINT_NONE,t._texture=null,t._style=D.SpriteStyle.EMPTY,t._cacheStyle=A.CacheStyle.EMPTY,t._boundStyle=null,t._graphics=null,t.mouseThrough=!1,t.autoSize=!1,t.hitTestPrior=!1,t}return e=a,n=[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];G(X(a.prototype),"destroy",this).call(this,t),this._style&&this._style.recover(),this._cacheStyle&&this._cacheStyle.recover(),this._boundStyle&&this._boundStyle.recover(),this._transform&&this._transform.recover(),this._style=null,this._cacheStyle=null,this._boundStyle=null,this._transform=null,this._graphics&&this._graphics.autoDestroy&&this._graphics.destroy(),this._graphics=null,this.texture=null}},{key:"updateZOrder",value:function(){R.Utils.updateOrder(this._children)&&this.repaint()}},{key:"_getBoundsStyle",value:function(){return this._boundStyle||(this._boundStyle=I.BoundsStyle.create()),this._boundStyle}},{key:"_setCustomRender",value:function(){}},{key:"customRenderEnable",set:function(t){t&&(this._renderType|=O.SpriteConst.CUSTOM,this._setRenderType(this._renderType),this._setCustomRender())}},{key:"cacheAs",get:function(){return this._cacheStyle.cacheAs},set:function(t){t!==this._cacheStyle.userSetCache&&(this.mask&&"normal"===t||(this._setCacheAs(t),this._getCacheStyle().userSetCache=t,this._checkCanvasEnable(),this.repaint()))}},{key:"_setCacheAs",value:function(t){}},{key:"_checkCanvasEnable",value:function(){var t=this._cacheStyle.needEnableCanvasRender();this._getCacheStyle().enableCanvasRender=t,t?(this._cacheStyle.needBitmapCache()?this._cacheStyle.cacheAs="bitmap":this._cacheStyle.cacheAs=this._cacheStyle.userSetCache,this._cacheStyle.reCache=!0,this._renderType|=O.SpriteConst.CANVAS):(this._cacheStyle.cacheAs="none",this._cacheStyle.releaseContext(),this._renderType&=~O.SpriteConst.CANVAS),this._setCacheAs(this._cacheStyle.cacheAs),this._setRenderType(this._renderType)}},{key:"staticCache",get:function(){return this._cacheStyle.staticCache},set:function(t){this._getCacheStyle().staticCache=t,t||this.reCache()}},{key:"reCache",value:function(){this._cacheStyle.reCache=!0,this._repaint|=O.SpriteConst.REPAINT_CACHE}},{key:"getRepaint",value:function(){return this._repaint}},{key:"_setX",value:function(t){this._x=t}},{key:"_setY",value:function(t){this._y=t}},{key:"_setWidth",value:function(t,e){}},{key:"_setHeight",value:function(t,e){}},{key:"x",get:function(){return this._x},set:function(t){if(!this.destroyed&&this._x!==t){this._setX(t),this.parentRepaint(O.SpriteConst.REPAINT_CACHE);var e=this._cacheStyle.maskParent;e&&e.repaint(O.SpriteConst.REPAINT_CACHE)}}},{key:"y",get:function(){return this._y},set:function(t){if(!this.destroyed&&this._y!==t){this._setY(t),this.parentRepaint(O.SpriteConst.REPAINT_CACHE);var e=this._cacheStyle.maskParent;e&&e.repaint(O.SpriteConst.REPAINT_CACHE)}}},{key:"width",get:function(){return this.get_width()},set:function(t){this.set_width(t)}},{key:"set_width",value:function(t){this._width!==t&&(this._width=t,this._setWidth(this.texture,t),this._setTranformChange())}},{key:"get_width",value:function(){return this.autoSize?this.texture?this.texture.width:this._graphics||0!==this._children.length?this.getSelfBounds().width:0:this._width||(this.texture?this.texture.width:0)}},{key:"height",get:function(){return this.get_height()},set:function(t){this.set_height(t)}},{key:"set_height",value:function(t){this._height!==t&&(this._height=t,this._setHeight(this.texture,t),this._setTranformChange())}},{key:"get_height",value:function(){return this.autoSize?this.texture?this.texture.height:this._graphics||0!==this._children.length?this.getSelfBounds().height:0:this._height||(this.texture?this.texture.height:0)}},{key:"displayWidth",get:function(){return this.width*this.scaleX}},{key:"displayHeight",get:function(){return this.height*this.scaleY}},{key:"setSelfBounds",value:function(t){this._getBoundsStyle().userBounds=t}},{key:"getBounds",value:function(){return this._getBoundsStyle().bounds=k.Rectangle._getWrapRec(this._boundPointsToParent())}},{key:"getSelfBounds",value:function(){return this._boundStyle&&this._boundStyle.userBounds?this._boundStyle.userBounds:this._graphics||0!==this._children.length||this._texture?this._getBoundsStyle().bounds=k.Rectangle._getWrapRec(this._getBoundPointsM(!1)):k.Rectangle.TEMP.setTo(0,0,this.width,this.height)}},{key:"_boundPointsToParent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0,n=0;this._style&&(e=this.pivotX,n=this.pivotY,t=t||0!==this._style.rotation,this._style.scrollRect&&(e+=this._style.scrollRect.x,n+=this._style.scrollRect.y));var i=this._getBoundPointsM(t);if(!i||i.length<1)return i;if(8!=i.length&&(i=t?T.GrahamScan.scanPList(i):k.Rectangle._getWrapRec(i,k.Rectangle.TEMP)._getBoundPoints()),!this.transform)return R.Utils.transPointList(i,this._x-e,this._y-n),i;var r,a=w.Point.TEMP,o=i.length;for(r=0;r<o;r+=2)a.x=i[r],a.y=i[r+1],this.toParentPoint(a),i[r]=a.x,i[r+1]=a.y;return i}},{key:"getGraphicBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._graphics?this._graphics.getBounds(t):k.Rectangle.TEMP.setTo(0,0,0,0)}},{key:"_getBoundPointsM",value:function(){var t,e,n,i,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._boundStyle&&this._boundStyle.userBounds)return this._boundStyle.userBounds._getBoundPoints();if(this._boundStyle||this._getBoundsStyle(),this._boundStyle.temBM||(this._boundStyle.temBM=[]),this._style.scrollRect){var o=R.Utils.clearArray(this._boundStyle.temBM),s=k.Rectangle.TEMP;return s.copyFrom(this._style.scrollRect),R.Utils.concatArray(o,s._getBoundPoints()),o}t=this._graphics?this._graphics.getBoundPoints():R.Utils.clearArray(this._boundStyle.temBM),this._texture&&((s=k.Rectangle.TEMP).setTo(0,0,this.width||this._texture.width,this.height||this._texture.height),R.Utils.concatArray(t,s._getBoundPoints()));for(var u=0,l=(i=this._children).length;u<l;u++)(e=i[u])instanceof a&&!0===e._visible&&(n=e._boundPointsToParent(r))&&(t=t?R.Utils.concatArray(t,n):n);return t}},{key:"_getCacheStyle",value:function(){return this._cacheStyle===A.CacheStyle.EMPTY&&(this._cacheStyle=A.CacheStyle.create()),this._cacheStyle}},{key:"getStyle",value:function(){return this._style===D.SpriteStyle.EMPTY&&(this._style=D.SpriteStyle.create()),this._style}},{key:"setStyle",value:function(t){this._style=t}},{key:"scaleX",get:function(){return this._style.scaleX},set:function(t){this.set_scaleX(t)}},{key:"_setScaleX",value:function(t){this._style.scaleX=t}},{key:"scaleY",get:function(){return this._style.scaleY},set:function(t){this.set_scaleY(t)}},{key:"_setScaleY",value:function(t){this._style.scaleY=t}},{key:"set_scaleX",value:function(t){this.getStyle().scaleX!==t&&(this._setScaleX(t),this._setTranformChange())}},{key:"get_scaleX",value:function(){return this._style.scaleX}},{key:"set_scaleY",value:function(t){this.getStyle().scaleY!==t&&(this._setScaleY(t),this._setTranformChange())}},{key:"get_scaleY",value:function(){return this._style.scaleY}},{key:"rotation",get:function(){return this._style.rotation},set:function(t){this.getStyle().rotation!==t&&(this._setRotation(t),this._setTranformChange())}},{key:"_setRotation",value:function(t){this._style.rotation=t}},{key:"skewX",get:function(){return this._style.skewX},set:function(t){this.getStyle().skewX!==t&&(this._setSkewX(t),this._setTranformChange())}},{key:"_setSkewX",value:function(t){this._style.skewX=t}},{key:"skewY",get:function(){return this._style.skewY},set:function(t){this.getStyle().skewY!==t&&(this._setSkewY(t),this._setTranformChange())}},{key:"_setSkewY",value:function(t){this._style.skewY=t}},{key:"_createTransform",value:function(){return x.Matrix.create()}},{key:"_adjustTransform",value:function(){this._tfChanged=!1;var t=this._style,e=t.scaleX,n=t.scaleY,i=t.skewX,r=t.skewY,a=t.rotation,o=this._transform||(this._transform=this._createTransform());if(a||1!==e||1!==n||0!==i||0!==r){o._bTransform=!0;var s=.0174532922222222*(a-i),u=.0174532922222222*(a+r),l=Math.cos(u),h=Math.sin(u),c=Math.sin(s),f=Math.cos(s);o.a=e*l,o.b=e*h,o.c=-n*c,o.d=n*f,o.tx=o.ty=0}else o.identity(),this._renderType&=~O.SpriteConst.TRANSFORM,this._setRenderType(this._renderType);return o}},{key:"_setTransform",value:function(t){}},{key:"transform",get:function(){return this._tfChanged?this._adjustTransform():this._transform},set:function(t){this.set_transform(t)}},{key:"get_transform",value:function(){return this._tfChanged?this._adjustTransform():this._transform}},{key:"set_transform",value:function(t){this._tfChanged=!1;var e=this._transform||(this._transform=this._createTransform());t.copyTo(e),this._setTransform(e),t&&(this._x=e.tx,this._y=e.ty,e.tx=e.ty=0),t?this._renderType|=O.SpriteConst.TRANSFORM:this._renderType&=~O.SpriteConst.TRANSFORM,this._setRenderType(this._renderType),this.parentRepaint()}},{key:"_setPivotX",value:function(t){this.getStyle().pivotX=t}},{key:"_getPivotX",value:function(){return this._style.pivotX}},{key:"_setPivotY",value:function(t){this.getStyle().pivotY=t}},{key:"_getPivotY",value:function(){return this._style.pivotY}},{key:"pivotX",get:function(){return this._getPivotX()},set:function(t){this._setPivotX(t),this.repaint()}},{key:"pivotY",get:function(){return this._getPivotY()},set:function(t){this._setPivotY(t),this.repaint()}},{key:"_setAlpha",value:function(t){this._style.alpha!==t&&(this.getStyle().alpha=t,1!==t?this._renderType|=O.SpriteConst.ALPHA:this._renderType&=~O.SpriteConst.ALPHA,this._setRenderType(this._renderType),this.parentRepaint())}},{key:"_getAlpha",value:function(){return this._style.alpha}},{key:"alpha",get:function(){return this._getAlpha()},set:function(t){t=t<0?0:t>1?1:t,this._setAlpha(t)}},{key:"visible",get:function(){return this.get_visible()},set:function(t){this.set_visible(t)}},{key:"get_visible",value:function(){return this._visible}},{key:"set_visible",value:function(t){this._visible!==t&&(this._visible=t,this.parentRepaint(O.SpriteConst.REPAINT_ALL))}},{key:"_setBlendMode",value:function(t){}},{key:"blendMode",get:function(){return this._style.blendMode},set:function(t){this._setBlendMode(t),this.getStyle().blendMode=t,t&&"source-over"!=t?this._renderType|=O.SpriteConst.BLEND:this._renderType&=~O.SpriteConst.BLEND,this._setRenderType(this._renderType),this.parentRepaint()}},{key:"graphics",get:function(){return this._graphics||(this.graphics=new B.Graphics,this._graphics.autoDestroy=!0),this._graphics},set:function(t){this._graphics&&(this._graphics._sp=null),this._graphics=t,t?(this._setGraphics(t),this._renderType|=O.SpriteConst.GRAPHICS,t._sp=this):this._renderType&=~O.SpriteConst.GRAPHICS,this._setRenderType(this._renderType),this.repaint()}},{key:"_setGraphics",value:function(t){}},{key:"_setGraphicsCallBack",value:function(){}},{key:"scrollRect",get:function(){return this._style.scrollRect},set:function(t){this.getStyle().scrollRect=t,this._setScrollRect(t),this.repaint(),t?this._renderType|=O.SpriteConst.CLIP:this._renderType&=~O.SpriteConst.CLIP,this._setRenderType(this._renderType)}},{key:"_setScrollRect",value:function(t){}},{key:"pos",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this._x!==t||this._y!==e){if(this.destroyed)return this;if(n){this._setX(t),this._setY(e),this.parentRepaint(O.SpriteConst.REPAINT_CACHE);var i=this._cacheStyle.maskParent;i&&i.repaint(O.SpriteConst.REPAINT_CACHE)}else this.x=t,this.y=e}return this}},{key:"pivot",value:function(t,e){return this.pivotX=t,this.pivotY=e,this}},{key:"size",value:function(t,e){return this.width=t,this.height=e,this}},{key:"scale",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.getStyle();if(i.scaleX!=t||i.scaleY!=e){if(this.destroyed)return this;n?(this._setScaleX(t),this._setScaleY(e),this._setTranformChange()):(this.scaleX=t,this.scaleY=e)}return this}},{key:"skew",value:function(t,e){return this.skewX=t,this.skewY=e,this}},{key:"render",value:function(t,e,n){C.RenderSprite.renders[this._renderType]._fun(this,t,e+this._x,n+this._y),this._repaint=0}},{key:"drawToCanvas",value:function(t,e,n,i){return a.drawToCanvas(this,this._renderType,t,e,n,i)}},{key:"drawToTexture",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return a.drawToTexture(this,this._renderType,t,e,n,i,r)}},{key:"drawToTexture3D",value:function(t,e,n){throw"not implement"}},{key:"customRender",value:function(t,e,n){this._repaint=O.SpriteConst.REPAINT_ALL}},{key:"_applyFilters",value:function(){}},{key:"filters",get:function(){return this._cacheStyle.filters},set:function(t){t&&0===t.length&&(t=null),this._cacheStyle.filters!=t&&(this._getCacheStyle().filters=t?(0,f.default)(t).call(t):null,t&&t.length?(this._setColorFilter(t[0]),this._renderType|=O.SpriteConst.FILTERS):(this._setColorFilter(null),this._renderType&=~O.SpriteConst.FILTERS),this._setRenderType(this._renderType),t&&t.length>0?(this._getBit(v.Const.DISPLAY)||this._setBitUp(v.Const.DISPLAY),1==t.length&&t[0]instanceof m.ColorFilter||(this._getCacheStyle().cacheForFilters=!0,this._checkCanvasEnable())):this._cacheStyle.cacheForFilters&&(this._cacheStyle.cacheForFilters=!1,this._checkCanvasEnable()),this._getCacheStyle().hasGlowFilter=this._isHaveGlowFilter(),this.repaint())}},{key:"_setColorFilter",value:function(t){}},{key:"_isHaveGlowFilter",value:function(){var t,e;if(this.filters)for(t=0;t<this.filters.length;t++)if(this.filters[t].type==b.Filter.GLOW)return!0;for(t=0,e=this._children.length;t<e;t++)if(this._children[t]._isHaveGlowFilter())return!0;return!1}},{key:"localToGlobal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!0===e&&(t=new w.Point(t.x,t.y));var i=this;for(n=n||y.ILaya.stage;i&&!i.destroyed&&i!=n;)t=i.toParentPoint(t),i=i.parent;return t}},{key:"globalToLocal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e&&(t=new w.Point(t.x,t.y));var i=this,r=[];for(n=n||y.ILaya.stage;i&&!i.destroyed&&i!=n;)r.push(i),i=i.parent;for(var a=r.length-1;a>=0;)t=(i=r[a]).fromParentPoint(t),a--;return t}},{key:"toParentPoint",value:function(t){if(!t)return t;t.x-=this.pivotX,t.y-=this.pivotY,this.transform&&this._transform.transformPoint(t),t.x+=this._x,t.y+=this._y;var e=this._style.scrollRect;return e&&(t.x-=e.x,t.y-=e.y),t}},{key:"fromParentPoint",value:function(t){if(!t)return t;t.x-=this._x,t.y-=this._y;var e=this._style.scrollRect;return e&&(t.x+=e.x,t.y+=e.y),this.transform&&this._transform.invertTransformPoint(t),t.x+=this.pivotX,t.y+=this.pivotY,t}},{key:"fromStagePoint",value:function(t){return t}},{key:"on",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return 1!==this._mouseState&&this.isMouseEvent(t)?(this.mouseEnabled=!0,this._setBit(v.Const.HAS_MOUSE,!0),this._parent&&this._onDisplay(),this._createListener(t,e,n,i,!1)):G(X(a.prototype),"on",this).call(this,t,e,n,i)}},{key:"once",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return 1!==this._mouseState&&this.isMouseEvent(t)?(this.mouseEnabled=!0,this._setBit(v.Const.HAS_MOUSE,!0),this._parent&&this._onDisplay(),this._createListener(t,e,n,i,!0)):G(X(a.prototype),"once",this).call(this,t,e,n,i)}},{key:"_onDisplay",value:function(t){if(1!==this._mouseState){var e=this;for(e=e.parent;e&&1!==e._mouseState&&!e._getBit(v.Const.HAS_MOUSE);)e.mouseEnabled=!0,e._setBit(v.Const.HAS_MOUSE,!0),e=e.parent}}},{key:"_setParent",value:function(t){G(X(a.prototype),"_setParent",this).call(this,t),t&&this._getBit(v.Const.HAS_MOUSE)&&this._onDisplay()}},{key:"loadImage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t){var n=y.ILaya.Loader.textureMap[F.URL.formatURL(t)];n||((n=new M.Texture).load(t),y.ILaya.Loader.cacheTexture(t,n)),this.texture=n,n.getIsReady()?i.call(this):n.once(g.Event.READY,this,i)}else this.texture=null,i.call(this);function i(){this.repaint(O.SpriteConst.REPAINT_ALL),e&&e.run()}return this}},{key:"repaint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O.SpriteConst.REPAINT_CACHE;this._repaint&t||(this._repaint|=t,this.parentRepaint(t)),this._cacheStyle&&this._cacheStyle.maskParent&&this._cacheStyle.maskParent.repaint(t)}},{key:"_needRepaint",value:function(){return this._repaint&O.SpriteConst.REPAINT_CACHE&&this._cacheStyle.enableCanvasRender&&this._cacheStyle.reCache}},{key:"_childChanged",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this._children.length?this._renderType|=O.SpriteConst.CHILDS:this._renderType&=~O.SpriteConst.CHILDS,this._setRenderType(this._renderType),t&&this._getBit(v.Const.HAS_ZORDER)&&y.ILaya.systemTimer.callLater(this,this.updateZOrder),this.repaint(O.SpriteConst.REPAINT_ALL)}},{key:"parentRepaint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O.SpriteConst.REPAINT_CACHE,e=this._parent;!e||e._repaint&t||(e._repaint|=t,e.parentRepaint(t))}},{key:"stage",get:function(){return y.ILaya.stage}},{key:"hitArea",get:function(){return this._style.hitArea},set:function(t){this.getStyle().hitArea=t}},{key:"_setMask",value:function(t){}},{key:"mask",get:function(){return this._cacheStyle.mask},set:function(t){t&&this.mask&&this.mask._cacheStyle.maskParent||(this._getCacheStyle().mask=t,this._setMask(t),this._checkCanvasEnable(),t?t._getCacheStyle().maskParent=this:this.mask&&(this.mask._getCacheStyle().maskParent=null),this._renderType|=O.SpriteConst.MASK,this._setRenderType(this._renderType),this.parentRepaint(O.SpriteConst.REPAINT_ALL))}},{key:"mouseEnabled",get:function(){return this._mouseState>1},set:function(t){this._mouseState=t?2:1}},{key:"startDrag",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:300,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.92;this._style.dragging||(this.getStyle().dragging=new y.ILaya.Dragging),this._style.dragging.start(this,t,e,n,i,r,a,o)}},{key:"stopDrag",value:function(){this._style.dragging&&this._style.dragging.stop()}},{key:"_setDisplay",value:function(t){t||this._cacheStyle&&(this._cacheStyle.releaseContext(),this._cacheStyle.releaseFilterCache(),this._cacheStyle.hasGlowFilter&&(this._cacheStyle.hasGlowFilter=!1)),G(X(a.prototype),"_setDisplay",this).call(this,t)}},{key:"hitTestPoint",value:function(t,e){var n=this.globalToLocal(w.Point.TEMP.setTo(t,e));return t=n.x,e=n.y,(this._style.hitArea?this._style.hitArea:this._width>0&&this._height>0?k.Rectangle.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(t,e)}},{key:"getMousePoint",value:function(){return this.globalToLocal(w.Point.TEMP.setTo(y.ILaya.stage.mouseX,y.ILaya.stage.mouseY))}},{key:"globalScaleX",get:function(){for(var t=1,e=this;e&&e!==y.ILaya.stage;)t*=e.scaleX,e=e.parent;return t}},{key:"globalRotation",get:function(){for(var t=0,e=this;e&&e!==y.ILaya.stage;)t+=e.rotation,e=e.parent;return t}},{key:"globalScaleY",get:function(){for(var t=1,e=this;e&&e!==y.ILaya.stage;)t*=e.scaleY,e=e.parent;return t}},{key:"mouseX",get:function(){return this.getMousePoint().x}},{key:"mouseY",get:function(){return this.getMousePoint().y}},{key:"zOrder",get:function(){return this._zOrder},set:function(t){this._zOrder!=t&&(this._zOrder=t,this._parent&&(t&&this._parent._setBit(v.Const.HAS_ZORDER,!0),y.ILaya.systemTimer.callLater(this._parent,this.updateZOrder)))}},{key:"texture",get:function(){return this._texture},set:function(t){"string"==typeof t?this.loadImage(t):this._texture!=t&&(this._texture&&this._texture._removeReference(),this._texture=t,t&&t._addReference(),this._setTexture(t),this._setWidth(this._texture,this.width),this._setHeight(this._texture,this.height),t?this._renderType|=O.SpriteConst.TEXTURE:this._renderType&=~O.SpriteConst.TEXTURE,this._setRenderType(this._renderType),this.repaint())}},{key:"_setTexture",value:function(t){}},{key:"viewport",get:function(){return this._style.viewport},set:function(t){var e;"string"==typeof t&&(e=t.split(",")).length>3&&(t=new k.Rectangle((0,_.default)(e[0]),(0,_.default)(e[1]),(0,_.default)(e[2]),(0,_.default)(e[3]))),this.getStyle().viewport=t}},{key:"_setRenderType",value:function(t){}},{key:"_setTranformChange",value:function(){this._tfChanged=!0,this._renderType|=O.SpriteConst.TRANSFORM,this.parentRepaint(O.SpriteConst.REPAINT_CACHE)}},{key:"_setBgStyleColor",value:function(t,e,n,i,r){}},{key:"_setBorderStyleColor",value:function(t,e,n,i,r,a){}},{key:"captureMouseEvent",value:function(t){y.ILaya.MouseManager.instance.setCapture(this,t)}},{key:"releaseMouseEvent",value:function(){y.ILaya.MouseManager.instance.releaseCapture()}},{key:"drawCallOptimize",get:function(){return this._getBit(v.Const.DRAWCALL_OPTIMIZE)},set:function(t){this._setBit(v.Const.DRAWCALL_OPTIMIZE,t)}}],i=[{key:"drawToCanvas",value:function(t,e,n,i,r,a){r-=t.x,a-=t.y,r|=0,a|=0,n|=0,i|=0;var o=new E.Context;o.size(n,i),o.asBitmap=!0,o._targets.start(),o._targets.clear(0,0,0,0),C.RenderSprite.renders[e]._fun(t,o,r,a),o.flush(),o._targets.end(),o._targets.restore();var s=o._targets.getData(0,0,n,i);o.destroy();for(var u=new ImageData(n,i),l=4*n,h=(new Uint8Array(l),u.data),c=i-1,f=c*l,_=0;c>=0;c--)h.set(s.subarray(_,_+l),f),f-=l,_+=l;var d=new S.HTMLCanvas(!0);return d.size(n,i),d.getContext("2d").putImageData(u,0,0),d}},{key:"drawToTexture",value:function(t,e,n,i,r,o){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;a.drawtocanvCtx||(a.drawtocanvCtx=new E.Context),r-=t.x,o-=t.y,r|=0,o|=0,n|=0,i|=0;var u=s?a.drawtocanvCtx:new E.Context;if(u.clear(),u.size(n,i),s?u._targets=s:u.asBitmap=!0,u._targets&&(u._targets.start(),u._targets.clear(0,0,0,0),C.RenderSprite.renders[e]._fun(t,u,r,o),u.flush(),u._targets.end(),u._targets.restore()),!s){var l=new M.Texture(u._targets,M.Texture.INV_UV);return u.destroy(!0),l}return t._repaint=0,s}},{key:"fromImage",value:function(t){return(new a).loadImage(t)}}],n&&N(e.prototype,n),i&&N(e,i),a}(P.Node);e.Sprite=z,L.ClassUtils.regClass("laya.display.Sprite",z),L.ClassUtils.regClass("Laya.Sprite",z)},43745:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.SpriteConst=void 0;var i=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)};e.SpriteConst=i,i.ALPHA=1,i.TRANSFORM=2,i.BLEND=4,i.CANVAS=8,i.FILTERS=16,i.MASK=32,i.CLIP=64,i.STYLE=128,i.TEXTURE=256,i.GRAPHICS=512,i.LAYAGL3D=1024,i.CUSTOM=2048,i.ONECHILD=4096,i.CHILDS=8192,i.REPAINT_NONE=0,i.REPAINT_NODE=1,i.REPAINT_CACHE=2,i.REPAINT_ALL=3},77590:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(62734),a=n(34074),o=n(1068),s=n(85507),u=n(54943),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.Stage=void 0;var f=G(n(94198)),_=G(n(81643)),d=G(n(92762)),p=G(n(85507)),y=G(n(21611)),v=n(78362),g=n(80340),m=n(61891),b=n(43745),T=n(13407),x=n(89662),w=n(47002),k=n(18008),C=n(85399),E=n(85136),S=n(12596),M=n(79741),L=n(93568),R=n(38022),I=n(13104),A=n(14400),D=n(25670),B=n(56161),P=n(683),O=n(92493),F=n(33873),U=n(23835),N=n(23877);function G(t){return t&&t.__esModule?t:{default:t}}function H(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function W(t,e){return W=s||function(t,e){return t.__proto__=e,t},W(t,e)}function V(t){var e=function(){if("undefined"==typeof Reflect||!o)return!1;if(o.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(o(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=K(t);if(e){var r=K(this).constructor;n=o(i,arguments,r)}else n=i.apply(this,arguments);return Y(this,n)}}function Y(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return X(t)}function X(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function z(){return z="undefined"!=typeof Reflect&&r?r:function(t,e,n){var i=j(t,e);if(i){var r=a(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},z.apply(this,arguments)}function j(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=K(t)););return t}function K(t){return K=p.default?y.default:function(t){return t.__proto__||(0,y.default)(t)},K(t)}var q=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=u(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&W(t,e)}(a,t);var e,n,i,r=V(a);function a(){var t,e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=r.call(this)).offset=new C.Point,e._frameRate="fast",e.designWidth=0,e.designHeight=0,e.canvasRotation=!1,e.canvasDegree=0,e.renderingEnabled=!0,e.screenAdaptationEnabled=!0,e._canvasTransform=new k.Matrix,e._screenMode="none",e._scaleMode="noscale",e._alignV="top",e._alignH="left",e._bgColor="black",e._mouseMoveTime=0,e._renderCount=0,e._safariOffsetY=0,e._frameStartTime=0,e._previousOrientation=L.Browser.window.orientation,e._wgColor=[0,0,0,1],e._scene3Ds=[],e._globalRepaintSet=!1,e._globalRepaintGet=!1,e._3dUI=[],e._curUIBase=null,e.useRetinalCanvas=!1,z((t=X(e),K(a.prototype)),"set_transform",t).call(t,e._createTransform()),e.mouseEnabled=!0,e.hitTestPrior=!0,e.autoSize=!1,e._setBit(T.Const.DISPLAYED_INSTAGE,!0),e._setBit(T.Const.ACTIVE_INHIERARCHY,!0),e._isFocused=!0,e._isVisibility=!0,e.useRetinalCanvas=g.Config.useRetinalCanvas;var n=L.Browser.window;n.addEventListener("focus",(function(){e._isFocused=!0,e.event(x.Event.FOCUS),e.event(x.Event.FOCUS_CHANGE)})),n.addEventListener("blur",(function(){e._isFocused=!1,e.event(x.Event.BLUR),e.event(x.Event.FOCUS_CHANGE),e._isInputting()&&(m.Input.inputElement.target.focus=!1)}));var i="visibilityState",o="visibilitychange",s=n.document;return void 0!==s.hidden?(o="visibilitychange",i="visibilityState"):void 0!==s.mozHidden?(o="mozvisibilitychange",i="mozVisibilityState"):void 0!==s.msHidden?(o="msvisibilitychange",i="msVisibilityState"):void 0!==s.webkitHidden&&(o="webkitvisibilitychange",i="webkitVisibilityState"),n.document.addEventListener(o,(function(){"hidden"==L.Browser.document[i]?(e._isVisibility=!1,e._isInputting()&&(m.Input.inputElement.target.focus=!1)):e._isVisibility=!0,e.renderingEnabled=e._isVisibility,e.event(x.Event.VISIBILITY_CHANGE)})),n.addEventListener("resize",(function(){var t=L.Browser.window.orientation;null!=t&&t!=e._previousOrientation&&e._isInputting()&&(m.Input.inputElement.target.focus=!1),e._previousOrientation=t,e._isInputting()||(L.Browser.onSafari&&(e._safariOffsetY=(L.Browser.window.__innerHeight||L.Browser.document.body.clientHeight||L.Browser.document.documentElement.clientHeight)-L.Browser.window.innerHeight),e._resetCanvas())})),n.addEventListener("orientationchange",(function(t){e._resetCanvas()})),e.on(x.Event.MOUSE_MOVE,X(e),e._onmouseMove),L.Browser.onMobile&&e.on(x.Event.MOUSE_DOWN,X(e),e._onmouseMove),e}return e=a,n=[{key:"_isInputting",value:function(){return L.Browser.onMobile&&m.Input.isInputting}},{key:"width",get:function(){return z(K(a.prototype),"get_width",this).call(this)},set:function(t){this.designWidth=t,z(K(a.prototype),"set_width",this).call(this,t),O.ILaya.systemTimer.callLater(this,this._changeCanvasSize)}},{key:"height",get:function(){return z(K(a.prototype),"get_height",this).call(this)},set:function(t){this.designHeight=t,z(K(a.prototype),"set_height",this).call(this,t),O.ILaya.systemTimer.callLater(this,this._changeCanvasSize)}},{key:"transform",get:function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||this._createTransform()},set:function(t){z(K(a.prototype),"set_transform",this).call(this,t)}},{key:"isFocused",get:function(){return this._isFocused}},{key:"isVisibility",get:function(){return this._isVisibility}},{key:"_changeCanvasSize",value:function(){this.setScreenSize(L.Browser.clientWidth*L.Browser.pixelRatio,L.Browser.clientHeight*L.Browser.pixelRatio)}},{key:"_resetCanvas",value:function(){this.screenAdaptationEnabled&&this._changeCanvasSize()}},{key:"setScreenSize",value:function(t,e){var n=!1;if(this._screenMode!==a.SCREEN_NONE&&(n=(t/e<1?a.SCREEN_VERTICAL:a.SCREEN_HORIZONTAL)!==this._screenMode)){var i=e;e=t,t=i}this.canvasRotation=n;var r=E.Render._mainCanvas,o=r.source.style,s=this._canvasTransform.identity(),u=this._scaleMode,l=t/this.designWidth,h=e/this.designHeight,c=this.useRetinalCanvas?t:this.designWidth,_=this.useRetinalCanvas?e:this.designHeight,d=t,p=e,y=L.Browser.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,u){case a.SCALE_NOSCALE:l=h=1,d=this.designWidth,p=this.designHeight;break;case a.SCALE_SHOWALL:l=h=Math.min(l,h),c=d=Math.round(this.designWidth*l),_=p=Math.round(this.designHeight*h);break;case a.SCALE_NOBORDER:l=h=Math.max(l,h),d=Math.round(this.designWidth*l),p=Math.round(this.designHeight*h);break;case a.SCALE_FULL:l=h=1,this._width=c=t,this._height=_=e;break;case a.SCALE_FIXED_WIDTH:h=l,this._height=_=Math.round(e/l);break;case a.SCALE_FIXED_HEIGHT:l=h,this._width=c=Math.round(t/h);break;case a.SCALE_FIXED_AUTO:t/e<this.designWidth/this.designHeight?(h=l,this._height=_=Math.round(e/l)):(l=h,this._width=c=Math.round(t/h))}this.useRetinalCanvas&&(d=c=t,p=_=e),l*=this.scaleX,h*=this.scaleY,1===l&&1===h?this.transform.identity():(this.transform.a=this._formatData(l/(d/c)),this.transform.d=this._formatData(h/(p/_))),r.size(c,_),A.RunDriver.changeWebGLSize(c,_),s.scale(d/c/y,p/_/y),this._alignH===a.ALIGN_LEFT?this.offset.x=0:this._alignH===a.ALIGN_RIGHT?this.offset.x=t-d:this.offset.x=.5*(t-d)/y,this._alignV===a.ALIGN_TOP?this.offset.y=0:this._alignV===a.ALIGN_BOTTOM?this.offset.y=e-p:this.offset.y=.5*(e-p)/y,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),s.translate(this.offset.x,this.offset.y),this._safariOffsetY&&s.translate(0,this._safariOffsetY),this.canvasDegree=0,n&&(this._screenMode===a.SCREEN_HORIZONTAL?(s.rotate(Math.PI/2),s.translate(e/y,0),this.canvasDegree=90):(s.rotate(-Math.PI/2),s.translate(0,t/y),this.canvasDegree=-90)),s.a=this._formatData(s.a),s.d=this._formatData(s.d),s.tx=this._formatData(s.tx),s.ty=this._formatData(s.ty),z(K(a.prototype),"set_transform",this).call(this,this.transform),o.transformOrigin=o.webkitTransformOrigin=o.msTransformOrigin=o.mozTransformOrigin=o.oTransformOrigin="0px 0px 0px",o.transform=o.webkitTransform=o.msTransform=o.mozTransform=o.oTransform="matrix("+s.toString()+")",o.width=c,o.height=_,this._safariOffsetY&&s.translate(0,-this._safariOffsetY),s.translate((0,f.default)(o.left)||0,(0,f.default)(o.top)||0),this.visible=!0,this._repaint|=b.SpriteConst.REPAINT_CACHE,this.event(x.Event.RESIZE)}},{key:"_formatData",value:function(t){return Math.abs(t)<1e-6?0:Math.abs(1-t)<.001?t>0?1:-1:t}},{key:"scaleMode",get:function(){return this._scaleMode},set:function(t){this._scaleMode=t,O.ILaya.systemTimer.callLater(this,this._changeCanvasSize)}},{key:"alignH",get:function(){return this._alignH},set:function(t){this._alignH=t,O.ILaya.systemTimer.callLater(this,this._changeCanvasSize)}},{key:"alignV",get:function(){return this._alignV},set:function(t){this._alignV=t,O.ILaya.systemTimer.callLater(this,this._changeCanvasSize)}},{key:"bgColor",get:function(){return this._bgColor},set:function(t){this._bgColor=t,this._wgColor=t?I.ColorUtils.create(t).arrColor:null,E.Render.canvas.style.background=t||"none"}},{key:"mouseX",get:function(){return Math.round(w.MouseManager.instance.mouseX/this.clientScaleX)}},{key:"mouseY",get:function(){return Math.round(w.MouseManager.instance.mouseY/this.clientScaleY)}},{key:"getMousePoint",value:function(){return C.Point.TEMP.setTo(this.mouseX,this.mouseY)}},{key:"clientScaleX",get:function(){return this._transform?this._transform.getScaleX():1}},{key:"clientScaleY",get:function(){return this._transform?this._transform.getScaleY():1}},{key:"screenMode",get:function(){return this._screenMode},set:function(t){this._screenMode=t}},{key:"repaint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b.SpriteConst.REPAINT_CACHE;this._repaint|=t}},{key:"parentRepaint",value:function(){arguments.length>0&&void 0!==arguments[0]||b.SpriteConst.REPAINT_CACHE}},{key:"_loop",value:function(){return this._globalRepaintGet=this._globalRepaintSet,this._globalRepaintSet=!1,this.render(E.Render._context,0,0),!0}},{key:"getFrameTm",value:function(){return this._frameStartTime}},{key:"_onmouseMove",value:function(t){this._mouseMoveTime=L.Browser.now()}},{key:"getTimeFromFrameStart",value:function(){return L.Browser.now()-this._frameStartTime}},{key:"visible",get:function(){return z(K(a.prototype),"visible",this)},set:function(t){this.visible!==t&&(z(K(a.prototype),"set_visible",this).call(this,t),E.Render._mainCanvas.source.style.visibility=t?"visible":"hidden")}},{key:"render",value:function(t,e,n){if(window.conch)this.renderToNative(t,e,n);else{if(this._frameRate===a.FRAME_SLEEP){var i=L.Browser.now();if(!(i-this._frameStartTime>=1e3))return;this._frameStartTime=i}else{if(!this._visible)return this._renderCount++,void(this._renderCount%5==0&&(R.CallLater.I._update(),P.Stat.loopCount++,S.RenderInfo.loopCount=P.Stat.loopCount,this._updateTimers()));this._frameStartTime=L.Browser.now(),S.RenderInfo.loopStTm=this._frameStartTime}this._renderCount++;var r=(this._frameRate===a.FRAME_MOUSE?this._frameStartTime-this._mouseMoveTime<2e3?a.FRAME_FAST:a.FRAME_SLOW:this._frameRate)!==a.FRAME_SLOW,o=this._renderCount%2==0;if(P.Stat.renderSlow=!r,r||o){if(R.CallLater.I._update(),P.Stat.loopCount++,S.RenderInfo.loopCount=P.Stat.loopCount,N.PerformancePlugin.begainSample(N.PerformancePlugin.PERFORMANCE_LAYA),this.renderingEnabled){for(var s=0,u=this._scene3Ds.length;s<u;s++)this._scene3Ds[s]._update();t.clear(),z(K(a.prototype),"render",this).call(this,t,e,n),P.Stat._StatRender.renderNotCanvas(t,e,n)}this.renderingEnabled&&(a.clear(this._bgColor),t.flush(),D.VectorGraphManager.instance&&D.VectorGraphManager.getInstance().endDispose()),this._updateTimers(),N.PerformancePlugin.endSample(N.PerformancePlugin.PERFORMANCE_LAYA)}}}},{key:"renderToNative",value:function(t,e,n){if(this._renderCount++,this._visible){if(this._frameStartTime=L.Browser.now(),R.CallLater.I._update(),P.Stat.loopCount++,S.RenderInfo.loopCount=P.Stat.loopCount,this.renderingEnabled){for(var i=0,r=this._scene3Ds.length;i<r;i++)this._scene3Ds[i]._update();t.clear(),z(K(a.prototype),"render",this).call(this,t,e,n),P.Stat._StatRender.renderNotCanvas(t,e,n)}this.renderingEnabled&&(a.clear(this._bgColor),t.flush(),D.VectorGraphManager.instance&&D.VectorGraphManager.getInstance().endDispose()),this._updateTimers()}else this._renderCount%5==0&&(R.CallLater.I._update(),P.Stat.loopCount++,S.RenderInfo.loopCount=P.Stat.loopCount,this._updateTimers())}},{key:"_updateTimers",value:function(){O.ILaya.systemTimer._update(),O.ILaya.startTimer._update(),O.ILaya.physicsTimer._update(),O.ILaya.updateTimer._update(),O.ILaya.lateTimer._update(),O.ILaya.timer._update()}},{key:"fullScreenEnabled",set:function(t){var e=L.Browser.document,n=E.Render.canvas;t?(n.addEventListener("mousedown",this._requestFullscreen),n.addEventListener("touchstart",this._requestFullscreen),e.addEventListener("fullscreenchange",this._fullScreenChanged),e.addEventListener("mozfullscreenchange",this._fullScreenChanged),e.addEventListener("webkitfullscreenchange",this._fullScreenChanged),e.addEventListener("msfullscreenchange",this._fullScreenChanged)):(n.removeEventListener("mousedown",this._requestFullscreen),n.removeEventListener("touchstart",this._requestFullscreen),e.removeEventListener("fullscreenchange",this._fullScreenChanged),e.removeEventListener("mozfullscreenchange",this._fullScreenChanged),e.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),e.removeEventListener("msfullscreenchange",this._fullScreenChanged))}},{key:"frameRate",get:function(){return O.ILaya.Render.isConchApp?this._frameRateNative:this._frameRate},set:function(t){if(O.ILaya.Render.isConchApp){var e=window.conch;switch(t){case a.FRAME_FAST:e.config.setLimitFPS(60);break;case a.FRAME_MOUSE:e.config.setMouseFrame(2e3);break;case a.FRAME_SLOW:e.config.setSlowFrame(!0);break;case a.FRAME_SLEEP:e.config.setLimitFPS(1)}this._frameRateNative=t}else this._frameRate=t}},{key:"_requestFullscreen",value:function(){var t=L.Browser.document.documentElement;t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()}},{key:"_fullScreenChanged",value:function(){O.ILaya.stage.event(x.Event.FULL_SCREEN_CHANGE)}},{key:"exitFullscreen",value:function(){var t=L.Browser.document;t.exitFullscreen?t.exitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitExitFullscreen&&t.webkitExitFullscreen()}},{key:"isGlobalRepaint",value:function(){return this._globalRepaintGet}},{key:"setGlobalRepaint",value:function(){this._globalRepaintSet=!0}},{key:"add3DUI",value:function(t){var e,n=t.rootView;(0,_.default)(e=this._3dUI).call(e,n)>=0||this._3dUI.push(n)}},{key:"remove3DUI",value:function(t){var e,n,i=t.rootView,r=(0,_.default)(e=this._3dUI).call(e,i);return r>=0&&((0,d.default)(n=this._3dUI).call(n,r,1),!0)}}],n&&H(e.prototype,n),i&&H(e,i),a}(v.Sprite);e.Stage=q,q.SCALE_NOSCALE="noscale",q.SCALE_EXACTFIT="exactfit",q.SCALE_SHOWALL="showall",q.SCALE_NOBORDER="noborder",q.SCALE_FULL="full",q.SCALE_FIXED_WIDTH="fixedwidth",q.SCALE_FIXED_HEIGHT="fixedheight",q.SCALE_FIXED_AUTO="fixedauto",q.ALIGN_LEFT="left",q.ALIGN_RIGHT="right",q.ALIGN_CENTER="center",q.ALIGN_TOP="top",q.ALIGN_MIDDLE="middle",q.ALIGN_BOTTOM="bottom",q.SCREEN_NONE="none",q.SCREEN_HORIZONTAL="horizontal",q.SCREEN_VERTICAL="vertical",q.FRAME_FAST="fast",q.FRAME_SLOW="slow",q.FRAME_MOUSE="mouse",q.FRAME_SLEEP="sleep",q.clear=function(t){M.Context.set2DRenderConfig();var e=F.LayaGL.instance;B.RenderState2D.worldScissorTest&&e.disable(e.SCISSOR_TEST);var n=E.Render.context,i=0==n._submits._length||g.Config.preserveDrawingBuffer?I.ColorUtils.create(t).arrColor:O.ILaya.stage._wgColor;i?n.clearBG(i[0],i[1],i[2],i[3]):n.clearBG(0,0,0,0),B.RenderState2D.clear()},U.ClassUtils.regClass("laya.display.Stage",q),U.ClassUtils.regClass("Laya.Stage",q)},81870:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.Text=void 0;var f=C(n(78914)),_=C(n(31238)),d=C(n(85507)),p=C(n(21611)),y=n(78362),v=n(43745),g=n(33176),m=n(89662),b=n(85399),T=n(98693),x=n(80651),w=n(92493),k=n(23835);function C(t){return t&&t.__esModule?t:{default:t}}function E(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function S(){return S="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=M(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},S.apply(this,arguments)}function M(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=A(t)););return t}function L(t,e){return L=a||function(t,e){return t.__proto__=e,t},L(t,e)}function R(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=A(t);if(e){var a=A(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return I(this,n)}}function I(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function A(t){return A=d.default?p.default:function(t){return t.__proto__||(0,p.default)(t)},A(t)}var D=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&L(t,e)}(a,t);var e,n,i,r=R(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this))._textWidth=0,t._textHeight=0,t._lines=[],t._lineWidths=[],t._startX=0,t._startY=0,t._charSize={},t._valign="top",t._fontSize=a.defaultFontSize,t._font=a.defaultFont,t._color="#000000",t._singleCharRender=!1,t.overflow=a.VISIBLE,t._style=g.TextStyle.EMPTY,t}return e=a,n=[{key:"getStyle",value:function(){return this._style===g.TextStyle.EMPTY&&(this._style=g.TextStyle.create()),this._style}},{key:"_getTextStyle",value:function(){return this._style===g.TextStyle.EMPTY&&(this._style=g.TextStyle.create()),this._style}},{key:"destroy",value:function(){var t,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];S(A(a.prototype),"destroy",this).call(this,e),this._clipPoint=null,this._lines=null,this._lineWidths=null,this._words&&(0,f.default)(t=this._words).call(t,(function(t){t.cleanCache()})),this._words=null,this._charSize=null}},{key:"_getBoundPointsM",value:function(){var t=T.Rectangle.TEMP;return t.setTo(0,0,this.width,this.height),t._getBoundPoints()}},{key:"getGraphicBounds",value:function(){var t=T.Rectangle.TEMP;return t.setTo(0,0,this.width,this.height),t}},{key:"width",get:function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},set:function(t){t!=this._width&&(S(A(a.prototype),"set_width",this).call(this,t),this.isChanged=!0,this.borderColor&&this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1))}},{key:"_getCSSStyle",value:function(){return this._style}},{key:"height",get:function(){return this._height?this._height:this.textHeight},set:function(t){t!=this._height&&(S(A(a.prototype),"set_height",this).call(this,t),this.isChanged=!0,this.borderColor&&this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1))}},{key:"textWidth",get:function(){return this._isChanged&&w.ILaya.systemTimer.runCallLater(this,this.typeset),this._textWidth}},{key:"textHeight",get:function(){return this._isChanged&&w.ILaya.systemTimer.runCallLater(this,this.typeset),this._textHeight}},{key:"text",get:function(){return this._text||""},set:function(t){this.set_text(t)}},{key:"get_text",value:function(){return this._text||""}},{key:"set_text",value:function(t){this._text!==t&&(this.lang(t+""),this.isChanged=!0,this.event(m.Event.CHANGE),this.borderColor&&this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1))}},{key:"lang",value:function(t){if(t=a.langPacks&&a.langPacks[t]?a.langPacks[t]:t,arguments.length<2)this._text=t;else{for(var e=0,n=arguments.length;e<n;e++)t=t.replace("{"+e+"}",arguments[e+1]);this._text=t}}},{key:"font",get:function(){return this._font},set:function(t){this._style.currBitmapFont&&(this._getTextStyle().currBitmapFont=null,this.scale(1,1)),a._bitmapFonts&&a._bitmapFonts[t]&&(this._getTextStyle().currBitmapFont=a._bitmapFonts[t]),this._font=t,this.isChanged=!0}},{key:"fontSize",get:function(){return this._fontSize},set:function(t){this._fontSize!=t&&(this._fontSize=t,this.isChanged=!0)}},{key:"bold",get:function(){return this._style.bold},set:function(t){this._getTextStyle().bold=t,this.isChanged=!0}},{key:"color",get:function(){return this._color},set:function(t){this.set_color(t)}},{key:"get_color",value:function(){return this._color}},{key:"set_color",value:function(t){this._color!=t&&(this._color=t,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}},{key:"italic",get:function(){return this._style.italic},set:function(t){this._getTextStyle().italic=t,this.isChanged=!0}},{key:"align",get:function(){return this._style.align},set:function(t){this._getTextStyle().align=t,this.isChanged=!0}},{key:"valign",get:function(){return this._valign},set:function(t){this._valign=t,this.isChanged=!0}},{key:"wordWrap",get:function(){return this._style.wordWrap},set:function(t){this._getTextStyle().wordWrap=t,this.isChanged=!0}},{key:"leading",get:function(){return this._style.leading},set:function(t){this._getTextStyle().leading=t,this.isChanged=!0}},{key:"padding",get:function(){return this._style.padding},set:function(t){if("string"==typeof t){var e,n,i;for(i=(e=t.split(",")).length;e.length<4;)e.push(0);for(n=0;n<i;n++)e[n]=(0,_.default)(e[n])||0;t=e}this._getTextStyle().padding=t,this.isChanged=!0}},{key:"bgColor",get:function(){return this._style.bgColor},set:function(t){this.set_bgColor(t)}},{key:"set_bgColor",value:function(t){this._getTextStyle().bgColor=t,this._renderType|=v.SpriteConst.STYLE,this._setBgStyleColor(0,0,this.width,this.height,t),this._setRenderType(this._renderType),this.isChanged=!0}},{key:"get_bgColor",value:function(){return this._style.bgColor}},{key:"borderColor",get:function(){return this._style.borderColor},set:function(t){this._getTextStyle().borderColor=t,this._renderType|=v.SpriteConst.STYLE,this._setBorderStyleColor(0,0,this.width,this.height,t,1),this._setRenderType(this._renderType),this.isChanged=!0}},{key:"stroke",get:function(){return this._style.stroke},set:function(t){this._getTextStyle().stroke=t,this.isChanged=!0}},{key:"strokeColor",get:function(){return this._style.strokeColor},set:function(t){this._getTextStyle().strokeColor=t,this.isChanged=!0}},{key:"isChanged",set:function(t){this._isChanged!==t&&(this._isChanged=t,t&&w.ILaya.systemTimer.callLater(this,this.typeset))}},{key:"_getContextFont",value:function(){return(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(w.ILaya.Browser.onIPhone&&a.fontFamilyMap[this.font]||this.font)}},{key:"_isPassWordMode",value:function(){var t=this._style.asPassword;return"prompt"in this&&this.prompt==this._text&&(t=!1),t}},{key:"_getPassWordTxt",value:function(t){var e;e="";for(var n=t.length;n>0;n--)e+="●";return e}},{key:"_renderText",value:function(){var t=this.padding,e=this._lines.length;this.overflow!=a.VISIBLE&&(e=Math.min(e,Math.floor((this.height-t[0]-t[2])/(this.leading+this._charSize.height))+1));var n=this.scrollY/(this._charSize.height+this.leading)|0,i=this.graphics;i.clear(!0);var r=this._getContextFont();w.ILaya.Browser.context.font=r;var o=t[3],s="left",u=this._lines,l=this.leading+this._charSize.height,h=this._style.currBitmapFont;h&&(l=this.leading+h.getMaxHeight());var c=t[0];!h&&this._width>0&&this._textWidth<=this._width&&("right"==this.align?(s="right",o=this._width-t[1]):"center"==this.align&&(s="center",o=.5*this._width+t[3]-t[1]));var f,_,d=1;if(h&&h.autoScaleSize&&(d=h.fontSize/this.fontSize),this._height>0){var p=this._textHeight>this._height?"top":this.valign;"middle"===p?c=.5*(this._height-e/d*l)+t[0]-t[2]:"bottom"===p&&(c=this._height-e/d*l-t[2])}this._clipPoint&&(i.save(),h&&h.autoScaleSize?(f=this._width?this._width-t[3]-t[1]:this._textWidth,_=this._height?this._height-t[0]-t[2]:this._textHeight,f*=d,_*=d,i.clipRect(t[3],t[0],f,_)):i.clipRect(t[3],t[0],this._width?this._width-t[3]-t[1]:this._textWidth,this._height?this._height-t[0]-t[2]:this._textHeight),this.repaint());var y=this._style,v=y.asPassword;"prompt"in this&&this.prompt==this._text&&(v=!1);for(var g=0,m=0,b=Math.min(this._lines.length,e+n)||1,T=n;T<b;T++){var k,C=u[T];if(v){var E=C.length;C="";for(var S=E;S>0;S--)C+="●"}if(null==C&&(C=""),g=o-(this._clipPoint?this._clipPoint.x:0),m=c+l*T-(this._clipPoint?this._clipPoint.y:0),this.underline&&this._drawUnderline(s,g,m,T),h){var M=this.width;h.autoScaleSize&&(M=this.width*d,g*=d,m*=d),h._drawText(C,this,g,m,this.align,M)}else this._words||(this._words=[]),this._words.length>T-n?k=this._words[T-n]:(k=new x.WordText,this._words.push(k)),k.setText(C),k.splitRender=this._singleCharRender,y.stroke?i.fillBorderText(k,g,m,r,this.color,s,y.stroke,y.strokeColor):i.fillText(k,g,m,r,this.color,s)}if(h&&h.autoScaleSize){var L=1/d;this.scale(L,L)}this._clipPoint&&i.restore(),this._startX=o,this._startY=c}},{key:"_drawUnderline",value:function(t,e,n,i){var r=this._lineWidths[i];switch(t){case"center":e-=r/2;break;case"right":e-=r}n+=this._charSize.height,this._graphics.drawLine(e,n,e+r,n,this.underlineColor||this.color,1)}},{key:"typeset",value:function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);w.ILaya.Render.isConchApp?window.conchTextCanvas.font=this._getContextFont():w.ILaya.Browser.context.font=this._getContextFont(),this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this._parseLines(this._getPassWordTxt(this._text)):this._parseLines(this._text),this._evalTextSize(),this._checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new b.Point(0,0)):this._clipPoint=null,this._renderText()}},{key:"_evalTextSize",value:function(){var t,e;t=Math.max.apply(this,this._lineWidths);var n=this._style.currBitmapFont;if(n){var i=n.getMaxHeight();n.autoScaleSize&&(i=this.fontSize),e=this._lines.length*(i+this.leading)+this.padding[0]+this.padding[2]}else e=this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],this._lines.length&&(e-=this.leading);t==this._textWidth&&e==this._textHeight||(this._textWidth=t,this._textHeight=e)}},{key:"_checkEnabledViewportOrNot",value:function(){return this.overflow==a.SCROLL&&(this._width>0&&this._textWidth>this._width||this._height>0&&this._textHeight>this._height)}},{key:"changeText",value:function(t){this._text!==t&&(this.lang(t+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())}},{key:"_parseLines",value:function(t){var e=this.wordWrap||this.overflow==a.HIDDEN;if(e)var n=this._getWordWrapWidth();var i=this._style.currBitmapFont;if(i)this._charSize.width=i.getMaxWidth(),this._charSize.height=i.getMaxHeight();else{var r=null;(r=w.ILaya.Render.isConchApp?window.conchTextCanvas.measureText(a._testWord):w.ILaya.Browser.context.measureText(a._testWord))||(r={width:100}),this._charSize.width=r.width,this._charSize.height=r.height||this.fontSize}for(var o=t.replace(/\r\n/g,"\n").split("\n"),s=0,u=o.length;s<u;s++){var l=o[s];e?this._parseLine(l,n):(this._lineWidths.push(this._getTextWidth(l)),this._lines.push(l))}}},{key:"_parseLine",value:function(t,e){var n=this._lines,i=0,r=0,o=0,s=0;if((r=this._getTextWidth(t))<=e)return n.push(t),void this._lineWidths.push(r);r=this._charSize.width,0==(i=Math.floor(e/r))&&(i=1),o=r=this._getTextWidth(t.substring(0,i));for(var u=i,l=t.length;u<l;u++)if((o+=r=this._getTextWidth(t.charAt(u)))>e)if(this.wordWrap){var h=t.substring(s,u),c=h.charCodeAt(h.length-1);if(c<19968||c>40869){var f=/(?:[^\s\!-\/])+$/.exec(h);f&&(u=f.index+s,0==f.index?u+=h.length:h=t.substring(s,u))}if(n.push(h),this._lineWidths.push(o-r),s=u,!(u+i<l)){n.push(t.substring(s,l)),this._lineWidths.push(this._getTextWidth(n[n.length-1])),s=-1;break}u+=i,o=r=this._getTextWidth(t.substring(s,u)),u--}else if(this.overflow==a.HIDDEN)return n.push(t.substring(0,u)),void this._lineWidths.push(this._getTextWidth(n[n.length-1]));this.wordWrap&&-1!=s&&(n.push(t.substring(s,l)),this._lineWidths.push(this._getTextWidth(n[n.length-1])))}},{key:"_getTextWidth",value:function(t){var e=this._style.currBitmapFont;return e?e.getTextWidth(t):w.ILaya.Render.isConchApp?window.conchTextCanvas.measureText(t).width:(w.ILaya.Browser.context.measureText(t)||{width:100}).width}},{key:"_getWordWrapWidth",value:function(){var t,e=this.padding,n=this._style.currBitmapFont;return(t=n&&n.autoScaleSize?this._width*(n.fontSize/this.fontSize):this._width)<=0&&(t=this.wordWrap?100:w.ILaya.Browser.width),t<=0&&(t=100),t-e[3]-e[1]}},{key:"getCharPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._isChanged&&w.ILaya.systemTimer.runCallLater(this,this.typeset);for(var n=0,i=this._lines,r=0,a=0,o=i.length;a<o;a++){if(t<(n+=i[a].length)){var s=a;break}r=n}var u=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;w.ILaya.Browser.context.font=u;var l=this._getTextWidth(this._text.substring(r,t)),h=e||new b.Point;return h.setTo(this._startX+l-(this._clipPoint?this._clipPoint.x:0),this._startY+s*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))}},{key:"scrollX",get:function(){return this._clipPoint?this._clipPoint.x:0},set:function(t){if(!(this.overflow!=a.SCROLL||this.textWidth<this._width)&&this._clipPoint){t=t<this.padding[3]?this.padding[3]:t;var e=this._textWidth-this._width;t=t>e?e:t,this._clipPoint.x=t,this._renderText()}}},{key:"scrollY",get:function(){return this._clipPoint?this._clipPoint.y:0},set:function(t){if(!(this.overflow!=a.SCROLL||this.textHeight<this._height)&&this._clipPoint){t=t<this.padding[0]?this.padding[0]:t;var e=this._textHeight-this._height;t=t>e?e:t,this._clipPoint.y=t,this._renderText()}}},{key:"maxScrollX",get:function(){return this.textWidth<this._width?0:this._textWidth-this._width}},{key:"maxScrollY",get:function(){return this.textHeight<this._height?0:this._textHeight-this._height}},{key:"lines",get:function(){return this._isChanged&&this.typeset(),this._lines}},{key:"underlineColor",get:function(){return this._style.underlineColor},set:function(t){this._getTextStyle().underlineColor=t,this._isChanged||this._renderText()}},{key:"underline",get:function(){return this._style.underline},set:function(t){this._getTextStyle().underline=t}},{key:"singleCharRender",get:function(){return this._singleCharRender},set:function(t){this._singleCharRender=t}}],i=[{key:"defaultFontStr",value:function(){return a.defaultFontSize+"px "+a.defaultFont}},{key:"registerBitmapFont",value:function(t,e){a._bitmapFonts||(a._bitmapFonts={}),a._bitmapFonts[t]=e}},{key:"unregisterBitmapFont",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(a._bitmapFonts&&a._bitmapFonts[t]){var n=a._bitmapFonts[t];e&&n.destroy(),delete a._bitmapFonts[t]}}}],n&&E(e.prototype,n),i&&E(e,i),a}(y.Sprite);e.Text=D,D.VISIBLE="visible",D.SCROLL="scroll",D.HIDDEN="hidden",D.defaultFontSize=12,D.defaultFont="Arial",D.isComplexText=!1,D.fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"},D._testWord="游",D.CharacterCache=!0,D.RightToLeft=!1,w.ILaya.regClass(D),k.ClassUtils.regClass("laya.display.Text",D),k.ClassUtils.regClass("Laya.Text",D)},23578:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.AlphaCmd=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"create",value:function(e){var n=a.Pool.getItemByClass("AlphaCmd",t);return n.alpha=e,n}}],(n=[{key:"recover",value:function(){a.Pool.recover("AlphaCmd",this)}},{key:"run",value:function(t,e,n){t.alpha(this.alpha)}},{key:"cmdID",get:function(){return t.ID}}])&&o(e.prototype,n),i&&o(e,i),t}();e.AlphaCmd=s,s.ID="Alpha"},95518:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.ClipRectCmd=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"create",value:function(e,n,i,r){var o=a.Pool.getItemByClass("ClipRectCmd",t);return o.x=e,o.y=n,o.width=i,o.height=r,o}}],(n=[{key:"recover",value:function(){a.Pool.recover("ClipRectCmd",this)}},{key:"run",value:function(t,e,n){t.clipRect(this.x+e,this.y+n,this.width,this.height)}},{key:"cmdID",get:function(){return t.ID}}])&&o(e.prototype,n),i&&o(e,i),t}();e.ClipRectCmd=s,s.ID="ClipRect"},94317:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Draw9GridTexture=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"create",value:function(e,n,i,r,o,s){var u=a.Pool.getItemByClass("Draw9GridTexture",t);return u.texture=e,e._addReference(),u.x=n,u.y=i,u.width=r,u.height=o,u.sizeGrid=s,u}}],(n=[{key:"recover",value:function(){this.texture._removeReference(),a.Pool.recover("Draw9GridTexture",this)}},{key:"run",value:function(t,e,n){t.drawTextureWithSizeGrid(this.texture,this.x,this.y,this.width,this.height,this.sizeGrid,e,n)}},{key:"cmdID",get:function(){return t.ID}}])&&o(e.prototype,n),i&&o(e,i),t}();e.Draw9GridTexture=s,s.ID="Draw9GridTexture"},26531:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.DrawCircleCmd=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"create",value:function(e,n,i,r,o,s,u){var l=a.Pool.getItemByClass("DrawCircleCmd",t);return l.x=e,l.y=n,l.radius=i,l.fillColor=r,l.lineColor=o,l.lineWidth=s,l.vid=u,l}}],(n=[{key:"recover",value:function(){this.fillColor=null,this.lineColor=null,a.Pool.recover("DrawCircleCmd",this)}},{key:"run",value:function(t,e,n){t._drawCircle(this.x+e,this.y+n,this.radius,this.fillColor,this.lineColor,this.lineWidth,this.vid)}},{key:"cmdID",get:function(){return t.ID}}])&&o(e.prototype,n),i&&o(e,i),t}();e.DrawCircleCmd=s,s.ID="DrawCircle"},95923:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.DrawCurvesCmd=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"create",value:function(e,n,i,r,o){var s=a.Pool.getItemByClass("DrawCurvesCmd",t);return s.x=e,s.y=n,s.points=i,s.lineColor=r,s.lineWidth=o,s}}],(n=[{key:"recover",value:function(){this.points=null,this.lineColor=null,a.Pool.recover("DrawCurvesCmd",this)}},{key:"run",value:function(t,e,n){this.points&&t.drawCurves(this.x+e,this.y+n,this.points,this.lineColor,this.lineWidth)}},{key:"cmdID",get:function(){return t.ID}}])&&o(e.prototype,n),i&&o(e,i),t}();e.DrawCurvesCmd=s,s.ID="DrawCurves"},40120:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.DrawImageCmd=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"create",value:function(e,n,i,r,o){var s=a.Pool.getItemByClass("DrawImageCmd",t);return s.texture=e,e._addReference(),s.x=n,s.y=i,s.width=r,s.height=o,s}}],(n=[{key:"recover",value:function(){this.texture&&this.texture._removeReference(),this.texture=null,a.Pool.recover("DrawImageCmd",this)}},{key:"run",value:function(t,e,n){this.texture&&t.drawTexture(this.texture,this.x+e,this.y+n,this.width,this.height)}},{key:"cmdID",get:function(){return t.ID}}])&&o(e.prototype,n),i&&o(e,i),t}();e.DrawImageCmd=s,s.ID="DrawImage"},65419:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.DrawLineCmd=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"create",value:function(e,n,i,r,o,s,u){var l=a.Pool.getItemByClass("DrawLineCmd",t);return l.fromX=e,l.fromY=n,l.toX=i,l.toY=r,l.lineColor=o,l.lineWidth=s,l.vid=u,l}}],(n=[{key:"recover",value:function(){a.Pool.recover("DrawLineCmd",this)}},{key:"run",value:function(t,e,n){t._drawLine(e,n,this.fromX,this.fromY,this.toX,this.toY,this.lineColor,this.lineWidth,this.vid)}},{key:"cmdID",get:function(){return t.ID}}])&&o(e.prototype,n),i&&o(e,i),t}();e.DrawLineCmd=s,s.ID="DrawLine"},57073:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.DrawLinesCmd=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"create",value:function(e,n,i,r,o,s){var u=a.Pool.getItemByClass("DrawLinesCmd",t);return u.x=e,u.y=n,u.points=i,u.lineColor=r,u.lineWidth=o,u.vid=s,u}}],(n=[{key:"recover",value:function(){this.points=null,this.lineColor=null,a.Pool.recover("DrawLinesCmd",this)}},{key:"run",value:function(t,e,n){this.points&&t._drawLines(this.x+e,this.y+n,this.points,this.lineColor,this.lineWidth,this.vid)}},{key:"cmdID",get:function(){return t.ID}}])&&o(e.prototype,n),i&&o(e,i),t}();e.DrawLinesCmd=s,s.ID="DrawLines"},9897:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.DrawPathCmd=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"create",value:function(e,n,i,r,o){var s=a.Pool.getItemByClass("DrawPathCmd",t);return s.x=e,s.y=n,s.paths=i,s.brush=r,s.pen=o,s}}],(n=[{key:"recover",value:function(){this.paths=null,this.brush=null,this.pen=null,a.Pool.recover("DrawPathCmd",this)}},{key:"run",value:function(t,e,n){this.paths&&t._drawPath(this.x+e,this.y+n,this.paths,this.brush,this.pen)}},{key:"cmdID",get:function(){return t.ID}}])&&o(e.prototype,n),i&&o(e,i),t}();e.DrawPathCmd=s,s.ID="DrawPath"},81844:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.DrawPieCmd=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"create",value:function(e,n,i,r,o,s,u,l,h){var c=a.Pool.getItemByClass("DrawPieCmd",t);return c.x=e,c.y=n,c.radius=i,c._startAngle=r,c._endAngle=o,c.fillColor=s,c.lineColor=u,c.lineWidth=l,c.vid=h,c}}],(n=[{key:"recover",value:function(){this.fillColor=null,this.lineColor=null,a.Pool.recover("DrawPieCmd",this)}},{key:"run",value:function(t,e,n){t._drawPie(this.x+e,this.y+n,this.radius,this._startAngle,this._endAngle,this.fillColor,this.lineColor,this.lineWidth,this.vid)}},{key:"cmdID",get:function(){return t.ID}},{key:"startAngle",get:function(){return 180*this._startAngle/Math.PI},set:function(t){this._startAngle=t*Math.PI/180}},{key:"endAngle",get:function(){return 180*this._endAngle/Math.PI},set:function(t){this._endAngle=t*Math.PI/180}}])&&o(e.prototype,n),i&&o(e,i),t}();e.DrawPieCmd=s,s.ID="DrawPie"},91813:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.DrawPolyCmd=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"create",value:function(e,n,i,r,o,s,u,l){var h=a.Pool.getItemByClass("DrawPolyCmd",t);return h.x=e,h.y=n,h.points=i,h.fillColor=r,h.lineColor=o,h.lineWidth=s,h.isConvexPolygon=u,h.vid=l,h}}],(n=[{key:"recover",value:function(){this.points=null,this.fillColor=null,this.lineColor=null,a.Pool.recover("DrawPolyCmd",this)}},{key:"run",value:function(t,e,n){this.points&&t._drawPoly(this.x+e,this.y+n,this.points,this.fillColor,this.lineColor,this.lineWidth,this.isConvexPolygon,this.vid)}},{key:"cmdID",get:function(){return t.ID}}])&&o(e.prototype,n),i&&o(e,i),t}();e.DrawPolyCmd=s,s.ID="DrawPoly"},65955:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.DrawRectCmd=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"create",value:function(e,n,i,r,o,s,u){var l=a.Pool.getItemByClass("DrawRectCmd",t);return l.x=e,l.y=n,l.width=i,l.height=r,l.fillColor=o,l.lineColor=s,l.lineWidth=u,l}}],(n=[{key:"recover",value:function(){this.fillColor=null,this.lineColor=null,a.Pool.recover("DrawRectCmd",this)}},{key:"run",value:function(t,e,n){t.drawRect(this.x+e,this.y+n,this.width,this.height,this.fillColor,this.lineColor,this.lineWidth)}},{key:"cmdID",get:function(){return t.ID}}])&&o(e.prototype,n),i&&o(e,i),t}();e.DrawRectCmd=s,s.ID="DrawRect"},82994:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.DrawTextureCmd=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(20084),o=n(64210);function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.colorFlt=null,this.uv=null}var e,n,i;return e=t,i=[{key:"create",value:function(e,n,i,r,s,u,l,h,c,f){var _=o.Pool.getItemByClass("DrawTextureCmd",t);return _.texture=e,e._addReference(),_.x=n,_.y=i,_.width=r,_.height=s,_.matrix=u,_.alpha=l,_.color=h,_.blendMode=c,_.uv=null==f?null:f,h&&(_.colorFlt=new a.ColorFilter,_.colorFlt.setColor(h)),_}}],(n=[{key:"recover",value:function(){this.texture&&this.texture._removeReference(),this.texture=null,this.matrix=null,o.Pool.recover("DrawTextureCmd",this)}},{key:"run",value:function(t,e,n){this.texture&&t.drawTextureWithTransform(this.texture,this.x,this.y,this.width,this.height,this.matrix,e,n,this.alpha,this.blendMode,this.colorFlt,this.uv)}},{key:"cmdID",get:function(){return t.ID}}])&&s(e.prototype,n),i&&s(e,i),t}();e.DrawTextureCmd=u,u.ID="DrawTexture"},65849:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.DrawTexturesCmd=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"create",value:function(e,n){var i=a.Pool.getItemByClass("DrawTexturesCmd",t);return i.texture=e,e._addReference(),i.pos=n,i}}],(n=[{key:"recover",value:function(){this.texture._removeReference(),this.texture=null,this.pos=null,a.Pool.recover("DrawTexturesCmd",this)}},{key:"run",value:function(t,e,n){t.drawTextures(this.texture,this.pos,e,n)}},{key:"cmdID",get:function(){return t.ID}}])&&o(e.prototype,n),i&&o(e,i),t}();e.DrawTexturesCmd=s,s.ID="DrawTextures"},47303:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.DrawTrianglesCmd=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(20084),o=n(13104),s=n(64210);function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"create",value:function(e,n,i,r,u,l,h,c,f,_,d){var p=s.Pool.getItemByClass("DrawTrianglesCmd",t);if(p.texture=e,p.x=n,p.y=i,p.vertices=r,p.uvs=u,p.indices=l,p.matrix=h,p.alpha=c,f){p.color=new a.ColorFilter;var y=o.ColorUtils.create(f).arrColor;p.color.color(255*y[0],255*y[1],255*y[2],255*y[3])}return p.blendMode=_,p.colorNum=d,p}}],(n=[{key:"recover",value:function(){this.texture=null,this.vertices=null,this.uvs=null,this.indices=null,this.matrix=null,s.Pool.recover("DrawTrianglesCmd",this)}},{key:"run",value:function(t,e,n){t.drawTriangles(this.texture,this.x+e,this.y+n,this.vertices,this.uvs,this.indices,this.matrix,this.alpha,this.color,this.blendMode,this.colorNum)}},{key:"cmdID",get:function(){return t.ID}}])&&u(e.prototype,n),i&&u(e,i),t}();e.DrawTrianglesCmd=l,l.ID="DrawTriangles"},4501:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.FillTextCmd=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(79741),o=n(13104),s=n(75494),u=n(64210),l=n(80651),h=n(92493);function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var f=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._textIsWorldText=!1,this._fontColor=4294967295,this._strokeColor=0,this._fontObj=t._defFontObj,this._nTexAlign=0}var e,n,i;return e=t,i=[{key:"create",value:function(e,n,i,r,a,o,s,h,c){var f=u.Pool.getItemByClass("FillTextCmd",t);return f.text=e,f._textIsWorldText=e instanceof l.WordText,f._words=n,f.x=i,f.y=r,f.font=a,f.color=o,f.textAlign=s,f._lineWidth=h,f._borderColor=c,f}}],(n=[{key:"recover",value:function(){u.Pool.recover("FillTextCmd",this)}},{key:"run",value:function(t,e,n){h.ILaya.stage.isGlobalRepaint()&&this._textIsWorldText&&this._text.cleanCache(),this._words?a.Context._textRender.fillWords(t,this._words,this.x+e,this.y+n,this._fontObj,this._color,this._borderColor,this._lineWidth):this._textIsWorldText?t._fast_filltext(this._text,this.x+e,this.y+n,this._fontObj,this._color,this._borderColor,this._lineWidth,this._nTexAlign,0):a.Context._textRender.filltext(t,this._text,this.x+e,this.y+n,this.font,this.color,this._borderColor,this._lineWidth,this._textAlign)}},{key:"cmdID",get:function(){return t.ID}},{key:"text",get:function(){return this._text},set:function(t){this._text=t,this._textIsWorldText=t instanceof l.WordText,this._textIsWorldText&&this._text.cleanCache()}},{key:"font",get:function(){return this._font},set:function(t){this._font=t,this._fontObj=s.FontInfo.Parse(t),this._textIsWorldText&&this._text.cleanCache()}},{key:"color",get:function(){return this._color},set:function(t){this._color=t,this._fontColor=o.ColorUtils.create(t).numColor,this._textIsWorldText&&this._text.cleanCache()}},{key:"textAlign",get:function(){return this._textAlign},set:function(t){switch(this._textAlign=t,t){case"center":this._nTexAlign=h.ILaya.Context.ENUM_TEXTALIGN_CENTER;break;case"right":this._nTexAlign=h.ILaya.Context.ENUM_TEXTALIGN_RIGHT;break;default:this._nTexAlign=h.ILaya.Context.ENUM_TEXTALIGN_DEFAULT}this._textIsWorldText&&this._text.cleanCache()}}])&&c(e.prototype,n),i&&c(e,i),t}();e.FillTextCmd=f,f.ID="FillText",f._defFontObj=new s.FontInfo(null)},99777:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.FillTextureCmd=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"create",value:function(e,n,i,r,o,s,u,l){var h=a.Pool.getItemByClass("FillTextureCmd",t);return h.texture=e,h.x=n,h.y=i,h.width=r,h.height=o,h.type=s,h.offset=u,h.other=l,h}}],(n=[{key:"recover",value:function(){this.texture=null,this.offset=null,this.other=null,a.Pool.recover("FillTextureCmd",this)}},{key:"run",value:function(t,e,n){t.fillTexture(this.texture,this.x+e,this.y+n,this.width,this.height,this.type,this.offset,this.other)}},{key:"cmdID",get:function(){return t.ID}}])&&o(e.prototype,n),i&&o(e,i),t}();e.FillTextureCmd=s,s.ID="FillTexture"},88720:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.RestoreCmd=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"create",value:function(){return a.Pool.getItemByClass("RestoreCmd",t)}}],(n=[{key:"recover",value:function(){a.Pool.recover("RestoreCmd",this)}},{key:"run",value:function(t,e,n){t.restore()}},{key:"cmdID",get:function(){return t.ID}}])&&o(e.prototype,n),i&&o(e,i),t}();e.RestoreCmd=s,s.ID="Restore"},7862:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.RotateCmd=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"create",value:function(e,n,i){var r=a.Pool.getItemByClass("RotateCmd",t);return r.angle=e,r.pivotX=n,r.pivotY=i,r}}],(n=[{key:"recover",value:function(){a.Pool.recover("RotateCmd",this)}},{key:"run",value:function(t,e,n){t._rotate(this.angle,this.pivotX+e,this.pivotY+n)}},{key:"cmdID",get:function(){return t.ID}}])&&o(e.prototype,n),i&&o(e,i),t}();e.RotateCmd=s,s.ID="Rotate"},95538:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.SaveCmd=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"create",value:function(){return a.Pool.getItemByClass("SaveCmd",t)}}],(n=[{key:"recover",value:function(){a.Pool.recover("SaveCmd",this)}},{key:"run",value:function(t,e,n){t.save()}},{key:"cmdID",get:function(){return t.ID}}])&&o(e.prototype,n),i&&o(e,i),t}();e.SaveCmd=s,s.ID="Save"},37187:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.ScaleCmd=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"create",value:function(e,n,i,r){var o=a.Pool.getItemByClass("ScaleCmd",t);return o.scaleX=e,o.scaleY=n,o.pivotX=i,o.pivotY=r,o}}],(n=[{key:"recover",value:function(){a.Pool.recover("ScaleCmd",this)}},{key:"run",value:function(t,e,n){t._scale(this.scaleX,this.scaleY,this.pivotX+e,this.pivotY+n)}},{key:"cmdID",get:function(){return t.ID}}])&&o(e.prototype,n),i&&o(e,i),t}();e.ScaleCmd=s,s.ID="Scale"},9047:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.TransformCmd=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"create",value:function(e,n,i){var r=a.Pool.getItemByClass("TransformCmd",t);return r.matrix=e,r.pivotX=n,r.pivotY=i,r}}],(n=[{key:"recover",value:function(){this.matrix=null,a.Pool.recover("TransformCmd",this)}},{key:"run",value:function(t,e,n){t._transform(this.matrix,this.pivotX+e,this.pivotY+n)}},{key:"cmdID",get:function(){return t.ID}}])&&o(e.prototype,n),i&&o(e,i),t}();e.TransformCmd=s,s.ID="Transform"},44449:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.TranslateCmd=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"create",value:function(e,n){var i=a.Pool.getItemByClass("TranslateCmd",t);return i.tx=e,i.ty=n,i}}],(n=[{key:"recover",value:function(){a.Pool.recover("TranslateCmd",this)}},{key:"run",value:function(t,e,n){t.translate(this.tx,this.ty)}},{key:"cmdID",get:function(){return t.ID}}])&&o(e.prototype,n),i&&o(e,i),t}();e.TranslateCmd=s,s.ID="Translate"},22805:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.BoundsStyle=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"create",value:function(){return a.Pool.getItemByClass("BoundsStyle",t)}}],(n=[{key:"reset",value:function(){return this.bounds&&this.bounds.recover(),this.userBounds&&this.userBounds.recover(),this.bounds=null,this.userBounds=null,this.temBM=null,this}},{key:"recover",value:function(){a.Pool.recover("BoundsStyle",this.reset())}}])&&o(e.prototype,n),i&&o(e,i),t}();e.BoundsStyle=s},6872:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.CacheStyle=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(85399),o=n(98693),s=n(26776),u=n(64210);function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var h=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.reset()}var e,n,i;return e=t,i=[{key:"create",value:function(){return u.Pool.getItemByClass("SpriteCache",t)}}],(n=[{key:"needBitmapCache",value:function(){return this.cacheForFilters||!!this.mask}},{key:"needEnableCanvasRender",value:function(){return"none"!=this.userSetCache||this.cacheForFilters||!!this.mask}},{key:"releaseContext",value:function(){if(this.canvas&&this.canvas.size){u.Pool.recover("CacheCanvas",this.canvas),this.canvas.size(0,0);try{this.canvas.width=0,this.canvas.height=0}catch(t){}}this.canvas=null}},{key:"createContext",value:function(){if(!this.canvas){this.canvas=u.Pool.getItem("CacheCanvas")||new s.HTMLCanvas(!1);var t=this.canvas.context;t||(t=this.canvas.getContext("2d"))}}},{key:"releaseFilterCache",value:function(){var t=this.filterCache;t&&(t.destroy(),t.recycle(),this.filterCache=null)}},{key:"recover",value:function(){this!==t.EMPTY&&u.Pool.recover("SpriteCache",this.reset())}},{key:"reset",value:function(){return this.releaseContext(),this.releaseFilterCache(),this.cacheAs="none",this.enableCanvasRender=!1,this.userSetCache="none",this.cacheForFilters=!1,this.staticCache=!1,this.reCache=!0,this.mask=null,this.maskParent=null,this.filterCache=null,this.filters=null,this.hasGlowFilter=!1,this.cacheRect&&this.cacheRect.recover(),this.cacheRect=null,this}},{key:"_calculateCacheRect",value:function(e,n,i,r){var a,s=e._cacheStyle;if(s.cacheRect||(s.cacheRect=o.Rectangle.create()),"bitmap"===n?((a=e.getSelfBounds()).width=a.width+2*t.CANVAS_EXTEND_EDGE,a.height=a.height+2*t.CANVAS_EXTEND_EDGE,a.x=a.x-e.pivotX,a.y=a.y-e.pivotY,a.x=a.x-t.CANVAS_EXTEND_EDGE,a.y=a.y-t.CANVAS_EXTEND_EDGE,a.x=Math.floor(a.x+i)-i,a.y=Math.floor(a.y+r)-r,a.width=Math.floor(a.width),a.height=Math.floor(a.height),s.cacheRect.copyFrom(a)):s.cacheRect.setTo(-e._style.pivotX,-e._style.pivotY,1,1),a=s.cacheRect,e._style.scrollRect){var u=e._style.scrollRect;a.x-=u.x,a.y-=u.y}return t._scaleInfo.setTo(1,1),t._scaleInfo}}])&&l(e.prototype,n),i&&l(e,i),t}();e.CacheStyle=h,h.EMPTY=new h,h._scaleInfo=new a.Point,h.CANVAS_EXTEND_EDGE=16},54216:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.SpriteStyle=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.reset()}var e,n,i;return e=t,i=[{key:"create",value:function(){return a.Pool.getItemByClass("SpriteStyle",t)}}],(n=[{key:"reset",value:function(){return this.scaleX=this.scaleY=1,this.skewX=this.skewY=0,this.pivotX=this.pivotY=this.rotation=0,this.alpha=1,this.scrollRect&&this.scrollRect.recover(),this.scrollRect=null,this.viewport&&this.viewport.recover(),this.viewport=null,this.hitArea=null,this.dragging=null,this.blendMode=null,this}},{key:"recover",value:function(){this!==t.EMPTY&&a.Pool.recover("SpriteStyle",this.reset())}}])&&o(e.prototype,n),i&&o(e,i),t}();e.SpriteStyle=s,s.EMPTY=new s},33176:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.TextStyle=void 0;var f=y(n(85507)),_=y(n(21611)),d=n(54216),p=n(64210);function y(t){return t&&t.__esModule?t:{default:t}}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function m(){return m="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=b(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},m.apply(this,arguments)}function b(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=k(t)););return t}function T(t,e){return T=a||function(t,e){return t.__proto__=e,t},T(t,e)}function x(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=k(t);if(e){var a=k(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return w(this,n)}}function w(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function k(t){return k=f.default?_.default:function(t){return t.__proto__||(0,_.default)(t)},k(t)}var C=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&T(t,e)}(a,t);var e,n,i,r=x(a);function a(){var t;return v(this,a),(t=r.apply(this,arguments)).italic=!1,t}return e=a,i=[{key:"create",value:function(){return p.Pool.getItemByClass("TextStyle",a)}}],(n=[{key:"reset",value:function(){return m(k(a.prototype),"reset",this).call(this),this.italic=!1,this.align="left",this.wordWrap=!1,this.leading=0,this.padding=[0,0,0,0],this.bgColor=null,this.borderColor=null,this.asPassword=!1,this.stroke=0,this.strokeColor="#000000",this.bold=!1,this.underline=!1,this.underlineColor=null,this.currBitmapFont=null,this}},{key:"recover",value:function(){this!==a.EMPTY&&p.Pool.recover("TextStyle",this.reset())}},{key:"render",value:function(t,e,n,i){(this.bgColor||this.borderColor)&&e.drawRect(n-this.pivotX,i-this.pivotY,t.width,t.height,this.bgColor,this.borderColor,1)}}])&&g(e.prototype,n),i&&g(e,i),a}(d.SpriteStyle);e.TextStyle=C,C.EMPTY=new C},89662:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Event=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(85399),o=n(92493);function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,(n=[{key:"setTo",value:function(t,e,n){return this.type=t,this.currentTarget=e,this.target=n,this}},{key:"stopPropagation",value:function(){this._stoped=!0}},{key:"touches",get:function(){if(!this.nativeEvent)return null;var t=this.nativeEvent.touches;if(t)for(var e=o.ILaya.stage,n=0,i=t.length;n<i;n++){var r=t[n],s=a.Point.TEMP;s.setTo(r.clientX,r.clientY),e._canvasTransform.invertTransformPoint(s),e.transform.invertTransformPoint(s),r.stageX=s.x,r.stageY=s.y}return t}},{key:"altKey",get:function(){return this.nativeEvent.altKey}},{key:"ctrlKey",get:function(){return this.nativeEvent.ctrlKey}},{key:"shiftKey",get:function(){return this.nativeEvent.shiftKey}},{key:"charCode",get:function(){return this.nativeEvent.charCode}},{key:"keyLocation",get:function(){return this.nativeEvent.location||this.nativeEvent.keyLocation}},{key:"stageX",get:function(){return o.ILaya.stage.mouseX}},{key:"stageY",get:function(){return o.ILaya.stage.mouseY}}])&&s(e.prototype,n),i&&s(e,i),t}();e.Event=u,u.EMPTY=new u,u.MOUSE_DOWN="mousedown",u.MOUSE_UP="mouseup",u.CLICK="click",u.RIGHT_MOUSE_DOWN="rightmousedown",u.RIGHT_MOUSE_UP="rightmouseup",u.RIGHT_CLICK="rightclick",u.MOUSE_MOVE="mousemove",u.MOUSE_OVER="mouseover",u.MOUSE_OUT="mouseout",u.MOUSE_WHEEL="mousewheel",u.ROLL_OVER="mouseover",u.ROLL_OUT="mouseout",u.DOUBLE_CLICK="doubleclick",u.CHANGE="change",u.CHANGED="changed",u.RESIZE="resize",u.ADDED="added",u.REMOVED="removed",u.DISPLAY="display",u.UNDISPLAY="undisplay",u.ERROR="error",u.COMPLETE="complete",u.LOADED="loaded",u.READY="ready",u.PROGRESS="progress",u.INPUT="input",u.RENDER="render",u.OPEN="open",u.MESSAGE="message",u.CLOSE="close",u.KEY_DOWN="keydown",u.KEY_PRESS="keypress",u.KEY_UP="keyup",u.FRAME="enterframe",u.DRAG_START="dragstart",u.DRAG_MOVE="dragmove",u.DRAG_END="dragend",u.ENTER="enter",u.SELECT="select",u.BLUR="blur",u.FOCUS="focus",u.VISIBILITY_CHANGE="visibilitychange",u.FOCUS_CHANGE="focuschange",u.PLAYED="played",u.PAUSED="paused",u.STOPPED="stopped",u.START="start",u.END="end",u.COMPONENT_ADDED="componentadded",u.COMPONENT_REMOVED="componentremoved",u.RELEASED="released",u.LINK="link",u.LABEL="label",u.FULL_SCREEN_CHANGE="fullscreenchange",u.DEVICE_LOST="devicelost",u.TRANSFORM_CHANGED="transformchanged",u.ANIMATION_CHANGED="animationchanged",u.TRAIL_FILTER_CHANGE="trailfilterchange",u.TRIGGER_ENTER="triggerenter",u.TRIGGER_STAY="triggerstay",u.TRIGGER_EXIT="triggerexit"},48856:function(t,e,n){"use strict";function i(t){return i="function"==typeof l&&"symbol"==typeof h?function(t){return typeof t}:function(t){return t&&"function"==typeof l&&t.constructor===l&&t!==l.prototype?"symbol":typeof t},i(t)}var r=n(85507),a=n(21611),o=n(1068),s=n(54943),u=n(63978),l=n(65420),h=n(98341);u(e,"__esModule",{value:!0}),e.EventDispatcher=void 0;var c=d(n(92762)),f=d(n(63978)),_=n(41107);function d(t){return t&&t.__esModule?t:{default:t}}function p(t,e){return p=r||function(t,e){return t.__proto__=e,t},p(t,e)}function y(t){var e=function(){if("undefined"==typeof Reflect||!o)return!1;if(o.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(o(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=g(t);if(e){var r=g(this).constructor;n=o(i,arguments,r)}else n=i.apply(this,arguments);return v(this,n)}}function v(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function g(t){return g=r?a:function(t){return t.__proto__||a(t)},g(t)}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,f.default)(t,i.key,i)}}function T(t,e,n){return e&&b(t.prototype,e),n&&b(t,n),t}var x=function(){function t(){m(this,t)}return T(t,[{key:"hasListener",value:function(t){return!!(this._events&&this._events[t])}},{key:"event",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this._events||!this._events[t])return!1;var n=this._events[t];if(n.run)n.once&&delete this._events[t],null!=e?n.runWith(e):n.run();else{for(var i=0,r=n.length;i<r;i++){var a=n[i];a&&(null!=e?a.runWith(e):a.run()),a&&!a.once||((0,c.default)(n).call(n,i,1),i--,r--)}0===n.length&&this._events&&!this._events[t].run&&delete this._events[t]}return!0}},{key:"on",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return this._createListener(t,e,n,i,!1)}},{key:"once",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return this._createListener(t,e,n,i,!0)}},{key:"_createListener",value:function(t,e,n,i,r){var a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];a&&this.off(t,e,n,r);var o=w.create(e||this,n,i,r);this._events||(this._events={});var s=this._events;return s[t]?s[t].run?s[t]=[s[t],o]:s[t].push(o):s[t]=o,this}},{key:"off",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!this._events||!this._events[t])return this;var r=this._events[t];if(null!=r)if(r.run)e&&r.caller!==e||null!=n&&r.method!==n||i&&!r.once||(delete this._events[t],r.recover());else{for(var a=0,o=0,s=r.length;o<s;o++){var u=r[o];u?!u||e&&u.caller!==e||null!=n&&u.method!==n||i&&!u.once||(a++,r[o]=null,u.recover()):a++}a===s&&delete this._events[t]}return this}},{key:"offAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this._events;if(!e)return this;if(t)this._recoverHandlers(e[t]),delete e[t];else{for(var n in e)this._recoverHandlers(e[n]);this._events=null}return this}},{key:"offAllCaller",value:function(t){if(t&&this._events)for(var e in this._events)this.off(e,t,null);return this}},{key:"_recoverHandlers",value:function(t){if(t)if(t.run)t.recover();else for(var e=t.length-1;e>-1;e--)t[e]&&(t[e].recover(),t[e]=null)}},{key:"isMouseEvent",value:function(e){return t.MOUSE_EVENTS[e]||!1}}]),t}();e.EventDispatcher=x,x.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0};var w=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=s(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(n,t);var e=y(n);function n(t,i,r,a){return m(this,n),e.call(this,t,i,r,a)}return T(n,[{key:"recover",value:function(){this._id>0&&(this._id=0,n._pool.push(this.clear()))}}],[{key:"create",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return n._pool.length?n._pool.pop().setTo(t,e,i,r):new n(t,e,i,r)}}]),n}(_.Handler);w._pool=[]},78499:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.KeyBoardManager=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(89662),o=n(92493);function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"__init__",value:function(){t._addEvent("keydown"),t._addEvent("keypress"),t._addEvent("keyup")}},{key:"_addEvent",value:function(e){o.ILaya.Browser.document.addEventListener(e,(function(n){t._dispatch(n,e)}),!0)}},{key:"_dispatch",value:function(e,n){if(t.enabled){t._event._stoped=!1,t._event.nativeEvent=e,t._event.keyCode=e.keyCode||e.which||e.charCode,"keydown"===n?t._pressKeys[t._event.keyCode]=!0:"keyup"===n&&(t._pressKeys[t._event.keyCode]=null);for(var i=o.ILaya.stage.focus&&null!=o.ILaya.stage.focus.event&&o.ILaya.stage.focus.displayedInStage?o.ILaya.stage.focus:o.ILaya.stage,r=i;r;)r.event(n,t._event.setTo(n,r,i)),r=r.parent}}},{key:"hasKeyDown",value:function(e){return t._pressKeys[e]}}],(n=null)&&s(e.prototype,n),i&&s(e,i),t}();e.KeyBoardManager=u,u._pressKeys={},u.enabled=!0,u._event=new a.Event},47002:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.MouseManager=void 0;var i=f(n(92762)),r=f(n(63978)),a=n(89662),o=n(69923),s=n(61891),u=n(85399),l=n(98693),h=n(93568),c=n(92493);function f(t){return t&&t.__esModule?t:{default:t}}function _(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var d=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseMoveAccuracy=2,this._event=new a.Event,this._captureSp=null,this._captureChain=[],this._captureExlusiveMode=!1,this._hitCaputreSp=!1,this._point=new u.Point,this._rect=new l.Rectangle,this._lastMoveTimer=0,this._prePoint=new u.Point,this._touchIDs={},this._curTouchID=NaN,this._id=1}var e,n,r;return e=t,n=[{key:"__init__",value:function(e,n){this._stage=e;var i=this;n.oncontextmenu=function(e){if(t.enabled)return!1},n.addEventListener("mousedown",(function(e){t.enabled&&(h.Browser.onIE||e.cancelable&&e.preventDefault(),i.mouseDownTime=h.Browser.now(),i.runEvent(e))})),n.addEventListener("mouseup",(function(e){t.enabled&&(e.cancelable&&e.preventDefault(),i.mouseDownTime=-h.Browser.now(),i.runEvent(e))}),!0),n.addEventListener("mousemove",(function(e){if(t.enabled){e.cancelable&&e.preventDefault();var n=h.Browser.now();if(n-i._lastMoveTimer<10)return;i._lastMoveTimer=n,i.runEvent(e)}}),!0),n.addEventListener("mouseout",(function(e){t.enabled&&i.runEvent(e)})),n.addEventListener("mouseover",(function(e){t.enabled&&i.runEvent(e)})),n.addEventListener("touchstart",(function(e){t.enabled&&(t._isFirstTouch||s.Input.isInputting||e.cancelable&&e.preventDefault(),i.mouseDownTime=h.Browser.now(),i.runEvent(e))})),n.addEventListener("touchend",(function(e){t.enabled?(t._isFirstTouch||s.Input.isInputting||e.cancelable&&e.preventDefault(),t._isFirstTouch=!1,i.mouseDownTime=-h.Browser.now(),i.runEvent(e)):i._curTouchID=NaN}),!0),n.addEventListener("touchmove",(function(e){t.enabled&&(e.cancelable&&e.preventDefault(),i.runEvent(e))}),!0),n.addEventListener("touchcancel",(function(e){t.enabled?(e.cancelable&&e.preventDefault(),i.runEvent(e)):i._curTouchID=NaN}),!0),n.addEventListener("mousewheel",(function(e){t.enabled&&i.runEvent(e)})),n.addEventListener("DOMMouseScroll",(function(e){t.enabled&&i.runEvent(e)}))}},{key:"initEvent",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this;i._event._stoped=!1,i._event.nativeEvent=n||t,i._target=null,this._point.setTo(t.pageX||t.clientX,t.pageY||t.clientY),this._stage._canvasTransform&&(this._stage._canvasTransform.invertTransformPoint(this._point),i.mouseX=this._point.x,i.mouseY=this._point.y),i._event.touchId=t.identifier||0,this._tTouchID=i._event.touchId,(e=o.TouchManager.I._event)._stoped=!1,e.nativeEvent=i._event.nativeEvent,e.touchId=i._event.touchId}},{key:"checkMouseWheel",value:function(t){this._event.delta=t.wheelDelta?.025*t.wheelDelta:-t.detail;for(var e=o.TouchManager.I.getLastOvers(),n=0,i=e.length;n<i;n++){var r=e[n];r.event(a.Event.MOUSE_WHEEL,this._event.setTo(a.Event.MOUSE_WHEEL,r,this._target))}}},{key:"onMouseMove",value:function(t){o.TouchManager.I.onMouseMove(t,this._tTouchID)}},{key:"onMouseDown",value:function(t){if(s.Input.isInputting&&c.ILaya.stage.focus&&c.ILaya.stage.focus.focus&&!c.ILaya.stage.focus.contains(this._target)){var e=c.ILaya.stage.focus._tf||c.ILaya.stage.focus,n=t._tf||t;n instanceof s.Input&&n.multiline==e.multiline?e._focusOut():e.focus=!1}o.TouchManager.I.onMouseDown(t,this._tTouchID,this._isLeftMouse)}},{key:"onMouseUp",value:function(t){o.TouchManager.I.onMouseUp(t,this._tTouchID,this._isLeftMouse)}},{key:"check",value:function(t,e,n,i){this._point.setTo(e,n),t.fromParentPoint(this._point),e=this._point.x,n=this._point.y;var r=t._style.scrollRect;if(r&&(this._rect.setTo(r.x,r.y,r.width,r.height),!this._rect.contains(e,n)))return!1;if(!this.disableMouseEvent){if(t.hitTestPrior&&!t.mouseThrough&&!this.hitTest(t,e,n))return!1;for(var a=t._children.length-1;a>-1;a--){var o=t._children[a];if(!o.destroyed&&o._mouseState>1&&o._visible&&this.check(o,e,n,i))return!0}for(a=t._extUIChild.length-1;a>=0;a--){var s=t._extUIChild[a];if(!s.destroyed&&s._mouseState>1&&s._visible&&this.check(s,e,n,i))return!0}}var u=!(!t.hitTestPrior||t.mouseThrough||this.disableMouseEvent)||this.hitTest(t,e,n);return u?(this._target=t,i.call(this,t),this._target==this._hitCaputreSp&&(this._hitCaputreSp=!0)):i===this.onMouseUp&&t===this._stage&&(this._target=this._stage,i.call(this,this._target)),u}},{key:"hitTest",value:function(t,e,n){var i=!1;t.scrollRect&&(e-=t._style.scrollRect.x,n-=t._style.scrollRect.y);var r=t._style.hitArea;return r&&r._hit?r.contains(e,n):((t.width>0&&t.height>0||t.mouseThrough||r)&&(i=t.mouseThrough?t.getGraphicBounds().contains(e,n):(r||this._rect.setTo(0,0,t.width,t.height)).contains(e,n)),i)}},{key:"_checkAllBaseUI",value:function(t,e,n){var i=this.handleExclusiveCapture(this.mouseX,this.mouseY,n);return!!i||(i=this.check(this._stage,this.mouseX,this.mouseY,n),this.handleCapture(this.mouseX,this.mouseY,n)||i)}},{key:"check3DUI",value:function(t,e,n){for(var i=this._stage._3dUI,r=0,a=!1;r<i.length;r++){var o=i[r];this._stage._curUIBase=o,!o.destroyed&&o._mouseState>1&&o._visible&&(a=a||this.check(o,this.mouseX,this.mouseY,n))}return this._stage._curUIBase=this._stage,a}},{key:"handleExclusiveCapture",value:function(t,e,n){if(this._captureExlusiveMode&&this._captureSp&&this._captureChain.length>0){var i;this._point.setTo(t,e);for(var r=0;r<this._captureChain.length;r++)(i=this._captureChain[r]).fromParentPoint(this._point);return this._target=i,n.call(this,i),!0}return!1}},{key:"handleCapture",value:function(t,e,n){if(!this._hitCaputreSp&&this._captureSp&&this._captureChain.length>0){var i;this._point.setTo(t,e);for(var r=0;r<this._captureChain.length;r++)(i=this._captureChain[r]).fromParentPoint(this._point);return this._target=i,n.call(this,i),!0}return!1}},{key:"runEvent",value:function(e){var n,i,r;switch("mousemove"!==e.type&&(this._prePoint.x=this._prePoint.y=-1e6),e.type){case"mousedown":this._touchIDs[0]=this._id++,t._isTouchRespond?t._isTouchRespond=!1:(this._isLeftMouse=0===e.button,this.initEvent(e),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===e.button,this.initEvent(e),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-e.clientX)+Math.abs(this._prePoint.y-e.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=e.clientX,this._prePoint.y=e.clientY,this.initEvent(e),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":t._isTouchRespond=!0,this._isLeftMouse=!0;var s=e.changedTouches;for(n=0,i=s.length;n<i;n++)r=s[n],(t.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=r.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[r.identifier]=this._id++,this.initEvent(r,e),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":t._isTouchRespond=!0,this._isLeftMouse=!0;var u=e.changedTouches;for(n=0,i=u.length;n<i;n++)r=u[n],(t.multiTouchEnabled||r.identifier==this._curTouchID)&&(this._curTouchID=NaN,this.initEvent(r,e),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null));break;case"touchmove":var l=e.changedTouches;for(n=0,i=l.length;n<i;n++)r=l[n],(t.multiTouchEnabled||r.identifier==this._curTouchID)&&(this.initEvent(r,e),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(e);break;case"mouseout":o.TouchManager.I.stageMouseOut();break;case"mouseover":this._stage.event(a.Event.MOUSE_OVER,this._event.setTo(a.Event.MOUSE_OVER,this._stage,this._stage))}}},{key:"setCapture",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._captureSp=t,this._captureExlusiveMode=e,this._captureChain.length=0,this._captureChain.push(t);for(var n=t;;){var r;if(n==c.ILaya.stage)break;if(n==c.ILaya.stage._curUIBase)break;if(!(n=n.parent))break;(0,i.default)(r=this._captureChain).call(r,0,0,n)}}},{key:"releaseCapture",value:function(){console.log("release capture"),this._captureSp=null}}],n&&_(e.prototype,n),r&&_(e,r),t}();e.MouseManager=d,d.instance=new d,d.enabled=!0,d.multiTouchEnabled=!0,d._isFirstTouch=!0},69923:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.TouchManager=void 0;var i=h(n(92762)),r=h(n(81643)),a=h(n(63978)),o=n(89662),s=n(93568),u=n(64210),l=n(92493);function h(t){return t&&t.__esModule?t:{default:t}}function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,a.default)(t,i.key,i)}}var f=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._event=new o.Event,this._lastClickTime=0}var e,n,a;return e=t,n=[{key:"_clearTempArrs",value:function(){t._oldArr.length=0,t._newArr.length=0,t._tEleArr.length=0}},{key:"getTouchFromArr",value:function(t,e){var n,i,r;for(i=e.length,n=0;n<i;n++)if((r=e[n]).id==t)return r;return null}},{key:"removeTouchFromArr",value:function(t,e){var n;for(n=e.length-1;n>=0;n--)e[n].id==t&&(0,i.default)(e).call(e,n,1)}},{key:"createTouchO",value:function(t,e){var n;return(n=u.Pool.getItem("TouchData")||{}).id=e,n.tar=t,n}},{key:"onMouseDown",value:function(e,n){var i,r,a,u,l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.enable&&(i=this.getTouchFromArr(n,this.preOvers),a=this.getEles(e,null,t._tEleArr),i?i.tar=e:(r=this.createTouchO(e,n),this.preOvers.push(r)),s.Browser.onMobile&&this.sendEvents(a,o.Event.MOUSE_OVER),u=l?this.preDowns:this.preRightDowns,(i=this.getTouchFromArr(n,u))?i.tar=e:(r=this.createTouchO(e,n),u.push(r)),this.sendEvents(a,l?o.Event.MOUSE_DOWN:o.Event.RIGHT_MOUSE_DOWN),this._clearTempArrs())}},{key:"sendEvents",value:function(t,e){var n,i,r;for(i=t.length,this._event._stoped=!1,r=t[0],n=0;n<i;n++){var a=t[n];if(a.destroyed)return;if(a.event(e,this._event.setTo(e,a,r)),this._event._stoped)break}}},{key:"getEles",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;for(n?n.length=0:n=[];t&&t!=e;)n.push(t),t=t.parent;return n}},{key:"checkMouseOutAndOverOfMove",value:function(e,n){var a,s,u,l;if(n!=e)if(n.contains(e))s=this.getEles(e,n,t._tEleArr),this.sendEvents(s,o.Event.MOUSE_OVER);else if(e.contains(n))s=this.getEles(n,e,t._tEleArr),this.sendEvents(s,o.Event.MOUSE_OUT);else{var h,c,f;for((s=t._tEleArr).length=0,h=this.getEles(n,null,t._oldArr),c=this.getEles(e,null,t._newArr),l=h.length,u=0;u<l;u++){if(a=h[u],(f=(0,r.default)(c).call(c,a))>=0){(0,i.default)(c).call(c,f,c.length-f);break}s.push(a)}s.length>0&&this.sendEvents(s,o.Event.MOUSE_OUT),c.length>0&&this.sendEvents(c,o.Event.MOUSE_OVER)}}},{key:"onMouseMove",value:function(e,n){var i,r;this.enable&&((i=this.getTouchFromArr(n,this.preOvers))?(this.checkMouseOutAndOverOfMove(e,i.tar),i.tar=e,r=this.getEles(e,null,t._tEleArr)):(r=this.getEles(e,null,t._tEleArr),this.sendEvents(r,o.Event.MOUSE_OVER),this.preOvers.push(this.createTouchO(e,n))),this.sendEvents(r,o.Event.MOUSE_MOVE),this._clearTempArrs())}},{key:"getLastOvers",value:function(){return t._tEleArr.length=0,this.preOvers.length>0&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,t._tEleArr):(t._tEleArr.push(l.ILaya.stage),t._tEleArr)}},{key:"stageMouseOut",value:function(){var t;t=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(t,o.Event.MOUSE_OUT)}},{key:"onMouseUp",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.enable){var a,l,h,c,f,_,d,p,y=s.Browser.onMobile;if(l=this.getEles(e,null,t._tEleArr),this.sendEvents(l,i?o.Event.MOUSE_UP:o.Event.RIGHT_MOUSE_UP),p=i?this.preDowns:this.preRightDowns,a=this.getTouchFromArr(n,p)){var v,g=s.Browser.now();if(v=g-this._lastClickTime<300,this._lastClickTime=g,e==a.tar)d=l;else for(h=this.getEles(a.tar,null,t._oldArr),(d=t._newArr).length=0,f=h.length,c=0;c<f;c++)_=h[c],(0,r.default)(l).call(l,_)>=0&&d.push(_);d.length>0&&this.sendEvents(d,i?o.Event.CLICK:o.Event.RIGHT_CLICK),i&&v&&this.sendEvents(d,o.Event.DOUBLE_CLICK),this.removeTouchFromArr(n,p),a.tar=null,u.Pool.recover("TouchData",a)}(a=this.getTouchFromArr(n,this.preOvers))&&y&&((d=this.getEles(a.tar,null,d))&&d.length>0&&this.sendEvents(d,o.Event.MOUSE_OUT),this.removeTouchFromArr(n,this.preOvers),a.tar=null,u.Pool.recover("TouchData",a)),this._clearTempArrs()}}}],n&&c(e.prototype,n),a&&c(e,a),t}();e.TouchManager=f,f.I=new f,f._oldArr=[],f._newArr=[],f._tEleArr=[]},9538:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.BlurFilter=void 0;var h=d(n(85507)),c=d(n(21611)),f=n(81114),_=n(96581);function d(t){return t&&t.__esModule?t:{default:t}}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function v(t,e){return v=a||function(t,e){return t.__proto__=e,t},v(t,e)}function g(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b(t);if(e){var a=b(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return m(this,n)}}function m(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function b(t){return b=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},b(t)}var T=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(a,t);var e,n,i,r=g(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;return p(this,a),(t=r.call(this)).strength_sig2_2sig2_gauss1=[],t.strength=e,t._glRender=new _.BlurFilterGLRender,t}return e=a,(n=[{key:"type",get:function(){return f.Filter.BLUR}},{key:"getStrenth_sig2_2sig2_native",value:function(){this.strength_sig2_native||(this.strength_sig2_native=new Float32Array(4));var t=this.strength/3,e=t*t;return this.strength_sig2_native[0]=this.strength,this.strength_sig2_native[1]=e,this.strength_sig2_native[2]=2*e,this.strength_sig2_native[3]=1/(2*Math.PI*e),this.strength_sig2_native}}])&&y(e.prototype,n),i&&y(e,i),a}(f.Filter);e.BlurFilter=T},96581:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.BlurFilterGLRender=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(81114),o=n(18008),s=n(43989),u=n(22245);function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var h=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,(n=[{key:"render",value:function(t,e,n,i,r){var a=u.Value2D.create(s.ShaderDefines2D.TEXTURE2D,0);this.setShaderInfo(a,r,t.width,t.height),e.drawTarget(t,0,0,n,i,o.Matrix.EMPTY.identity(),a)}},{key:"setShaderInfo",value:function(e,n,i,r){e.defines.add(a.Filter.BLUR);var o=e;t.blurinfo[0]=i,t.blurinfo[1]=r,o.blurInfo=t.blurinfo;var s=n.strength/3,u=s*s;n.strength_sig2_2sig2_gauss1[0]=n.strength,n.strength_sig2_2sig2_gauss1[1]=u,n.strength_sig2_2sig2_gauss1[2]=2*u,n.strength_sig2_2sig2_gauss1[3]=1/(2*Math.PI*u),o.strength_sig2_2sig2_gauss1=n.strength_sig2_2sig2_gauss1}}])&&l(e.prototype,n),i&&l(e,i),t}();e.BlurFilterGLRender=h,h.blurinfo=new Array(2)},20084:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.ColorFilter=void 0;var h=y(n(77766)),c=y(n(3649)),f=y(n(85507)),_=y(n(21611)),d=n(81114),p=n(13104);function y(t){return t&&t.__esModule?t:{default:t}}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function m(t,e){return m=a||function(t,e){return t.__proto__=e,t},m(t,e)}function b(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return T(this,n)}}function T(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function x(t){return x=f.default?_.default:function(t){return t.__proto__||(0,_.default)(t)},x(t)}var w=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(a,t);var e,n,i,r=b(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return v(this,a),t=r.call(this),e||(e=t._copyMatrix(a.IDENTITY_MATRIX)),t._mat=new Float32Array(16),t._alpha=new Float32Array(4),t.setByMatrix(e),t}return e=a,n=[{key:"gray",value:function(){return this.setByMatrix(a.GRAY_MATRIX)}},{key:"color",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return this.setByMatrix([1,0,0,0,t,0,1,0,0,e,0,0,1,0,n,0,0,0,1,i])}},{key:"setColor",value:function(t){var e=p.ColorUtils.create(t).arrColor,n=[0,0,0,0,256*e[0],0,0,0,0,256*e[1],0,0,0,0,256*e[2],0,0,0,1,0];return this.setByMatrix(n)}},{key:"setByMatrix",value:function(t){this._matrix!=t&&this._copyMatrix(t);for(var e=0,n=0,i=0;i<20;i++)i%5!=4?this._mat[e++]=t[i]:this._alpha[n++]=t[i];return this}},{key:"type",get:function(){return d.Filter.COLOR}},{key:"adjustColor",value:function(t,e,n,i){return this.adjustHue(i),this.adjustContrast(e),this.adjustBrightness(t),this.adjustSaturation(n),this}},{key:"adjustBrightness",value:function(t){return 0==(t=this._clampValue(t,100))||isNaN(t)?this:this._multiplyMatrix([1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0,0,0,0,0,1])}},{key:"adjustContrast",value:function(t){if(0==(t=this._clampValue(t,100))||isNaN(t))return this;var e,n=(e=t<0?127+t/100*127:127*(e=0==(e=t%1)?a.DELTA_INDEX[t]:a.DELTA_INDEX[t<<0]*(1-e)+a.DELTA_INDEX[1+(t<<0)]*e)+127)/127,i=.5*(127-e);return this._multiplyMatrix([n,0,0,0,i,0,n,0,0,i,0,0,n,0,i,0,0,0,1,0,0,0,0,0,1])}},{key:"adjustSaturation",value:function(t){if(0==(t=this._clampValue(t,100))||isNaN(t))return this;var e=1+(t>0?3*t/100:t/100),n=1-e,i=.3086*n,r=.6094*n,a=.082*n;return this._multiplyMatrix([i+e,r,a,0,0,i,r+e,a,0,0,i,r,a+e,0,0,0,0,0,1,0,0,0,0,0,1])}},{key:"adjustHue",value:function(t){if(0==(t=this._clampValue(t,180)/180*Math.PI)||isNaN(t))return this;var e=Math.cos(t),n=Math.sin(t),i=.213,r=.715,a=.072;return this._multiplyMatrix([i+e*(1-i)+n*-i,r+e*-r+n*-r,a+e*-a+n*(1-a),0,0,i+e*-i+.143*n,r+e*(1-r)+.14*n,a+e*-a+-.283*n,0,0,i+e*-i+-.787*n,r+e*-r+n*r,a+e*(1-a)+n*a,0,0,0,0,0,1,0,0,0,0,0,1])}},{key:"reset",value:function(){return this.setByMatrix(this._copyMatrix(a.IDENTITY_MATRIX))}},{key:"_multiplyMatrix",value:function(t){var e=[];this._matrix=this._fixMatrix(this._matrix);for(var n=0;n<5;n++){for(var i=0;i<5;i++)e[i]=this._matrix[i+5*n];for(i=0;i<5;i++){for(var r=0,a=0;a<5;a++)r+=t[i+5*a]*e[a];this._matrix[i+5*n]=r}}return this.setByMatrix(this._matrix)}},{key:"_clampValue",value:function(t,e){return Math.min(e,Math.max(-e,t))}},{key:"_fixMatrix",value:function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null==n?a.IDENTITY_MATRIX:(n.length<a.LENGTH?n=(0,h.default)(t=(0,c.default)(n).call(n,0,n.length)).call(t,(0,c.default)(e=a.IDENTITY_MATRIX).call(e,n.length,a.LENGTH)):n.length>a.LENGTH&&(n=(0,c.default)(n).call(n,0,a.LENGTH)),n)}},{key:"_copyMatrix",value:function(t){var e=a.LENGTH;this._matrix||(this._matrix=[]);for(var n=0;n<e;n++)this._matrix[n]=t[n];return this._matrix}}],n&&g(e.prototype,n),i&&g(e,i),a}(d.Filter);e.ColorFilter=w,w.DELTA_INDEX=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],w.GRAY_MATRIX=[.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0],w.IDENTITY_MATRIX=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],w.LENGTH=25},81114:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Filter=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(18008),o=n(85399),s=n(98693),u=n(93894),l=n(95453),h=n(91700),c=n(43989),f=n(22245),_=n(69153);function d(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var p=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,(n=[{key:"type",get:function(){return-1}}])&&d(e.prototype,n),i&&d(e,i),t}();e.Filter=p,p.BLUR=16,p.COLOR=32,p.GLOW=8,p._filter=function(t,e,n,i){var r=e,d=this._next;if(d){var y=t.filters,v=y.length;if(1==v&&y[0].type==p.COLOR)return e.save(),e.setColorFilter(y[0]),d._fun.call(d,t,e,n,i),void e.restore();var g,m=f.Value2D.create(c.ShaderDefines2D.TEXTURE2D,0),b=o.Point.TEMP,T=r._curMat,x=a.Matrix.create();T.copyTo(x);var w=0,k=0,C=null,E=t._cacheStyle.filterCache||null;if(E&&0==t.getRepaint()){if((t._isHaveGlowFilter()||!1)&&(w=50,k=25),(g=t.getBounds()).width<=0||g.height<=0)return;g.width+=w+8,g.height+=w+8,g.x-=t.pivotX+4,g.y-=t.pivotY+4,b.x=g.x*x.a+g.y*x.c,b.y=g.y*x.d+g.x*x.b,g.x=b.x,g.y=b.y,b.x=g.width*x.a+g.height*x.c,b.y=g.height*x.d+g.width*x.b,g.width=b.x,g.height=b.y}else{t._isHaveGlowFilter()&&(w=50,k=25),(g=new s.Rectangle).copyFrom(t.getSelfBounds()),g.x+=t.x,g.y+=t.y,g.x-=t.pivotX+4,g.y-=t.pivotY+4;var S=g.x,M=g.y;if(g.width+=w+8,g.height+=w+8,b.x=g.x*x.a+g.y*x.c,b.y=g.y*x.d+g.x*x.b,g.x=b.x,g.y=b.y,b.x=g.width*x.a+g.height*x.c,b.y=g.height*x.d+g.width*x.b,g.width=b.x,g.height=b.y,g.width<=0||g.height<=0)return;E&&l.WebGLRTMgr.releaseRT(E),C=l.WebGLRTMgr.getRT(g.width,g.height);var L=E=l.WebGLRTMgr.getRT(g.width,g.height);t._getCacheStyle().filterCache=E,r.pushRT(),r.useRT(C);var R=t.x-S+k,I=t.y-M+k;d._fun.call(d,t,e,R,I),r.useRT(L);for(var A=0;A<v;A++){0!=A&&(r.useRT(C),r.drawTarget(L,0,0,g.width,g.height,a.Matrix.TEMP.identity(),m,null,h.BlendMode.TOINT.overlay),r.useRT(L));var D=y[A];switch(D.type){case p.BLUR:case p.GLOW:D._glRender&&D._glRender.render(C,e,g.width,g.height,D);break;case p.COLOR:r.setColorFilter(D),r.drawTarget(C,0,0,g.width,g.height,a.Matrix.EMPTY.identity(),f.Value2D.create(c.ShaderDefines2D.TEXTURE2D,0)),r.setColorFilter(null)}}r.popRT()}if(n=n-k-t.x,i=i-k-t.y,b.setTo(n,i),x.transformPoint(b),n=b.x+g.x,i=b.y+g.y,r._drawRenderTexture(E,n,i,g.width,g.height,a.Matrix.TEMP.identity(),1,u.RenderTexture2D.defuv),C){var B=_.SubmitCMD.create([C],(function(t){t.destroy()}),this);C=null,e.addRenderObject(B)}x.destroy()}}},12677:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.GlowFilter=void 0;var h=y(n(85507)),c=y(n(21611)),f=n(81114),_=n(63483),d=n(13104),p=n(9538);function y(t){return t&&t.__esModule?t:{default:t}}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function m(t,e){return m=a||function(t,e){return t.__proto__=e,t},m(t,e)}function b(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return T(this,n)}}function T(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function x(t){return x=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},x(t)}var w=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(a,t);var e,n,i,r=b(a);function a(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6;return v(this,a),(e=r.call(this))._elements=new Float32Array(9),e._sv_blurInfo1=new Array(4),e._sv_blurInfo2=[0,0,1,0],e._color=new d.ColorUtils(t),e.blur=Math.min(n,20),e.offX=i,e.offY=o,e._sv_blurInfo1[0]=e._sv_blurInfo1[1]=e.blur,e._sv_blurInfo1[2]=i,e._sv_blurInfo1[3]=-o,e._glRender=new _.GlowFilterGLRender,e}return e=a,(n=[{key:"type",get:function(){return p.BlurFilter.GLOW}},{key:"offY",get:function(){return this._elements[6]},set:function(t){this._elements[6]=t,this._sv_blurInfo1[3]=-t}},{key:"offX",get:function(){return this._elements[5]},set:function(t){this._elements[5]=t,this._sv_blurInfo1[2]=t}},{key:"getColor",value:function(){return this._color.arrColor}},{key:"blur",get:function(){return this._elements[4]},set:function(t){this._elements[4]=t,this._sv_blurInfo1[0]=this._sv_blurInfo1[1]=t}},{key:"getColorNative",value:function(){this._color_native||(this._color_native=new Float32Array(4));var t=this.getColor();return this._color_native[0]=t[0],this._color_native[1]=t[1],this._color_native[2]=t[2],this._color_native[3]=t[3],this._color_native}},{key:"getBlurInfo1Native",value:function(){return this._blurInof1_native||(this._blurInof1_native=new Float32Array(4)),this._blurInof1_native[0]=this._blurInof1_native[1]=this.blur,this._blurInof1_native[2]=this.offX,this._blurInof1_native[3]=this.offY,this._blurInof1_native}},{key:"getBlurInfo2Native",value:function(){return this._blurInof2_native||(this._blurInof2_native=new Float32Array(4)),this._blurInof2_native[2]=1,this._blurInof2_native}}])&&g(e.prototype,n),i&&g(e,i),a}(f.Filter);e.GlowFilter=w},63483:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.GlowFilterGLRender=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(18008),o=n(43989),s=n(22245);function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,(n=[{key:"setShaderInfo",value:function(t,e,n,i){t.defines.add(i.type);var r=t;r.u_blurInfo1=i._sv_blurInfo1;var a=i._sv_blurInfo2;a[0]=e,a[1]=n,r.u_blurInfo2=a,r.u_color=i.getColor()}},{key:"render",value:function(t,e,n,i,r){var u=n,l=i,h=s.Value2D.create(o.ShaderDefines2D.TEXTURE2D,0);this.setShaderInfo(h,u,l,r);var c=s.Value2D.create(o.ShaderDefines2D.TEXTURE2D,0),f=a.Matrix.TEMP.identity();e.drawTarget(t,0,0,u,l,f,h),e.drawTarget(t,0,0,u,l,f,c)}}])&&u(e.prototype,n),i&&u(e,i),t}();e.GlowFilterGLRender=l},26861:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.HTMLBrElement=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(65202),o=n(89364),s=n(64210),u=n(17661),l=n(92493),h=n(23835);function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var f=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,(n=[{key:"_addToLayout",value:function(t){t.push(this)}},{key:"reset",value:function(){return this}},{key:"destroy",value:function(){s.Pool.recover(a.HTMLElement.getClassName(this),this.reset())}},{key:"_setParent",value:function(t){}},{key:"parent",set:function(t){}},{key:"URI",set:function(t){}},{key:"href",set:function(t){}},{key:"_getCSSStyle",value:function(){return t.brStyle||(t.brStyle=new o.HTMLStyle,t.brStyle.setLineElement(!0),t.brStyle.block=!0),t.brStyle}},{key:"renderSelfToGraphic",value:function(t,e,n,i){}}])&&c(e.prototype,n),i&&c(e,i),t}();e.HTMLBrElement=f,u.IHtml.HTMLBrElement=f,l.ILaya.regClass(f),h.ClassUtils.regClass("laya.html.dom.HTMLBrElement",f),h.ClassUtils.regClass("Laya.HTMLBrElement",f)},22825:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.HTMLDivElement=void 0;var f=T(n(85507)),_=T(n(21611)),d=n(79386),p=n(78362),y=n(89662),v=n(41107),g=n(17661),m=n(23216),b=n(23835);function T(t){return t&&t.__esModule?t:{default:t}}function x(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function w(){return w="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=k(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},w.apply(this,arguments)}function k(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=L(t)););return t}function C(t,e){return C=a||function(t,e){return t.__proto__=e,t},C(t,e)}function E(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=L(t);if(e){var a=L(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return S(this,n)}}function S(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return M(t)}function M(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function L(t){return L=f.default?_.default:function(t){return t.__proto__||(0,_.default)(t)},L(t)}var R=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&C(t,e)}(a,t);var e,n,i,r=E(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this))._recList=[],t._repaintState=0,t._element=new d.HTMLDivParser,t._element.repaintHandler=new v.Handler(M(t),t._htmlDivRepaint),t.mouseEnabled=!0,t.on(y.Event.CLICK,M(t),t._onMouseClick),t}return e=a,n=[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._element&&this._element.reset(),this._element=null,this._doClears(),w(L(a.prototype),"destroy",this).call(this,t)}},{key:"_htmlDivRepaint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t?this._repaintState<2&&(this._repaintState=2):this._repaintState<1&&(this._repaintState=1),this._repaintState>0&&this._setGraphicDirty()}},{key:"_updateGraphicWork",value:function(){switch(this._repaintState){case 1:this._updateGraphic();break;case 2:this._refresh()}}},{key:"_setGraphicDirty",value:function(){this.callLater(this._updateGraphicWork)}},{key:"_doClears",value:function(){if(this._recList){var t,e=this._recList.length;for(t=0;t<e;t++)this._recList[t].recover();this._recList.length=0}}},{key:"_updateGraphic",value:function(){this._doClears(),this.graphics.clear(!0),this._repaintState=0,this._element.drawToGraphic(this.graphics,-this._element.x,-this._element.y,this._recList);var t=this._element.getBounds();t&&this.setSelfBounds(t),this.size(t.width,t.height)}},{key:"style",get:function(){return this._element.style}},{key:"innerHTML",set:function(t){this._innerHTML!=t&&(this._repaintState=1,this._innerHTML=t,this._element.innerHTML=t,this._setGraphicDirty())}},{key:"_refresh",value:function(){this._repaintState=1,this._innerHTML&&(this._element.innerHTML=this._innerHTML),this._setGraphicDirty()}},{key:"width",get:function(){return this._element.width},set:function(t){this._element.width=t}},{key:"height",get:function(){return this._element.height},set:function(t){this._element.height=t}},{key:"contextWidth",get:function(){return this._element.contextWidth}},{key:"contextHeight",get:function(){return this._element.contextHeight}},{key:"_onMouseClick",value:function(){var t,e,n,i=this.mouseX,r=this.mouseY;for(e=this._recList.length,t=0;t<e;t++)(n=this._recList[t]).rec.contains(i,r)&&this._eventLink(n.href)}},{key:"_eventLink",value:function(t){this.event(y.Event.LINK,[t])}}],n&&x(e.prototype,n),i&&x(e,i),a}(p.Sprite);e.HTMLDivElement=R,g.IHtml.HTMLDivElement=R,g.IHtml.HTMLParse=m.HTMLParse,b.ClassUtils.regClass("laya.html.dom.HTMLDivElement",R),b.ClassUtils.regClass("Laya.HTMLDivElement",R)},79386:function(t,e,n){"use strict";function i(t){return i="function"==typeof c&&"symbol"==typeof f?function(t){return typeof t}:function(t){return t&&"function"==typeof c&&t.constructor===c&&t!==c.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(9705),c=n(65420),f=n(98341);l(e,"__esModule",{value:!0}),e.HTMLDivParser=void 0;var _=C(n(78914)),d=C(n(85507)),p=C(n(21611)),y=n(65202),v=n(61391),g=n(47076),m=n(89364),b=n(211),T=n(98693),x=n(17661),w=n(92493),k=n(23835);function C(t){return t&&t.__esModule?t:{default:t}}function E(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function S(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function M(t,e,n,i){return M="undefined"!=typeof Reflect&&h?h:function(t,e,n,i){var r,a=I(t,e);if(a){if((r=u(a,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=u(i,e)){if(!r.writable)return!1;r.value=n,l(i,e,r)}else!function(t,e,n){e in t?l(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0},M(t,e,n,i)}function L(t,e,n,i,r){if(!M(t,e,n,i||t)&&r)throw new Error("failed to set property");return n}function R(){return R="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=I(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},R.apply(this,arguments)}function I(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=P(t)););return t}function A(t,e){return A=a||function(t,e){return t.__proto__=e,t},A(t,e)}function D(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=P(t);if(e){var a=P(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return B(this,n)}}function B(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function P(t){return P=d.default?p.default:function(t){return t.__proto__||(0,p.default)(t)},P(t)}var O=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&A(t,e)}(a,t);var e,n,i,r=D(a);function a(){var t;return E(this,a),(t=r.apply(this,arguments)).repaintHandler=null,t}return e=a,n=[{key:"reset",value:function(){return v.HTMLStyleElement,g.HTMLLinkElement,R(P(a.prototype),"reset",this).call(this),this._style.block=!0,this._style.setLineElement(!0),this._style.width=200,this._style.height=200,this.repaintHandler=null,this.contextHeight=0,this.contextWidth=0,this}},{key:"innerHTML",set:function(t){this.destroyChildren(),this.appendHTML(t)}},{key:"width",get:function(){return this._width?this._width:this.contextWidth},set:function(t){var e;e=0===t?t!=this._width:t!=this.width,L(P(a.prototype),"width",t,this,!0),e&&this.layout()}},{key:"appendHTML",value:function(t){x.IHtml.HTMLParse.parse(this,t,this.URI),this.layout()}},{key:"_addChildsToLayout",value:function(t){var e=this._getWords();if(null==e&&(!this._children||0==this._children.length))return!1;e&&(0,_.default)(e).call(e,(function(e){t.push(e)}));for(var n=!0,i=0,r=this._children.length;i<r;i++){var a=this._children[i];n?n=!1:t.push(null),a._addToLayout(t)}return!0}},{key:"_addToLayout",value:function(t){this.layout(),!this.style.absolute&&t.push(this)}},{key:"getBounds",value:function(){return this._htmlBounds?(this._boundsRec||(this._boundsRec=T.Rectangle.create()),this._boundsRec.copyFrom(this._htmlBounds)):null}},{key:"parentRepaint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];R(P(a.prototype),"parentRepaint",this).call(this),this.repaintHandler&&this.repaintHandler.runWith(t)}},{key:"layout",value:function(){this.style._type|=m.HTMLStyle.ADDLAYOUTED;var t=b.Layout.layout(this);if(t){this._htmlBounds||(this._htmlBounds=T.Rectangle.create());var e=this._htmlBounds;e.x=e.y=0,e.width=this.contextWidth=t[0],e.height=this.contextHeight=t[1]}}},{key:"height",get:function(){return this._height?this._height:this.contextHeight},set:function(t){L(P(a.prototype),"height",t,this,!0)}}],n&&S(e.prototype,n),i&&S(e,i),a}(y.HTMLElement);e.HTMLDivParser=O,x.IHtml.HTMLDivParser=O,w.ILaya.regClass(O),k.ClassUtils.regClass("laya.html.dom.HTMLDivParser",O),k.ClassUtils.regClass("Laya.HTMLDivParser",O)},74412:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.HTMLDocument=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(89364),o=n(23835);function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.all={},this.styleSheets=a.HTMLStyle.styleSheets}var e,n,i;return e=t,(n=[{key:"getElementById",value:function(t){return this.all[t]}},{key:"setElementById",value:function(t,e){this.all[t]=e}}])&&s(e.prototype,n),i&&s(e,i),t}();e.HTMLDocument=u,u.document=new u,o.ClassUtils.regClass("laya.html.dom.HTMLDocument",u),o.ClassUtils.regClass("Laya.HTMLDocument",u)},65202:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.HTMLElementType=e.HTMLElement=void 0;var i,r=b(n(78914)),a=b(n(92762)),o=b(n(31238)),s=b(n(94198)),u=b(n(81643)),l=b(n(63978)),h=n(74412),c=n(94294),f=n(89364),_=n(211),d=n(84935),p=n(25810),y=n(64210),v=n(92493),g=n(17661),m=n(23835);function b(t){return t&&t.__esModule?t:{default:t}}function T(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,l.default)(t,i.key,i)}}e.HTMLElementType=i,function(t){t[t.BASE=0]="BASE",t[t.IMAGE=1]="IMAGE"}(i||(e.HTMLElementType=i={}));var x=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.eletype=i.BASE,this._creates(),this.reset()}var e,n,l;return e=t,n=[{key:"_creates",value:function(){this._style=f.HTMLStyle.create()}},{key:"reset",value:function(){if(this.URI=null,this.parent=null,this._style.reset(),this._style.ower=this,this._style.valign="middle",this._text&&this._text.words){var e,n,i,r=this._text.words;for(n=r.length,e=0;e<n;e++)(i=r[e])&&i.recover()}return this._text=t._EMPTYTEXT,this._children&&(this._children.length=0),this._x=this._y=this._width=this._height=0,this}},{key:"_getCSSStyle",value:function(){return this._style}},{key:"_addChildsToLayout",value:function(t){var e,n=this._getWords();if(null==n&&(!this._children||0==this._children.length))return!1;if(n)for(var i=0,a=n.length;i<a;i++)t.push(n[i]);return this._children&&(0,r.default)(e=this._children).call(e,(function(e,n,i){var r=e._style;r._enableLayout&&r._enableLayout()&&e._addToLayout(t)})),!0}},{key:"_addToLayout",value:function(t){if(this._style){var e=this._style;e.absolute||(e.block?t.push(this):this._addChildsToLayout(t)&&(this.x=this.y=0))}}},{key:"id",set:function(t){h.HTMLDocument.document.setElementById(t,this)}},{key:"repaint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.parentRepaint(t)}},{key:"parentRepaint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.parent&&this.parent.repaint(t)}},{key:"innerTEXT",get:function(){return this._text.text},set:function(e){this._text===t._EMPTYTEXT?this._text={text:e,words:null}:(this._text.text=e,this._text.words&&(this._text.words.length=0)),this.repaint()}},{key:"_setParent",value:function(e){if(e instanceof t){var n=e;this.URI||(this.URI=n.URI),this.style&&this.style.inherit(n.style)}}},{key:"appendChild",value:function(t){return this.addChild(t)}},{key:"addChild",value:function(t){return t.parent&&t.parent.removeChild(t),this._children||(this._children=[]),this._children.push(t),t.parent=this,t._setParent(this),this.repaint(),t}},{key:"removeChild",value:function(t){if(!this._children)return null;var e,n;for(n=this._children.length,e=0;e<n;e++){var i;if(this._children[e]==t)return(0,a.default)(i=this._children).call(i,e,1),t}return null}},{key:"destroy",value:function(){this._children&&(this.destroyChildren(),this._children.length=0),y.Pool.recover(t.getClassName(this),this.reset())}},{key:"destroyChildren",value:function(){if(this._children){for(var t=this._children.length-1;t>-1;t--)this._children[t].destroy();this._children.length=0}}},{key:"style",get:function(){return this._style}},{key:"_getWords",value:function(){if(!this._text)return null;var t=this._text.text;if(!t||0===t.length)return null;var e,n=this._text.words;if(n&&n.length===t.length)return n;null===n&&(this._text.words=n=[]),n.length=t.length;for(var i=this.style,r=i.font,a=0,o=t.length;a<o;a++)e=v.ILaya.Browser.measureText(t.charAt(a),r),n[a]=p.HTMLChar.create().setData(t.charAt(a),e.width,e.height||i.fontSize,i);return n}},{key:"_isChar",value:function(){return!1}},{key:"_layoutLater",value:function(){var t=this.style;t._type&f.HTMLStyle.ADDLAYOUTED||(t.widthed(this)&&(this._children&&this._children.length>0||null!=this._getWords())&&t.block?(_.Layout.later(this),t._type|=f.HTMLStyle.ADDLAYOUTED):this.parent&&this.parent._layoutLater())}},{key:"x",get:function(){return this._x},set:function(t){this._x!=t&&(this._x=t,this.parentRepaint())}},{key:"y",get:function(){return this._y},set:function(t){this._y!=t&&(this._y=t,this.parentRepaint())}},{key:"width",get:function(){return this._width},set:function(t){this._width!==t&&(this._width=t,this.repaint())}},{key:"height",get:function(){return this._height},set:function(t){this._height!==t&&(this._height=t,this.repaint())}},{key:"_setAttributes",value:function(t,e){switch(t){case"style":this.style.cssText(e);break;case"class":this.className=e;break;case"x":this.x=(0,o.default)(e);break;case"y":this.y=(0,o.default)(e);break;case"width":this.width=(0,o.default)(e);break;case"height":this.height=(0,o.default)(e);break;default:this[t]=e}}},{key:"href",get:function(){return this._style?this._style.href:null},set:function(t){this._style&&t!=this._style.href&&(this._style.href=t,this.repaint())}},{key:"formatURL",value:function(e){return this.URI?t.formatURL1(e,this.URI?this.URI.path:null):e}},{key:"color",set:function(t){this.style.color=t}},{key:"className",set:function(t){this.style.attrs(h.HTMLDocument.document.styleSheets["."+t])}},{key:"drawToGraphic",value:function(t,e,n,i){e+=this.x,n+=this.y;var r,a,o,s=this.style;if(s.paddingLeft&&(e+=s.paddingLeft),s.paddingTop&&(n+=s.paddingTop),(null!=s.bgColor||s.borderColor)&&t.drawRect(e,n,this.width,this.height,s.bgColor,s.borderColor,1),this.renderSelfToGraphic(t,e,n,i),this._children&&this._children.length>0)for(a=this._children.length,r=0;r<a;r++)null!=(o=this._children[r]).drawToGraphic&&o.drawToGraphic(t,e,n,i)}},{key:"renderSelfToGraphic",value:function(t,e,n,i){var r=this.style,a=this._getWords();if(a&&(a.length,r)){var o=r.font,u=r.color;if(r.stroke){var l=r.stroke;l=(0,s.default)(l);var h=r.strokeColor;t.fillBorderWords(a,e,n,o,u,h,l)}else t.fillWords(a,e,n,o,u);if(this.href){var f=a[a.length-1],_=f.y+f.height;if(f.y==a[0].y){"none"!=r.textDecoration&&t.drawLine(a[0].x,_,f.x+f.width,_,u,1);var d=c.HTMLHitRect.create();d.rec.setTo(a[0].x,f.y,f.x+f.width-a[0].x,f.height),d.href=this.href,i.push(d)}else this.workLines(a,t,i)}}}},{key:"workLines",value:function(t,e,n){var i;i="none"!=this.style.textDecoration;var r,a,o,s=0;if(r=t.length,o=a=t[s],a){var u;for(s=1;s<r;s++)(u=t[s]).y!=a.y?(this.createOneLine(a,o,i,e,n),a=u,o=u):o=u;this.createOneLine(a,o,i,e,n)}}},{key:"createOneLine",value:function(t,e,n,i,r){var a=e.y+e.height;n&&i.drawLine(t.x,a,e.x+e.width,a,this.style.color,1);var o=c.HTMLHitRect.create();o.rec.setTo(t.x,e.y,e.x+e.width-t.x,e.height),o.href=this.href,r.push(o)}}],l=[{key:"formatURL1",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t)return"null path";if(e||(e=d.URL.basePath),(0,u.default)(t).call(t,":")>0)return t;if(null!=d.URL.customFormat&&(t=d.URL.customFormat(t)),(0,u.default)(t).call(t,":")>0)return t;var n=t.charAt(0);if("."===n)return d.URL._formatRelativePath(e+t);if("~"===n)return d.URL.rootPath+t.substring(1);if("d"===n){if(0===(0,u.default)(t).call(t,"data:image"))return t}else if("/"===n)return t;return e+t}},{key:"getClassName",value:function(t){return t instanceof Function?t.name:t.constructor.name}}],n&&T(e.prototype,n),l&&T(e,l),t}();e.HTMLElement=x,x._EMPTYTEXT={text:null,words:null},v.ILaya.regClass(x),g.IHtml.HTMLElementType=i,m.ClassUtils.regClass("laya.html.dom.HTMLElement",x),m.ClassUtils.regClass("Laya.HTMLElement",x)},94294:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.HTMLHitRect=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(98693),o=n(64210),s=n(23835);function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rec=new a.Rectangle,this.reset()}var e,n,i;return e=t,i=[{key:"create",value:function(){return o.Pool.getItemByClass("HTMLHitRect",t)}}],(n=[{key:"reset",value:function(){return this.rec.reset(),this.href=null,this}},{key:"recover",value:function(){o.Pool.recover("HTMLHitRect",this.reset())}}])&&u(e.prototype,n),i&&u(e,i),t}();e.HTMLHitRect=l,s.ClassUtils.regClass("laya.html.dom.HTMLHitRect",l),s.ClassUtils.regClass("Laya.HTMLHitRect",l)},32635:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.HTMLImageElement=void 0;var f=T(n(85507)),_=T(n(21611)),d=n(65202),p=n(89662),y=n(85096),v=n(54598),g=n(17661),m=n(92493),b=n(23835);function T(t){return t&&t.__esModule?t:{default:t}}function x(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function w(){return w="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=k(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},w.apply(this,arguments)}function k(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=M(t)););return t}function C(t,e){return C=a||function(t,e){return t.__proto__=e,t},C(t,e)}function E(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=M(t);if(e){var a=M(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return S(this,n)}}function S(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function M(t){return M=f.default?_.default:function(t){return t.__proto__||(0,_.default)(t)},M(t)}var L=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&C(t,e)}(a,t);var e,n,i,r=E(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this)).eletype=d.HTMLElementType.IMAGE,t}return e=a,(n=[{key:"reset",value:function(){return w(M(a.prototype),"reset",this).call(this),this._tex&&this._tex.off(p.Event.LOADED,this,this.onloaded),this._tex=null,this._url=null,this}},{key:"src",set:function(t){if(t=this.formatURL(t),this._url!==t){this._url=t;var e=this._tex=y.Loader.getRes(t);e||(this._tex=e=new v.Texture,e.load(t),y.Loader.cacheTexture(t,e)),e.getIsReady()?this.onloaded():e.once(p.Event.READY,this,this.onloaded)}}},{key:"onloaded",value:function(){if(this._style){var t=this._style;t.widthed(this)||this._tex.width,t.heighted(this)||this._tex.height,t.widthed(this)||this._width==this._tex.width||(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),t.heighted(this)||this._height==this._tex.height||(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),this.repaint()}}},{key:"_addToLayout",value:function(t){!this._style.absolute&&t.push(this)}},{key:"renderSelfToGraphic",value:function(t,e,n,i){this._tex&&t.drawImage(this._tex,e,n,this.width||this._tex.width,this.height||this._tex.height)}}])&&x(e.prototype,n),i&&x(e,i),a}(d.HTMLElement);e.HTMLImageElement=L,g.IHtml.HTMLImageElement=L,m.ILaya.regClass(L),b.ClassUtils.regClass("laya.html.dom.HTMLImageElement",L),b.ClassUtils.regClass("Laya.HTMLImageElement",L)},47076:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.HTMLLinkElement=void 0;var f=T(n(85507)),_=T(n(21611)),d=n(65202),p=n(85096),y=n(89662),v=n(89364),g=n(84935),m=n(92493),b=n(23835);function T(t){return t&&t.__esModule?t:{default:t}}function x(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function k(){return k="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=C(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},k.apply(this,arguments)}function C(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=L(t)););return t}function E(t,e){return E=a||function(t,e){return t.__proto__=e,t},E(t,e)}function S(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=L(t);if(e){var a=L(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return M(this,n)}}function M(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function L(t){return L=f.default?_.default:function(t){return t.__proto__||(0,_.default)(t)},L(t)}var R=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&E(t,e)}(a,t);var e,n,i,r=S(a);function a(){return x(this,a),r.apply(this,arguments)}return e=a,(n=[{key:"_creates",value:function(){}},{key:"drawToGraphic",value:function(t,e,n,i){}},{key:"reset",value:function(){return this._loader&&this._loader.off(y.Event.COMPLETE,this,this._onload),this._loader=null,this}},{key:"_onload",value:function(t){this._loader&&(this._loader=null),"text/css"===this.type&&v.HTMLStyle.parseCSS(t,this.URI),this.repaint(!0)}},{key:"href",get:function(){return k(L(a.prototype),"href",this)},set:function(t){t&&(t=this.formatURL(t),this.URI=new g.URL(t),this._loader&&this._loader.off(y.Event.COMPLETE,this,this._onload),p.Loader.getRes(t)?"text/css"==this.type&&v.HTMLStyle.parseCSS(p.Loader.getRes(t),this.URI):(this._loader=new p.Loader,this._loader.once(y.Event.COMPLETE,this,this._onload),this._loader.load(t,p.Loader.TEXT)))}}])&&w(e.prototype,n),i&&w(e,i),a}(d.HTMLElement);e.HTMLLinkElement=R,R._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g"),m.ILaya.regClass(R),b.ClassUtils.regClass("laya.html.dom.HTMLLinkElement",R),b.ClassUtils.regClass("Laya.HTMLLinkElement",R)},61391:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.HTMLStyleElement=void 0;var f=g(n(85507)),_=g(n(21611)),d=n(65202),p=n(89364),y=n(92493),v=n(23835);function g(t){return t&&t.__esModule?t:{default:t}}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function T(){return T="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=x(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},T.apply(this,arguments)}function x(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=E(t)););return t}function w(t,e){return w=a||function(t,e){return t.__proto__=e,t},w(t,e)}function k(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=E(t);if(e){var a=E(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return C(this,n)}}function C(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function E(t){return E=f.default?_.default:function(t){return t.__proto__||(0,_.default)(t)},E(t)}var S=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}(a,t);var e,n,i,r=k(a);function a(){return m(this,a),r.apply(this,arguments)}return e=a,(n=[{key:"_creates",value:function(){}},{key:"drawToGraphic",value:function(t,e,n,i){}},{key:"reset",value:function(){return this}},{key:"innerTEXT",get:function(){return T(E(a.prototype),"innerTEXT",this)},set:function(t){p.HTMLStyle.parseCSS(t,null)}}])&&b(e.prototype,n),i&&b(e,i),a}(d.HTMLElement);e.HTMLStyleElement=S,y.ILaya.regClass(S),v.ClassUtils.regClass("laya.html.dom.HTMLStyleElement",S),v.ClassUtils.regClass("Laya.HTMLStyleElement",S)},22504:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.HTMLExtendStyle=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210),o=n(23835);function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.reset()}var e,n,i;return e=t,i=[{key:"create",value:function(){return a.Pool.getItemByClass("HTMLExtendStyle",t)}}],(n=[{key:"reset",value:function(){return this.stroke=0,this.strokeColor="#000000",this.leading=0,this.lineHeight=0,this.letterSpacing=0,this.href=null,this}},{key:"recover",value:function(){this!=t.EMPTY&&a.Pool.recover("HTMLExtendStyle",this.reset())}}])&&s(e.prototype,n),i&&s(e,i),t}();e.HTMLExtendStyle=u,u.EMPTY=new u,o.ClassUtils.regClass("laya.html.utils.HTMLExtendStyle",u),o.ClassUtils.regClass("Laya.HTMLExtendStyle",u)},23216:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.HTMLParse=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(79386),o=n(65202),s=n(64210),u=n(23835),l=n(56083),h=n(17661),c=n(26861),f=n(61391),_=n(47076),d=n(32635);function p(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var y=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"getInstance",value:function(e){var n=s.Pool.getItem(t._htmlClassMapShort[e]);return n||(n=u.ClassUtils.getInstance(e)),n}},{key:"parse",value:function(e,n,i){n=(n="<root>"+(n=n.replace(/<br>/g,"<br/>"))+"</root>").replace(t.spacePattern,t.char255);var r=l.Utils.parseXMLFromString(n);t._parseXML(e,r.childNodes[0].childNodes,i)}},{key:"_parseXML",value:function(e,n,i){var r,a,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(n.join||n.item)for(r=0,a=n.length;r<a;++r)t._parseXML(e,n[r],i,s);else{var u,l;if(3==n.nodeType){var c;if(e instanceof h.IHtml.HTMLDivParser)null==n.nodeName&&(n.nodeName="#text"),l=n.nodeName.toLowerCase(),(c=n.textContent.replace(/^\s+|\s+$/g,"")).length>0&&(u=t.getInstance(l))&&(e.addChild(u),u.innerTEXT=c.replace(t.char255AndOneSpacePattern," "));else if((c=n.textContent.replace(/^\s+|\s+$/g,"")).length>0){var f=e;if(e instanceof o.HTMLElement&&e.innerTEXT&&e.innerTEXT.length>0){var _=t.getInstance("p");_&&(e.addChild(_),f=_)}f.innerTEXT=c.replace(t.char255AndOneSpacePattern," ")}return}if("#comment"==(l=n.nodeName.toLowerCase()))return;if(u=t.getInstance(l)){"p"==l?(e.addChild(t.getInstance("br")),u=e.addChild(u),e.addChild(t.getInstance("br"))):u=e.addChild(u),u.URI=i,u.href=s;var d=n.attributes;if(d&&d.length>0)for(r=0,a=d.length;r<a;++r){var p=d[r],y=p.nodeName,v=p.value;u._setAttributes(y,v)}t._parseXML(u,n.childNodes,i,u.href)}else t._parseXML(e,n.childNodes,i,s)}}}],(n=null)&&p(e.prototype,n),i&&p(e,i),t}();e.HTMLParse=y,y.char255=String.fromCharCode(255),y.spacePattern=/&nbsp;|&#160;/g,y.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),y._htmlClassMapShort={div:a.HTMLDivParser,p:o.HTMLElement,img:d.HTMLImageElement,span:o.HTMLElement,br:c.HTMLBrElement,style:f.HTMLStyleElement,font:o.HTMLElement,a:o.HTMLElement,"#text":o.HTMLElement,link:_.HTMLLinkElement},h.IHtml.HTMLParse=y,u.ClassUtils.regClass("div",a.HTMLDivParser),u.ClassUtils.regClass("p",o.HTMLElement),u.ClassUtils.regClass("img",d.HTMLImageElement),u.ClassUtils.regClass("span",o.HTMLElement),u.ClassUtils.regClass("br",c.HTMLBrElement),u.ClassUtils.regClass("style",f.HTMLStyleElement),u.ClassUtils.regClass("font",o.HTMLElement),u.ClassUtils.regClass("a",o.HTMLElement),u.ClassUtils.regClass("#text",o.HTMLElement),u.ClassUtils.regClass("link",_.HTMLLinkElement),u.ClassUtils.regClass("laya.html.utils.HTMLParse",y),u.ClassUtils.regClass("Laya.HTMLParse",y)},89364:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.HTMLStyle=void 0;var i=h(n(81643)),r=h(n(94198)),a=h(n(63978)),o=n(22504),s=n(92493),u=n(64210),l=n(23835);function h(t){return t&&t.__esModule?t:{default:t}}function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,a.default)(t,i.key,i)}}var f=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.padding=t._PADDING,this.reset()}var e,n,a;return e=t,a=[{key:"create",value:function(){return u.Pool.getItemByClass("HTMLStyle",t)}},{key:"parseOneCSS",value:function(e,n){for(var a,o=[],s=e.split(n),u=0,l=s.length;u<l;u++){var h=s[u],c=(0,i.default)(h).call(h,":"),f=h.substr(0,c).replace(/^\s+|\s+$/g,"");if(0!==f.length){var _=h.substr(c+1).replace(/^\s+|\s+$/g,""),d=[f,_];switch(f){case"italic":case"bold":d[1]="true"==_;break;case"font-weight":"bold"==_&&(d[1]=!0,d[0]="bold");break;case"line-height":d[0]="lineHeight",d[1]=(0,r.default)(_);break;case"font-size":d[0]="fontSize",d[1]=(0,r.default)(_);break;case"stroke":d[0]="stroke",d[1]=(0,r.default)(_);break;case"padding":(a=_.split(" ")).length>1||(a[1]=a[2]=a[3]=a[0]),d[1]=[(0,r.default)(a[0]),(0,r.default)(a[1]),(0,r.default)(a[2]),(0,r.default)(a[3])];break;default:(d[0]=t._CSSTOVALUE[f])||(d[0]=f)}o.push(d)}}return o}},{key:"parseCSS",value:function(e,n){for(var i;null!=(i=t._parseCSSRegExp.exec(e));)t.styleSheets[i[1]]=t.parseOneCSS(i[2],";")}}],(n=[{key:"_getExtendStyle",value:function(){return this._extendStyle===o.HTMLExtendStyle.EMPTY&&(this._extendStyle=o.HTMLExtendStyle.create()),this._extendStyle}},{key:"href",get:function(){return this._extendStyle.href},set:function(t){t!==this._extendStyle.href&&(this._getExtendStyle().href=t)}},{key:"stroke",get:function(){return this._extendStyle.stroke},set:function(t){this._extendStyle.stroke!==t&&(this._getExtendStyle().stroke=t)}},{key:"strokeColor",get:function(){return this._extendStyle.strokeColor},set:function(t){this._extendStyle.strokeColor!==t&&(this._getExtendStyle().strokeColor=t)}},{key:"leading",get:function(){return this._extendStyle.leading},set:function(t){this._extendStyle.leading!==t&&(this._getExtendStyle().leading=t)}},{key:"lineHeight",get:function(){return this._extendStyle.lineHeight},set:function(t){this._extendStyle.lineHeight!==t&&(this._getExtendStyle().lineHeight=t)}},{key:"align",get:function(){var e=this._type&t._ALIGN;return t.align_Value[e]},set:function(e){e in t.alignVDic&&(this._type&=~t._ALIGN,this._type|=t.alignVDic[e])}},{key:"valign",get:function(){var e=this._type&t._VALIGN;return t.vAlign_Value[e]},set:function(e){e in t.alignVDic&&(this._type&=~t._VALIGN,this._type|=t.alignVDic[e])}},{key:"font",get:function(){return(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(s.ILaya.Browser.onIPhone&&s.ILaya.Text.fontFamilyMap[this.family]||this.family)},set:function(t){for(var e=t.split(" "),n=0,a=e.length;n<a;n++){var o=e[n];switch(o){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}(0,i.default)(o).call(o,"px")>0&&(this.fontSize=(0,r.default)(o),this.family=e[n+1],n++)}}},{key:"block",get:function(){return 0!=(this._type&t._CSS_BLOCK)},set:function(e){e?this._type|=t._CSS_BLOCK:this._type&=~t._CSS_BLOCK}},{key:"reset",value:function(){return this.ower=null,this._type=0,this.wordWrap=!0,this.fontSize=s.ILaya.Text.defaultFontSize,this.family=s.ILaya.Text.defaultFont,this.color="#000000",this.valign=t.VALIGN_TOP,this.padding=t._PADDING,this.bold=!1,this.italic=!1,this.align=t.ALIGN_LEFT,this.textDecoration=null,this.bgColor=null,this.borderColor=null,this._extendStyle&&this._extendStyle.recover(),this._extendStyle=o.HTMLExtendStyle.EMPTY,this}},{key:"recover",value:function(){u.Pool.recover("HTMLStyle",this.reset())}},{key:"inherit",value:function(e){var n,i,r,a;for(i=(r=t._inheritProps).length,n=0;n<i;n++)this[a=r[n]]=e[a]}},{key:"wordWrap",get:function(){return 0==(this._type&t._NOWARP)},set:function(e){e?this._type&=~t._NOWARP:this._type|=t._NOWARP}},{key:"bold",get:function(){return 0!=(this._type&t._BOLD)},set:function(e){e?this._type|=t._BOLD:this._type&=~t._BOLD}},{key:"fontWeight",get:function(){return this._type&t._BOLD?"bold":"none"},set:function(e){"bold"==e?this._type|=t._BOLD:this._type&=~t._BOLD}},{key:"italic",get:function(){return 0!=(this._type&t._ITALIC)},set:function(e){e?this._type|=t._ITALIC:this._type&=~t._ITALIC}},{key:"_widthAuto",value:function(){return 0!=(this._type&t._WIDTHAUTO)}},{key:"widthed",value:function(e){return 0!=(this._type&t._WIDTH_SET)}},{key:"whiteSpace",get:function(){return this._type&t._NOWARP?"nowrap":""},set:function(e){"nowrap"===e&&(this._type|=t._NOWARP),"none"===e&&(this._type&=~t._NOWARP)}},{key:"_calculation",value:function(t,e){return!1}},{key:"width",set:function(e){if(this._type|=t._WIDTH_SET,"string"==typeof e){var n=(0,i.default)(e).call(e,"auto");if(n>=0&&(this._type|=t._WIDTHAUTO,e=e.substr(0,n)),this._calculation("width",e))return;e=(0,r.default)(e)}this.size(e,-1)}},{key:"height",set:function(e){if(this._type|=t._HEIGHT_SET,"string"==typeof e){if(this._calculation("height",e))return;e=(0,r.default)(e)}this.size(-1,e)}},{key:"heighted",value:function(e){return 0!=(this._type&t._HEIGHT_SET)}},{key:"size",value:function(e,n){var i=this.ower,r=!1;-1!==e&&e!=i.width&&(this._type|=t._WIDTH_SET,i.width=e,r=!0),-1!==n&&n!=i.height&&(this._type|=t._HEIGHT_SET,i.height=n,r=!0),r&&i._layoutLater()}},{key:"getLineElement",value:function(){return 0!=(this._type&t._LINE_ELEMENT)}},{key:"setLineElement",value:function(e){e?this._type|=t._LINE_ELEMENT:this._type&=~t._LINE_ELEMENT}},{key:"_enableLayout",value:function(){return 0==(this._type&t._DISPLAY_NONE)&&0==(this._type&t._ABSOLUTE)}},{key:"letterSpacing",get:function(){return this._extendStyle.letterSpacing},set:function(t){"string"==typeof t&&(t=(0,r.default)(t+"")),t!=this._extendStyle.letterSpacing&&(this._getExtendStyle().letterSpacing=t)}},{key:"cssText",value:function(e){this.attrs(t.parseOneCSS(e,";"))}},{key:"attrs",value:function(t){if(t)for(var e=0,n=t.length;e<n;e++){var i=t[e];this[i[0]]=i[1]}}},{key:"position",get:function(){return this._type&t._ABSOLUTE?"absolute":""},set:function(e){"absolute"===e?this._type|=t._ABSOLUTE:this._type&=~t._ABSOLUTE}},{key:"absolute",get:function(){return 0!=(this._type&t._ABSOLUTE)}},{key:"paddingLeft",get:function(){return this.padding[3]}},{key:"paddingTop",get:function(){return this.padding[0]}}])&&c(e.prototype,n),a&&c(e,a),t}();e.HTMLStyle=f,f._CSSTOVALUE={"letter-spacing":"letterSpacing","white-space":"whiteSpace","line-height":"lineHeight","font-family":"family","vertical-align":"valign","text-decoration":"textDecoration","background-color":"bgColor","border-color":"borderColor"},f._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),f._inheritProps=["italic","align","valign","leading","letterSpacing","stroke","strokeColor","bold","fontWeight","fontSize","lineHeight","wordWrap","color"],f.ALIGN_LEFT="left",f.ALIGN_CENTER="center",f.ALIGN_RIGHT="right",f.VALIGN_TOP="top",f.VALIGN_MIDDLE="middle",f.VALIGN_BOTTOM="bottom",f.styleSheets={},f.ADDLAYOUTED=512,f._PADDING=[0,0,0,0],f._HEIGHT_SET=8192,f._LINE_ELEMENT=65536,f._NOWARP=131072,f._WIDTHAUTO=262144,f._BOLD=1024,f._ITALIC=2048,f._CSS_BLOCK=1,f._DISPLAY_NONE=2,f._ABSOLUTE=4,f._WIDTH_SET=8,f.alignVDic={left:0,center:16,right:32,top:0,middle:64,bottom:128},f.align_Value={0:"left",16:"center",32:"right"},f.vAlign_Value={0:"top",64:"middle",128:"bottom"},f._ALIGN=48,f._VALIGN=192,l.ClassUtils.regClass("laya.html.utils.HTMLStyle",f),l.ClassUtils.regClass("Laya.HTMLStyle",f)},17661:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.IHtml=void 0;var i=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)};e.IHtml=i,i.HTMLDivElement=null,i.HTMLImageElement=null,i.HTMLBrElement=null,i.HTMLDivParser=null,i.HTMLParse=null,i.HTMLElementType=null},211:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Layout=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(89364),o=n(92493),s=n(93891),u=n(17661),l=n(23835);function h(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var c=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"later",value:function(e){null==t._will&&(t._will=[],o.ILaya.stage.frameLoop(1,null,(function(){if(!(t._will.length<1)){for(var e=0;e<t._will.length;e++)t.layout(t._will[e]);t._will.length=0}}))),t._will.push(e)}},{key:"layout",value:function(e){return e&&e._style?0==(e._style._type&a.HTMLStyle.ADDLAYOUTED)?null:(e.style._type&=~a.HTMLStyle.ADDLAYOUTED,t._multiLineLayout(e)):null}},{key:"_multiLineLayout",value:function(e){var n=[];e._addChildsToLayout(n);var i,r,o,l,h,c,f,_=n.length,d=e._getCSSStyle(),p=d.letterSpacing,y=d.leading,v=d.lineHeight,g=d._widthAuto()||!d.wordWrap,m=g?999999:e.width,b=(e.height,0),T=d.italic?d.fontSize/3:0,x=d.align,w=d.valign,k=w!==a.HTMLStyle.VALIGN_TOP||x!==a.HTMLStyle.ALIGN_LEFT||0!=v,C=0,E=0,S=0,M=0,L=[],R=L[0]=new s.LayoutLine,I=!1;R.h=0,d.italic&&(m-=d.fontSize/3);var A=0,D=!0;function B(){R.y=E,E+=R.h+y,R.mWidth=A,A=0,R=new s.LayoutLine,L.push(R),R.h=0,C=0,D=!0,h=!1}for(i=0;i<_;i++)if(null!=(r=n[i]))if(D=!1,r instanceof u.IHtml.HTMLBrElement)B(),R.y=E,R.h=v;else{if(r._isChar()){if(S=(c=r).width+c.style.letterSpacing,M=c.height,c.isWord)h=I||"\n"===c.char,R.wordStartIndex=R.elements.length;else{if(L.length>0&&C+S>m&&R.wordStartIndex>0){var P;P=R.elements.length-R.wordStartIndex+1,R.elements.length=R.wordStartIndex,i-=P,B();continue}h=!1,A+=c.width}I=!1,(h=h||C+S>m)&&B(),R.minTextHeight=Math.min(R.minTextHeight,r.height)}else o=r._getCSSStyle(),f=r,l=o.padding,h=I||o.getLineElement(),S=f.width+l[1]+l[3]+o.letterSpacing,M=f.height+l[0]+l[2],I=o.getLineElement(),(h=h||C+S>m&&o.wordWrap)&&B();R.elements.push(r),R.h=Math.max(R.h,M),r.x=C,r.y=E,C+=S,R.w=C-p,R.y=E,b=Math.max(C+T,b)}else D||(C+=t.DIV_ELEMENT_PADDING),R.wordStartIndex=R.elements.length;if(E=R.y+R.h,k){var O=0,F=m;for(g&&e.width>0&&(F=e.width),i=0,_=L.length;i<_;i++)L[i].updatePos(0,F,i,O,x,w,v),O+=Math.max(v,L[i].h+y);E=O}return g&&(e.width=b),E>e.height&&(e.height=E),[b,E]}}],(n=null)&&h(e.prototype,n),i&&h(e,i),t}();e.Layout=c,c.DIV_ELEMENT_PADDING=0,l.ClassUtils.regClass("laya.html.utils.Layout",c),l.ClassUtils.regClass("Laya.Layout",c)},93891:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.LayoutLine=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(89364),o=n(17661),s=n(23835);function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.elements=[],this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0}var e,n,i;return e=t,(n=[{key:"updatePos",value:function(t,e,n,i,r,s,u){var l,h=0;this.elements.length>0&&(h=(l=this.elements[this.elements.length-1]).x+l.width-this.elements[0].x),u=u||this.h;var c,f=0;r===a.HTMLStyle.ALIGN_CENTER&&(f=(e-h)/2),r===a.HTMLStyle.ALIGN_RIGHT&&(f=e-h);for(var _=0,d=this.elements.length;_<d;_++){var p=(l=this.elements[_])._getCSSStyle();switch(0!==f&&(l.x+=f),p.valign){case"top":l.y=i;break;case"middle":var y=0;99999!=this.minTextHeight&&(y=this.minTextHeight);var v=(y+u)/2;v=Math.max(v,this.h),l.eletype,o.IHtml.HTMLElementType.IMAGE,c=i+v-l.height,l.y=c;break;case"bottom":l.y=i+(u-l.height)}}}}])&&u(e.prototype,n),i&&u(e,i),t}();e.LayoutLine=l,s.ClassUtils.regClass("laya.html.utils.LayoutLine",l),s.ClassUtils.regClass("Laya.LayoutLine",l)},33873:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.LayaGL=void 0;var i=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)};e.LayaGL=i,i.ARRAY_BUFFER_TYPE_DATA=0,i.ARRAY_BUFFER_TYPE_CMD=1,i.ARRAY_BUFFER_REF_REFERENCE=0,i.ARRAY_BUFFER_REF_COPY=1,i.UPLOAD_SHADER_UNIFORM_TYPE_ID=0,i.UPLOAD_SHADER_UNIFORM_TYPE_DATA=1},93062:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Bezier=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(85399);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._controlPoints=[new a.Point,new a.Point,new a.Point],this._calFun=this.getPoint2}var e,n,i;return e=t,n=[{key:"_switchPoint",value:function(t,e){var n=this._controlPoints.shift();n.setTo(t,e),this._controlPoints.push(n)}},{key:"getPoint2",value:function(t,e){var n=this._controlPoints[0],i=this._controlPoints[1],r=this._controlPoints[2],a=Math.pow(1-t,2)*n.x+2*t*(1-t)*i.x+Math.pow(t,2)*r.x,o=Math.pow(1-t,2)*n.y+2*t*(1-t)*i.y+Math.pow(t,2)*r.y;e.push(a,o)}},{key:"getPoint3",value:function(t,e){var n=this._controlPoints[0],i=this._controlPoints[1],r=this._controlPoints[2],a=this._controlPoints[3],o=Math.pow(1-t,3)*n.x+3*i.x*t*(1-t)*(1-t)+3*r.x*t*t*(1-t)+a.x*Math.pow(t,3),s=Math.pow(1-t,3)*n.y+3*i.y*t*(1-t)*(1-t)+3*r.y*t*t*(1-t)+a.y*Math.pow(t,3);e.push(o,s)}},{key:"insertPoints",value:function(t,e){var n,i;for(i=1/(t=t>0?t:5),n=0;n<=1;n+=i)this._calFun(n,e)}},{key:"getBezierPoints",value:function(t){var e,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if((n=t.length)<2*(r+1))return[];var o=[];switch(r){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=r;)this._controlPoints.push(a.Point.create());for(e=0;e<2*r;e+=2)this._switchPoint(t[e],t[e+1]);for(e=2*r;e<n;e+=2)this._switchPoint(t[e],t[e+1]),e/2%r==0&&this.insertPoints(i,o);return o}}],n&&o(e.prototype,n),i&&o(e,i),t}();e.Bezier=s,s.I=new s},9686:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.GrahamScan=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(85399),o=n(56083);function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"multiply",value:function(t,e,n){return(t.x-n.x)*(e.y-n.y)-(e.x-n.x)*(t.y-n.y)}},{key:"dis",value:function(t,e){return(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)}},{key:"_getPoints",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;for(t._mPointList||(t._mPointList=[]);t._mPointList.length<e;)t._mPointList.push(new a.Point);return i||(i=[]),i.length=0,n?t.getFrom(i,t._mPointList,e):t.getFromR(i,t._mPointList,e),i}},{key:"getFrom",value:function(t,e,n){var i;for(i=0;i<n;i++)t.push(e[i]);return t}},{key:"getFromR",value:function(t,e,n){var i;for(i=0;i<n;i++)t.push(e.pop());return t}},{key:"pListToPointList",value:function(e){var n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.length/2,a=t._getPoints(r,i,t._tempPointList);for(n=0;n<r;n++)a[n].setTo(e[n+n],e[n+n+1]);return a}},{key:"pointListToPlist",value:function(e){var n,i,r=e.length,a=t._temPList;for(a.length=0,n=0;n<r;n++)i=e[n],a.push(i.x,i.y);return a}},{key:"scanPList",value:function(e){return o.Utils.copyArray(e,t.pointListToPlist(t.scan(t.pListToPointList(e,!0))))}},{key:"scan",value:function(e){var n,i,r,a,s,u=0,l=e.length,h={};for((a=t._temArr).length=0,n=(l=e.length)-1;n>=0;n--)(s=(r=e[n]).x+"_"+r.y)in h||(h[s]=!0,a.push(r));for(l=a.length,o.Utils.copyArray(e,a),n=1;n<l;n++)(e[n].y<e[u].y||e[n].y==e[u].y&&e[n].x<e[u].x)&&(u=n);for(r=e[0],e[0]=e[u],e[u]=r,n=1;n<l-1;n++){for(u=n,i=n+1;i<l;i++)(t.multiply(e[i],e[u],e[0])>0||0==t.multiply(e[i],e[u],e[0])&&t.dis(e[0],e[i])<t.dis(e[0],e[u]))&&(u=i);r=e[n],e[n]=e[u],e[u]=r}if((a=t._temArr).length=0,e.length<3)return o.Utils.copyArray(a,e);for(a.push(e[0],e[1],e[2]),n=3;n<l;n++){for(;a.length>=2&&t.multiply(e[n],a[a.length-1],a[a.length-2])>=0;)a.pop();e[n]&&a.push(e[n])}return a}}],(n=null)&&s(e.prototype,n),i&&s(e,i),t}();e.GrahamScan=u,u._tempPointList=[],u._temPList=[],u._temArr=[]},64968:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.MathUtil=void 0;var i=a(n(31238)),r=a(n(63978));function a(t){return t&&t.__esModule?t:{default:t}}function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,r=[{key:"subtractVector3",value:function(t,e,n){n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2]}},{key:"lerp",value:function(t,e,n){return t*(1-n)+e*n}},{key:"scaleVector3",value:function(t,e,n){n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e}},{key:"lerpVector3",value:function(t,e,n,i){var r=t[0],a=t[1],o=t[2];i[0]=r+n*(e[0]-r),i[1]=a+n*(e[1]-a),i[2]=o+n*(e[2]-o)}},{key:"lerpVector4",value:function(t,e,n,i){var r=t[0],a=t[1],o=t[2],s=t[3];i[0]=r+n*(e[0]-r),i[1]=a+n*(e[1]-a),i[2]=o+n*(e[2]-o),i[3]=s+n*(e[3]-s)}},{key:"slerpQuaternionArray",value:function(t,e,n,i,r,a,o){var s,u,l,h,c,f=t[e+0],_=t[e+1],d=t[e+2],p=t[e+3],y=n[i+0],v=n[i+1],g=n[i+2],m=n[i+3];return(u=f*y+_*v+d*g+p*m)<0&&(u=-u,y=-y,v=-v,g=-g,m=-m),1-u>1e-6?(s=Math.acos(u),l=Math.sin(s),h=Math.sin((1-r)*s)/l,c=Math.sin(r*s)/l):(h=1-r,c=r),a[o+0]=h*f+c*y,a[o+1]=h*_+c*v,a[o+2]=h*d+c*g,a[o+3]=h*p+c*m,a}},{key:"getRotation",value:function(t,e,n,i){return Math.atan2(i-e,n-t)/Math.PI*180}},{key:"sortBigFirst",value:function(t,e){return t==e?0:e>t?1:-1}},{key:"sortSmallFirst",value:function(t,e){return t==e?0:e>t?-1:1}},{key:"sortNumBigFirst",value:function(t,e){return(0,i.default)(e)-(0,i.default)(t)}},{key:"sortNumSmallFirst",value:function(t,e){return(0,i.default)(t)-(0,i.default)(e)}},{key:"sortByKey",value:function(e){var n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return n=i?r?t.sortNumBigFirst:t.sortBigFirst:r?t.sortNumSmallFirst:t.sortSmallFirst,function(t,i){return n(t[e],i[e])}}}],(n=null)&&o(e.prototype,n),r&&o(e,r),t}();e.MathUtil=s},18008:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Matrix=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if(o(this,t),this._bTransform=!1,null!=t._createFun)return t._createFun(e,n,i,r,a,s,u);this.a=e,this.b=n,this.c=i,this.d=r,this.tx=a,this.ty=s,this._checkTransform()}var e,n,i;return e=t,i=[{key:"mul",value:function(t,e,n){var i=t.a,r=t.b,a=t.c,o=t.d,s=t.tx,u=t.ty,l=e.a,h=e.b,c=e.c,f=e.d,_=e.tx,d=e.ty;return 0!==h||0!==c?(n.a=i*l+r*c,n.b=i*h+r*f,n.c=a*l+o*c,n.d=a*h+o*f,n.tx=l*s+c*u+_,n.ty=h*s+f*u+d):(n.a=i*l,n.b=r*f,n.c=a*l,n.d=o*f,n.tx=l*s+_,n.ty=f*u+d),n}},{key:"mul16",value:function(t,e,n){var i=t.a,r=t.b,a=t.c,o=t.d,s=t.tx,u=t.ty,l=e.a,h=e.b,c=e.c,f=e.d,_=e.tx,d=e.ty;return 0!==h||0!==c?(n[0]=i*l+r*c,n[1]=i*h+r*f,n[4]=a*l+o*c,n[5]=a*h+o*f,n[12]=l*s+c*u+_,n[13]=h*s+f*u+d):(n[0]=i*l,n[1]=r*f,n[4]=a*l,n[5]=o*f,n[12]=l*s+_,n[13]=f*u+d),n}},{key:"create",value:function(){return a.Pool.getItemByClass("Matrix",t)}}],(n=[{key:"identity",value:function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this._bTransform=!1,this}},{key:"_checkTransform",value:function(){return this._bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d}},{key:"setTranslate",value:function(t,e){return this.tx=t,this.ty=e,this}},{key:"translate",value:function(t,e){return this.tx+=t,this.ty+=e,this}},{key:"scale",value:function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this._bTransform=!0,this}},{key:"rotate",value:function(t){var e=Math.cos(t),n=Math.sin(t),i=this.a,r=this.c,a=this.tx;return this.a=i*e-this.b*n,this.b=i*n+this.b*e,this.c=r*e-this.d*n,this.d=r*n+this.d*e,this.tx=a*e-this.ty*n,this.ty=a*n+this.ty*e,this._bTransform=!0,this}},{key:"skew",value:function(t,e){var n=Math.tan(t),i=Math.tan(e),r=this.a,a=this.b;return this.a+=i*this.c,this.b+=i*this.d,this.c+=n*r,this.d+=n*a,this}},{key:"invertTransformPoint",value:function(t){var e=this.a,n=this.b,i=this.c,r=this.d,a=this.tx,o=e*r-n*i,s=r/o,u=-n/o,l=-i/o,h=e/o,c=(i*this.ty-r*a)/o,f=-(e*this.ty-n*a)/o;return t.setTo(s*t.x+l*t.y+c,u*t.x+h*t.y+f)}},{key:"transformPoint",value:function(t){return t.setTo(this.a*t.x+this.c*t.y+this.tx,this.b*t.x+this.d*t.y+this.ty)}},{key:"transformPointN",value:function(t){return t.setTo(this.a*t.x+this.c*t.y,this.b*t.x+this.d*t.y)}},{key:"getScaleX",value:function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)}},{key:"getScaleY",value:function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)}},{key:"invert",value:function(){var t=this.a,e=this.b,n=this.c,i=this.d,r=this.tx,a=t*i-e*n;return this.a=i/a,this.b=-e/a,this.c=-n/a,this.d=t/a,this.tx=(n*this.ty-i*r)/a,this.ty=-(t*this.ty-e*r)/a,this}},{key:"setTo",value:function(t,e,n,i,r,a){return this.a=t,this.b=e,this.c=n,this.d=i,this.tx=r,this.ty=a,this}},{key:"concat",value:function(t){var e=this.a,n=this.c,i=this.tx;return this.a=e*t.a+this.b*t.c,this.b=e*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d,this.tx=i*t.a+this.ty*t.c+t.tx,this.ty=i*t.b+this.ty*t.d+t.ty,this}},{key:"scaleEx",value:function(t,e){var n=this.a,i=this.b,r=this.c,a=this.d;0!==i||0!==r?(this.a=t*n,this.b=t*i,this.c=e*r,this.d=e*a):(this.a=t*n,this.b=0*a,this.c=0*n,this.d=e*a),this._bTransform=!0}},{key:"rotateEx",value:function(t){var e=Math.cos(t),n=Math.sin(t),i=this.a,r=this.b,a=this.c,o=this.d;0!==r||0!==a?(this.a=e*i+n*a,this.b=e*r+n*o,this.c=-n*i+e*a,this.d=-n*r+e*o):(this.a=e*i,this.b=n*o,this.c=-n*i,this.d=e*o),this._bTransform=!0}},{key:"clone",value:function(){var e=t.create();return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e._bTransform=this._bTransform,e}},{key:"copyTo",value:function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t._bTransform=this._bTransform,t}},{key:"toString",value:function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty}},{key:"destroy",value:function(){this.recover()}},{key:"recover",value:function(){a.Pool.recover("Matrix",this.identity())}}])&&s(e.prototype,n),i&&s(e,i),t}();e.Matrix=u,u.EMPTY=new u,u.TEMP=new u,u._createFun=null},85399:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Point=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;o(this,t),this.x=e,this.y=n}var e,n,i;return e=t,i=[{key:"create",value:function(){return a.Pool.getItemByClass("Point",t)}}],(n=[{key:"setTo",value:function(t,e){return this.x=t,this.y=e,this}},{key:"reset",value:function(){return this.x=this.y=0,this}},{key:"recover",value:function(){a.Pool.recover("Point",this.reset())}},{key:"distance",value:function(t,e){return Math.sqrt((this.x-t)*(this.x-t)+(this.y-e)*(this.y-e))}},{key:"toString",value:function(){return this.x+","+this.y}},{key:"normalize",value:function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);if(t>0){var e=1/t;this.x*=e,this.y*=e}}},{key:"copy",value:function(t){return this.setTo(t.x,t.y)}}])&&s(e.prototype,n),i&&s(e,i),t}();e.Point=u,u.TEMP=new u,u.EMPTY=new u},98693:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Rectangle=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210),o=n(85399);function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var l=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;s(this,t),this.x=e,this.y=n,this.width=i,this.height=r}var e,n,i;return e=t,n=[{key:"right",get:function(){return this.x+this.width}},{key:"bottom",get:function(){return this.y+this.height}},{key:"setTo",value:function(t,e,n,i){return this.x=t,this.y=e,this.width=n,this.height=i,this}},{key:"reset",value:function(){return this.x=this.y=this.width=this.height=0,this}},{key:"recover",value:function(){this!=t.TEMP&&this!=t.EMPTY?a.Pool.recover("Rectangle",this.reset()):console.log("recover Temp or Empty:",this)}},{key:"copyFrom",value:function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}},{key:"contains",value:function(t,e){return!(this.width<=0||this.height<=0)&&t>=this.x&&t<this.right&&e>=this.y&&e<this.bottom}},{key:"intersects",value:function(t){return!(t.x>this.x+this.width||t.x+t.width<this.x||t.y>this.y+this.height||t.y+t.height<this.y)}},{key:"intersection",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.intersects(e)?(n||(n=new t),n.x=Math.max(this.x,e.x),n.y=Math.max(this.y,e.y),n.width=Math.min(this.right,e.right)-n.x,n.height=Math.min(this.bottom,e.bottom)-n.y,n):null}},{key:"union",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return n||(n=new t),this.clone(n),e.width<=0||e.height<=0?n:(n.addPoint(e.x,e.y),n.addPoint(e.right,e.bottom),this)}},{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e||(e=new t),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}},{key:"toString",value:function(){return this.x+","+this.y+","+this.width+","+this.height}},{key:"equals",value:function(t){return!(!t||t.x!==this.x||t.y!==this.y||t.width!==this.width||t.height!==this.height)}},{key:"addPoint",value:function(t,e){return this.x>t&&(this.width+=this.x-t,this.x=t),this.y>e&&(this.height+=this.y-e,this.y=e),this.width<t-this.x&&(this.width=t-this.x),this.height<e-this.y&&(this.height=e-this.y),this}},{key:"_getBoundPoints",value:function(){var e=t._temB;return e.length=0,0==this.width||0==this.height||e.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),e}},{key:"isEmpty",value:function(){return this.width<=0||this.height<=0}}],i=[{key:"create",value:function(){return a.Pool.getItemByClass("Rectangle",t)}},{key:"_getBoundPointS",value:function(e,n,i,r){var a=t._temA;return a.length=0,0==i||0==r||a.push(e,n,e+i,n,e,n+r,e+i,n+r),a}},{key:"_getWrapRec",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e||e.length<1)return n?n.setTo(0,0,0,0):t.TEMP.setTo(0,0,0,0);n=n||t.create();var i,r,a,s,u,l=e.length,h=o.Point.TEMP;for(a=u=-(r=s=99999),i=0;i<l;i+=2)h.x=e[i],h.y=e[i+1],r=r<h.x?r:h.x,s=s<h.y?s:h.y,a=a>h.x?a:h.x,u=u>h.y?u:h.y;return n.setTo(r,s,a-r,u-s)}}],n&&u(e.prototype,n),i&&u(e,i),t}();e.Rectangle=l,l.EMPTY=new l,l.TEMP=new l,l._temB=[],l._temA=[]},96088:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.SoundChannel=void 0;var h=f(n(85507)),c=f(n(21611));function f(t){return t&&t.__esModule?t:{default:t}}function _(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function p(t,e){return p=a||function(t,e){return t.__proto__=e,t},p(t,e)}function y(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=g(t);if(e){var a=g(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return v(this,n)}}function v(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function g(t){return g=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},g(t)}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(a,t);var e,n,i,r=y(a);function a(){var t;return _(this,a),(t=r.apply(this,arguments)).isStopped=!1,t}return e=a,(n=[{key:"volume",get:function(){return 1},set:function(t){}},{key:"position",get:function(){return 0}},{key:"duration",get:function(){return 0}},{key:"play",value:function(){}},{key:"stop",value:function(){this.completeHandler&&this.completeHandler.runWith(!1)}},{key:"pause",value:function(){}},{key:"resume",value:function(){}},{key:"__runComplete",value:function(t){t&&t.runWith(!0)}}])&&d(e.prototype,n),i&&d(e,i),a}(n(48856).EventDispatcher);e.SoundChannel=m},17886:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.SoundManager=void 0;var i=_(n(81643)),r=_(n(92762)),a=_(n(63978)),o=n(89662),s=n(16313),u=n(30690),l=n(84935),h=n(56083),c=n(92493),f=n(93568);function _(t){return t&&t.__esModule?t:{default:t}}function d(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,a.default)(t,i.key,i)}}var p=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,a;return e=t,a=[{key:"__init__",value:function(){var e=c.ILaya.Browser.window,n=!!(e.AudioContext||e.webkitAudioContext||e.mozAudioContext);return n&&u.WebAudioSound.initWebAudio(),t._soundClass=n?u.WebAudioSound:s.AudioSound,f.Browser.onTBMiniGame||s.AudioSound._initMusicAudio(),t._musicClass=s.AudioSound,n}},{key:"addChannel",value:function(e){var n;(0,i.default)(n=t._channels).call(n,e)>=0||t._channels.push(e)}},{key:"removeChannel",value:function(e){var n;for(n=t._channels.length-1;n>=0;n--){var i;t._channels[n]==e&&(0,r.default)(i=t._channels).call(i,n,1)}}},{key:"disposeSoundLater",value:function(e){t._lastSoundUsedTimeDic[e]=c.ILaya.Browser.now(),t._isCheckingDispose||(t._isCheckingDispose=!0,c.ILaya.timer.loop(5e3,null,t._checkDisposeSound))}},{key:"_checkDisposeSound",value:function(){var e,n=c.ILaya.Browser.now(),i=!1;for(e in t._lastSoundUsedTimeDic)n-t._lastSoundUsedTimeDic[e]>3e4?(delete t._lastSoundUsedTimeDic[e],t.disposeSoundIfNotUsed(e)):i=!0;i||(t._isCheckingDispose=!1,c.ILaya.timer.clear(null,t._checkDisposeSound))}},{key:"disposeSoundIfNotUsed",value:function(e){var n;for(n=t._channels.length-1;n>=0;n--)if(t._channels[n].url==e)return;t.destroySound(e)}},{key:"autoStopMusic",get:function(){return t._autoStopMusic},set:function(e){c.ILaya.stage.off(o.Event.BLUR,null,t._stageOnBlur),c.ILaya.stage.off(o.Event.FOCUS,null,t._stageOnFocus),c.ILaya.stage.off(o.Event.VISIBILITY_CHANGE,null,t._visibilityChange),t._autoStopMusic=e,e&&(c.ILaya.stage.on(o.Event.BLUR,null,t._stageOnBlur),c.ILaya.stage.on(o.Event.FOCUS,null,t._stageOnFocus),c.ILaya.stage.on(o.Event.VISIBILITY_CHANGE,null,t._visibilityChange))}},{key:"_visibilityChange",value:function(){c.ILaya.stage.isVisibility?t._stageOnFocus():t._stageOnBlur()}},{key:"_stageOnBlur",value:function(){t._isActive=!1,t._musicChannel&&(t._musicChannel.isStopped||(t._blurPaused=!0,t._musicChannel.pause())),t.stopAllSound(),c.ILaya.stage.once(o.Event.MOUSE_DOWN,null,t._stageOnFocus)}},{key:"_recoverWebAudio",value:function(){u.WebAudioSound.ctx&&"running"!=u.WebAudioSound.ctx.state&&u.WebAudioSound.ctx.resume&&u.WebAudioSound.ctx.resume()}},{key:"_stageOnFocus",value:function(){t._isActive=!0,t._recoverWebAudio(),c.ILaya.stage.off(o.Event.MOUSE_DOWN,null,t._stageOnFocus),t._blurPaused&&t._musicChannel&&t._musicChannel.isStopped&&(t._blurPaused=!1,t._musicChannel.resume())}},{key:"muted",get:function(){return t._muted},set:function(e){e!=t._muted&&(e&&t.stopAllSound(),t.musicMuted=e,t._muted=e)}},{key:"soundMuted",get:function(){return t._soundMuted},set:function(e){t._soundMuted=e}},{key:"musicMuted",get:function(){return t._musicMuted},set:function(e){e!=t._musicMuted&&(e?(t._bgMusic&&t._musicChannel&&!t._musicChannel.isStopped?c.ILaya.Render.isConchApp?t._musicChannel._audio&&(t._musicChannel._audio.muted=!0):t._musicChannel.pause():t._musicChannel=null,t._musicMuted=e):(t._musicMuted=e,t._bgMusic&&t._musicChannel&&(c.ILaya.Render.isConchApp?t._musicChannel._audio&&(t._musicChannel._audio.muted=!1):t._musicChannel.resume())))}},{key:"useAudioMusic",get:function(){return t._useAudioMusic},set:function(e){t._useAudioMusic=e,t._musicClass=e?s.AudioSound:null}},{key:"playSound",value:function(e){var n,i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!t._isActive||!e)return null;if(t._muted)return null;if(t._recoverWebAudio(),(e=l.URL.formatURL(e))==t._bgMusic){if(t._musicMuted)return null}else{if(c.ILaya.Render.isConchApp){var u=h.Utils.getFileExtension(e);if("wav"!=u&&"ogg"!=u)return alert("The sound only supports wav or ogg format,for optimal performance reason,please refer to the official website document."),null}if(t._soundMuted)return null}return f.Browser._isMiniGame||(n=c.ILaya.loader.getRes(e)),o||(o=t._soundClass),n||((n=new o).load(e),f.Browser._isMiniGame||c.ILaya.Loader.cacheRes(e,n)),(i=n.play(s,r))?(i.url=e,i.volume=e==t._bgMusic?t.musicVolume:t.soundVolume,i.completeHandler=a,i):null}},{key:"destroySound",value:function(t){var e=c.ILaya.loader.getRes(t);e&&(c.ILaya.Loader.clearRes(t),e.dispose())}},{key:"playMusic",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return e=l.URL.formatURL(e),t._bgMusic=e,t._musicChannel&&t._musicChannel.stop(),t._musicChannel=t.playSound(e,n,i,t._musicClass,r)}},{key:"stopSound",value:function(e){var n,i;for(e=l.URL.formatURL(e),n=t._channels.length-1;n>=0;n--)(i=t._channels[n]).url==e&&i.stop()}},{key:"stopAll",value:function(){var e;for(t._bgMusic=null,e=t._channels.length-1;e>=0;e--)t._channels[e].stop()}},{key:"stopAllSound",value:function(){var e,n;for(e=t._channels.length-1;e>=0;e--)(n=t._channels[e]).url!=t._bgMusic&&n.stop()}},{key:"stopMusic",value:function(){t._musicChannel&&t._musicChannel.stop(),t._bgMusic=null}},{key:"setSoundVolume",value:function(e){var n,i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(r)r=l.URL.formatURL(r),t._setVolume(r,e);else for(t.soundVolume=e,n=t._channels.length-1;n>=0;n--)(i=t._channels[n]).url!=t._bgMusic&&(i.volume=e)}},{key:"setMusicVolume",value:function(e){t.musicVolume=e,t._setVolume(t._bgMusic,e)}},{key:"_setVolume",value:function(e,n){var i,r;for(e=l.URL.formatURL(e),i=t._channels.length-1;i>=0;i--)(r=t._channels[i]).url==e&&(r.volume=n)}}],(n=null)&&d(e.prototype,n),a&&d(e,a),t}();e.SoundManager=p,p.musicVolume=1,p.soundVolume=1,p.playbackRate=1,p._useAudioMusic=!0,p._muted=!1,p._soundMuted=!1,p._musicMuted=!1,p._bgMusic=null,p._musicChannel=null,p._channels=[],p._blurPaused=!1,p._isActive=!0,p._lastSoundUsedTimeDic={},p._isCheckingDispose=!1,p.autoReleaseSound=!0},16313:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.AudioSound=void 0;var h=b(n(85507)),c=b(n(21611)),f=n(31111),_=n(89662),d=n(48856),p=n(84935),y=n(85136),v=n(93568),g=n(64210),m=n(92493);function b(t){return t&&t.__esModule?t:{default:t}}function T(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function w(t,e){return w=a||function(t,e){return t.__proto__=e,t},w(t,e)}function k(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=E(t);if(e){var a=E(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return C(this,n)}}function C(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function E(t){return E=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},E(t)}var S=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}(a,t);var e,n,i,r=k(a);function a(){var t;return T(this,a),(t=r.apply(this,arguments)).loaded=!1,t}return e=a,n=[{key:"dispose",value:function(){var t=a._audioCache[this.url];g.Pool.clearBySign("audio:"+this.url),t&&(y.Render.isConchApp||(t.src=""),delete a._audioCache[this.url])}},{key:"load",value:function(t){var e;if(t=p.URL.formatURL(t),this.url=t,t==m.ILaya.SoundManager._bgMusic?(a._initMusicAudio(),(e=a._musicAudio).src!=t&&(delete a._audioCache[e.src],e=null)):e=a._audioCache[t],e&&e.readyState>=2)this.event(_.Event.COMPLETE);else{e||(t==m.ILaya.SoundManager._bgMusic?(a._initMusicAudio(),e=a._musicAudio):e=v.Browser.createElement("audio"),a._audioCache[t]=e,e.src=t),e.addEventListener("canplaythrough",i),e.addEventListener("error",r);var n=this;this.audio=e,e.load?e.load():r()}function i(){o(),n.loaded=!0,n.event(_.Event.COMPLETE)}function r(){e.load=null,o(),n.event(_.Event.ERROR)}function o(){e.removeEventListener("canplaythrough",i),e.removeEventListener("error",r)}}},{key:"play",value:function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.url)return null;if(this.url==m.ILaya.SoundManager._bgMusic?""!=(t=a._musicAudio).src&&t.src!=this.url&&(delete a._audioCache[t.src],a._audioCache[this.url]=t):t=a._audioCache[this.url],!t)return null;e=g.Pool.getItem("audio:"+this.url),y.Render.isConchApp?e||((e=v.Browser.createElement("audio")).src=this.url):this.url==m.ILaya.SoundManager._bgMusic?(a._initMusicAudio(),(e=a._musicAudio).src=this.url):e=e||t.cloneNode(!0);var r=new f.AudioSoundChannel(e);return r.url=this.url,r.loops=i,r.startTime=n,r.play(),m.ILaya.SoundManager.addChannel(r),r}},{key:"duration",get:function(){var t;return(t=a._audioCache[this.url])?t.duration:0}}],i=[{key:"_initMusicAudio",value:function(){a._musicAudio||(a._musicAudio||(a._musicAudio=v.Browser.createElement("audio")),y.Render.isConchApp||v.Browser.document.addEventListener("mousedown",a._makeMusicOK))}},{key:"_makeMusicOK",value:function(){v.Browser.document.removeEventListener("mousedown",a._makeMusicOK),a._musicAudio.src?a._musicAudio.play():(a._musicAudio.src="",a._musicAudio.load())}}],n&&x(e.prototype,n),i&&x(e,i),a}(d.EventDispatcher);e.AudioSound=S,S._audioCache={}},31111:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.AudioSoundChannel=void 0;var f=m(n(54103)),_=m(n(85507)),d=m(n(21611)),p=n(89662),y=n(96088),v=n(93568),g=n(92493);function m(t){return t&&t.__esModule?t:{default:t}}function b(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function T(){return T="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=x(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},T.apply(this,arguments)}function x(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=S(t)););return t}function w(t,e){return w=a||function(t,e){return t.__proto__=e,t},w(t,e)}function k(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=S(t);if(e){var a=S(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return C(this,n)}}function C(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return E(t)}function E(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function S(t){return S=_.default?d.default:function(t){return t.__proto__||(0,d.default)(t)},S(t)}var M=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}(a,t);var e,n,i,r=k(a);function a(t){var e,n,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(i=r.call(this))._audio=null,i._onEnd=(0,f.default)(e=i.__onEnd).call(e,E(i)),i._resumePlay=(0,f.default)(n=i.__resumePlay).call(n,E(i)),t.addEventListener("ended",i._onEnd),i._audio=t,i}return e=a,(n=[{key:"__onEnd",value:function(t){if(1==this.loops)return this.completeHandler&&(g.ILaya.systemTimer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event(p.Event.COMPLETE);this.loops>0&&this.loops--,this.startTime=0,this.play()}},{key:"__resumePlay",value:function(){if(this._audio&&this._audio.removeEventListener("canplay",this._resumePlay),!this.isStopped)try{this._audio.currentTime=this.startTime,v.Browser.container.appendChild(this._audio),this._audio.play()}catch(t){this.event(p.Event.ERROR)}}},{key:"play",value:function(){this.isStopped=!1;try{this._audio.playbackRate=g.ILaya.SoundManager.playbackRate,this._audio.currentTime=this.startTime}catch(t){return void this._audio.addEventListener("canplay",this._resumePlay)}g.ILaya.SoundManager.addChannel(this),v.Browser.container.appendChild(this._audio),"play"in this._audio&&this._audio.play()}},{key:"position",get:function(){return this._audio?this._audio.currentTime:0}},{key:"duration",get:function(){return this._audio?this._audio.duration:0}},{key:"stop",value:function(){T(S(a.prototype),"stop",this).call(this),this.isStopped=!0,g.ILaya.SoundManager.removeChannel(this),this.completeHandler=null,this._audio&&("pause"in this._audio&&g.ILaya.Render.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),g.ILaya.Browser.onIE||this._audio!=g.ILaya.AudioSound._musicAudio&&g.ILaya.Pool.recover("audio:"+this.url,this._audio),v.Browser.removeElement(this._audio),this._audio=null,g.ILaya.SoundManager.autoReleaseSound&&g.ILaya.SoundManager.disposeSoundLater(this.url))}},{key:"pause",value:function(){this.isStopped=!0,g.ILaya.SoundManager.removeChannel(this),this._audio&&("pause"in this._audio&&this._audio.pause(),g.ILaya.SoundManager.autoReleaseSound&&g.ILaya.SoundManager.disposeSoundLater(this.url))}},{key:"resume",value:function(){var t=this._audio;t&&(this.isStopped=!1,0==t.readyState&&(t.src=this.url,t.addEventListener("canplay",this._resumePlay),t.load&&t.load()),g.ILaya.SoundManager.addChannel(this),"play"in t&&t.play())}},{key:"volume",get:function(){return this._audio?this._audio.volume:1},set:function(t){this._audio&&(this._audio.volume=t)}}])&&b(e.prototype,n),i&&b(e,i),a}(y.SoundChannel);e.AudioSoundChannel=M},30690:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.WebAudioSound=void 0;var h=v(n(85507)),c=v(n(21611)),f=n(96250),_=n(89662),d=n(48856),p=n(84935),y=n(92493);function v(t){return t&&t.__esModule?t:{default:t}}function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function b(t,e){return b=a||function(t,e){return t.__proto__=e,t},b(t,e)}function T(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=w(t);if(e){var a=w(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return x(this,n)}}function x(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function w(t){return w=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},w(t)}var k=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&b(t,e)}(a,t);var e,n,i,r=T(a);function a(){var t;return g(this,a),(t=r.apply(this,arguments)).loaded=!1,t._disposed=!1,t}return e=a,n=[{key:"load",value:function(t){var e=this;if(t=p.URL.formatURL(t),this.url=t,this.audioBuffer=a._dataCache[t],this.audioBuffer)this._loaded(this.audioBuffer);else if(a.e.on("loaded:"+t,this,this._loaded),a.e.on("err:"+t,this,this._err),!a.__loadingSound[t]){a.__loadingSound[t]=!0;var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(){e._disposed?e._removeLoadEvents():(e.data=n.response,a.buffs.push({buffer:e.data,url:e.url}),a.decode())},n.onerror=function(t){e._err()},n.send()}}},{key:"_err",value:function(){this._removeLoadEvents(),a.__loadingSound[this.url]=!1,this.event(_.Event.ERROR)}},{key:"_loaded",value:function(t){this._removeLoadEvents(),this._disposed||(this.audioBuffer=t,a._dataCache[this.url]=this.audioBuffer,this.loaded=!0,this.event(_.Event.COMPLETE))}},{key:"_removeLoadEvents",value:function(){a.e.off("loaded:"+this.url,this,this._loaded),a.e.off("err:"+this.url,this,this._err)}},{key:"__playAfterLoaded",value:function(){if(this.__toPlays){var t,e,n,i;for(e=(n=this.__toPlays).length,t=0;t<e;t++)(i=n[t])[2]&&!i[2].isStopped&&this.play(i[0],i[1],i[2]);this.__toPlays.length=0}}},{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return n=n||new f.WebAudioSoundChannel,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([t,e,n]),this.once(_.Event.COMPLETE,this,this.__playAfterLoaded),this.load(this.url)),n.url=this.url,n.loops=e,n.audioBuffer=this.audioBuffer,n.startTime=t,n.play(),y.ILaya.SoundManager.addChannel(n),n}},{key:"duration",get:function(){return this.audioBuffer?this.audioBuffer.duration:0}},{key:"dispose",value:function(){this._disposed=!0,delete a._dataCache[this.url],delete a.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]}}],i=[{key:"decode",value:function(){a.buffs.length<=0||a.isDecoding||(a.isDecoding=!0,a.tInfo=a.buffs.shift(),a.ctx.decodeAudioData(a.tInfo.buffer,a._done,a._fail))}},{key:"_done",value:function(t){a.e.event("loaded:"+a.tInfo.url,t),a.isDecoding=!1,a.decode()}},{key:"_fail",value:function(){a.e.event("err:"+a.tInfo.url,null),a.isDecoding=!1,a.decode()}},{key:"_playEmptySound",value:function(){if(null!=a.ctx){var t=a.ctx.createBufferSource();t.buffer=a._miniBuffer,t.connect(a.ctx.destination),t.start(0,0,0)}}},{key:"_unlock",value:function(){a._unlocked||(a._playEmptySound(),"running"==a.ctx.state&&(window.document.removeEventListener("mousedown",a._unlock,!0),window.document.removeEventListener("touchend",a._unlock,!0),window.document.removeEventListener("touchstart",a._unlock,!0),a._unlocked=!0))}},{key:"initWebAudio",value:function(){"running"!=a.ctx.state&&(a._unlock(),window.document.addEventListener("mousedown",a._unlock,!0),window.document.addEventListener("touchend",a._unlock,!0),window.document.addEventListener("touchstart",a._unlock,!0))}}],n&&m(e.prototype,n),i&&m(e,i),a}(d.EventDispatcher);e.WebAudioSound=k,k._dataCache={},k.webAudioEnabled=window.AudioContext||window.webkitAudioContext||window.mozAudioContext,k.ctx=k.webAudioEnabled?new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext):void 0,k.buffs=[],k.isDecoding=!1,k._miniBuffer=k.ctx?k.ctx.createBuffer(1,1,22050):void 0,k.e=new d.EventDispatcher,k._unlocked=!1,k.__loadingSound={}},96250:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.WebAudioSoundChannel=void 0;var f=b(n(54103)),_=b(n(85507)),d=b(n(21611)),p=n(89662),y=n(96088),v=n(93568),g=n(56083),m=n(92493);function b(t){return t&&t.__esModule?t:{default:t}}function T(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function x(){return x="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=w(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},x.apply(this,arguments)}function w(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=M(t)););return t}function k(t,e){return k=a||function(t,e){return t.__proto__=e,t},k(t,e)}function C(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=M(t);if(e){var a=M(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return E(this,n)}}function E(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return S(t)}function S(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function M(t){return M=_.default?d.default:function(t){return t.__proto__||(0,d.default)(t)},M(t)}var L=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&k(t,e)}(a,t);var e,n,i,r=C(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this)).bufferSource=null,t._currentTime=0,t._volume=1,t._startTime=0,t._pauseTime=0,t.context=m.ILaya.WebAudioSound.ctx,t._onPlayEnd=(0,f.default)(g.Utils).call(g.Utils,t.__onPlayEnd,S(t)),t.context.createGain?t.gain=t.context.createGain():t.gain=t.context.createGainNode(),t}return e=a,(n=[{key:"play",value:function(){if(m.ILaya.SoundManager.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){if(this.startTime>=this.duration)return this.stop();var t=this.context,e=this.gain,n=t.createBufferSource();this.bufferSource=n,n.buffer=this.audioBuffer,n.connect(e),e&&e.disconnect(),e.connect(t.destination),n.onended=this._onPlayEnd,this._startTime=v.Browser.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,a.SetTargetDelay):this.gain.gain.value=this._volume,0==this.loops&&(n.loop=!0),n.playbackRate.setTargetAtTime?n.playbackRate.setTargetAtTime(m.ILaya.SoundManager.playbackRate,this.context.currentTime,a.SetTargetDelay):n.playbackRate.value=m.ILaya.SoundManager.playbackRate,n.start(0,this.startTime),this._currentTime=0}}},{key:"__onPlayEnd",value:function(){if(1==this.loops)return this.completeHandler&&(m.ILaya.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event(p.Event.COMPLETE);this.loops>0&&this.loops--,this.startTime=0,this.play()}},{key:"position",get:function(){return this.bufferSource?(v.Browser.now()-this._startTime)/1e3+this.startTime:0}},{key:"duration",get:function(){return this.audioBuffer?this.audioBuffer.duration:0}},{key:"_clearBufferSource",value:function(){if(this.bufferSource){var t=this.bufferSource;t.stop?t.stop(0):t.noteOff(0),t.disconnect(0),t.onended=null,a._tryCleanFailed||this._tryClearBuffer(t),this.bufferSource=null}}},{key:"_tryClearBuffer",value:function(t){try{t.buffer=null}catch(t){a._tryCleanFailed=!0}}},{key:"stop",value:function(){x(M(a.prototype),"stop",this).call(this),this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,m.ILaya.SoundManager.removeChannel(this),this.completeHandler=null,m.ILaya.SoundManager.autoReleaseSound&&m.ILaya.SoundManager.disposeSoundLater(this.url)}},{key:"pause",value:function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,m.ILaya.SoundManager.removeChannel(this),m.ILaya.SoundManager.autoReleaseSound&&m.ILaya.SoundManager.disposeSoundLater(this.url)}},{key:"resume",value:function(){this.startTime=this._pauseTime,this.play()}},{key:"volume",get:function(){return this._volume},set:function(t){this._volume=t,this.isStopped||(this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(t,this.context.currentTime,a.SetTargetDelay):this.gain.gain.value=t)}}])&&T(e.prototype,n),i&&T(e,i),a}(y.SoundChannel);e.WebAudioSoundChannel=L,L._tryCleanFailed=!1,L.SetTargetDelay=.001},68291:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.AtlasInfoManager=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(41107),o=n(92493),s=n(85096);function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"enable",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;o.ILaya.loader.load(e,a.Handler.create(null,t._onInfoLoaded,[n]),null,s.Loader.JSON)}},{key:"_onInfoLoaded",value:function(e,n){var i,r,a,o,s;for(i in n)for(r=(a=n[i])[0],s=(a=a[1]).length,o=0;o<s;o++)t._fileLoadDic[r+a[o]]=i;e&&e.run()}},{key:"getFileLoadPath",value:function(e){return t._fileLoadDic[e]||e}}],(n=null)&&u(e.prototype,n),i&&u(e,i),t}();e.AtlasInfoManager=l,l._fileLoadDic={}},46785:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.HttpRequest=void 0;var h=v(n(59340)),c=v(n(85507)),f=v(n(21611)),_=n(89662),d=n(48856),p=n(56083),y=n(93568);function v(t){return t&&t.__esModule?t:{default:t}}function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function b(t,e){return b=a||function(t,e){return t.__proto__=e,t},b(t,e)}function T(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=w(t);if(e){var a=w(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return x(this,n)}}function x(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function w(t){return w=c.default?f.default:function(t){return t.__proto__||(0,f.default)(t)},w(t)}var k=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&b(t,e)}(a,t);var e,n,i,r=T(a);function a(){var t;return g(this,a),(t=r.apply(this,arguments))._http=new XMLHttpRequest,t}return e=a,n=[{key:"send",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"get",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"text",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this._responseType=i,this._data=null,(y.Browser.onVVMiniGame||y.Browser.onQGMiniGame||y.Browser.onQQMiniGame||y.Browser.onAlipayMiniGame||y.Browser.onBLMiniGame||y.Browser.onHWMiniGame||y.Browser.onTTMiniGame||y.Browser.onTBMiniGame)&&(t=a._urlEncode(t)),this._url=t;var o=this,s=this._http;s.open(n,t,!0);var u=!1;if(r)for(var l=0;l<r.length;l++)s.setRequestHeader(r[l++],r[l]);else window.conch||(e&&"string"!=typeof e?(s.setRequestHeader("Content-Type","application/json"),e instanceof ArrayBuffer||"string"==typeof e||(u=!0)):s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));var c="arraybuffer"!==i?"text":"arraybuffer";s.responseType=c,s.dataType&&(s.dataType=c),s.onerror=function(t){o._onError(t)},s.onabort=function(t){o._onAbort(t)},s.onprogress=function(t){o._onProgress(t)},s.onload=function(t){o._onLoad(t)},y.Browser.onBLMiniGame&&y.Browser.onAndroid&&!e&&(e={}),s.send(u?(0,h.default)(e):e)}},{key:"_onProgress",value:function(t){t&&t.lengthComputable&&this.event(_.Event.PROGRESS,t.loaded/t.total)}},{key:"_onAbort",value:function(t){this.error("Request was aborted by user")}},{key:"_onError",value:function(t){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)}},{key:"_onLoad",value:function(t){var e=this._http,n=void 0!==e.status?e.status:200;200===n||204===n||0===n?this.complete():this.error("["+e.status+"]"+e.statusText+":"+e.responseURL)}},{key:"error",value:function(t){this.clear(),console.warn(this.url,t),this.event(_.Event.ERROR,t)}},{key:"complete",value:function(){this.clear();var t=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=p.Utils.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(e){t=!1,this.error(e.message)}t&&this.event(_.Event.COMPLETE,this._data instanceof Array?[this._data]:this._data)}},{key:"clear",value:function(){var t=this._http;t.onerror=t.onabort=t.onprogress=t.onload=null}},{key:"url",get:function(){return this._url}},{key:"data",get:function(){return this._data}},{key:"http",get:function(){return this._http}}],n&&m(e.prototype,n),i&&m(e,i),a}(d.EventDispatcher);e.HttpRequest=k,k._urlEncode=encodeURI},85096:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.Loader=void 0;var h=B(n(81643)),c=B(n(23054)),f=B(n(97093)),_=B(n(31238)),d=B(n(78914)),p=B(n(85507)),y=B(n(21611)),v=n(92493),g=n(72643),m=n(81870),b=n(89662),T=n(48856),x=n(17886),w=n(54598),k=n(87035),C=n(93568),E=n(14002),S=n(41107),M=n(56083),L=n(60397),R=n(46785),I=n(84935),A=n(73972),D=n(69176);function B(t){return t&&t.__esModule?t:{default:t}}function P(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function O(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function F(t,e){return F=a||function(t,e){return t.__proto__=e,t},F(t,e)}function U(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=G(t);if(e){var a=G(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return N(this,n)}}function N(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function G(t){return G=p.default?y.default:function(t){return t.__proto__||(0,y.default)(t)},G(t)}var H=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&F(t,e)}(a,t);var e,n,i,r=U(a);function a(){var t;return P(this,a),(t=r.apply(this,arguments))._customParse=!1,t}return e=a,n=[{key:"load",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:v.ILaya.WorkerLoader.enable;if(t){var s;if(a.setGroup(t,"666"),this._url=t,0!==(0,h.default)(t).call(t,"data:image")||e?t=I.URL.formatURL(t):e=a.IMAGE,this._type=e||(e=a.getTypeFromUrl(this._url)),this._cache=n,this._useWorkerLoader=o,this._data=null,o&&v.ILaya.WorkerLoader.enableWorkerLoader(),e==a.IMAGE?(s=a.textureMap[t])&&(!s.bitmap||s.bitmap&&s.bitmap.destroyed)&&(s=null):s=a.loadedMap[t],!r&&s)return this._data=s,this.event(b.Event.PROGRESS,1),void this.event(b.Event.COMPLETE,this._data);if(i&&a.setGroup(t,i),null!=a.parserMap[e])return this._customParse=!0,void(a.parserMap[e]instanceof S.Handler?a.parserMap[e].runWith(this):a.parserMap[e].call(null,this));this._loadResourceFilter(e,t)}else this.onLoaded(null)}},{key:"_loadResourceFilter",value:function(t,e){this._loadResource(t,e)}},{key:"_loadResource",value:function(t,e){switch(t){case a.IMAGE:case"htmlimage":case"nativeimage":this._loadImage(e);break;case a.SOUND:this._loadSound(e);break;case a.TTF:this._loadTTF(e);break;case a.ATLAS:case a.PREFAB:case a.PLF:this._loadHttpRequestWhat(e,a.JSON);break;case a.FONT:this._loadHttpRequestWhat(e,a.XML);break;case a.PLFB:this._loadHttpRequestWhat(e,a.BUFFER);break;default:this._loadHttpRequestWhat(e,t)}}},{key:"_loadHttpRequest",value:function(t,e,n,i,r,a,o,s){C.Browser.onVVMiniGame||C.Browser.onHWMiniGame?this._http=new R.HttpRequest:this._http||(this._http=new R.HttpRequest),a&&this._http.on(b.Event.PROGRESS,r,a),i&&this._http.on(b.Event.COMPLETE,n,i),this._http.on(b.Event.ERROR,o,s),this._http.send(t,null,"get",e)}},{key:"_loadHtmlImage",value:function(t,e,n,i,r){var o;function s(){var e=o;e.onload=null,e.onerror=null,delete a._imgCache[t]}(o=new C.Browser.window.Image).crossOrigin="",o.onload=function(){s(),n.call(e,o)},o.onerror=function(){s(),r.call(i)},o.src=t,a._imgCache[t]=o}},{key:"_loadHttpRequestWhat",value:function(t,e){a.preLoadedMap[t]?this.onLoaded(a.preLoadedMap[t]):this._loadHttpRequest(t,e,this,this.onLoaded,this,this.onProgress,this,this.onError)}},{key:"_loadTTF",value:function(t){t=I.URL.formatURL(t);var e=new v.ILaya.TTFLoader;e.complete=S.Handler.create(this,this.onLoaded),e.load(t)}},{key:"_loadImage",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this;e&&(t=I.URL.formatURL(t));var i=function(){n.event(b.Event.ERROR,"Load image failed")};if("nativeimage"===this._type)this._loadHtmlImage(t,this,this.onLoaded,this,i);else{var r=M.Utils.getFileExtension(t);"bin"==r&&this._url&&(r=M.Utils.getFileExtension(this._url)),"ktx"===r||"pvr"===r?this._loadHttpRequest(t,a.BUFFER,this,this.onLoaded,this,this.onProgress,this,this.onError):this._loadHtmlImage(t,this,this.onLoaded,this,i)}}},{key:"_loadSound",value:function(t){var e=new x.SoundManager._soundClass,n=this;function i(){e.offAll()}e.on(b.Event.COMPLETE,this,(function(){i(),n.onLoaded(e)})),e.on(b.Event.ERROR,this,(function(){i(),e.dispose(),n.event(b.Event.ERROR,"Load sound failed")})),e.load(t)}},{key:"onProgress",value:function(t){this._type===a.ATLAS?this.event(b.Event.PROGRESS,.3*t):this._originType==a.HIERARCHY?this.event(b.Event.PROGRESS,t/3):this.event(b.Event.PROGRESS,t)}},{key:"onError",value:function(t){this.event(b.Event.ERROR,t)}},{key:"onLoaded",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if((S=this._type)==a.PLFB)this.parsePLFBData(t),this.complete(t);else if(S==a.PLF)this.parsePLFData(t),this.complete(t);else if(S===a.IMAGE){var e;if(t instanceof ArrayBuffer){var n;switch(E=M.Utils.getFileExtension(this._url)){case"ktx":n=A.TextureFormat.ETC1RGB;break;case"pvr":n=A.TextureFormat.PVRTCRGBA_4BPPV;break;default:return void console.error("unknown format",E)}(e=new k.Texture2D(0,0,n,!1,!1)).wrapModeU=D.WarpMode.Clamp,e.wrapModeV=D.WarpMode.Clamp,e.setCompressData(t),e._setCreateURL(this.url)}else t instanceof k.Texture2D?e=t:((e=new k.Texture2D(t.width,t.height,1,!1,!1)).wrapModeU=D.WarpMode.Clamp,e.wrapModeV=D.WarpMode.Clamp,e.loadImageSource(t,!0),e._setCreateURL(t.src));var i=new w.Texture(e);i.url=this._url,this.complete(i)}else if(S===a.SOUND||"nativeimage"===S)this.complete(t);else if("htmlimage"===S){var r=new k.Texture2D(t.width,t.height,1,!1,!1);r.wrapModeU=D.WarpMode.Clamp,r.wrapModeV=D.WarpMode.Clamp,r.loadImageSource(t,!0),r._setCreateURL(t.src),this.complete(r)}else if(S===a.ATLAS){if(t.frames){var o=[];if(!this._data){if(this._data=t,t.meta&&t.meta.image){var s,u;o=t.meta.image.split(",");var l=(0,h.default)(s=this._url).call(s,"/")>=0?"/":"\\",d=(0,c.default)(u=this._url).call(u,l),p=d>=0?this._url.substr(0,d+1):"",y=null;C.Browser.onAndroid&&t.meta.compressTextureAndroid&&(y=".ktx"),C.Browser.onIOS&&t.meta.compressTextureIOS&&(y=t.meta.astc?".ktx":".pvr");for(var v=0,T=o.length;v<T;v++)o[v]=y?p+o[v].replace(".png",y):p+o[v]}else o=[this._url.replace(".json",".png")];(0,f.default)(o).call(o),t.toLoads=o,t.pics=[]}this.event(b.Event.PROGRESS,.3+1/o.length*.6);var x=I.URL.formatURL(o.pop()),E=M.Utils.getFileExtension(x),S=a.IMAGE;return"pvr"!=E&&"ktx"!=E||(S=a.BUFFER),this._loadResourceFilter(S,x)}if(!(t instanceof k.Texture2D))if(t instanceof ArrayBuffer){var R;switch(x=this._http?this._http.url:this._url,E=M.Utils.getFileExtension(x)){case"ktx":R=A.TextureFormat.ETC1RGB;break;case"pvr":R=A.TextureFormat.PVRTCRGBA_4BPPV;break;default:return void console.error("unknown format",E)}var B=new k.Texture2D(0,0,R,!1,!1);B.wrapModeU=D.WarpMode.Clamp,B.wrapModeV=D.WarpMode.Clamp,B.setCompressData(t),B._setCreateURL(x),t=B}else{var P=new k.Texture2D(t.width,t.height,1,!1,!1);P.wrapModeU=D.WarpMode.Clamp,P.wrapModeV=D.WarpMode.Clamp,P.loadImageSource(t,!0),P._setCreateURL(t.src),t=P}if(this._data.pics.push(t),this._data.toLoads.length>0)return this.event(b.Event.PROGRESS,.3+1/this._data.toLoads.length*.6),x=I.URL.formatURL(this._data.toLoads.pop()),E=M.Utils.getFileExtension(x),S=a.IMAGE,"pvr"!=E&&"ktx"!=E||(S=a.BUFFER),this._loadResourceFilter(S,x);var O=this._data.frames,F=this._url.split("?")[0],U=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:F.substring(0,(0,c.default)(F).call(F,"."))+"/",N=this._data.pics,G=I.URL.formatURL(this._url),H=a.atlasMap[G]||(a.atlasMap[G]=[]);H.dir=U;var W=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var V in W=(0,_.default)(this._data.meta.scale),O){var Y,X=O[V],z=N[X.frame.idx?X.frame.idx:0];x=U+V,z.scaleRate=W,Y=w.Texture._create(z,X.frame.x,X.frame.y,X.frame.w,X.frame.h,X.spriteSourceSize.x,X.spriteSourceSize.y,X.sourceSize.w,X.sourceSize.h,a.getRes(x)),a.cacheTexture(x,Y),Y.url=x,H.push(x)}else for(V in O)z=N[(X=O[V]).frame.idx?X.frame.idx:0],x=U+V,Y=w.Texture._create(z,X.frame.x,X.frame.y,X.frame.w,X.frame.h,X.spriteSourceSize.x,X.spriteSourceSize.y,X.sourceSize.w,X.sourceSize.h,a.getRes(x)),a.cacheTexture(x,Y),Y.url=x,H.push(x);delete this._data.pics,this.complete(this._data)}else if(S===a.FONT){if(!t._source)return this._data=t,this.event(b.Event.PROGRESS,.5),this._loadResourceFilter(a.IMAGE,this._url.replace(".fnt",".png"));var j=new L.BitmapFont;j.parseFont(this._data,new w.Texture(t));var K=this._url.split(".fnt")[0].split("/"),q=K[K.length-1];m.Text.registerBitmapFont(q,j),this._data=j,this.complete(this._data)}else if(S===a.PREFAB){var Z=new g.Prefab;Z.json=t,this.complete(Z)}else this.complete(t)}},{key:"parsePLFData",value:function(t){var e,n,i;for(e in t)for(n in i=t[e])a.preLoadedMap[I.URL.formatURL(n)]=i[n]}},{key:"parsePLFBData",value:function(t){var e,n,i;for(i=(e=new E.Byte(t)).getInt32(),n=0;n<i;n++)this.parseOnePLFBFile(e)}},{key:"parseOnePLFBFile",value:function(t){var e,n,i;n=t.getUTFString(),e=t.getInt32(),i=t.readArrayBuffer(e),a.preLoadedMap[I.URL.formatURL(n)]=i}},{key:"complete",value:function(t){this._data=t,this._customParse?this.event(b.Event.LOADED,t instanceof Array?[t]:t):(a._loaders.push(this),a._isWorking||a.checkNext())}},{key:"endLoad",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t&&(this._data=t),this._cache&&a.cacheRes(this._url,this._data),this.event(b.Event.PROGRESS,1),this.event(b.Event.COMPLETE,this.data instanceof Array?[this.data]:this.data)}},{key:"url",get:function(){return this._url}},{key:"type",get:function(){return this._type}},{key:"cache",get:function(){return this._cache}},{key:"data",get:function(){return this._data}}],i=[{key:"getTypeFromUrl",value:function(t){var e=M.Utils.getFileExtension(t);return e?a.typeMap[e]:(console.warn("Not recognize the resources suffix",t),"text")}},{key:"checkNext",value:function(){a._isWorking=!0;for(var t=C.Browser.now();a._startIndex<a._loaders.length;)if(a._loaders[a._startIndex].endLoad(),a._startIndex++,C.Browser.now()-t>a.maxTimeOut)return console.warn("loader callback cost a long time:"+(C.Browser.now()-t)+" url="+a._loaders[a._startIndex-1].url),void v.ILaya.systemTimer.frameOnce(1,null,a.checkNext);a._loaders.length=0,a._startIndex=0,a._isWorking=!1}},{key:"clearRes",value:function(t){t=I.URL.formatURL(t);var e=a.getAtlas(t);if(e){for(var n=0,i=e.length;n<i;n++){var r=e[n],o=a.getRes(r);delete a.textureMap[r],o&&o.destroy()}e.length=0,delete a.atlasMap[t]}var s=a.textureMap[t];s&&(s.destroy(),delete a.textureMap[t]),a.loadedMap[t]&&delete a.loadedMap[t]}},{key:"clearTextureRes",value:function(t){t=I.URL.formatURL(t);var e=a.getAtlas(t);if(e&&e.length>0)(0,d.default)(e).call(e,(function(t){var e=a.getRes(t);e instanceof w.Texture&&e.disposeBitmap()}));else{var n=a.getRes(t);n instanceof w.Texture&&n.disposeBitmap()}}},{key:"getRes",value:function(t){var e=a.textureMap[I.URL.formatURL(t)];return e||a.loadedMap[I.URL.formatURL(t)]}},{key:"getAtlas",value:function(t){return a.atlasMap[I.URL.formatURL(t)]}},{key:"cacheRes",value:function(t,e){t=I.URL.formatURL(t),null!=a.loadedMap[t]?console.warn("Resources already exist,is repeated loading:",t):e instanceof w.Texture?(a.loadedMap[t]=e.bitmap,a.textureMap[t]=e):a.loadedMap[t]=e}},{key:"cacheResForce",value:function(t,e){a.loadedMap[t]=e}},{key:"cacheTexture",value:function(t,e){t=I.URL.formatURL(t),null!=a.textureMap[t]?console.warn("Resources already exist,is repeated loading:",t):a.textureMap[t]=e}},{key:"setGroup",value:function(t,e){a.groupMap[e]||(a.groupMap[e]=[]),a.groupMap[e].push(t)}},{key:"clearResByGroup",value:function(t){if(a.groupMap[t]){var e,n=a.groupMap[t],i=n.length;for(e=0;e<i;e++)a.clearRes(n[e]);n.length=0}}}],n&&O(e.prototype,n),i&&O(e,i),a}(T.EventDispatcher);e.Loader=H,H.TEXT="text",H.JSON="json",H.PREFAB="prefab",H.XML="xml",H.BUFFER="arraybuffer",H.IMAGE="image",H.SOUND="sound",H.ATLAS="atlas",H.FONT="font",H.TTF="ttf",H.PLF="plf",H.PLFB="plfb",H.HIERARCHY="HIERARCHY",H.MESH="MESH",H.MATERIAL="MATERIAL",H.TEXTURE2D="TEXTURE2D",H.TEXTURECUBE="TEXTURECUBE",H.ANIMATIONCLIP="ANIMATIONCLIP",H.AVATAR="AVATAR",H.TERRAINHEIGHTDATA="TERRAINHEIGHTDATA",H.TERRAINRES="TERRAIN",H.typeMap={ttf:"ttf",png:"image",jpg:"image",jpeg:"image",ktx:"image",pvr:"image",txt:"text",json:"json",prefab:"prefab",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",plf:"plf",plfb:"plfb",scene:"json",ani:"json",sk:"arraybuffer",wasm:"arraybuffer"},H.parserMap={},H.maxTimeOut=100,H.groupMap={},H.loadedMap={},H.atlasMap={},H.textureMap={},H.preLoadedMap={},H._imgCache={},H._loaders=[],H._isWorking=!1,H._startIndex=0},33063:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.LoaderManager=void 0;var h=w(n(81643)),c=w(n(85507)),f=w(n(21611)),_=n(92493),d=n(89662),p=n(48856),y=n(84935),v=n(25883),g=n(54598),m=n(41107),b=n(56083),T=n(68291),x=n(85096);function w(t){return t&&t.__esModule?t:{default:t}}function k(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function C(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function E(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&S(t,e)}function S(t,e){return S=a||function(t,e){return t.__proto__=e,t},S(t,e)}function M(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=R(t);if(e){var a=R(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return L(this,n)}}function L(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function R(t){return R=c.default?f.default:function(t){return t.__proto__||(0,f.default)(t)},R(t)}var I=function(t){E(a,t);var e,n,i,r=M(a);function a(){var t;k(this,a),(t=r.call(this)).retryNum=1,t.retryDelay=0,t.maxLoader=5,t._loaders=[],t._loaderCount=0,t._resInfos=[],t._infoPool=[],t._maxPriority=5,t._failRes={},t._statInfo={count:1,loaded:1};for(var e=0;e<t._maxPriority;e++)t._resInfos[e]=[];return t}return e=a,n=[{key:"getProgress",value:function(){return this._statInfo.loaded/this._statInfo.count}},{key:"resetProgress",value:function(){this._statInfo.count=this._statInfo.loaded=1}},{key:"create",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];this._create(t,!0,e,n,i,r,a,o,s)}},{key:"_create",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,u=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];if(t instanceof Array){var l=!0,h=t,c=h.length,f=0;if(i)var _=m.Handler.create(i.caller,i?i.method:null,i.args,!1);for(var d=0;d<c;d++){var p=h[d];"string"==typeof p&&(p=h[d]={url:p}),p.progress=0}for(d=0;d<c;d++){p=h[d];var y=i?m.Handler.create(null,(function(t,e){t.progress=e;for(var n=0,i=0;i<c;i++)n+=h[i].progress;var r=n/c;_.runWith(r)}),[p],!1):null,v=i||n?m.Handler.create(null,(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;f++,t.progress=1,e||(l=!1),f===c&&n&&n.runWith(l)}),[p]):null;this._createOne(p.url,e,v,y,p.type||r,p.constructParams||a,p.propertyParams||o,p.priority||s,u)}}else this._createOne(t,e,n,i,r,a,o,s,u)}},{key:"_createOne",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,l=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],h=this.getRes(t);if(h)!e&&h instanceof v.Resource&&h._addReference(),i&&i.runWith(1),n&&n.runWith(h);else{var c=a.createMap[b.Utils.getFilecompatibleExtension(t)]?b.Utils.getFilecompatibleExtension(t):b.Utils.getFileExtension(t);if(r||(r=a.createMap[c]?a.createMap[c][0]:null),!r)return void this.load(t,n,i,r,u,l);var f=x.Loader.parserMap;if(!f[r])return void this.load(t,n,i,r,u,l);this._createLoad(t,m.Handler.create(null,(function(i){i&&(!e&&i instanceof v.Resource&&i._addReference(),i._setCreateURL(t)),n&&n.runWith(i),_.ILaya.loader.event(t)})),i,r,o,s,u,l,!0)}}},{key:"load",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,l=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:_.ILaya.WorkerLoader.enable;if(t instanceof Array)return this._loadAssets(t,n,i,r,o,s,u);if(r||(r=0===(0,h.default)(t).call(t,"data:image")?x.Loader.IMAGE:x.Loader.getTypeFromUrl(t)),r===x.Loader.IMAGE?(e=x.Loader.textureMap[y.URL.formatURL(t)])&&(!e.bitmap||e.bitmap&&e.bitmap.destroyed)&&(e=null):e=x.Loader.loadedMap[y.URL.formatURL(t)],l||null==e){var f;f=t,(t=T.AtlasInfoManager.getFileLoadPath(t))!=f&&"nativeimage"!==r?r=x.Loader.ATLAS:f=null;var p=a._resMap[t];p?(n&&(f?n&&p._createListener(d.Event.COMPLETE,this,this._resInfoLoaded,[f,n],!1,!1):n&&p._createListener(d.Event.COMPLETE,n.caller,n.method,n.args,!1,!1)),i&&p._createListener(d.Event.PROGRESS,i.caller,i.method,i.args,!1,!1)):((p=this._infoPool.length?this._infoPool.pop():new A).url=t,p.type=r,p.cache=s,p.group=u,p.ignoreCache=l,p.useWorkerLoader=c,p.originalUrl=f,n&&p.on(d.Event.COMPLETE,n.caller,n.method,n.args),i&&p.on(d.Event.PROGRESS,i.caller,i.method,i.args),a._resMap[t]=p,o=o<this._maxPriority?o:this._maxPriority-1,this._resInfos[o].push(p),this._statInfo.count++,this.event(d.Event.PROGRESS,this.getProgress()),this._next())}else _.ILaya.systemTimer.callLater(this,(function(){i&&i.runWith(1),n&&n.runWith(e instanceof Array?[e]:e),this._loaderCount||this.event(d.Event.COMPLETE)}));return this}},{key:"_resInfoLoaded",value:function(t,e){e.runWith(x.Loader.getRes(t))}},{key:"_createLoad",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,u=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];if(t instanceof Array)return this._loadAssets(t,e,n,i,s,u);var h=x.Loader.getRes(t);if(null!=h)_.ILaya.systemTimer.frameOnce(1,this,(function(){n&&n.runWith(1),e&&e.runWith(h),this._loaderCount||this.event(d.Event.COMPLETE)}));else{var c=a._resMap[t];c?(e&&c._createListener(d.Event.COMPLETE,e.caller,e.method,e.args,!1,!1),n&&c._createListener(d.Event.PROGRESS,n.caller,n.method,n.args,!1,!1)):((c=this._infoPool.length?this._infoPool.pop():new A).url=t,c.type=i,c.cache=!1,c.ignoreCache=l,c.originalUrl=null,c.group=null,c.createCache=u,c.createConstructParams=r,c.createPropertyParams=o,e&&c.on(d.Event.COMPLETE,e.caller,e.method,e.args),n&&c.on(d.Event.PROGRESS,n.caller,n.method,n.args),a._resMap[t]=c,s=s<this._maxPriority?s:this._maxPriority-1,this._resInfos[s].push(c),this._statInfo.count++,this.event(d.Event.PROGRESS,this.getProgress()),this._next())}return this}},{key:"_next",value:function(){if(!(this._loaderCount>=this.maxLoader)){for(var t=0;t<this._maxPriority;t++)for(var e=this._resInfos[t];e.length>0;){var n=e.shift();if(n)return this._doLoad(n)}this._loaderCount||this.event(d.Event.COMPLETE)}}},{key:"_doLoad",value:function(t){this._loaderCount++;var e=this._loaders.length?this._loaders.pop():new x.Loader;e.on(d.Event.COMPLETE,null,i),e.on(d.Event.PROGRESS,null,(function(e){t.event(d.Event.PROGRESS,e)})),e.on(d.Event.ERROR,null,(function(t){i(null)}));var n=this;function i(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e.offAll(),e._data=null,e._customParse=!1,n._loaders.push(e),n._endLoad(t,i instanceof Array?[i]:i),n._loaderCount--,n._next()}e._constructParams=t.createConstructParams,e._propertyParams=t.createPropertyParams,e._createCache=t.createCache,e.load(t.url,t.type,t.cache,t.group,t.ignoreCache,t.useWorkerLoader)}},{key:"_endLoad",value:function(t,e){var n=t.url;if(null==e){var i=this._failRes[n]||0;if(i<this.retryNum)return console.warn("[warn]Retry to load:",n),this._failRes[n]=i+1,void _.ILaya.systemTimer.once(this.retryDelay,this,this._addReTry,[t],!1);x.Loader.clearRes(n),console.warn("[error]Failed to load:",n),this.event(d.Event.ERROR,n)}this._failRes[n]&&(this._failRes[n]=0),delete a._resMap[n],t.originalUrl&&(e=x.Loader.getRes(t.originalUrl)),t.event(d.Event.COMPLETE,e),t.offAll(),this._infoPool.push(t),this._statInfo.loaded++,this.event(d.Event.PROGRESS,this.getProgress())}},{key:"_addReTry",value:function(t){this._resInfos[this._maxPriority-1].push(t),this._next()}},{key:"clearRes",value:function(t){x.Loader.clearRes(t)}},{key:"clearTextureRes",value:function(t){x.Loader.clearTextureRes(t)}},{key:"getRes",value:function(t){return x.Loader.getRes(t)}},{key:"cacheRes",value:function(t,e){x.Loader.cacheRes(t,e)}},{key:"setGroup",value:function(t,e){x.Loader.setGroup(t,e)}},{key:"clearResByGroup",value:function(t){x.Loader.clearResByGroup(t)}},{key:"clearUnLoaded",value:function(){for(var t=0;t<this._maxPriority;t++){for(var e=this._resInfos[t],n=e.length-1;n>-1;n--){var i=e[n];i&&(i.offAll(),this._infoPool.push(i))}e.length=0}this._loaderCount=0,a._resMap={}}},{key:"cancelLoadByUrls",value:function(t){if(t)for(var e=0,n=t.length;e<n;e++)this.cancelLoadByUrl(t[e])}},{key:"cancelLoadByUrl",value:function(t){for(var e=0;e<this._maxPriority;e++)for(var n=this._resInfos[e],i=n.length-1;i>-1;i--){var r=n[i];r&&r.url===t&&(n[i]=null,r.offAll(),this._infoPool.push(r))}a._resMap[t]&&delete a._resMap[t]}},{key:"_loadAssets",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=t.length,u=0,l=0,h=[],c=!0,f=0;f<s;f++){var _=t[f],d=void 0;(d="string"==typeof _?{url:_,type:i,size:1,priority:r}:_).size||(d.size=1),d.progress=0,l+=d.size,h.push(d);var p=n?m.Handler.create(null,g,[d],!1):null,y=e||n?m.Handler.create(null,v,[d]):null;this.load(d.url,y,p,d.type,d.priority||1,a,d.group||o,!1,d.useWorkerLoader)}function v(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;u++,t.progress=1,n||(c=!1),u===s&&e&&e.runWith(c)}function g(t,e){if(null!=n){t.progress=e;for(var i=0,r=0;r<h.length;r++){var a=h[r];if(a){var o=null==a.progress?0:a.progress;i+=null==a.size?0:a.size*o}}var s=i/l;n.runWith(s)}}return this}},{key:"decodeBitmaps",value:function(t){var e,n,i=t.length;for(n=_.ILaya.Render._context,e=0;e<i;e++){var r,a;(r=x.Loader.getAtlas(t[e]))?this._decodeTexture(r[0],n):(a=this.getRes(t[e]))&&a instanceof g.Texture&&this._decodeTexture(a,n)}}},{key:"_decodeTexture",value:function(t,e){var n=t.bitmap;if(t&&n){var i=n.source||n.image;i&&i instanceof HTMLImageElement&&(e.drawImage(i,0,0,1,1),e.getImageData(0,0,1,1))}}}],i=[{key:"cacheRes",value:function(t,e){x.Loader.cacheRes(t,e)}}],n&&C(e.prototype,n),i&&C(e,i),a}(p.EventDispatcher);e.LoaderManager=I,I._resMap={},I.createMap={atlas:[null,x.Loader.ATLAS]};var A=function(t){E(n,t);var e=M(n);function n(){return k(this,n),e.apply(this,arguments)}return n}(p.EventDispatcher)},20966:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.LocalStorage=void 0;var i=a(n(59340)),r=a(n(63978));function a(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}function u(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}var l=function(){function t(){o(this,t)}return u(t,null,[{key:"__init__",value:function(){return t._baseClass||(t._baseClass=h,h.init()),t.items=t._baseClass.items,t.support=t._baseClass.support,t.support}},{key:"setItem",value:function(e,n){t._baseClass.setItem(e,n)}},{key:"getItem",value:function(e){return t._baseClass.getItem(e)}},{key:"setJSON",value:function(e,n){t._baseClass.setJSON(e,n)}},{key:"getJSON",value:function(e){return t._baseClass.getJSON(e)}},{key:"removeItem",value:function(e){t._baseClass.removeItem(e)}},{key:"clear",value:function(){t._baseClass.clear()}}]),t}();e.LocalStorage=l,l.support=!1;var h=function(){function t(){o(this,t)}return u(t,null,[{key:"init",value:function(){try{t.support=!0,t.items=window.localStorage,t.setItem("laya","1"),t.removeItem("laya")}catch(e){t.support=!1}t.support||console.log("LocalStorage is not supprot or browser is private mode.")}},{key:"setItem",value:function(e,n){try{t.support&&t.items.setItem(e,n)}catch(t){console.warn("set localStorage failed",t)}}},{key:"getItem",value:function(e){return t.support?t.items.getItem(e):null}},{key:"setJSON",value:function(e,n){try{t.support&&t.items.setItem(e,(0,i.default)(n))}catch(t){console.warn("set localStorage failed",t)}}},{key:"getJSON",value:function(e){try{return JSON.parse(t.support?t.items.getItem(e):null)}catch(n){return t.items.getItem(e)}}},{key:"removeItem",value:function(e){t.support&&t.items.removeItem(e)}},{key:"clear",value:function(){t.support&&t.items.clear()}}]),t}();h.support=!1},8863:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.SceneLoader=void 0;var h=x(n(81643)),c=x(n(85507)),f=x(n(21611)),_=n(85096),d=n(92493),p=n(68291),y=n(33063),v=n(72643),g=n(89662),m=n(48856),b=n(41107),T=n(56083);function x(t){return t&&t.__esModule?t:{default:t}}function w(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function k(t,e){return k=a||function(t,e){return t.__proto__=e,t},k(t,e)}function C(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=M(t);if(e){var a=M(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return E(this,n)}}function E(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return S(t)}function S(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function M(t){return M=c.default?f.default:function(t){return t.__proto__||(0,f.default)(t)},M(t)}var L=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&k(t,e)}(a,t);var e,n,i,r=C(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this))._completeHandler=new b.Handler(S(t),t.onOneLoadComplete),t.reset(),t}return e=a,n=[{key:"reset",value:function(){this._toLoadList=[],this._isLoading=!1,this.totalCount=0}},{key:"leftCount",get:function(){return this._isLoading?this._toLoadList.length+1:this._toLoadList.length}},{key:"loadedCount",get:function(){return this.totalCount-this.leftCount}},{key:"load",value:function(t){var e,n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t instanceof Array)for(n=t.length,e=0;e<n;e++)this._addToLoadList(t[e],i);else this._addToLoadList(t,i);r&&this._checkNext()}},{key:"_addToLoadList",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,h.default)(e=this._toLoadList).call(e,t)>=0||_.Loader.getRes(t)||(n?this._toLoadList.push({url:t}):this._toLoadList.push(t),this.totalCount++)}},{key:"_checkNext",value:function(){if(!this._isLoading){if(0==this._toLoadList.length)return void this.event(g.Event.COMPLETE);var t;"string"==typeof(t=this._toLoadList.pop())?this.loadOne(t):this.loadOne(t.url,!0)}}},{key:"loadOne",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._curUrl=t;var n=T.Utils.getFileExtension(this._curUrl);e?d.ILaya.loader.create(t,this._completeHandler):a.LoadableExtensions[n]?d.ILaya.loader.load(t,this._completeHandler,null,a.LoadableExtensions[n]):t!=p.AtlasInfoManager.getFileLoadPath(t)||a.No3dLoadTypes[n]||!y.LoaderManager.createMap[n]?d.ILaya.loader.load(t,this._completeHandler):d.ILaya.loader.create(t,this._completeHandler)}},{key:"onOneLoadComplete",value:function(){this._isLoading=!1,_.Loader.getRes(this._curUrl)||console.log("Fail to load:",this._curUrl);var t,e=T.Utils.getFileExtension(this._curUrl);a.LoadableExtensions[e]&&((t=_.Loader.getRes(this._curUrl))&&t instanceof v.Prefab&&(t=t.json),t&&(t.loadList&&this.load(t.loadList,!1,!1),t.loadList3D&&this.load(t.loadList3D,!0,!1))),"sk"==e&&this.load(this._curUrl.replace(".sk",".png"),!1,!1),this.event(g.Event.PROGRESS,this.getProgress()),this._checkNext()}},{key:"getProgress",value:function(){return this.loadedCount/this.totalCount}}],n&&w(e.prototype,n),i&&w(e,i),a}(m.EventDispatcher);e.SceneLoader=L,L.LoadableExtensions={scene:_.Loader.JSON,scene3d:_.Loader.JSON,ani:_.Loader.JSON,ui:_.Loader.JSON,prefab:_.Loader.PREFAB},L.No3dLoadTypes={png:!0,jpg:!0,txt:!0}},65356:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.TTFLoader=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(92493),o=n(89662),s=n(93568),u=n(46785),l=n(85096);function h(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var c=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,n=[{key:"load",value:function(t){this._url=t;var e=t.toLowerCase().split(".ttf")[0].split("/");this.fontName=e[e.length-1],a.ILaya.Render.isConchApp?this._loadConch():window.FontFace?this._loadWithFontFace():this._loadWithCSS()}},{key:"_loadConch",value:function(){this._http=new u.HttpRequest,this._http.on(o.Event.ERROR,this,this._onErr),this._http.on(o.Event.COMPLETE,this,this._onHttpLoaded),this._http.send(this._url,null,"get",l.Loader.BUFFER)}},{key:"_onHttpLoaded",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;window.conchTextCanvas.setFontFaceFromBuffer(this.fontName,t),this._clearHttp(),this._complete()}},{key:"_clearHttp",value:function(){this._http&&(this._http.off(o.Event.ERROR,this,this._onErr),this._http.off(o.Event.COMPLETE,this,this._onHttpLoaded),this._http=null)}},{key:"_onErr",value:function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)}},{key:"_complete",value:function(){a.ILaya.systemTimer.clear(this,this._complete),a.ILaya.systemTimer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)}},{key:"_checkComplete",value:function(){a.ILaya.Browser.measureText(t._testString,this._fontTxt).width!=this._txtWidth&&this._complete()}},{key:"_loadWithFontFace",value:function(){var t=new window.FontFace(this.fontName,"url('"+this._url+"')");document.fonts.add(t);var e=this;t.loaded.then((function(){e._complete()})),t.load()}},{key:"_createDiv",value:function(){this._div=s.Browser.createElement("div"),this._div.innerHTML="laya";var t=this._div.style;t.fontFamily=this.fontName,t.position="absolute",t.left="-100px",t.top="-100px",document.body.appendChild(this._div)}},{key:"_loadWithCSS",value:function(){var e=s.Browser.createElement("style");e.type="text/css",document.body.appendChild(e),e.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=s.Browser.measureText(t._testString,this._fontTxt).width;var n=this;e.onload=function(){a.ILaya.systemTimer.once(1e4,n,n._complete)},a.ILaya.systemTimer.loop(20,this,this._checkComplete),this._createDiv()}}],n&&h(e.prototype,n),i&&h(e,i),t}();e.TTFLoader=c,c._testString="LayaTTFFont"},84935:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.URL=void 0;var i=u(n(81643)),r=u(n(92762)),a=u(n(23054)),o=u(n(63978)),s=n(92493);function u(t){return t&&t.__esModule?t:{default:t}}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,o.default)(t,i.key,i)}}var h=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._url=t.formatURL(e),this._path=t.getPath(e)}var e,n,o;return e=t,o=[{key:"basePath",get:function(){return t._basePath},set:function(e){t._basePath=s.ILaya.Laya._getUrlPath(),t._basePath=t.formatURL(e)}},{key:"formatURL",value:function(e){if(!e)return"null path";if((0,i.default)(e).call(e,":")>0)return e;t.exportSceneToJson&&(e=t.getAdptedFilePath(e)),null!=t.customFormat&&(e=t.customFormat(e));var n=e.charAt(0);if("."===n)return t._formatRelativePath(t._basePath+e);if("~"===n)return t.rootPath+e.substring(1);if("d"===n){if(0===(0,i.default)(e).call(e,"data:image"))return e}else if("/"===n)return e;return t._basePath+e}},{key:"_formatRelativePath",value:function(t){for(var e=t.split("/"),n=0,i=e.length;n<i;n++)".."==e[n]&&((0,r.default)(e).call(e,n-1,2),n-=2);return e.join("/")}},{key:"getPath",value:function(t){var e=(0,a.default)(t).call(t,"/");return e>0?t.substr(0,e+1):""}},{key:"getFileName",value:function(t){var e=(0,a.default)(t).call(t,"/");return e>0?t.substr(e+1):t}},{key:"getAdptedFilePath",value:function(e){if(!t.exportSceneToJson||!e)return e;var n,i,r;for(i=t._adpteTypeList.length,n=0;n<i;n++)r=t._adpteTypeList[n],e=e.replace(r[0],r[1]);return e}}],(n=[{key:"url",get:function(){return this._url}},{key:"path",get:function(){return this._path}}])&&l(e.prototype,n),o&&l(e,o),t}();e.URL=h,h.version={},h.exportSceneToJson=!1,h._basePath="",h.rootPath="",h.customFormat=function(t){var e=h.version[t];return!window.conch&&e&&(t+="?v="+e),t},h._adpteTypeList=[[".scene3d",".json"],[".scene",".json"],[".taa",".json"],[".prefab",".json"]]},37397:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.WorkerLoader=void 0;var h=v(n(85507)),c=v(n(21611)),f=n(85096),_=n(84935),d=n(48856),p=n(87035),y=n(69176);function v(t){return t&&t.__esModule?t:{default:t}}function g(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function m(t,e){return m=a||function(t,e){return t.__proto__=e,t},m(t,e)}function b(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=w(t);if(e){var a=w(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return T(this,n)}}function T(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return x(t)}function x(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function w(t){return w=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},w(t)}var k=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(a,t);var e,n,i,r=b(a);function a(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this)).worker=new Worker(a.workerPath);var e=x(t);return t.worker.onmessage=function(t){e.workerMessage(t.data)},t}return e=a,i=[{key:"__init__",value:function(){return null==a._preLoadFun&&!!Worker&&(a._preLoadFun=f.Loader.prototype._loadImage,f.Loader.prototype._loadImage=a.prototype._loadImage,a.I||(a.I=new a),!0)}},{key:"workerSupported",value:function(){return!!Worker}},{key:"enableWorkerLoader",value:function(){a._tryEnabled||(a.enable=!0,a._tryEnabled=!0)}},{key:"enable",get:function(){return a._enable},set:function(t){a._enable!=t&&(a._enable=t,t&&null==a._preLoadFun&&(a._enable=a.__init__()))}}],(n=[{key:"workerMessage",value:function(t){if(t)switch(t.type){case"Image":this.imageLoaded(t);break;case"Disable":a.enable=!1}}},{key:"imageLoaded",value:function(t){if(t.dataType&&"imageBitmap"==t.dataType){var e=t.imageBitmap;console.log("load:",t.url),this.event(t.url,e)}else this.event(t.url,null)}},{key:"loadImage",value:function(t){this.worker.postMessage(t)}},{key:"_loadImage",value:function(t){var e=this,n=e.type;if(this._useWorkerLoader&&a._enable){t=_.URL.formatURL(t);var i=function(i){if(r(),i){var o=i;"nativeimage"!==n&&((o=new p.Texture2D).wrapModeU=y.WarpMode.Clamp,o.wrapModeV=y.WarpMode.Clamp,o.loadImageSource(i,!0)),e.onLoaded(o)}else a._preLoadFun.call(e,t)};a.I.on(t,e,i),a.I.loadImage(t)}else a._preLoadFun.call(e,t);function r(){a.I.off(t,e,i)}}}])&&g(e.prototype,n),i&&g(e,i),a}(d.EventDispatcher);e.WorkerLoader=k,k.workerPath="libs/workerloader.js",k._enable=!1,k._tryEnabled=!1},64469:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.LayaGLQuickRunner=void 0;var i=u(n(2991)),r=u(n(63978)),a=n(13407),o=n(43745),s=n(18008);function u(t){return t&&t.__esModule?t:{default:t}}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var h=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,r=[{key:"__init__",value:function(){(0,i.default)(t)[o.SpriteConst.ALPHA|o.SpriteConst.TRANSFORM|o.SpriteConst.GRAPHICS]=t.alpha_transform_drawLayaGL,(0,i.default)(t)[o.SpriteConst.ALPHA|o.SpriteConst.GRAPHICS]=t.alpha_drawLayaGL,(0,i.default)(t)[o.SpriteConst.TRANSFORM|o.SpriteConst.GRAPHICS]=t.transform_drawLayaGL,(0,i.default)(t)[o.SpriteConst.TRANSFORM|o.SpriteConst.CHILDS]=t.transform_drawNodes,(0,i.default)(t)[o.SpriteConst.ALPHA|o.SpriteConst.TRANSFORM|o.SpriteConst.TEXTURE]=t.alpha_transform_drawTexture,(0,i.default)(t)[o.SpriteConst.ALPHA|o.SpriteConst.TEXTURE]=t.alpha_drawTexture,(0,i.default)(t)[o.SpriteConst.TRANSFORM|o.SpriteConst.TEXTURE]=t.transform_drawTexture,(0,i.default)(t)[o.SpriteConst.GRAPHICS|o.SpriteConst.CHILDS]=t.drawLayaGL_drawNodes}},{key:"transform_drawTexture",value:function(e,n,i,r){e._style;var a=e.texture;n.saveTransform(t.curMat),n.transformByMatrix(e.transform,i,r);var o=e._width||a.sourceWidth,s=e._height||a.sourceHeight,u=o/a.sourceWidth,l=s/a.sourceHeight;if(o=a.width*u,s=a.height*l,o<=0||s<=0)return null;var h=-e.pivotX+a.offsetX*u,c=-e.pivotY+a.offsetY*l;n.drawTexture(a,h,c,o,s),n.restoreTransform(t.curMat)}},{key:"alpha_drawTexture",value:function(t,e,n,i){var r,a=t._style,o=t.texture;if((r=a.alpha)>.01||t._needRepaint()){var s=e.globalAlpha;e.globalAlpha*=r;var u=t._width||o.width,l=t._height||o.height,h=u/o.sourceWidth,c=l/o.sourceHeight;if(u=o.width*h,l=o.height*c,u<=0||l<=0)return null;var f=n-a.pivotX+o.offsetX*h,_=i-a.pivotY+o.offsetY*c;e.drawTexture(o,f,_,u,l),e.globalAlpha=s}}},{key:"alpha_transform_drawTexture",value:function(e,n,i,r){var a,o=e._style,s=e.texture;if((a=o.alpha)>.01||e._needRepaint()){var u=n.globalAlpha;n.globalAlpha*=a,n.saveTransform(t.curMat),n.transformByMatrix(e.transform,i,r);var l=e._width||s.sourceWidth,h=e._height||s.sourceHeight,c=l/s.sourceWidth,f=h/s.sourceHeight;if(l=s.width*c,h=s.height*f,l<=0||h<=0)return null;var _=-o.pivotX+s.offsetX*c,d=-o.pivotY+s.offsetY*f;n.drawTexture(s,_,d,l,h),n.restoreTransform(t.curMat),n.globalAlpha=u}}},{key:"alpha_transform_drawLayaGL",value:function(e,n,i,r){var a,o=e._style;if((a=o.alpha)>.01||e._needRepaint()){var s=n.globalAlpha;n.globalAlpha*=a,n.saveTransform(t.curMat),n.transformByMatrix(e.transform,i,r),e._graphics&&e._graphics._render(e,n,-o.pivotX,-o.pivotY),n.restoreTransform(t.curMat),n.globalAlpha=s}}},{key:"alpha_drawLayaGL",value:function(t,e,n,i){var r,a=t._style;if((r=a.alpha)>.01||t._needRepaint()){var o=e.globalAlpha;e.globalAlpha*=r,t._graphics&&t._graphics._render(t,e,n-a.pivotX,i-a.pivotY),e.globalAlpha=o}}},{key:"transform_drawLayaGL",value:function(e,n,i,r){var a=e._style;n.saveTransform(t.curMat),n.transformByMatrix(e.transform,i,r),e._graphics&&e._graphics._render(e,n,-a.pivotX,-a.pivotY),n.restoreTransform(t.curMat)}},{key:"transform_drawNodes",value:function(e,n,i,r){var o=e._getBit(a.Const.DRAWCALL_OPTIMIZE)&&n.drawCallOptimize(!0),s=e._style;n.saveTransform(t.curMat),n.transformByMatrix(e.transform,i,r),i=-s.pivotX,r=-s.pivotY;var u,l=e._children,h=l.length;if(s.viewport){var c,f,_=s.viewport,d=_.x,p=_.y,y=_.right,v=_.bottom;for(g=0;g<h;++g)(u=l[g])._visible&&(c=u._x)<y&&c+u.width>d&&(f=u._y)<v&&f+u.height>p&&u.render(n,i,r)}else for(var g=0;g<h;++g)(u=l[g])._visible&&u.render(n,i,r);n.restoreTransform(t.curMat),o&&n.drawCallOptimize(!1)}},{key:"drawLayaGL_drawNodes",value:function(t,e,n,i){var r=t._getBit(a.Const.DRAWCALL_OPTIMIZE)&&e.drawCallOptimize(!0),o=t._style;n-=o.pivotX,i-=o.pivotY,t._graphics&&t._graphics._render(t,e,n,i);var s,u=t._children,l=u.length;if(o.viewport){var h,c,f=o.viewport,_=f.x,d=f.y,p=f.right,y=f.bottom;for(v=0;v<l;++v)(s=u[v])._visible&&(h=s._x)<p&&h+s.width>_&&(c=s._y)<y&&c+s.height>d&&s.render(e,n,i)}else for(var v=0;v<l;++v)(s=u[v])._visible&&s.render(e,n,i);r&&e.drawCallOptimize(!1)}}],(n=null)&&l(e.prototype,n),r&&l(e,r),t}();e.LayaGLQuickRunner=h,h.map=[],h.curMat=new s.Matrix},85136:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Render=void 0;var i=b(n(31581)),r=b(n(63978)),a=n(92493),o=n(80340),s=n(33873),u=n(79741),l=n(62285),h=n(61266),c=n(91700),f=n(97246),_=n(43989),d=n(22245),p=n(15323),y=n(93055),v=n(46996),g=n(93568),m=n(12596);function b(t){return t&&t.__esModule?t:{default:t}}function T(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var x=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._timeId=0,t._mainCanvas=i;var r=t._mainCanvas.source;r.id="layaCanvas",r.width=e,r.height=n,t.isConchApp&&document.body.appendChild(r),this.initRender(t._mainCanvas,e,n),window.requestAnimationFrame((function t(e){a.ILaya.stage._loop(),window.requestAnimationFrame(t)})),a.ILaya.stage.on("visibilitychange",this,this._onVisibilitychange)}var e,n,r;return e=t,n=[{key:"_onVisibilitychange",value:function(){a.ILaya.stage.isVisibility?0!=this._timeId&&window.clearInterval(this._timeId):this._timeId=(0,i.default)(this._enterFrame,1e3)}},{key:"initRender",value:function(e,n,i){var r=s.LayaGL.instance=h.WebGLContext.mainContext=function(t){var e,n=["webgl2","webgl","experimental-webgl","webkit-3d","moz-webgl"];o.Config.useWebGL2&&!g.Browser.onBDMiniGame||n.shift();for(var i=0;i<n.length;i++){try{e=t.getContext(n[i],{stencil:o.Config.isStencil,alpha:o.Config.isAlpha,antialias:o.Config.isAntialias,premultipliedAlpha:o.Config.premultipliedAlpha,preserveDrawingBuffer:o.Config.preserveDrawingBuffer})}catch(t){}if(e)return"webgl2"===n[i]&&(l.WebGL._isWebGL2=!0),new s.LayaGL,e}return null}(t._mainCanvas.source);if(o.Config.printWebglOrder&&this._replaceWebglcall(r),!r)return!1;s.LayaGL.instance=r,s.LayaGL.layaGPUInstance=new v.LayaGPU(r,l.WebGL._isWebGL2),e.size(n,i),u.Context.__init__(),y.SubmitBase.__init__();var a=new u.Context;return a.isMain=!0,t._context=a,e._setContext(a),_.ShaderDefines2D.__init__(),d.Value2D.__init__(),f.Shader2D.__init__(),p.Buffer2D.__int__(r),c.BlendMode._init_(r),!0}},{key:"_replaceWebglcall",value:function(t){var e={},n=function(n){"function"==typeof t[n]&&"getError"!=n&&"__SPECTOR_Origin_getError"!=n&&"__proto__"!=n&&(e[n]=t[n],t[n]=function(){for(var i=[],r=0;r<arguments.length;r++)i.push(arguments[r]);var a=e[n].apply(t,i);console.log(m.RenderInfo.loopCount+":gl."+n+":"+i);var o=t.getError();return o&&console.log(o),a})};for(var i in t)n(i)}},{key:"_enterFrame",value:function(){a.ILaya.stage._loop()}}],r=[{key:"context",get:function(){return t._context}},{key:"canvas",get:function(){return t._mainCanvas.source}}],n&&T(e.prototype,n),r&&T(e,r),t}();e.Render=x,x.supportWebGLPlusAnimation=!1,x.supportWebGLPlusRendering=!1,x.isConchApp=!1,x.isConchApp=null!=window.conch,(x.isConchApp||null!=window.qq&&null!=window.qq.webglPlus)&&(x.supportWebGLPlusRendering=!1)},12596:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.RenderInfo=void 0;var i=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)};e.RenderInfo=i,i.loopStTm=0,i.loopCount=0},8272:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.RenderSprite=void 0;var i=T(n(2991)),r=T(n(63978)),a=n(13407),o=n(43745),s=n(81114),u=n(18008),l=n(98693),h=n(54598),c=n(95453),f=n(683),_=n(91700),d=n(37560),p=n(43989),y=n(22245),v=n(69153),g=n(61266),m=n(64469),b=n(92493);function T(t){return t&&t.__esModule?t:{default:t}}function x(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var w=function(){function t(e,n){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),(0,i.default)(m.LayaGLQuickRunner)[e])return this._fun=(0,i.default)(m.LayaGLQuickRunner)[e],void(this._next=t.NORENDER);switch(this._next=n||t.NORENDER,e){case 0:return void(this._fun=this._no);case o.SpriteConst.ALPHA:return void(this._fun=this._alpha);case o.SpriteConst.TRANSFORM:return void(this._fun=this._transform);case o.SpriteConst.BLEND:return void(this._fun=this._blend);case o.SpriteConst.CANVAS:return void(this._fun=this._canvas);case o.SpriteConst.MASK:return void(this._fun=this._mask);case o.SpriteConst.CLIP:return void(this._fun=this._clip);case o.SpriteConst.STYLE:return void(this._fun=this._style);case o.SpriteConst.GRAPHICS:return void(this._fun=this._graphics);case o.SpriteConst.CHILDS:return void(this._fun=this._children);case o.SpriteConst.CUSTOM:return void(this._fun=this._custom);case o.SpriteConst.TEXTURE:return void(this._fun=this._texture);case o.SpriteConst.FILTERS:return void(this._fun=s.Filter._filter);case t.INIT:return void(this._fun=t._initRenderFun)}this.onCreate(e)}var e,n,r;return e=t,r=[{key:"__init__",value:function(){var e,n,i;for(m.LayaGLQuickRunner.__init__(),i=new t(t.INIT,null),n=t.renders.length=2*o.SpriteConst.CHILDS,e=0;e<n;e++)t.renders[e]=i;t.renders[0]=new t(0,null)}},{key:"_initRenderFun",value:function(e,n,i,r){var a=e._renderType;(t.renders[a]=t._getTypeRender(a))._fun(e,n,i,r)}},{key:"_getTypeRender",value:function(e){if((0,i.default)(m.LayaGLQuickRunner)[e])return new t(e,null);for(var n=null,r=o.SpriteConst.CHILDS;r>0;)r&e&&(n=new t(r,n)),r>>=1;return n}},{key:"tmpTarget",value:function(t,e,n,i){e.start(),e.clear(0,0,0,0)}},{key:"recycleTarget",value:function(t){c.WebGLRTMgr.releaseRT(t)}},{key:"setBlendMode",value:function(t){var e=g.WebGLContext.mainContext;_.BlendMode.targetFns[_.BlendMode.TOINT[t]](e)}}],(n=[{key:"onCreate",value:function(t){}},{key:"_style",value:function(t,e,n,i){var r=t._style;null!=r.render&&r.render(t,e,n,i);var a=this._next;a._fun.call(a,t,e,n,i)}},{key:"_no",value:function(t,e,n,i){}},{key:"_custom",value:function(t,e,n,i){t.customRender(e,n,i),this._next._fun.call(this._next,t,e,0,0)}},{key:"_clip",value:function(e,n,i,r){var a=this._next;if(a!=t.NORENDER){var o=e._style.scrollRect,s=o.width,u=o.height;0!==s&&0!==u&&(n.save(),n.clipRect(i,r,s,u),a._fun.call(a,e,n,i-o.x,r-o.y),n.restore())}}},{key:"_texture",value:function(e,n,i,r){var a=e.texture;if(a._getSource()){var o=e._width||a.sourceWidth,s=e._height||a.sourceHeight,u=o/a.sourceWidth,l=s/a.sourceHeight;if(o=a.width*u,s=a.height*l,o<=0||s<=0)return;var h=i-e.pivotX+a.offsetX*u,c=r-e.pivotY+a.offsetY*l;n.drawTexture(a,h,c,o,s)}var f=this._next;f!=t.NORENDER&&f._fun.call(f,e,n,i,r)}},{key:"_graphics",value:function(e,n,i,r){var a=e._style,o=e._graphics;o&&o._render(e,n,i-a.pivotX,r-a.pivotY);var s=this._next;s!=t.NORENDER&&s._fun.call(s,e,n,i,r)}},{key:"_image",value:function(t,e,n,i){var r=t._style;e.drawTexture2(n,i,r.pivotX,r.pivotY,t.transform,t._graphics._one)}},{key:"_image2",value:function(t,e,n,i){var r=t._style;e.drawTexture2(n,i,r.pivotX,r.pivotY,t.transform,t._graphics._one)}},{key:"_alpha",value:function(t,e,n,i){var r;if((r=t._style.alpha)>.01||t._needRepaint()){var a=e.globalAlpha;e.globalAlpha*=r;var o=this._next;o._fun.call(o,t,e,n,i),e.globalAlpha=a}}},{key:"_transform",value:function(e,n,i,r){var a=e.transform,o=this._next;e._style,a&&o!=t.NORENDER?(n.save(),n.transform(a.a,a.b,a.c,a.d,a.tx+i,a.ty+r),o._fun.call(o,e,n,0,0),n.restore()):o!=t.NORENDER&&o._fun.call(o,e,n,i,r)}},{key:"_children",value:function(t,e,n,i){var r,o=t._style,s=t._children,u=s.length;n-=t.pivotX,i-=t.pivotY;var l=t._getBit(a.Const.DRAWCALL_OPTIMIZE)&&e.drawCallOptimize(!0);if(o.viewport){var h,c,f=o.viewport,_=f.x,d=f.y,p=f.right,y=f.bottom;for(v=0;v<u;++v)(r=s[v])._visible&&(h=r._x)<p&&h+r.width>_&&(c=r._y)<y&&c+r.height>d&&r.render(e,n,i)}else for(var v=0;v<u;++v)(r=s[v])._visible&&r.render(e,n,i);l&&e.drawCallOptimize(!1)}},{key:"_canvas",value:function(t,e,n,i){var r=t._cacheStyle,a=this._next;if(r.enableCanvasRender){"bitmap"===r.cacheAs?f.Stat.canvasBitmap++:f.Stat.canvasNormal++;var o=!1,s=!1;if(r.canvas){var u=r.canvas,l=(u.context,u.touches);if(l)for(var h=0;h<l.length;h++)if(l[h].deleted){s=!0;break}o=u.isCacheValid&&!u.isCacheValid()}if(t._needRepaint()||!r.canvas||s||o||b.ILaya.stage.isGlobalRepaint())if("normal"===r.cacheAs){if(e._targets)return void a._fun.call(a,t,e,n,i);this._canvas_webgl_normal_repaint(t,e)}else this._canvas_repaint(t,e,n,i);var c=r.cacheRect;e.drawCanvas(r.canvas,n+c.x,i+c.y,c.width,c.height)}else a._fun.call(a,t,e,n,i)}},{key:"_canvas_repaint",value:function(t,e,n,i){var r,a,o,s,u,l,h,c,_,d=t._cacheStyle,p=this._next,y=d.canvas,v=d.cacheAs;if(h=(_=d._calculateCacheRect(t,v,n,i)).x,c=_.y,u=(s=d.cacheRect).width*h,l=s.height*c,a=s.x,o=s.y,"bitmap"===v&&(u>2048||l>2048))return console.warn("cache bitmap size larger than 2048,cache ignored"),d.releaseContext(),void p._fun.call(p,t,e,n,i);if(y||(d.createContext(),y=d.canvas),(r=y.context).sprite=t,(y.width!=u||y.height!=l)&&y.size(u,l),"bitmap"===v?r.asBitmap=!0:"normal"===v&&(r.asBitmap=!1),r.clear(),1!=h||1!=c){var g=r;g.save(),g.scale(h,c),p._fun.call(p,t,r,-a,-o),g.restore(),t._applyFilters()}else g=r,p._fun.call(p,t,r,-a,-o),t._applyFilters();d.staticCache&&(d.reCache=!1),f.Stat.canvasReCache++}},{key:"_canvas_webgl_normal_repaint",value:function(t,e){var n=t._cacheStyle,i=this._next,r=n.canvas,a=n.cacheAs;n._calculateCacheRect(t,a,0,0),r||(r=new d.WebGLCacheAsNormalCanvas(e,t),n.canvas=r);var o=r.context;r.startRec(),i._fun.call(i,t,o,t.pivotX,t.pivotY),t._applyFilters(),f.Stat.canvasReCache++,r.endRec()}},{key:"_blend",value:function(t,e,n,i){var r=t._style,a=this._next;r.blendMode?(e.save(),e.globalCompositeOperation=r.blendMode,a._fun.call(a,t,e,n,i),e.restore()):a._fun.call(a,t,e,n,i)}},{key:"_mask",value:function(e,n,i,r){var a=this._next,o=e.mask,s=n;if(o){s.save();var f=s.globalCompositeOperation,_=new l.Rectangle;if(_.copyFrom(o.getBounds()),_.width=Math.round(_.width),_.height=Math.round(_.height),_.x=Math.round(_.x),_.y=Math.round(_.y),_.width>0&&_.height>0){var d=_.width,g=_.height,m=c.WebGLRTMgr.getRT(d,g);s.breakNextMerge(),s.pushRT(),s.addRenderObject(v.SubmitCMD.create([s,m,d,g],t.tmpTarget,this)),o.render(s,-_.x,-_.y),s.breakNextMerge(),s.popRT(),s.save();var b=.1;s.clipRect(i+_.x-e.getStyle().pivotX+b,r+_.y-e.getStyle().pivotY+b,d-.2,g-.2),a._fun.call(a,e,s,i,r),s.restore(),f=s.globalCompositeOperation,s.addRenderObject(v.SubmitCMD.create(["mask"],t.setBlendMode,this));var T=y.Value2D.create(p.ShaderDefines2D.TEXTURE2D,0),x=h.Texture.INV_UV;s.drawTarget(m,i+_.x-e.getStyle().pivotX,r+_.y-e.getStyle().pivotY,d,g,u.Matrix.TEMP.identity(),T,x,6),s.addRenderObject(v.SubmitCMD.create([m],t.recycleTarget,this)),s.addRenderObject(v.SubmitCMD.create([f],t.setBlendMode,this))}s.restore()}else a._fun.call(a,e,n,i,r)}}])&&x(e.prototype,n),r&&x(e,r),t}();e.RenderSprite=w,w.INIT=69905,w.renders=[],w.NORENDER=new w(0,null),w.tempUV=new Array(8)},69534:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.BaseTexture=void 0;var h=g(n(85507)),c=g(n(21611)),f=n(33873),_=n(61266),d=n(8944),p=n(69432),y=n(73972),v=n(69176);function g(t){return t&&t.__esModule?t:{default:t}}function m(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function b(t,e){return b=a||function(t,e){return t.__proto__=e,t},b(t,e)}function T(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=w(t);if(e){var a=w(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return x(this,n)}}function x(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function w(t){return w=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},w(t)}var k=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&b(t,e)}(a,t);var e,n,i,r=T(a);function a(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(n=r.call(this))._wrapModeU=v.WarpMode.Repeat,n._wrapModeV=v.WarpMode.Repeat,n._filterMode=p.FilterMode.Bilinear,n._readyed=!1,n._width=-1,n._height=-1,n._format=t,n._mipmap=e,n._anisoLevel=1,n._glTexture=f.LayaGL.instance.createTexture(),n}return e=a,(n=[{key:"mipmap",get:function(){return this._mipmap}},{key:"format",get:function(){return this._format}},{key:"wrapModeU",get:function(){return this._wrapModeU},set:function(t){this._wrapModeU!==t&&(this._wrapModeU=t,-1!==this._width&&this._setWarpMode(f.LayaGL.instance.TEXTURE_WRAP_S,t))}},{key:"wrapModeV",get:function(){return this._wrapModeV},set:function(t){this._wrapModeV!==t&&(this._wrapModeV=t,-1!==this._height&&this._setWarpMode(f.LayaGL.instance.TEXTURE_WRAP_T,t))}},{key:"filterMode",get:function(){return this._filterMode},set:function(t){t!==this._filterMode&&(this._filterMode=t,-1!==this._width&&-1!==this._height&&this._setFilterMode(t))}},{key:"anisoLevel",get:function(){return this._anisoLevel},set:function(t){t!==this._anisoLevel&&(this._anisoLevel=Math.max(1,Math.min(16,t)),-1!==this._width&&-1!==this._height&&this._setAnisotropy(t))}},{key:"mipmapCount",get:function(){return this._mipmapCount},set:function(t){this._mipmapCount=t}},{key:"defaulteTexture",get:function(){throw"BaseTexture:must override it."}},{key:"_getFormatByteCount",value:function(){switch(this._format){case y.TextureFormat.R8G8B8:return 3;case y.TextureFormat.R8G8B8A8:return 4;case y.TextureFormat.R5G6B5:case y.TextureFormat.Alpha8:return 1;case y.TextureFormat.R16G16B16A16:return 2;case y.TextureFormat.R32G32B32A32:return 4;default:throw"Texture2D: unknown format."}}},{key:"_isPot",value:function(t){return 0==(t&t-1)}},{key:"_getGLFormat",value:function(){var t,e=f.LayaGL.instance,n=f.LayaGL.layaGPUInstance;switch(this._format){case y.TextureFormat.R8G8B8:case y.TextureFormat.R5G6B5:t=e.RGB;break;case y.TextureFormat.R8G8B8A8:t=e.RGBA;break;case y.TextureFormat.Alpha8:t=e.ALPHA;break;case y.TextureFormat.R32G32B32A32:case y.TextureFormat.R16G16B16A16:t=e.RGBA;break;case y.TextureFormat.DXT1:if(!n._compressedTextureS3tc)throw"BaseTexture: not support DXT1 format.";t=n._compressedTextureS3tc.COMPRESSED_RGB_S3TC_DXT1_EXT;break;case y.TextureFormat.DXT5:if(!n._compressedTextureS3tc)throw"BaseTexture: not support DXT5 format.";t=n._compressedTextureS3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;case y.TextureFormat.ETC1RGB:if(!n._compressedTextureEtc1)throw"BaseTexture: not support ETC1RGB format.";t=n._compressedTextureEtc1.COMPRESSED_RGB_ETC1_WEBGL;break;case y.TextureFormat.ETC2RGB:if(!n._compressedTextureETC)throw"BaseTexture: not support ETC2RGB format.";t=n._compressedTextureETC.COMPRESSED_RGB8_ETC2;break;case y.TextureFormat.ETC2RGBA:if(!n._compressedTextureETC)throw"BaseTexture: not support ETC2RGBA format.";t=n._compressedTextureETC.COMPRESSED_RGBA8_ETC2_EAC;break;case y.TextureFormat.ETC2RGB_Alpha8:if(!n._compressedTextureETC)throw"BaseTexture: not support ETC2SRGB_Alpha8 format.";t=n._compressedTextureETC.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC;break;case y.TextureFormat.ETC2SRGB:if(!n._compressedTextureETC)throw"BaseTexture: not support ETC2SRGB format.";t=n._compressedTextureETC.COMPRESSED_SRGB8_ETC2;break;case y.TextureFormat.PVRTCRGB_2BPPV:if(!n._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGB_2BPPV format.";t=n._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case y.TextureFormat.PVRTCRGBA_2BPPV:if(!n._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGBA_2BPPV format.";t=n._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;break;case y.TextureFormat.PVRTCRGB_4BPPV:if(!n._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGB_4BPPV format.";t=n._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;break;case y.TextureFormat.PVRTCRGBA_4BPPV:if(!n._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGBA_4BPPV format.";t=n._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;case y.TextureFormat.ASTC4x4:if(!n._compressedTextureASTC)throw"BaseTexture: not support ASTC4x4 format.";t=n._compressedTextureASTC.COMPRESSED_RGBA_ASTC_4x4_KHR;break;case y.TextureFormat.ASTC4x4SRGB:if(!n._compressedTextureASTC)throw"BaseTexture: not support ASTC4x4_KHR format.";t=n._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR;break;case y.TextureFormat.ASTC6x6:if(!n._compressedTextureASTC)throw"BaseTexture: not support ASTC6x6 format.";t=n._compressedTextureASTC.COMPRESSED_RGBA_ASTC_6x6_KHR;break;case y.TextureFormat.ASTC6x6SRGB:if(!n._compressedTextureASTC)throw"BaseTexture: not support ASTC6x6_KHR format.";t=n._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR;break;case y.TextureFormat.ASTC8x8:if(!n._compressedTextureASTC)throw"BaseTexture: not support ASTC8x8 format.";t=n._compressedTextureASTC.COMPRESSED_RGBA_ASTC_8x8_KHR;break;case y.TextureFormat.ASTC8x8SRGB:if(!n._compressedTextureASTC)throw"BaseTexture: not support ASTC8x8 format.";t=n._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR;break;case y.TextureFormat.ASTC10x10:if(!n._compressedTextureASTC)throw"BaseTexture: not support ASTC10x10 format.";t=n._compressedTextureASTC.COMPRESSED_RGBA_ASTC_10x10_KHR;break;case y.TextureFormat.ASTC10x10SRGB:if(!n._compressedTextureASTC)throw"BaseTexture: not support ASTC10x10 format.";t=n._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR;break;case y.TextureFormat.ASTC12x12:if(!n._compressedTextureASTC)throw"BaseTexture: not support ASTC12x12 format.";t=n._compressedTextureASTC.COMPRESSED_RGBA_ASTC_12x12_KHR;break;case y.TextureFormat.ASTC12x12SRGB:if(!n._compressedTextureASTC)throw"BaseTexture: not support ASTC12x12 format.";t=n._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR;break;default:throw"BaseTexture: unknown texture format."}return t}},{key:"_setFilterMode",value:function(t){var e=f.LayaGL.instance;switch(_.WebGLContext.bindTexture(e,this._glTextureType,this._glTexture),t){case p.FilterMode.Point:this._mipmap?e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST):e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(this._glTextureType,e.TEXTURE_MAG_FILTER,e.NEAREST);break;case p.FilterMode.Bilinear:this._mipmap?e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_NEAREST):e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(this._glTextureType,e.TEXTURE_MAG_FILTER,e.LINEAR);break;case p.FilterMode.Trilinear:this._mipmap?e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR):e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(this._glTextureType,e.TEXTURE_MAG_FILTER,e.LINEAR);break;default:throw new Error("BaseTexture:unknown filterMode value.")}}},{key:"_setWarpMode",value:function(t,e){var n=f.LayaGL.instance;if(_.WebGLContext.bindTexture(n,this._glTextureType,this._glTexture),this._isPot(this._width)&&this._isPot(this._height))switch(e){case v.WarpMode.Repeat:n.texParameteri(this._glTextureType,t,n.REPEAT);break;case v.WarpMode.Clamp:n.texParameteri(this._glTextureType,t,n.CLAMP_TO_EDGE);break;case v.WarpMode.Mirrored:n.texParameteri(this._glTextureType,t,n.MIRRORED_REPEAT)}else n.texParameteri(this._glTextureType,t,n.CLAMP_TO_EDGE)}},{key:"_setAnisotropy",value:function(t){var e=f.LayaGL.layaGPUInstance._extTextureFilterAnisotropic;if(e){t=Math.max(t,1);var n=f.LayaGL.instance;_.WebGLContext.bindTexture(n,this._glTextureType,this._glTexture),t=Math.min(n.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT),t),n.texParameterf(this._glTextureType,e.TEXTURE_MAX_ANISOTROPY_EXT,t)}}},{key:"_disposeResource",value:function(){this._glTexture&&(f.LayaGL.instance.deleteTexture(this._glTexture),this._glTexture=null,this._setGPUMemory(0))}},{key:"_getSource",value:function(){return this._readyed?this._glTexture:null}},{key:"generateMipmap",value:function(){this._isPot(this.width)&&this._isPot(this.height)&&f.LayaGL.instance.generateMipmap(this._glTextureType)}}])&&m(e.prototype,n),i&&m(e,i),a}(d.Bitmap);e.BaseTexture=k,k._rgbmRange=5,k.FORMAT_R8G8B8=0,k.FORMAT_R8G8B8A8=1,k.FORMAT_ALPHA8=2,k.FORMAT_DXT1=3,k.FORMAT_DXT5=4,k.FORMAT_ETC1RGB=5,k.FORMAT_PVRTCRGB_2BPPV=9,k.FORMAT_PVRTCRGBA_2BPPV=10,k.FORMAT_PVRTCRGB_4BPPV=11,k.FORMAT_PVRTCRGBA_4BPPV=12,k.RENDERTEXTURE_FORMAT_RGBA_HALF_FLOAT=14,k.FORMAT_R32G32B32A32=15,k.FORMAT_DEPTH_16=0,k.FORMAT_STENCIL_8=1,k.FORMAT_DEPTHSTENCIL_16_8=2,k.FORMAT_DEPTHSTENCIL_NONE=3,k.FILTERMODE_POINT=0,k.FILTERMODE_BILINEAR=1,k.FILTERMODE_TRILINEAR=2,k.WARPMODE_REPEAT=0,k.WARPMODE_CLAMP=1},8944:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.Bitmap=void 0;var h=f(n(85507)),c=f(n(21611));function f(t){return t&&t.__esModule?t:{default:t}}function _(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function d(t,e){return d=a||function(t,e){return t.__proto__=e,t},d(t,e)}function p(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=v(t);if(e){var a=v(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}function y(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function v(t){return v=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},v(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(a,t);var e,n,i,r=p(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this))._width=-1,t._height=-1,t}return e=a,(n=[{key:"width",get:function(){return this._width},set:function(t){this._width=t}},{key:"height",get:function(){return this._height},set:function(t){this._height=t}},{key:"_getSource",value:function(){throw"Bitmap: must override it."}}])&&_(e.prototype,n),i&&_(e,i),a}(n(25883).Resource);e.Bitmap=g},79741:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Context=void 0;var i=q(n(3649)),r=q(n(44494)),a=q(n(77766)),o=q(n(78914)),s=q(n(63978)),u=n(92493),l=n(33873),h=n(93062),c=n(18008),f=n(85399),_=n(98693),d=n(683),p=n(91700),y=n(4629),v=n(91902),g=n(94961),m=n(64554),b=n(43719),T=n(55307),x=n(87948),w=n(37560),k=n(20541),C=n(97246),E=n(43989),S=n(28434),M=n(22245),L=n(46322),R=n(30347),I=n(36296),A=n(93055),D=n(23800),B=n(69153),P=n(76993),O=n(40113),F=n(95055),U=n(35266),N=n(30875),G=n(94286),H=n(30966),W=n(86044),V=n(56161),Y=n(61266),X=n(93894),z=n(57693),j=n(54598),K=n(87035);function q(t){return t&&t.__esModule?t:{default:t}}function Z(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Q(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,s.default)(t,i.key,i)}}function $(t,e,n){return e&&Q(t.prototype,e),n&&Q(t,n),t}var J=function(){function t(){if(Z(this,t),this._tmpMatrix=new c.Matrix,this._drawTexToDrawTri_Vert=new Float32Array(8),this._drawTexToDrawTri_Index=new Uint16Array([0,1,2,0,2,3]),this._tempUV=new Float32Array(8),this._drawTriUseAbsMatrix=!1,this._id=++t._COUNT,this._other=null,this._renderNextSubmitIndex=0,this._path=null,this._drawCount=1,this._width=t._MAXSIZE,this._height=t._MAXSIZE,this._renderCount=0,this._submits=null,this._curSubmit=null,this._submitKey=new P.SubmitKey,this._pathMesh=null,this._triangleMesh=null,this.meshlist=[],this._transedPoints=new Array(8),this._temp4Points=new Array(8),this._clipRect=t.MAXCLIPRECT,this._globalClipMatrix=new c.Matrix(t._MAXSIZE,0,0,t._MAXSIZE,0,0),this._clipInCache=!1,this._clipInfoID=0,this._clipID_Gen=0,this._lastMatScaleX=1,this._lastMatScaleY=1,this._lastMat_a=1,this._lastMat_b=0,this._lastMat_c=0,this._lastMat_d=1,this._nBlendType=0,this._save=null,this._targets=null,this._charSubmitCache=null,this._saveMark=null,this._shader2D=new C.Shader2D,this.sprite=null,this._italicDeg=0,this._lastTex=null,this._fillColor=0,this._flushCnt=0,this.defTexture=null,this._colorFiler=null,this.drawTexAlign=!1,this._incache=!1,this.isMain=!1,t._contextcount++,t._textRender=t._textRender||new N.TextRender,!this.defTexture){var e=new K.Texture2D(2,2);e.setPixels(new Uint8Array(16)),e.lock=!0,this.defTexture=new j.Texture(e)}this._lastTex=this.defTexture,this.clear()}return $(t,[{key:"drawImage",value:function(){}},{key:"getImageData",value:function(){}},{key:"measureText",value:function(t){return null}},{key:"setTransform",value:function(){}},{key:"$transform",value:function(t,e,n,i,r,a){}},{key:"lineJoin",get:function(){return""},set:function(t){}},{key:"lineCap",get:function(){return""},set:function(t){}},{key:"miterLimit",get:function(){return""},set:function(t){}},{key:"clearRect",value:function(t,e,n,i){}},{key:"_drawRect",value:function(t,e,n,i,r){d.Stat.renderBatches++,r&&(this.fillStyle=r),this.fillRect(t,e,n,i,null)}},{key:"drawTexture2",value:function(t,e,n,i,r,a){}},{key:"transformByMatrix",value:function(t,e,n){this.transform(t.a,t.b,t.c,t.d,t.tx+e,t.ty+n)}},{key:"saveTransform",value:function(t){this.save()}},{key:"restoreTransform",value:function(t){this.restore()}},{key:"drawRect",value:function(t,e,n,i,r,a,o){var s=this;null!=r&&(s.fillStyle=r,s.fillRect(t,e,n,i)),null!=a&&(s.strokeStyle=a,s.lineWidth=o,s.strokeRect(t,e,n,i))}},{key:"alpha",value:function(t){this.globalAlpha*=t}},{key:"_transform",value:function(t,e,n){this.translate(e,n),this.transform(t.a,t.b,t.c,t.d,t.tx,t.ty),this.translate(-e,-n)}},{key:"_rotate",value:function(t,e,n){this.translate(e,n),this.rotate(t),this.translate(-e,-n)}},{key:"_scale",value:function(t,e,n,i){this.translate(n,i),this.scale(t,e),this.translate(-n,-i)}},{key:"_drawLine",value:function(t,e,n,i,r,a,o,s,u){this.beginPath(),this.strokeStyle=o,this.lineWidth=s,this.moveTo(t+n,e+i),this.lineTo(t+r,e+a),this.stroke()}},{key:"_drawLines",value:function(t,e,n,r,a,o){this.beginPath(),this.strokeStyle=r,this.lineWidth=a,this.addPath((0,i.default)(n).call(n),!1,!1,t,e),this.stroke()}},{key:"drawCurves",value:function(t,e,n,i,r){this.beginPath(),this.strokeStyle=i,this.lineWidth=r,this.moveTo(t+n[0],e+n[1]);for(var a=2,o=n.length;a<o;)this.quadraticCurveTo(t+n[a++],e+n[a++],t+n[a++],e+n[a++]);this.stroke()}},{key:"_fillAndStroke",value:function(t,e,n){var i;null!=t&&(this.fillStyle=t,(0,r.default)(i=this).call(i));null!=e&&n>0&&(this.strokeStyle=e,this.lineWidth=n,this.stroke())}},{key:"_drawCircle",value:function(e,n,i,r,a,o,s){d.Stat.renderBatches++,this.beginPath(!0),this.arc(e,n,i,0,t.PI2),this.closePath(),this._fillAndStroke(r,a,o)}},{key:"_drawPie",value:function(t,e,n,i,r,a,o,s,u){this.beginPath(),this.moveTo(t,e),this.arc(t,e,n,i,r),this.closePath(),this._fillAndStroke(a,o,s)}},{key:"_drawPoly",value:function(t,e,n,r,a,o,s,u){this.beginPath(),this.addPath((0,i.default)(n).call(n),!0,s,t,e),this.closePath(),this._fillAndStroke(r,a,o,s)}},{key:"_drawPath",value:function(t,e,n,i,a){this.beginPath();for(var o=0,s=n.length;o<s;o++){var u=n[o];switch(u[0]){case"moveTo":this.moveTo(t+u[1],e+u[2]);break;case"lineTo":this.lineTo(t+u[1],e+u[2]);break;case"arcTo":this.arcTo(t+u[1],e+u[2],t+u[3],e+u[4],u[5]);break;case"closePath":this.closePath()}}null!=i&&(this.fillStyle=i.fillStyle,(0,r.default)(this).call(this));null!=a&&(this.strokeStyle=a.strokeStyle,this.lineWidth=a.lineWidth||1,this.lineJoin=a.lineJoin,this.lineCap=a.lineCap,this.miterLimit=a.miterLimit,this.stroke())}},{key:"clearBG",value:function(t,e,n,i){var r=Y.WebGLContext.mainContext;r.clearColor(t,e,n,i),r.clear(r.COLOR_BUFFER_BIT)}},{key:"_getSubmits",value:function(){return this._submits}},{key:"_releaseMem",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._submits){this._curMat&&this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null,this._charSubmitCache.clear();for(var e=0,n=this._submits._length;e<n;e++)this._submits[e].releaseRender();var i;for(this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path=null,this._save=null,e=0,i=this.meshlist.length;e<i;e++){var r=this.meshlist[e];r.destroy()}this.meshlist.length=0,this.sprite=null,t||(this._targets&&this._targets.destroy(),this._targets=null)}}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];--t._contextcount,this.sprite=null,this._releaseMem(e),this._charSubmitCache&&this._charSubmitCache.destroy(),this._mesh.destroy(),e||(this._targets&&this._targets.destroy(),this._targets=null)}},{key:"clear",value:function(){this._submits||(this._other=tt.DEFAULT,this._curMat=c.Matrix.create(),this._charSubmitCache=new U.CharSubmitCache,this._mesh=G.MeshQuadTexture.getAMesh(this.isMain),this.meshlist.push(this._mesh),this._pathMesh=W.MeshVG.getAMesh(this.isMain),this.meshlist.push(this._pathMesh),this._triangleMesh=H.MeshTexture.getAMesh(this.isMain),this.meshlist.push(this._triangleMesh),this._submits=[],this._save=[b.SaveMark.Create(this)],this._save.length=10,this._shader2D=new C.Shader2D),this._submitKey.clear(),this._mesh.clearVB(),this._drawCount=1,this._other=tt.DEFAULT,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=t.MAXCLIPRECT,this._curSubmit=A.SubmitBase.RENDERBASE,A.SubmitBase.RENDERBASE._ref=16777215,A.SubmitBase.RENDERBASE._numEle=0,this._shader2D.fillStyle=this._shader2D.strokeStyle=y.DrawStyle.DEFAULT;for(var e=0,n=this._submits._length;e<n;e++)this._submits[e].releaseRender();this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1}},{key:"size",value:function(t,e){this._width==t&&this._height==e||(this._width=t,this._height=e,this._targets&&(this._targets.destroy(),this._targets=new X.RenderTexture2D(t,e,z.RenderTextureFormat.R8G8B8A8,-1)),this.isMain&&(Y.WebGLContext.mainContext.viewport(0,0,t,e),V.RenderState2D.width=t,V.RenderState2D.height=e)),0===t&&0===e&&this._releaseMem()}},{key:"asBitmap",set:function(t){if(t){var e=this._targets;if(!this._width||!this._height)throw Error("asBitmap no size!");e&&e.width==this._width&&e.height==this._height||(e&&e.destroy(),this._targets=new X.RenderTexture2D(this._width,this._height,z.RenderTextureFormat.R8G8B8A8,-1))}else this._targets&&this._targets.destroy(),this._targets=null}},{key:"getMatScaleX",value:function(){return this._lastMat_a==this._curMat.a&&this._lastMat_b==this._curMat.b||(this._lastMatScaleX=this._curMat.getScaleX(),this._lastMat_a=this._curMat.a,this._lastMat_b=this._curMat.b),this._lastMatScaleX}},{key:"getMatScaleY",value:function(){return this._lastMat_c==this._curMat.c&&this._lastMat_d==this._curMat.d||(this._lastMatScaleY=this._curMat.getScaleY(),this._lastMat_c=this._curMat.c,this._lastMat_d=this._curMat.d),this._lastMatScaleY}},{key:"setFillColor",value:function(t){this._fillColor=t}},{key:"getFillColor",value:function(){return this._fillColor}},{key:"fillStyle",get:function(){return this._shader2D.fillStyle},set:function(t){this._shader2D.fillStyle.equal(t)||(g.SaveBase.save(this,g.SaveBase.TYPE_FILESTYLE,this._shader2D,!1),this._shader2D.fillStyle=y.DrawStyle.create(t),this._submitKey.other=-this._shader2D.fillStyle.toInt())}},{key:"globalAlpha",get:function(){return this._shader2D.ALPHA},set:function(t){(t=Math.floor(1e3*t)/1e3)!=this._shader2D.ALPHA&&(g.SaveBase.save(this,g.SaveBase.TYPE_ALPHA,this._shader2D,!1),this._shader2D.ALPHA=t)}},{key:"textAlign",get:function(){return this._other.textAlign},set:function(t){this._other.textAlign===t||(this._other=this._other.make(),g.SaveBase.save(this,g.SaveBase.TYPE_TEXTALIGN,this._other,!1),this._other.textAlign=t)}},{key:"textBaseline",get:function(){return this._other.textBaseline},set:function(t){this._other.textBaseline===t||(this._other=this._other.make(),g.SaveBase.save(this,g.SaveBase.TYPE_TEXTBASELINE,this._other,!1),this._other.textBaseline=t)}},{key:"globalCompositeOperation",get:function(){return p.BlendMode.NAMES[this._nBlendType]},set:function(t){var e=p.BlendMode.TOINT[t];null==e||this._nBlendType===e||(g.SaveBase.save(this,g.SaveBase.TYPE_GLOBALCOMPOSITEOPERATION,this,!0),this._curSubmit=A.SubmitBase.RENDERBASE,this._nBlendType=e)}},{key:"strokeStyle",get:function(){return this._shader2D.strokeStyle},set:function(t){this._shader2D.strokeStyle.equal(t)||(g.SaveBase.save(this,g.SaveBase.TYPE_STROKESTYLE,this._shader2D,!1),this._shader2D.strokeStyle=y.DrawStyle.create(t),this._submitKey.other=-this._shader2D.strokeStyle.toInt())}},{key:"translate",value:function(t,e){0===t&&0===e||(x.SaveTranslate.save(this),this._curMat._bTransform?(T.SaveTransform.save(this),this._curMat.tx+=t*this._curMat.a+e*this._curMat.c,this._curMat.ty+=t*this._curMat.b+e*this._curMat.d):(this._curMat.tx=t,this._curMat.ty=e))}},{key:"lineWidth",get:function(){return this._other.lineWidth},set:function(t){this._other.lineWidth===t||(this._other=this._other.make(),g.SaveBase.save(this,g.SaveBase.TYPE_LINEWIDTH,this._other,!1),this._other.lineWidth=t)}},{key:"save",value:function(){this._save[this._save._length++]=b.SaveMark.Create(this)}},{key:"restore",value:function(){var t=this._save._length,e=this._nBlendType;if(!(t<1)){for(var n=t-1;n>=0;n--){var i=this._save[n];if(i.restore(this),i.isSaveMark())return void(this._save._length=n)}e!=this._nBlendType&&(this._curSubmit=A.SubmitBase.RENDERBASE)}}},{key:"font",set:function(t){this._other=this._other.make(),g.SaveBase.save(this,g.SaveBase.TYPE_FONT,this._other,!1)}},{key:"fillText",value:function(e,n,i,r,a,o){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"";t._textRender.filltext(this,e,n,i,r,a,u,s,o)}},{key:"drawText",value:function(e,n,i,r,a,o){t._textRender.filltext(this,e,n,i,r,a,null,0,o)}},{key:"fillWords",value:function(e,n,i,r,a){t._textRender.fillWords(this,e,n,i,r,a,null,0)}},{key:"strokeWord",value:function(e,n,i,r,a,o,s){t._textRender.filltext(this,e,n,i,r,null,a,o,s)}},{key:"fillBorderText",value:function(e,n,i,r,a,o,s,u){t._textRender.filltext(this,e,n,i,r,a,o,s,u)}},{key:"fillBorderWords",value:function(e,n,i,r,a,o,s){t._textRender.fillWords(this,e,n,i,r,a,o,s)}},{key:"_fast_filltext",value:function(e,n,i,r,a,o,s,u){var l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;t._textRender._fast_filltext(this,e,null,n,i,r,a,o,s,u,l)}},{key:"_fillRect",value:function(e,n,i,r,a){var o=this._curSubmit,s=o&&o._key.submitType===A.SubmitBase.KEY_DRAWTEXTURE&&o._key.blendShader===this._nBlendType;this._mesh.vertNum+4>t._MAXVERTNUM&&(this._mesh=G.MeshQuadTexture.getAMesh(this.isMain),this.meshlist.push(this._mesh),s=!1),s&&(s=s&&this.isSameClipInfo(o)),this.transformQuad(e,n,i,r,0,this._curMat,this._transedPoints),this.clipedOff(this._transedPoints)||(this._mesh.addQuad(this._transedPoints,j.Texture.NO_UV,a,!1),s||(o=this._curSubmit=F.SubmitTexture.create(this,this._mesh,M.Value2D.create(E.ShaderDefines2D.TEXTURE2D,0)),this._submits[this._submits._length++]=o,this._copyClipInfo(o,this._globalClipMatrix),o.shaderValue.textureHost=this._lastTex,o._key.other=this._lastTex&&this._lastTex.bitmap?this._lastTex.bitmap.id:-1,o._renderType=A.SubmitBase.TYPE_TEXTURE),this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4)}},{key:"fillRect",value:function(t,e,n,i,r){var a=r?y.DrawStyle.create(r):this._shader2D.fillStyle,o=this.mixRGBandAlpha(a.toInt());this._fillRect(t,e,n,i,o)}},{key:"fillTexture",value:function(t,e,n,i,r,a,o,s){t._getSource()?this._fillTexture(t,t.width,t.height,t.uvrect,e,n,i,r,a,o.x,o.y):this.sprite&&u.ILaya.systemTimer.callLater(this,this._repaintSprite)}},{key:"_fillTexture",value:function(e,n,i,r,o,s,u,l,h,c,f){var _=this._curSubmit;this._mesh.vertNum+4>t._MAXVERTNUM&&(this._mesh=G.MeshQuadTexture.getAMesh(this.isMain),this.meshlist.push(this._mesh));var d=!0,p=!0;switch(h){case"repeat":default:break;case"repeat-x":p=!1;break;case"repeat-y":d=!1;break;case"no-repeat":d=p=!1}var y=this._temp4Points,v=0,g=0,m=0,b=0,T=0,x=0;if(c<0?(m=o,v=-c%n/n):m=o+c,f<0?(b=s,g=-f%i/i):b=s+f,T=o+u,x=s+l,!d&&(T=Math.min(T,o+c+n)),!p&&(x=Math.min(x,s+f+i)),!(T<o||x<s||m>T||b>x)){var w=(T-o-c)/n,k=(x-s-f)/i;if(this.transformQuad(m,b,T-m,x-b,0,this._curMat,this._transedPoints),y[0]=v,y[1]=g,y[2]=w,y[3]=g,y[4]=w,y[5]=k,y[6]=v,y[7]=k,!this.clipedOff(this._transedPoints)){var C=this._mixRGBandAlpha(4294967295,this._shader2D.ALPHA);this._mesh.addQuad(this._transedPoints,y,C,!0);var S=M.Value2D.create(E.ShaderDefines2D.TEXTURE2D,0);S.defines.add(E.ShaderDefines2D.FILLTEXTURE),S.u_TexRange=(0,a.default)(r).call(r),_=this._curSubmit=F.SubmitTexture.create(this,this._mesh,S),this._submits[this._submits._length++]=_,this._copyClipInfo(_,this._globalClipMatrix),_.shaderValue.textureHost=e,_._renderType=A.SubmitBase.TYPE_TEXTURE,this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4}this.breakNextMerge()}}},{key:"setColorFilter",value:function(t){g.SaveBase.save(this,g.SaveBase.TYPE_COLORFILTER,this,!0),this._colorFiler=t,this._curSubmit=A.SubmitBase.RENDERBASE}},{key:"drawTexture",value:function(t,e,n,i,r){this._drawTextureM(t,e,n,i,r,null,1,null)}},{key:"drawTextures",value:function(t,e,n,i){if(t._getSource())for(var r=e.length/2,a=0,o=t.bitmap.id,s=0;s<r;s++)this._inner_drawTexture(t,o,e[a++]+n,e[a++]+i,0,0,null,null,1,!1);else this.sprite&&u.ILaya.systemTimer.callLater(this,this._repaintSprite)}},{key:"_drawTextureAddSubmit",value:function(t,e){var n=null;n=F.SubmitTexture.create(this,this._mesh,M.Value2D.create(E.ShaderDefines2D.TEXTURE2D,0)),this._submits[this._submits._length++]=n,n.shaderValue.textureHost=e,n._key.other=t,n._renderType=A.SubmitBase.TYPE_TEXTURE,this._curSubmit=n}},{key:"_drawTextureM",value:function(t,e,n,i,r,a,o,s){var u=this.sprite;return!!t._getSource((function(){u&&u.repaint()}))&&this._inner_drawTexture(t,t.bitmap.id,e,n,i,r,a,s,o,!1)}},{key:"_drawRenderTexture",value:function(t,e,n,i,r,a,o,s){return this._inner_drawTexture(t,-1,e,n,i,r,a,s,1,!1)}},{key:"submitDebugger",value:function(){this._submits[this._submits._length++]=B.SubmitCMD.create([],(function(){}),this)}},{key:"_copyClipInfo",value:function(t,e){var n=t.shaderValue.clipMatDir;n[0]=e.a,n[1]=e.b,n[2]=e.c,n[3]=e.d;var i=t.shaderValue.clipMatPos;i[0]=e.tx,i[1]=e.ty,t.clipInfoID=this._clipInfoID,this._clipInCache&&(t.shaderValue.clipOff[0]=1)}},{key:"isSameClipInfo",value:function(t){return t.clipInfoID===this._clipInfoID}},{key:"_useNewTex2DSubmit",value:function(e,n){this._mesh.vertNum+n>t._MAXVERTNUM&&(this._mesh=G.MeshQuadTexture.getAMesh(this.isMain),this.meshlist.push(this._mesh));var i=F.SubmitTexture.create(this,this._mesh,M.Value2D.create(E.ShaderDefines2D.TEXTURE2D,0));this._submits[this._submits._length++]=this._curSubmit=i,i.shaderValue.textureHost=e,this._copyClipInfo(i,this._globalClipMatrix)}},{key:"_drawTexRect",value:function(t,e,n,i,r){this.transformQuad(t,e,n,i,this._italicDeg,this._curMat,this._transedPoints);var a=this._transedPoints;a[0]=a[0]+.5|0,a[1]=a[1]+.5|0,a[2]=a[2]+.5|0,a[3]=a[3]+.5|0,a[4]=a[4]+.5|0,a[5]=a[5]+.5|0,a[6]=a[6]+.5|0,a[7]=a[7]+.5|0,this.clipedOff(this._transedPoints)||(this._mesh.addQuad(this._transedPoints,r,this._fillColor,!0),this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4)}},{key:"drawCallOptimize",value:function(t){return this._charSubmitCache.enable(t,this),t}},{key:"_inner_drawTexture",value:function(e,n,i,r,a,o,s,u,l,h){if(a<=0||o<=0)return!1;var c=this._curSubmit._key;if(u=u||e._uv,c.submitType===A.SubmitBase.KEY_TRIANGLES&&c.other===n){var f=this._drawTexToDrawTri_Vert;f[0]=i,f[1]=r,f[2]=i+a,f[3]=r,f[4]=i+a,f[5]=r+o,f[6]=i,f[7]=r+o,this._drawTriUseAbsMatrix=!0;var _=this._tempUV;return _[0]=u[0],_[1]=u[1],_[2]=u[2],_[3]=u[3],_[4]=u[4],_[5]=u[5],_[6]=u[6],_[7]=u[7],this.drawTriangles(e,0,0,f,_,this._drawTexToDrawTri_Index,s||this._curMat,l,null,null),this._drawTriUseAbsMatrix=!1,!0}var d=this._mesh,p=this._curSubmit,y=h?this._charSubmitCache.getPos():this._transedPoints;if(this.transformQuad(i,r,a||e.width,o||e.height,this._italicDeg,s||this._curMat,y),this.drawTexAlign){var v=Math.round;y[0]=v(y[0]),y[1]=v(y[1]),y[2]=v(y[2]),y[3]=v(y[3]),y[4]=v(y[4]),y[5]=v(y[5]),y[6]=v(y[6]),y[7]=v(y[7]),this.drawTexAlign=!1}var g=this._mixRGBandAlpha(4294967295,this._shader2D.ALPHA*l);if(h)return this._charSubmitCache.add(this,e,n,y,u,g),!0;this._drawCount++;var m=n>=0&&c.submitType===A.SubmitBase.KEY_DRAWTEXTURE&&c.other===n;return m&&(m=m&&this.isSameClipInfo(p)),this._lastTex=e,d.vertNum+4>t._MAXVERTNUM&&(d=this._mesh=G.MeshQuadTexture.getAMesh(this.isMain),this.meshlist.push(d),m=!1),d.addQuad(y,u,g,!0),m||(this._submits[this._submits._length++]=this._curSubmit=p=F.SubmitTexture.create(this,d,M.Value2D.create(E.ShaderDefines2D.TEXTURE2D,0)),p.shaderValue.textureHost=e,p._key.other=n,this._copyClipInfo(p,this._globalClipMatrix)),p._numEle+=6,d.indexNum+=6,d.vertNum+=4,!0}},{key:"transform4Points",value:function(t,e,n){var i=e.tx,r=e.ty,a=e.a,o=e.b,s=e.c,u=e.d,l=t[0],h=t[1],c=t[2],f=t[3],_=t[4],d=t[5],p=t[6],y=t[7];e._bTransform?(n[0]=l*a+h*s+i,n[1]=l*o+h*u+r,n[2]=c*a+f*s+i,n[3]=c*o+f*u+r,n[4]=_*a+d*s+i,n[5]=_*o+d*u+r,n[6]=p*a+y*s+i,n[7]=p*o+y*u+r):(n[0]=l+i,n[1]=h+r,n[2]=c+i,n[3]=f+r,n[4]=_+i,n[5]=d+r,n[6]=p+i,n[7]=y+r)}},{key:"clipedOff",value:function(t){return this._clipRect.width<=0||this._clipRect.height<=0}},{key:"transformQuad",value:function(t,e,n,i,r,a,o){var s=0;0!=r&&(s=Math.tan(r*Math.PI/180)*i);var u=t+n,l=e+i,h=a.tx,c=a.ty,f=a.a,_=a.b,d=a.c,p=a.d,y=t+s,v=e,g=u+s,m=e,b=u,T=l,x=t,w=l;a._bTransform?(o[0]=y*f+v*d+h,o[1]=y*_+v*p+c,o[2]=g*f+m*d+h,o[3]=g*_+m*p+c,o[4]=b*f+T*d+h,o[5]=b*_+T*p+c,o[6]=x*f+w*d+h,o[7]=x*_+w*p+c):(o[0]=y+h,o[1]=v+c,o[2]=g+h,o[3]=m+c,o[4]=b+h,o[5]=T+c,o[6]=x+h,o[7]=w+c)}},{key:"pushRT",value:function(){this.addRenderObject(B.SubmitCMD.create(null,X.RenderTexture2D.pushRT,this))}},{key:"popRT",value:function(){this.addRenderObject(B.SubmitCMD.create(null,X.RenderTexture2D.popRT,this)),this.breakNextMerge()}},{key:"useRT",value:function(t){this.addRenderObject(B.SubmitCMD.create([t],(function(t){if(!t)throw"error useRT";t.start(),t.clear(0,0,0,0)}),this)),this.breakNextMerge()}},{key:"RTRestore",value:function(t){this.addRenderObject(B.SubmitCMD.create([t],(function(t){t.restore()}),this)),this.breakNextMerge()}},{key:"breakNextMerge",value:function(){this._curSubmit=A.SubmitBase.RENDERBASE}},{key:"_repaintSprite",value:function(){this.sprite&&this.sprite.repaint()}},{key:"drawTextureWithTransform",value:function(t,e,n,i,r,a,o,s,u,l){var h,f=arguments.length>10&&void 0!==arguments[10]?arguments[10]:null,_=arguments.length>11?arguments[11]:void 0,d=this._curMat;l&&(h=this.globalCompositeOperation,this.globalCompositeOperation=l);var p=this._colorFiler;if(f&&this.setColorFilter(f),!a)return this._drawTextureM(t,e+o,n+s,i,r,d,u,_),l&&(this.globalCompositeOperation=h),void(f&&this.setColorFilter(p));var y=this._tmpMatrix;y.a=a.a,y.b=a.b,y.c=a.c,y.d=a.d,y.tx=a.tx+o,y.ty=a.ty+s,y._bTransform=a._bTransform,a&&d._bTransform?(c.Matrix.mul(y,d,y),(a=y)._bTransform=!0):(y.tx+=d.tx,y.ty+=d.ty,a=y),this._drawTextureM(t,e,n,i,r,a,u,_),l&&(this.globalCompositeOperation=h),f&&this.setColorFilter(p)}},{key:"_flushToTarget",value:function(t,e){V.RenderState2D.worldScissorTest=!1;var n=l.LayaGL.instance;n.disable(n.SCISSOR_TEST);var i=V.RenderState2D.worldAlpha,r=V.RenderState2D.worldMatrix4,a=V.RenderState2D.worldMatrix;V.RenderState2D.worldShaderDefines;V.RenderState2D.worldMatrix=c.Matrix.EMPTY,V.RenderState2D.restoreTempArray(),V.RenderState2D.worldMatrix4=V.RenderState2D.TEMPMAT4_ARRAY,V.RenderState2D.worldAlpha=1,k.BaseShader.activeShader=null,e.start(),t._submits._length>0&&e.clear(0,0,0,0),t._curSubmit=A.SubmitBase.RENDERBASE,t.flush(),t.clear(),e.restore(),t._curSubmit=A.SubmitBase.RENDERBASE,k.BaseShader.activeShader=null,V.RenderState2D.worldAlpha=i,V.RenderState2D.worldMatrix4=r,V.RenderState2D.worldMatrix=a}},{key:"drawCanvas",value:function(t,e,n,i,r){if(t){var a,s=t.context;if(s._targets)s._submits._length>0&&(a=B.SubmitCMD.create([s,s._targets],this._flushToTarget,this),this._submits[this._submits._length++]=a),this._drawRenderTexture(s._targets,e,n,i,r,null,1,X.RenderTexture2D.flipyuv),this._curSubmit=A.SubmitBase.RENDERBASE;else{var u,l=t;if(l.touches)(0,o.default)(u=l.touches).call(u,(function(t){t.touch()}));a=D.SubmitCanvas.create(t,this._shader2D.ALPHA,this._shader2D.filters),this._submits[this._submits._length++]=a,a._key.clear();var h=a._matrix;this._curMat.copyTo(h);var _=h.tx,d=h.ty;h.tx=h.ty=0,h.transformPoint(f.Point.TEMP.setTo(e,n)),h.translate(f.Point.TEMP.x+_,f.Point.TEMP.y+d),c.Matrix.mul(l.invMat,h,h),this._curSubmit=A.SubmitBase.RENDERBASE}}}},{key:"drawTarget",value:function(e,n,i,r,a,o,s){var u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:-1;this._drawCount++;if(this._mesh.vertNum+4>t._MAXVERTNUM&&(this._mesh=G.MeshQuadTexture.getAMesh(this.isMain),this.meshlist.push(this._mesh)),this.transformQuad(n,i,r,a,0,o||this._curMat,this._transedPoints),!this.clipedOff(this._transedPoints)){this._mesh.addQuad(this._transedPoints,u||j.Texture.DEF_UV,4294967295,!0);var h=this._curSubmit=O.SubmitTarget.create(this,this._mesh,s,e);return h.blendType=-1==l?this._nBlendType:l,this._copyClipInfo(h,this._globalClipMatrix),h._numEle=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4,this._submits[this._submits._length++]=h,this._curSubmit=A.SubmitBase.RENDERBASE,!0}return this._curSubmit=A.SubmitBase.RENDERBASE,!1}},{key:"drawTriangles",value:function(e,n,i,r,a,o,s,l,h,f){var _=arguments.length>10&&void 0!==arguments[10]?arguments[10]:4294967295;if(e._getSource()){var d=null;f&&(d=this.globalCompositeOperation,this.globalCompositeOperation=f),this._drawCount++;var p=this._tmpMatrix,y=this._triangleMesh,v=null,g=!1;h&&(v=this._colorFiler,this._colorFiler=h,this._curSubmit=A.SubmitBase.RENDERBASE,g=v!=h);var m=e.bitmap,b=this._curSubmit._key,T=b.submitType===A.SubmitBase.KEY_TRIANGLES&&b.other===m.id&&b.blendShader==this._nBlendType;if(y.vertNum+r.length/2>t._MAXVERTNUM&&(y=this._triangleMesh=H.MeshTexture.getAMesh(this.isMain),this.meshlist.push(y),T=!1),!T){var x=this._curSubmit=F.SubmitTexture.create(this,y,M.Value2D.create(E.ShaderDefines2D.TEXTURE2D,0));x.shaderValue.textureHost=e,x._renderType=A.SubmitBase.TYPE_TEXTURE,x._key.submitType=A.SubmitBase.KEY_TRIANGLES,x._key.other=m.id,this._copyClipInfo(x,this._globalClipMatrix),this._submits[this._submits._length++]=x}var w=this._mixRGBandAlpha(_,this._shader2D.ALPHA*l);this._drawTriUseAbsMatrix?y.addData(r,a,o,s,w):(s?(p.a=s.a,p.b=s.b,p.c=s.c,p.d=s.d,p.tx=s.tx+n,p.ty=s.ty+i):(p.a=1,p.b=0,p.c=0,p.d=1,p.tx=n,p.ty=i),c.Matrix.mul(p,this._curMat,p),y.addData(r,a,o,p||this._curMat,w)),this._curSubmit._numEle+=o.length,g&&(this._colorFiler=v,this._curSubmit=A.SubmitBase.RENDERBASE),f&&(this.globalCompositeOperation=d)}else this.sprite&&u.ILaya.systemTimer.callLater(this,this._repaintSprite)}},{key:"transform",value:function(t,e,n,i,r,a){T.SaveTransform.save(this),c.Matrix.mul(c.Matrix.TEMP.setTo(t,e,n,i,r,a),this._curMat,this._curMat),this._curMat._checkTransform()}},{key:"_transformByMatrix",value:function(t,e,n){t.setTranslate(e,n),c.Matrix.mul(t,this._curMat,this._curMat),t.setTranslate(0,0),this._curMat._bTransform=!0}},{key:"setTransformByMatrix",value:function(t){t.copyTo(this._curMat)}},{key:"rotate",value:function(t){T.SaveTransform.save(this),this._curMat.rotateEx(t)}},{key:"scale",value:function(t,e){T.SaveTransform.save(this),this._curMat.scaleEx(t,e)}},{key:"clipRect",value:function(e,n,i,r){m.SaveClipRect.save(this),this._clipRect==t.MAXCLIPRECT?this._clipRect=new _.Rectangle(e,n,i,r):(this._clipRect.width=i,this._clipRect.height=r,this._clipRect.x=e,this._clipRect.y=n),this._clipID_Gen++,this._clipID_Gen%=1e4,this._clipInfoID=this._clipID_Gen;var a=this._globalClipMatrix,o=a.tx,s=a.ty,u=o+a.a,l=s+a.d;if(this._clipRect.width>=t._MAXSIZE?(a.a=a.d=t._MAXSIZE,a.b=a.c=a.tx=a.ty=0):(this._curMat._bTransform?(a.tx=this._clipRect.x*this._curMat.a+this._clipRect.y*this._curMat.c+this._curMat.tx,a.ty=this._clipRect.x*this._curMat.b+this._clipRect.y*this._curMat.d+this._curMat.ty,a.a=this._clipRect.width*this._curMat.a,a.b=this._clipRect.width*this._curMat.b,a.c=this._clipRect.height*this._curMat.c,a.d=this._clipRect.height*this._curMat.d):(a.tx=this._clipRect.x+this._curMat.tx,a.ty=this._clipRect.y+this._curMat.ty,a.a=this._clipRect.width,a.b=a.c=0,a.d=this._clipRect.height),this._incache&&(this._clipInCache=!0)),a.a>0&&a.d>0){var h=a.tx+a.a,c=a.ty+a.d;h<=o||c<=s||a.tx>=u||a.ty>=l?(a.a=-.1,a.d=-.1):(a.tx<o&&(a.a-=o-a.tx,a.tx=o),h>u&&(a.a-=h-u),a.ty<s&&(a.d-=s-a.ty,a.ty=s),c>l&&(a.d-=c-l),a.a<=0&&(a.a=-.1),a.d<=0&&(a.d=-.1))}}},{key:"drawMesh",value:function(t,e,n,i,r,a,o,s){}},{key:"addRenderObject",value:function(t){this._submits[this._submits._length++]=t}},{key:"submitElement",value:function(t,e){this.isMain;var n=this._submits,i=n._length;e<0&&(e=n._length);for(var r=A.SubmitBase.RENDERBASE;t<e;)this._renderNextSubmitIndex=t+1,n[t]!==A.SubmitBase.RENDERBASE?(A.SubmitBase.preRender=r,t+=(r=n[t]).renderSubmit()):t++;return i}},{key:"flush",value:function(){this._clipID_Gen=0;var t=this.submitElement(0,this._submits._length);this._path&&this._path.reset(),S.SkinMeshBuffer.instance&&S.SkinMeshBuffer.getInstance().reset(),this._curSubmit=A.SubmitBase.RENDERBASE;for(var e=0,n=this.meshlist.length;e<n;e++){var i=this.meshlist[e];i.canReuse?i.releaseMesh():i.destroy()}return this.meshlist.length=0,this._mesh=G.MeshQuadTexture.getAMesh(this.isMain),this._pathMesh=W.MeshVG.getAMesh(this.isMain),this._triangleMesh=H.MeshTexture.getAMesh(this.isMain),this.meshlist.push(this._mesh,this._pathMesh,this._triangleMesh),this._flushCnt++,this._flushCnt%60==0&&this.isMain&&N.TextRender.textRenderInst&&N.TextRender.textRenderInst.GC(),t}},{key:"beginPath",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this._getPath();e.beginPath(t)}},{key:"closePath",value:function(){this._path.closePath()}},{key:"addPath",value:function(t,e,n,i,r){for(var a=0,o=0,s=t.length/2;o<s;o++){var u=t[a]+i,l=t[a+1]+r;t[a]=u,t[a+1]=l,a+=2}this._getPath().push(t,n)}},{key:"fill",value:function(){var e=this._curMat,n=this._getPath(),i=this._curSubmit,r=i._key.submitType===A.SubmitBase.KEY_VG&&i._key.blendShader===this._nBlendType;r&&(r=r&&this.isSameClipInfo(i)),r||(this._curSubmit=this.addVGSubmit(this._pathMesh));for(var o,s=this.mixRGBandAlpha(this.fillStyle.toInt()),u=0,l=0,h=n.paths.length;l<h;l++){var c,f=n.paths[l],_=f.path.length/2;if(!(_<3||3==_&&!f.convex)){var d,p,y,v,g=(0,a.default)(c=f.path).call(c),m=0;if(e._bTransform)for(m=0;m<_;m++)p=(d=m<<1)+1,y=g[d],v=g[p],g[d]=e.a*y+e.c*v+e.tx,g[p]=e.b*y+e.d*v+e.ty;else for(m=0;m<_;m++)p=(d=m<<1)+1,y=g[d],v=g[p],g[d]=y+e.tx,g[p]=v+e.ty;this._pathMesh.vertNum+_>t._MAXVERTNUM&&(this._curSubmit._numEle+=u,u=0,this._pathMesh=W.MeshVG.getAMesh(this.isMain),this._curSubmit=this.addVGSubmit(this._pathMesh));var b=this._pathMesh.vertNum;if(f.convex){var T=_-2;o=new Array(3*T);for(var x=0,w=0;w<T;w++)o[x++]=b,o[x++]=w+1+b,o[x++]=w+2+b}else if(o=R.Earcut.earcut(g,null,2),b>0)for(var k=0;k<o.length;k++)o[k]+=b;this._pathMesh.addVertAndIBToMesh(this,g,s,o),u+=o.length}}this._curSubmit._numEle+=u}},{key:"addVGSubmit",value:function(t){var e=I.Submit.createShape(this,t,0,M.Value2D.create(E.ShaderDefines2D.PRIMITIVE,0));return e._key.submitType=A.SubmitBase.KEY_VG,this._submits[this._submits._length++]=e,this._copyClipInfo(e,this._globalClipMatrix),e}},{key:"stroke",value:function(){if(this.lineWidth>0){var e=this.mixRGBandAlpha(this.strokeStyle._color.numColor),n=this._getPath(),i=this._curSubmit,r=i._key.submitType===A.SubmitBase.KEY_VG&&i._key.blendShader===this._nBlendType;r&&(r=r&&this.isSameClipInfo(i)),r||(this._curSubmit=this.addVGSubmit(this._pathMesh));for(var a=0,o=0,s=n.paths.length;o<s;o++){var u=n.paths[o];if(!(u.path.length<=0)){var l=[],h=[],c=2*u.path.length;if(!(c<2)){this._pathMesh.vertNum+c>t._MAXVERTNUM&&(this._curSubmit._numEle+=a,a=0,this._pathMesh=W.MeshVG.getAMesh(this.isMain),this.meshlist.push(this._pathMesh),this._curSubmit=this.addVGSubmit(this._pathMesh)),L.BasePoly.createLine2(u.path,l,this.lineWidth,this._pathMesh.vertNum,h,u.loop);var f,_,d,p,y=h.length/2,v=this._curMat,g=0;if(v._bTransform)for(g=0;g<y;g++)_=(f=g<<1)+1,d=h[f],p=h[_],h[f]=v.a*d+v.c*p+v.tx,h[_]=v.b*d+v.d*p+v.ty;else for(g=0;g<y;g++)_=(f=g<<1)+1,d=h[f],p=h[_],h[f]=d+v.tx,h[_]=p+v.ty;this._pathMesh.addVertAndIBToMesh(this,h,e,l),a+=l.length}}}this._curSubmit._numEle+=a}}},{key:"moveTo",value:function(t,e){var n=this._getPath();n.newPath(),n._lastOriX=t,n._lastOriY=e,n.addPoint(t,e)}},{key:"lineTo",value:function(t,e){var n=this._getPath();Math.abs(t-n._lastOriX)<.001&&Math.abs(e-n._lastOriY)<.001||(n._lastOriX=t,n._lastOriY=e,n.addPoint(t,e))}},{key:"arcTo",value:function(e,n,i,r,a){var o=0,s=0,u=0,l=this._path._lastOriX-e,h=this._path._lastOriY-n,c=Math.sqrt(l*l+h*h);if(!(c<=1e-6)){var f=l/c,_=h/c,d=i-e,p=r-n,y=d*d+p*p,v=Math.sqrt(y);if(!(v<=1e-6)){var g=d/v,m=p/v,b=f+g,T=_+m,x=Math.sqrt(b*b+T*T);if(!(x<=1e-6)){var w=b/x,k=T/x,C=Math.acos(w*f+k*_),E=Math.PI/2-C,S=(c=a/Math.tan(E))*f+e,M=c*_+n,L=Math.sqrt(c*c+a*a),R=e+w*L,I=n+k*L,A=0,D=0;if(f*m-_*g>=0){var B=2*E/t.SEGNUM;A=Math.sin(B),D=Math.cos(B)}else B=2*-E/t.SEGNUM,A=Math.sin(B),D=Math.cos(B);var P=this._path._lastOriX,O=this._path._lastOriY,F=S,U=M;(Math.abs(F-this._path._lastOriX)>.1||Math.abs(U-this._path._lastOriY)>.1)&&(s=F,u=U,P=F,O=U,this._path._lastOriX=s,this._path._lastOriY=u,this._path.addPoint(s,u));var N=S-R,G=M-I;for(o=0;o<t.SEGNUM;o++){var H=N*D+G*A,W=-N*A+G*D;s=H+R,u=W+I,(Math.abs(P-s)>.1||Math.abs(O-u)>.1)&&(this._path._lastOriX=s,this._path._lastOriY=u,this._path.addPoint(s,u),P=s,O=u),N=H,G=W}}}}}},{key:"arc",value:function(t,e,n,i,r){var a,o,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=0,l=0,h=0,c=0,f=0,_=0,d=0;if(l=r-i,s)if(Math.abs(l)>=2*Math.PI)l=2*-Math.PI;else for(;l>0;)l-=2*Math.PI;else if(Math.abs(l)>=2*Math.PI)l=2*Math.PI;else for(;l<0;)l+=2*Math.PI;var p=this.getMatScaleX(),y=this.getMatScaleY(),v=n*(p>y?p:y),g=2*Math.PI*v;h=l/(o=0|Math.max(g/10,10))/2,c=Math.abs(4/3*(1-Math.cos(h))/Math.sin(h)),s&&(c=-c);var m=this._getPath();for(a=0;a<=o;a++)u=i+l*(a/o),f=Math.cos(u),d=e+Math.sin(u)*n,(_=t+f*n)==this._path._lastOriX&&d==this._path._lastOriY||m.addPoint(_,d);f=Math.cos(r),d=e+Math.sin(r)*n,(_=t+f*n)==this._path._lastOriX&&d==this._path._lastOriY||m.addPoint(_,d)}},{key:"quadraticCurveTo",value:function(t,e,n,i){for(var r=h.Bezier.I.getBezierPoints([this._path._lastOriX,this._path._lastOriY,t,e,n,i],30,2),a=0,o=r.length/2;a<o;a++)this.lineTo(r[2*a],r[2*a+1]);this.lineTo(n,i)}},{key:"mixRGBandAlpha",value:function(t){return this._mixRGBandAlpha(t,this._shader2D.ALPHA)}},{key:"_mixRGBandAlpha",value:function(t,e){if(e>=1)return t;var n=(4278190080&t)>>>24;return 0!=n?n*=e:n=255*e,16777215&t|n<<24}},{key:"strokeRect",value:function(t,e,n,i,r){if(this.lineWidth>0){var a=this.mixRGBandAlpha(this.strokeStyle._color.numColor),o=this.lineWidth/2;this._fillRect(t-o,e-o,n+this.lineWidth,this.lineWidth,a),this._fillRect(t-o,e-o+i,n+this.lineWidth,this.lineWidth,a),this._fillRect(t-o,e+o,this.lineWidth,i-this.lineWidth,a),this._fillRect(t-o+n,e+o,this.lineWidth,i-this.lineWidth,a)}}},{key:"clip",value:function(){}},{key:"drawParticle",value:function(t,e,n){n.x=t,n.y=e,this._submits[this._submits._length++]=n}},{key:"_getPath",value:function(){return this._path||(this._path=new v.Path)}},{key:"canvas",get:function(){return this._canvas}},{key:"_fillTexture_h",value:function(e,n,i,r,a,o,s,u){r<=0&&console.error("_fillTexture_h error: oriw must>0");for(var l=o,h=Math.floor(u/r),c=u%r,f=0;f<h;f++)this._inner_drawTexture(e,n,l,s,r,a,this._curMat,i,1,!1),l+=r;if(c>0){var _=i[2]-i[0],d=i[0]+_*(c/r),p=t.tmpuv1;p[0]=i[0],p[1]=i[1],p[2]=d,p[3]=i[3],p[4]=d,p[5]=i[5],p[6]=i[6],p[7]=i[7],this._inner_drawTexture(e,n,l,s,c,a,this._curMat,p,1,!1)}}},{key:"_fillTexture_v",value:function(e,n,i,r,a,o,s,u){a<=0&&console.error("_fillTexture_v error: orih must>0");for(var l=s,h=Math.floor(u/a),c=u%a,f=0;f<h;f++)this._inner_drawTexture(e,n,o,l,r,a,this._curMat,i,1,!1),l+=a;if(c>0){var _=i[7]-i[1],d=i[1]+_*(c/a),p=t.tmpuv1;p[0]=i[0],p[1]=i[1],p[2]=i[2],p[3]=i[3],p[4]=i[4],p[5]=d,p[6]=i[6],p[7]=d,this._inner_drawTexture(e,n,o,l,r,c,this._curMat,p,1,!1)}}},{key:"drawTextureWithSizeGrid",value:function(e,n,i,r,a,o,s,u){if(e._getSource()){n+=s,i+=u;var l=e.uv,h=e.bitmap.width,c=e.bitmap.height,f=o[0],_=o[3],d=o[1],p=o[2],y=o[4];r==h&&(_=d=0),a==c&&(f=p=0);var v=f/c,g=_/h,m=d/h,b=p/c,T=e.bitmap.id,x=this._curMat,w=this._tempUV,k=1,C=1;_+d>r&&(k=r/(_+d)),f+p>a&&(C=a/(f+p)),_*=k,d*=k,f*=C,p*=C;var E=l[0],S=l[1],M=l[4],L=l[5],R=E,I=S,A=M,D=L;if(_&&f&&(A=E+g,D=S+v,w[0]=E,w[1]=S,w[2]=A,w[3]=S,w[4]=A,w[5]=D,w[6]=E,w[7]=D,this._inner_drawTexture(e,T,n,i,_,f,x,w,1,!1)),d&&f&&(R=M-m,I=S,A=M,D=S+v,w[0]=R,w[1]=I,w[2]=A,w[3]=I,w[4]=A,w[5]=D,w[6]=R,w[7]=D,this._inner_drawTexture(e,T,r-d+n,0+i,d,f,x,w,1,!1)),_&&p&&(R=E,I=L-b,A=E+g,D=L,w[0]=R,w[1]=I,w[2]=A,w[3]=I,w[4]=A,w[5]=D,w[6]=R,w[7]=D,this._inner_drawTexture(e,T,0+n,a-p+i,_,p,x,w,1,!1)),d&&p&&(R=M-m,I=L-b,A=M,D=L,w[0]=R,w[1]=I,w[2]=A,w[3]=I,w[4]=A,w[5]=D,w[6]=R,w[7]=D,this._inner_drawTexture(e,T,r-d+n,a-p+i,d,p,x,w,1,!1)),f&&(R=E+g,I=S,A=M-m,D=S+v,w[0]=R,w[1]=I,w[2]=A,w[3]=I,w[4]=A,w[5]=D,w[6]=R,w[7]=D,y?this._fillTexture_h(e,T,w,e.width-_-d,f,_+n,i,r-_-d):this._inner_drawTexture(e,T,_+n,i,r-_-d,f,x,w,1,!1)),p&&(R=E+g,I=L-b,A=M-m,D=L,w[0]=R,w[1]=I,w[2]=A,w[3]=I,w[4]=A,w[5]=D,w[6]=R,w[7]=D,y?this._fillTexture_h(e,T,w,e.width-_-d,p,_+n,a-p+i,r-_-d):this._inner_drawTexture(e,T,_+n,a-p+i,r-_-d,p,x,w,1,!1)),_&&(R=E,I=S+v,A=E+g,D=L-b,w[0]=R,w[1]=I,w[2]=A,w[3]=I,w[4]=A,w[5]=D,w[6]=R,w[7]=D,y?this._fillTexture_v(e,T,w,_,e.height-f-p,n,f+i,a-f-p):this._inner_drawTexture(e,T,n,f+i,_,a-f-p,x,w,1,!1)),d&&(R=M-m,I=S+v,A=M,D=L-b,w[0]=R,w[1]=I,w[2]=A,w[3]=I,w[4]=A,w[5]=D,w[6]=R,w[7]=D,y?this._fillTexture_v(e,T,w,d,e.height-f-p,r-d+n,f+i,a-f-p):this._inner_drawTexture(e,T,r-d+n,f+i,d,a-f-p,x,w,1,!1)),R=E+g,I=S+v,A=M-m,D=L-b,w[0]=R,w[1]=I,w[2]=A,w[3]=I,w[4]=A,w[5]=D,w[6]=R,w[7]=D,y){var B=t.tmpUVRect;B[0]=R,B[1]=I,B[2]=A-R,B[3]=D-I,this._fillTexture(e,e.width-_-d,e.height-f-p,B,_+n,f+i,r-_-d,a-f-p,"repeat",0,0)}else this._inner_drawTexture(e,T,_+n,f+i,r-_-d,a-f-p,x,w,1,!1);!1}}}],[{key:"__init__",value:function(){t.MAXCLIPRECT=new _.Rectangle(0,0,t._MAXSIZE,t._MAXSIZE),tt.DEFAULT=new tt,w.WebGLCacheAsNormalCanvas}},{key:"set2DRenderConfig",value:function(){var t=l.LayaGL.instance;Y.WebGLContext.setBlend(t,!0),Y.WebGLContext.setBlendEquation(t,t.FUNC_ADD),p.BlendMode.activeBlendFunction=null,Y.WebGLContext.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_ALPHA),Y.WebGLContext.setDepthTest(t,!1),Y.WebGLContext.setCullFace(t,!1),Y.WebGLContext.setDepthMask(t,!0),Y.WebGLContext.setFrontFace(t,t.CCW),t.viewport(0,0,V.RenderState2D.width,V.RenderState2D.height),t.enable(t.SCISSOR_TEST),t.scissor(0,0,V.RenderState2D.width,V.RenderState2D.height)}}]),t}();e.Context=J,J.ENUM_TEXTALIGN_DEFAULT=0,J.ENUM_TEXTALIGN_CENTER=1,J.ENUM_TEXTALIGN_RIGHT=2,J._SUBMITVBSIZE=32e3,J._MAXSIZE=99999999,J._MAXVERTNUM=65535,J.MAXCLIPRECT=null,J._COUNT=0,J.SEGNUM=32,J._contextcount=0,J.PI2=2*Math.PI,J._textRender=null,J.tmpuv1=[0,0,0,0,0,0,0,0],J.tmpUV=[0,0,0,0,0,0,0,0],J.tmpUVRect=[0,0,0,0];var tt=function(){function t(){Z(this,t),this.lineWidth=1}return $(t,[{key:"clear",value:function(){this.lineWidth=1,this.textAlign=this.textBaseline=null}},{key:"make",value:function(){return this===t.DEFAULT?new t:this}}]),t}()},69432:function(t,e,n){"use strict";var i;n(63978)(e,"__esModule",{value:!0}),e.FilterMode=void 0,e.FilterMode=i,function(t){t[t.Point=0]="Point",t[t.Bilinear=1]="Bilinear",t[t.Trilinear=2]="Trilinear"}(i||(e.FilterMode=i={}))},26776:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.HTMLCanvas=void 0;var f=m(n(85507)),_=m(n(21611)),d=n(8944),p=n(54598),y=n(87035),v=n(92493),g=n(93568);function m(t){return t&&t.__esModule?t:{default:t}}function b(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function x(){return x="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=w(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},x.apply(this,arguments)}function w(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=M(t)););return t}function k(t,e){return k=a||function(t,e){return t.__proto__=e,t},k(t,e)}function C(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=M(t);if(e){var a=M(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return E(this,n)}}function E(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return S(t)}function S(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function M(t){return M=f.default?_.default:function(t){return t.__proto__||(0,_.default)(t)},M(t)}var L=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&k(t,e)}(a,t);var e,n,i,r=C(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return b(this,a),(t=r.call(this))._source=e?g.Browser.createElement("canvas"):S(t),t.lock=!0,t}return e=a,(n=[{key:"source",get:function(){return this._source}},{key:"_getSource",value:function(){return this._source}},{key:"clear",value:function(){this._ctx&&(this._ctx.clear?this._ctx.clear():this._ctx.clearRect(0,0,this._width,this._height)),this._texture&&(this._texture.destroy(),this._texture=null)}},{key:"destroy",value:function(){x(M(a.prototype),"destroy",this).call(this),this._setCPUMemory(0),this._ctx&&this._ctx.destroy&&this._ctx.destroy(),this._ctx=null}},{key:"release",value:function(){}},{key:"context",get:function(){return this._ctx||(this._source==this?this._ctx=new v.ILaya.Context:this._ctx=this._source.getContext(v.ILaya.Render.isConchApp?"layagl":"2d"),this._ctx._canvas=this),this._ctx}},{key:"_setContext",value:function(t){this._ctx=t}},{key:"getContext",value:function(t){return this.context}},{key:"getMemSize",value:function(){return 0}},{key:"size",value:function(t,e){(this._width!=t||this._height!=e||this._source&&(this._source.width!=t||this._source.height!=e))&&(this._width=t,this._height=e,this._setCPUMemory(t*e*4),this._ctx&&this._ctx.size&&this._ctx.size(t,e),this._source&&(this._source.height=e,this._source.width=t),this._texture&&(this._texture.destroy(),this._texture=null))}},{key:"getTexture",value:function(){if(!this._texture){var t=new y.Texture2D;t.loadImageSource(this.source),this._texture=new p.Texture(t)}return this._texture}},{key:"toBase64",value:function(t,e){if(this._source){if(v.ILaya.Render.isConchApp){var n=window;if(2==n.conchConfig.threadMode)throw"native 2 thread mode use toBase64Async";var i=this._ctx._targets.sourceWidth,r=this._ctx._targets.sourceHeight,a=this._ctx._targets.getData(0,0,i,r);return n.conchToBase64FlipY?n.conchToBase64FlipY(t,e,a.buffer,i,r):n.conchToBase64(t,e,a.buffer,i,r)}return this._source.toDataURL(t,e)}return null}},{key:"toBase64Async",value:function(t,e,n){var i=this._ctx._targets.sourceWidth,r=this._ctx._targets.sourceHeight;this._ctx._targets.getDataAsync(0,0,i,r,(function(a){var o=window,s=o.conchToBase64FlipY?o.conchToBase64FlipY(t,e,a.buffer,i,r):o.conchToBase64(t,e,a.buffer,i,r);n(s)}))}}])&&T(e.prototype,n),i&&T(e,i),a}(d.Bitmap);e.HTMLCanvas=L},64178:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.HTMLImage=void 0;var h=p(n(85507)),c=p(n(21611)),f=n(8944),_=n(87035),d=n(69176);function p(t){return t&&t.__esModule?t:{default:t}}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){return v=a||function(t,e){return t.__proto__=e,t},v(t,e)}function g(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b(t);if(e){var a=b(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return m(this,n)}}function m(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function b(t){return b=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},b(t)}var T=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(n,t);var e=g(n);function n(){return y(this,n),e.apply(this,arguments)}return n}(f.Bitmap);e.HTMLImage=T,T.create=function(t,e,n){var i=new _.Texture2D(t,e,n,!1,!1);return i.wrapModeU=d.WarpMode.Clamp,i.wrapModeV=d.WarpMode.Clamp,i}},93894:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.RenderTexture2D=void 0;var h=b(n(85507)),c=b(n(21611)),f=n(87035),_=n(33873),d=n(69534),p=n(61266),y=n(20541),v=n(56161),g=n(92493),m=n(57693);function b(t){return t&&t.__esModule?t:{default:t}}function T(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function w(t,e){return w=a||function(t,e){return t.__proto__=e,t},w(t,e)}function k(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=E(t);if(e){var a=E(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return C(this,n)}}function C(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function E(t){return E=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},E(t)}var S=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}(a,t);var e,n,i,r=k(a);function a(t,e){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m.RenderTextureFormat.R8G8B8,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:m.RenderTextureDepthFormat.DEPTH_16;return T(this,a),(n=r.call(this,i,!1))._mgrKey=0,n._glTextureType=_.LayaGL.instance.TEXTURE_2D,n._width=t,n._height=e,n._depthStencilFormat=o,n._create(t,e),n.lock=!0,n}return e=a,n=[{key:"depthStencilFormat",get:function(){return this._depthStencilFormat}},{key:"defaulteTexture",get:function(){return f.Texture2D.grayTexture}},{key:"getIsReady",value:function(){return!0}},{key:"sourceWidth",get:function(){return this._width}},{key:"sourceHeight",get:function(){return this._height}},{key:"offsetX",get:function(){return 0}},{key:"offsetY",get:function(){return 0}},{key:"_create",value:function(t,e){var n=_.LayaGL.instance;this._frameBuffer=n.createFramebuffer(),p.WebGLContext.bindTexture(n,this._glTextureType,this._glTexture);var i=this._getGLFormat();if(n.texImage2D(this._glTextureType,0,i,t,e,0,i,n.UNSIGNED_BYTE,null),this._setGPUMemory(t*e*4),n.bindFramebuffer(n.FRAMEBUFFER,this._frameBuffer),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this._glTexture,0),this._depthStencilFormat!==m.RenderTextureDepthFormat.DEPTHSTENCIL_NONE)switch(this._depthStencilBuffer=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,this._depthStencilBuffer),this._depthStencilFormat){case m.RenderTextureDepthFormat.DEPTH_16:n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,t,e),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,this._depthStencilBuffer);break;case m.RenderTextureDepthFormat.STENCIL_8:n.renderbufferStorage(n.RENDERBUFFER,n.STENCIL_INDEX8,t,e),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.STENCIL_ATTACHMENT,n.RENDERBUFFER,this._depthStencilBuffer);break;case m.RenderTextureDepthFormat.DEPTHSTENCIL_24_8:n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,t,e),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,this._depthStencilBuffer)}n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindRenderbuffer(n.RENDERBUFFER,null),this._setWarpMode(n.TEXTURE_WRAP_S,this._wrapModeU),this._setWarpMode(n.TEXTURE_WRAP_T,this._wrapModeV),this._setFilterMode(this._filterMode),this._setAnisotropy(this._anisoLevel),this._readyed=!0,this._activeResource()}},{key:"generateMipmap",value:function(){this._isPot(this.width)&&this._isPot(this.height)?(this._mipmap=!0,_.LayaGL.instance.generateMipmap(this._glTextureType),this._setFilterMode(this._filterMode),this._setGPUMemory(this.width*this.height*4*(1+1/3))):(this._mipmap=!1,this._setGPUMemory(this.width*this.height*4))}},{key:"start",value:function(){var t=_.LayaGL.instance;_.LayaGL.instance.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),this._lastRT=a._currentActive,a._currentActive=this,this._readyed=!0,t.viewport(0,0,this._width,this._height),this._lastWidth=v.RenderState2D.width,this._lastHeight=v.RenderState2D.height,v.RenderState2D.width=this._width,v.RenderState2D.height=this._height,y.BaseShader.activeShader=null}},{key:"end",value:function(){var t=_.LayaGL.instance;t.bindFramebuffer(t.FRAMEBUFFER,null),a._currentActive=null,this._readyed=!0}},{key:"restore",value:function(){var t=_.LayaGL.instance;this._lastRT!=a._currentActive&&(_.LayaGL.instance.bindFramebuffer(t.FRAMEBUFFER,this._lastRT?this._lastRT._frameBuffer:null),a._currentActive=this._lastRT),this._readyed=!0,t.viewport(0,0,this._lastWidth,this._lastHeight),v.RenderState2D.width=this._lastWidth,v.RenderState2D.height=this._lastHeight,y.BaseShader.activeShader=null}},{key:"clear",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=_.LayaGL.instance;r.clearColor(t,e,n,i);var a=r.COLOR_BUFFER_BIT;switch(this._depthStencilFormat){case r.DEPTH_COMPONENT16:a|=r.DEPTH_BUFFER_BIT;break;case r.STENCIL_INDEX8:a|=r.STENCIL_BUFFER_BIT;break;case r.DEPTH_STENCIL:a|=r.DEPTH_BUFFER_BIT,a|=r.STENCIL_BUFFER_BIT}r.clear(a)}},{key:"getData",value:function(t,e,n,i){if(g.ILaya.Render.isConchApp&&2==window.conchConfig.threadMode)throw"native 2 thread mode use getDataAsync";var r=_.LayaGL.instance;if(r.bindFramebuffer(r.FRAMEBUFFER,this._frameBuffer),r.checkFramebufferStatus(r.FRAMEBUFFER)!==r.FRAMEBUFFER_COMPLETE)return r.bindFramebuffer(r.FRAMEBUFFER,null),null;var a=new Uint8Array(this._width*this._height*4),o=this._getGLFormat();return r.readPixels(t,e,n,i,o,r.UNSIGNED_BYTE,a),r.bindFramebuffer(r.FRAMEBUFFER,null),a}},{key:"getDataAsync",value:function(t,e,n,i,r){var a=_.LayaGL.instance;a.bindFramebuffer(a.FRAMEBUFFER,this._frameBuffer),a.readPixelsAsync(t,e,n,i,a.RGBA,a.UNSIGNED_BYTE,(function(t){r(new Uint8Array(t))})),a.bindFramebuffer(a.FRAMEBUFFER,null)}},{key:"recycle",value:function(){}},{key:"_disposeResource",value:function(){if(this._frameBuffer){var t=_.LayaGL.instance;t.deleteTexture(this._glTexture),t.deleteFramebuffer(this._frameBuffer),t.deleteRenderbuffer(this._depthStencilBuffer),this._glTexture=null,this._frameBuffer=null,this._depthStencilBuffer=null,this._setGPUMemory(0)}}}],i=[{key:"currentActive",get:function(){return a._currentActive}},{key:"pushRT",value:function(){a.rtStack.push({rt:a._currentActive,w:v.RenderState2D.width,h:v.RenderState2D.height})}},{key:"popRT",value:function(){var t=_.LayaGL.instance,e=a.rtStack.pop();e&&(a._currentActive!=e.rt&&(_.LayaGL.instance.bindFramebuffer(t.FRAMEBUFFER,e.rt?e.rt._frameBuffer:null),a._currentActive=e.rt),t.viewport(0,0,e.w,e.h),v.RenderState2D.width=e.w,v.RenderState2D.height=e.h)}}],n&&x(e.prototype,n),i&&x(e,i),a}(d.BaseTexture);e.RenderTexture2D=S,S.rtStack=[],S.defuv=[0,0,1,0,1,1,0,1],S.flipyuv=[0,1,1,1,1,0,0,0]},57693:function(t,e,n){"use strict";var i,r,a;n(63978)(e,"__esModule",{value:!0}),e.RenderTextureFormat=e.RenderTextureDepthFormat=e.RTDEPTHATTACHMODE=void 0,e.RenderTextureFormat=i,function(t){t[t.R8G8B8=0]="R8G8B8",t[t.R8G8B8A8=1]="R8G8B8A8",t[t.Alpha8=2]="Alpha8",t[t.R16G16B16A16=14]="R16G16B16A16",t[t.Depth=15]="Depth",t[t.ShadowMap=16]="ShadowMap"}(i||(e.RenderTextureFormat=i={})),e.RenderTextureDepthFormat=r,function(t){t[t.DEPTH_16=0]="DEPTH_16",t[t.STENCIL_8=1]="STENCIL_8",t[t.DEPTHSTENCIL_24_8=2]="DEPTHSTENCIL_24_8",t[t.DEPTHSTENCIL_NONE=3]="DEPTHSTENCIL_NONE",t[t.DEPTH_32=4]="DEPTH_32",t[t.DEPTHSTENCIL_16_8=2]="DEPTHSTENCIL_16_8"}(r||(e.RenderTextureDepthFormat=r={})),e.RTDEPTHATTACHMODE=a,function(t){t[t.RENDERBUFFER=0]="RENDERBUFFER",t[t.TEXTURE=1]="TEXTURE"}(a||(e.RTDEPTHATTACHMODE=a={}))},25883:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.Resource=void 0;var h=v(n(92762)),c=v(n(81643)),f=v(n(85507)),_=v(n(21611)),d=n(92493),p=n(48856),y=n(84935);function v(t){return t&&t.__esModule?t:{default:t}}function g(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function m(t,e){return m=a||function(t,e){return t.__proto__=e,t},m(t,e)}function b(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=w(t);if(e){var a=w(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return T(this,n)}}function T(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return x(t)}function x(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function w(t){return w=f.default?_.default:function(t){return t.__proto__||(0,_.default)(t)},w(t)}var k=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(a,t);var e,n,i,r=b(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this))._id=0,t._url=null,t._cpuMemory=0,t._gpuMemory=0,t._destroyed=!1,t._referenceCount=0,t.lock=!1,t.name=null,t._id=++a._uniqueIDCounter,t._destroyed=!1,t._referenceCount=0,a._idResourcesMap[t.id]=x(t),t.lock=!1,t}return e=a,n=[{key:"id",get:function(){return this._id}},{key:"url",get:function(){return this._url}},{key:"cpuMemory",get:function(){return this._cpuMemory}},{key:"gpuMemory",get:function(){return this._gpuMemory}},{key:"destroyed",get:function(){return this._destroyed}},{key:"referenceCount",get:function(){return this._referenceCount}},{key:"_setCPUMemory",value:function(t){var e=t-this._cpuMemory;this._cpuMemory=t,a._addCPUMemory(e)}},{key:"_setGPUMemory",value:function(t){var e=t-this._gpuMemory;this._gpuMemory=t,a._addGPUMemory(e)}},{key:"_setCreateURL",value:function(t){var e;t=y.URL.formatURL(t),this._url!==t&&(this._url&&(e=a._urlResourcesMap[this._url],(0,h.default)(e).call(e,(0,c.default)(e).call(e,this),1),0===e.length&&delete a._urlResourcesMap[this._url]),t&&((e=a._urlResourcesMap[t])||(a._urlResourcesMap[t]=e=[]),e.push(this)),this._url=t)}},{key:"_addReference",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._referenceCount+=t}},{key:"_removeReference",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._referenceCount-=t}},{key:"_clearReference",value:function(){this._referenceCount=0}},{key:"_recoverResource",value:function(){}},{key:"_disposeResource",value:function(){}},{key:"_activeResource",value:function(){}},{key:"destroy",value:function(){var t;this._destroyed||(this._destroyed=!0,this.lock=!1,this._disposeResource(),delete a._idResourcesMap[this.id],this._url&&((t=a._urlResourcesMap[this._url])&&((0,h.default)(t).call(t,(0,c.default)(t).call(t,this),1),0===t.length&&delete a._urlResourcesMap[this._url]),d.ILaya.Loader.loadedMap[this._url]==this&&delete d.ILaya.Loader.loadedMap[this._url]))}}],i=[{key:"cpuMemory",get:function(){return a._cpuMemory}},{key:"gpuMemory",get:function(){return a._gpuMemory}},{key:"_addCPUMemory",value:function(t){a._cpuMemory+=t}},{key:"_addGPUMemory",value:function(t){a._gpuMemory+=t}},{key:"_addMemory",value:function(t,e){a._cpuMemory+=t,a._gpuMemory+=e}},{key:"getResourceByID",value:function(t){return a._idResourcesMap[t]}},{key:"getResourceByURL",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return a._urlResourcesMap[t][e]}},{key:"destroyUnusedResources",value:function(){for(var t in a._idResourcesMap){var e=a._idResourcesMap[t];e.lock||0!==e._referenceCount||e.destroy()}}}],n&&g(e.prototype,n),i&&g(e,i),a}(p.EventDispatcher);e.Resource=k,k._uniqueIDCounter=0,k._idResourcesMap={},k._urlResourcesMap={},k._cpuMemory=0,k._gpuMemory=0},54598:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.Texture=void 0;var h=g(n(3649)),c=g(n(85507)),f=g(n(21611)),_=n(89662),d=n(48856),p=n(98693),y=n(41107),v=n(92493);function g(t){return t&&t.__esModule?t:{default:t}}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function T(t,e){return T=a||function(t,e){return t.__proto__=e,t},T(t,e)}function x(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=k(t);if(e){var a=k(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return w(this,n)}}function w(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function k(t){return k=c.default?f.default:function(t){return t.__proto__||(0,f.default)(t)},k(t)}var C=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&T(t,e)}(a,t);var e,n,i,r=x(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return m(this,a),(t=r.call(this)).uvrect=[0,0,1,1],t._destroyed=!1,t._referenceCount=0,t.$_GID=0,t.offsetX=0,t.offsetY=0,t._w=0,t._h=0,t.sourceWidth=0,t.sourceHeight=0,t.url=null,t.scaleRate=1,t.setTo(e,n,i,o),t}return e=a,n=[{key:"uv",get:function(){return this._uv},set:function(t){this.uvrect[0]=Math.min(t[0],t[2],t[4],t[6]),this.uvrect[1]=Math.min(t[1],t[3],t[5],t[7]),this.uvrect[2]=Math.max(t[0],t[2],t[4],t[6])-this.uvrect[0],this.uvrect[3]=Math.max(t[1],t[3],t[5],t[7])-this.uvrect[1],this._uv=t}},{key:"width",get:function(){return this._w?this._w:this.bitmap?this.uv&&this.uv!==a.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width:0},set:function(t){this._w=t,this.sourceWidth||(this.sourceWidth=t)}},{key:"height",get:function(){return this._h?this._h:this.bitmap?this.uv&&this.uv!==a.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height:0},set:function(t){this._h=t,this.sourceHeight||(this.sourceHeight=t)}},{key:"bitmap",get:function(){return this._bitmap},set:function(t){this._bitmap&&this._bitmap._removeReference(this._referenceCount),this._bitmap=t,t&&t._addReference(this._referenceCount)}},{key:"destroyed",get:function(){return this._destroyed}},{key:"_addReference",value:function(){this._bitmap&&this._bitmap._addReference(),this._referenceCount++}},{key:"_removeReference",value:function(){this._bitmap&&this._bitmap._removeReference(),this._referenceCount--}},{key:"_getSource",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this._destroyed||!this._bitmap?null:(this.recoverBitmap(t),this._bitmap.destroyed?null:this.bitmap._getSource())}},{key:"_onLoaded",value:function(t,e){if(e)if(e==this);else if(e instanceof a){var n=e;a._create(e,0,0,n.width,n.height,0,0,n.sourceWidth,n.sourceHeight,this)}else this.bitmap=e,this.sourceWidth=this._w=e.width,this.sourceHeight=this._h=e.height;t&&t.run(),this.event(_.Event.READY,this)}},{key:"getIsReady",value:function(){return!this._destroyed&&!!this._bitmap}},{key:"setTo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.bitmap=t,this.sourceWidth=n,this.sourceHeight=i,t&&(this._w=t.width,this._h=t.height,this.sourceWidth=this.sourceWidth||t.width,this.sourceHeight=this.sourceHeight||t.height),this.uv=e||a.DEF_UV}},{key:"load",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._destroyed||v.ILaya.loader.load(t,y.Handler.create(this,this._onLoaded,[e]),null,"htmlimage",1,!0)}},{key:"getTexturePixels",value:function(t,e,n,i){var r,a,o,s=this.bitmap,u=this._w,l=this._h,c=this.sourceWidth,f=this.sourceHeight,_=s.width,d=s.height,p=this.offsetX,y=this.offsetY,g=n,m=i;if(t+n>u+p&&(g-=t+n-u-p),t+n>c&&(n-=t+n-c),e+i>l+y&&(m-=e+i-l-y),e+i>f&&(i-=e+i-f),n<=0||i<=0)return null;var b=p>t?p-t:0,T=y>e?y-e:0,x=t>p?t-p:0,w=e>y?e-y:0;g-=b,m-=T;var k=4*n,C=null;try{C=s.getPixels()}catch(t){}if(C){var E;if(0==t&&0==e&&n==_&&i==d)return C;var S=(0,h.default)(E=this._uv).call(E),M=Math.round(S[0]*_),L=Math.round(S[1]*d),R=new Uint8Array(n*i*4);for(r=4*M+4*x+(a=(L+w)*(k=4*_)),o=0;o<m;o++)R.set((0,h.default)(C).call(C,r,r+4*g),4*n*(o+T)+4*b),r+=k;return R}var I=new v.ILaya.Context;I.size(n,i),I.asBitmap=!0;var A=null;if(0!=t||0!=e||n!=_||i!=d){var D,B=(A=(0,h.default)(D=this._uv).call(D))[0],P=A[1],O=(A[2]-B)/u,F=(A[7]-P)/l;A=[B+x*O,P+w*F,B+(x+g)*O,P+w*F,B+(x+g)*O,P+(w+m)*F,B+x*O,P+(w+m)*F]}I._drawTextureM(this,b,T,g,m,null,1,A),I._targets.start(),I.flush(),I._targets.end(),I._targets.restore();var U=I._targets.getData(0,0,n,i);for(I.destroy(),R=new Uint8Array(n*i*4),r=0,a=(i-1)*k,o=i-1;o>=0;o--)R.set((0,h.default)(U).call(U,a,a+k),r),r+=k,a-=k;return R}},{key:"getPixels",value:function(t,e,n,i){return window.conch?this._nativeObj.getImageData(t,e,n,i):this.getTexturePixels(t,e,n,i)}},{key:"recoverBitmap",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this._bitmap.url;if(!this._destroyed&&(!this._bitmap||this._bitmap.destroyed)&&n){var i=v.ILaya.Loader.loadedMap[n];i?(this.bitmap=i,e&&e()):v.ILaya.loader.load(n,y.Handler.create(this,(function(n){t.bitmap=n,e&&e()})),null,"htmlimage",1,!0)}}},{key:"disposeBitmap",value:function(){!this._destroyed&&this._bitmap&&this._bitmap.destroy()}},{key:"destroy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this._destroyed){this._destroyed=!0;var e=this._bitmap;e&&(e._removeReference(this._referenceCount),(0===e.referenceCount||t)&&e.destroy(),e=null),this.url&&this===v.ILaya.loader.getRes(this.url)&&v.ILaya.Loader.clearRes(this.url)}}}],i=[{key:"moveUV",value:function(t,e,n){for(var i=0;i<8;i+=2)n[i]+=t,n[i+1]+=e;return n}},{key:"create",value:function(t,e,n,i,r){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;return a._create(t,e,n,i,r,o,s,u,l)}},{key:"_create",value:function(t,e,n,i,r){var o,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,f=t instanceof a,_=f?t.uv:a.DEF_UV,d=f?t.bitmap:t;d.width&&e+i>d.width&&(i=d.width-e),d.height&&n+r>d.height&&(r=d.height-n),c?(o=c).setTo(d,null,l||i,h||r):o=new a(d,null,l||i,h||r),o.width=i,o.height=r,o.offsetX=s,o.offsetY=u;var p=1/d.width,y=1/d.height;e*=p,n*=y,i*=p,r*=y;var v=o.uv[0],g=o.uv[1],m=o.uv[4],b=o.uv[5],T=m-v,x=b-g,w=a.moveUV(_[0],_[1],[e,n,e+i,n,e+i,n+r,e,n+r]);o.uv=new Float32Array([v+w[0]*T,g+w[1]*x,m-(1-w[2])*T,g+w[3]*x,m-(1-w[4])*T,b-(1-w[5])*x,v+w[6]*T,b-(1-w[7])*x]);var k=d.scaleRate;return k&&1!=k?(o.sourceWidth/=k,o.sourceHeight/=k,o.width/=k,o.height/=k,o.scaleRate=k,o.offsetX/=k,o.offsetY/=k):o.scaleRate=1,o}},{key:"createFromTexture",value:function(t,e,n,i,r){var o=t.scaleRate;1!=o&&(e*=o,n*=o,i*=o,r*=o);var s=p.Rectangle.TEMP.setTo(e-t.offsetX,n-t.offsetY,i,r),u=s.intersection(a._rect1.setTo(0,0,t.width,t.height),a._rect2);return u?a.create(t,u.x,u.y,u.width,u.height,u.x-s.x,u.y-s.y,i,r):null}}],n&&b(e.prototype,n),i&&b(e,i),a}(d.EventDispatcher);e.Texture=C,C.DEF_UV=new Float32Array([0,0,1,0,1,1,0,1]),C.NO_UV=new Float32Array([0,0,0,0,0,0,0,0]),C.INV_UV=new Float32Array([0,1,1,1,1,0,0,0]),C._rect1=new p.Rectangle,C._rect2=new p.Rectangle},87035:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.Texture2D=void 0;var h=x(n(86029)),c=x(n(85507)),f=x(n(21611)),_=n(92493),d=n(33873),p=n(61266),y=n(69534),v=n(73972),g=n(14002),m=n(69432),b=n(86877),T=n(34277);function x(t){return t&&t.__esModule?t:{default:t}}function w(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function k(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function C(t,e){return C=a||function(t,e){return t.__proto__=e,t},C(t,e)}function E(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=M(t);if(e){var a=M(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return S(this,n)}}function S(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function M(t){return M=c.default?f.default:function(t){return t.__proto__||(0,f.default)(t)},M(t)}var L=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&C(t,e)}(a,t);var e,n,i,r=E(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v.TextureFormat.R8G8B8A8,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];w(this,a),t=r.call(this,i,o);var u=d.LayaGL.instance;t._glTextureType=u.TEXTURE_2D,t._width=e,t._height=n,t._canRead=s,t._setWarpMode(u.TEXTURE_WRAP_S,t._wrapModeU),t._setWarpMode(u.TEXTURE_WRAP_T,t._wrapModeV),t._setFilterMode(t._filterMode),t._setAnisotropy(t._anisoLevel);var l=t._gpuCompressFormat();if(o){var c=Math.max(Math.ceil((0,h.default)(e))+1,Math.ceil((0,h.default)(n))+1);if(!l)for(var f=0;f<c;f++)t._setPixels(null,f,Math.max(e>>f,1),Math.max(n>>f,1));t._mipmapCount=c,t._setGPUMemory(e*n*4*(1+1/3))}else l||t._setPixels(null,0,e,n),t._mipmapCount=1,t._setGPUMemory(e*n*4);return t}return e=a,n=[{key:"defaulteTexture",get:function(){return a.grayTexture}},{key:"_gpuCompressFormat",value:function(){return this._format!=v.TextureFormat.R8G8B8A8&&this._format!=v.TextureFormat.R8G8B8&&this._format!=v.TextureFormat.R16G16B16A16&&this._format!=v.TextureFormat.R32G32B32A32&&this._format!=v.TextureFormat.R5G6B5&&this._format!=v.TextureFormat.Alpha8}},{key:"_setPixels",value:function(t,e,n,i){var r=d.LayaGL.instance,a=this._glTextureType,o=this._getGLFormat();switch(p.WebGLContext.bindTexture(r,a,this._glTexture),this.format){case v.TextureFormat.R8G8B8:case v.TextureFormat.R8G8B8A8:r.pixelStorei(r.UNPACK_ALIGNMENT,1),r.texImage2D(a,e,o,n,i,0,o,r.UNSIGNED_BYTE,t),r.pixelStorei(r.UNPACK_ALIGNMENT,4);break;case v.TextureFormat.R5G6B5:r.pixelStorei(r.UNPACK_ALIGNMENT,2),r.texImage2D(a,e,o,n,i,0,o,r.UNSIGNED_SHORT_5_6_5,t),r.pixelStorei(r.UNPACK_ALIGNMENT,4);break;case v.TextureFormat.R32G32B32A32:d.LayaGL.layaGPUInstance._isWebGL2?r.texImage2D(a,e,r.RGBA32F,n,i,0,o,r.FLOAT,t):r.texImage2D(a,e,r.RGBA,n,i,0,o,r.FLOAT,t);break;case v.TextureFormat.R16G16B16A16:d.LayaGL.layaGPUInstance._isWebGL2?r.texImage2D(a,e,r.RGBA16F,n,i,0,o,r.HALF_FLOAT,t):r.texImage2D(a,e,r.RGBA,n,i,0,o,d.LayaGL.layaGPUInstance._oesTextureHalfFloat.HALF_FLOAT_OES,t);break;default:r.texImage2D(a,e,o,n,i,0,o,r.UNSIGNED_BYTE,t)}}},{key:"_calcualatesCompressedDataSize",value:function(t,e,n){switch(t){case v.TextureFormat.DXT1:return(e+3>>2)*(n+3>>2)*8;case v.TextureFormat.DXT5:return(e+3>>2)*(n+3>>2)*16;case v.TextureFormat.PVRTCRGB_4BPPV:case v.TextureFormat.PVRTCRGBA_4BPPV:return Math.floor((Math.max(e,8)*Math.max(n,8)*4+7)/8);case v.TextureFormat.PVRTCRGB_2BPPV:case v.TextureFormat.PVRTCRGBA_2BPPV:return Math.floor((Math.max(e,16)*Math.max(n,8)*2+7)/8);default:return 0}}},{key:"_pharseDDS",value:function(t){var e=new Int32Array(t,0,31);if(542327876!=e[0])throw"Invalid magic number in DDS header";if(!(4&e[20]))throw"Unsupported format, must contain a FourCC code";var n=e[21];switch(this._format){case v.TextureFormat.DXT1:if(827611204!==n)throw"the FourCC code is not same with texture format.";break;case v.TextureFormat.DXT5:if(894720068!==n)throw"the FourCC code is not same with texture format.";break;default:throw"unknown texture format."}var i=1;if(131072&e[2]){if(i=Math.max(1,e[7]),!this._mipmap)throw"the mipmap is not same with Texture2D."}else if(this._mipmap)throw"the mipmap is not same with Texture2D.";var r=e[4],a=e[3];this._width=r,this._height=a;var o=e[1]+4;this._upLoadCompressedTexImage2D(t,r,a,i,o,0)}},{key:"_pharseKTX",value:function(t){var e=new Uint8Array(t,0,12);if(171!=e[0]||75!=e[1]||84!=e[2]||88!=e[3]||32!=e[4]||49!=e[5]||49!=e[6]||187!=e[7]||13!=e[8]||10!=e[9]||26!=e[10]||10!=e[11])throw"Invalid fileIdentifier in KTX header";var n=new Int32Array(e.buffer,e.length,13),i=n[4];if(this._format=-1,d.LayaGL.layaGPUInstance._compressedTextureASTC)switch(i){case d.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_RGBA_ASTC_4x4_KHR:this._format=v.TextureFormat.ASTC4x4;break;case d.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:this._format=v.TextureFormat.ASTC4x4SRGB;break;case d.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:this._format=v.TextureFormat.ASTC6x6SRGB;break;case d.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:this._format=v.TextureFormat.ASTC8x8SRGB;break;case d.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:this._format=v.TextureFormat.ASTC10x10SRGB;break;case d.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:this._format=v.TextureFormat.ASTC12x12SRGB;break;case d.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_RGBA_ASTC_6x6_KHR:this._format=v.TextureFormat.ASTC6x6;break;case d.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_RGBA_ASTC_8x8_KHR:this._format=v.TextureFormat.ASTC8x8;break;case d.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_RGBA_ASTC_10x10_KHR:this._format=v.TextureFormat.ASTC10x10;break;case d.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_RGBA_ASTC_12x12_KHR:this._format=v.TextureFormat.ASTC12x12}if(d.LayaGL.layaGPUInstance._compressedTextureEtc1&&i===d.LayaGL.layaGPUInstance._compressedTextureEtc1.COMPRESSED_RGB_ETC1_WEBGL&&(this._format=v.TextureFormat.ETC1RGB),d.LayaGL.layaGPUInstance._compressedTextureETC)switch(i){case d.LayaGL.layaGPUInstance._compressedTextureETC.COMPRESSED_RGBA8_ETC2_EAC:this._format=v.TextureFormat.ETC2RGBA;break;case d.LayaGL.layaGPUInstance._compressedTextureETC.COMPRESSED_RGB8_ETC2:this._format=v.TextureFormat.ETC2RGB;break;case d.LayaGL.layaGPUInstance._compressedTextureETC.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:this._format=v.TextureFormat.ETC2RGB_Alpha8;break;case d.LayaGL.layaGPUInstance._compressedTextureETC.COMPRESSED_SRGB8_ETC2:this._format=v.TextureFormat.ETC2SRGB}if(-1==this._format)throw"unknown texture format.";var r=n[11],a=n[6],o=n[7];this._width=a,this._height=o;var s=64+n[12];this._upLoadKTXCompressedTexImage2D(t,a,o,r,s,4)}},{key:"_pharsePVR",value:function(t){var e=new Int32Array(t,0,13);if(55727696!=e[0])throw"Invalid magic number in PVR header";switch(e[2]){case 0:this._format=v.TextureFormat.PVRTCRGB_2BPPV;break;case 2:this._format=v.TextureFormat.PVRTCRGB_4BPPV;break;case 1:this._format=v.TextureFormat.PVRTCRGBA_2BPPV;break;case 3:this._format=v.TextureFormat.PVRTCRGBA_4BPPV;break;default:throw"Texture2D:unknown PVR format."}var n=e[11],i=e[7],r=e[6];this._width=i,this._height=r;var a=e[12]+52;this._upLoadCompressedTexImage2D(t,i,r,n,a,0)}},{key:"_upLoadCompressedTexImage2D",value:function(t,e,n,i,r,a){var o=d.LayaGL.instance,s=this._glTextureType;p.WebGLContext.bindTexture(o,s,this._glTexture);for(var u=this._getGLFormat(),l=r,h=0;h<i;h++){l+=a;var c=this._calcualatesCompressedDataSize(this._format,e,n),f=new Uint8Array(t,l,c);o.compressedTexImage2D(s,h,u,e,n,0,f),e=Math.max(e>>1,1),n=Math.max(n>>1,1),l+=c}var _=l;this._setGPUMemory(_),this._readyed=!0,this._activeResource()}},{key:"_upLoadKTXCompressedTexImage2D",value:function(t,e,n,i,r,a){var o=d.LayaGL.instance,s=this._glTextureType;p.WebGLContext.bindTexture(o,s,this._glTexture);for(var u=this._getGLFormat(),l=r,h=0;h<i;h++){var c=new Int32Array(t,l,1)[0];l+=a;var f=new Uint8Array(t,l,c);o.compressedTexImage2D(s,h,u,e,n,0,f),e=Math.max(e>>1,1),n=Math.max(n>>1,1),l+=c,l+=3-(c+3)%4}var _=l;this._setGPUMemory(_),this._readyed=!0,this._activeResource()}},{key:"loadImageSource",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=d.LayaGL.instance,i=t.width,r=t.height;this._width=i,this._height=r,this._isPot(i)&&this._isPot(r)||(this._mipmap=!1),this._setWarpMode(n.TEXTURE_WRAP_S,this._wrapModeU),this._setWarpMode(n.TEXTURE_WRAP_T,this._wrapModeV),this._setFilterMode(this._filterMode),p.WebGLContext.bindTexture(n,this._glTextureType,this._glTexture);var a=this._getGLFormat();_.ILaya.Render.isConchApp?(t.setPremultiplyAlpha&&t.setPremultiplyAlpha(e),n.texImage2D(this._glTextureType,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)):(e&&n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),this.format==v.TextureFormat.R5G6B5?n.texImage2D(this._glTextureType,0,n.RGB,n.RGB,n.UNSIGNED_SHORT_5_6_5,t):n.texImage2D(this._glTextureType,0,a,a,n.UNSIGNED_BYTE,t),e&&n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1)),this._mipmap?(n.generateMipmap(this._glTextureType),this._setGPUMemory(i*r*4*(1+1/3))):this._setGPUMemory(i*r*4),this._canRead&&(_.ILaya.Render.isConchApp?this._pixels=new Uint8Array(t._nativeObj.getImageData(0,0,i,r)):(_.ILaya.Browser.canvas.size(i,r),_.ILaya.Browser.canvas.clear(),_.ILaya.Browser.context.drawImage(t,0,0,i,r),this._pixels=new Uint8Array(_.ILaya.Browser.context.getImageData(0,0,i,r).data.buffer))),this._readyed=!0,this._activeResource()}},{key:"setPixels",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this._gpuCompressFormat())throw"Texture2D:the format is GPU compression format.";if(!t)throw"Texture2D:pixels can't be null.";var n=Math.max(this._width>>e,1),i=Math.max(this._height>>e,1),r=n*i*this._getFormatByteCount();if(t.length<r)throw"Texture2D:pixels length should at least "+r+".";this._setPixels(t,e,n,i),this._canRead&&(this._pixels=t),this._readyed=!0,this._activeResource()}},{key:"setSubPixels",value:function(t,e,n,i,r){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(this._gpuCompressFormat())throw"Texture2D:the format is GPU compression format.";if(!r)throw"Texture2D:pixels can't be null.";var o=d.LayaGL.instance,s=this._glTextureType;p.WebGLContext.bindTexture(o,s,this._glTexture);var u=this._getGLFormat();switch(this.format){case v.TextureFormat.R8G8B8:o.pixelStorei(o.UNPACK_ALIGNMENT,1),o.texSubImage2D(s,a,t,e,n,i,u,o.UNSIGNED_BYTE,r),o.pixelStorei(o.UNPACK_ALIGNMENT,4);break;case v.TextureFormat.R5G6B5:o.pixelStorei(o.UNPACK_ALIGNMENT,2),o.texSubImage2D(s,a,t,e,n,i,u,o.UNSIGNED_SHORT_5_6_5,r),o.pixelStorei(o.UNPACK_ALIGNMENT,4);break;case v.TextureFormat.R32G32B32A32:o.texSubImage2D(s,a,t,e,n,i,u,o.FLOAT,r);break;default:o.texSubImage2D(s,a,t,e,n,i,u,o.UNSIGNED_BYTE,r)}this._readyed=!0,this._activeResource()}},{key:"setCompressData",value:function(t){switch(this._format){case v.TextureFormat.DXT1:case v.TextureFormat.DXT5:this._pharseDDS(t);break;case v.TextureFormat.ETC1RGB:case v.TextureFormat.ETC2RGB:case v.TextureFormat.ETC2RGBA:case v.TextureFormat.ETC2RGB_Alpha8:case v.TextureFormat.ETC2SRGB:case v.TextureFormat.ASTC4x4:case v.TextureFormat.ASTC4x4SRGB:case v.TextureFormat.ASTC6x6:case v.TextureFormat.ASTC6x6SRGB:case v.TextureFormat.ASTC8x8:case v.TextureFormat.ASTC8x8SRGB:case v.TextureFormat.ASTC10x10:case v.TextureFormat.ASTC10x10SRGB:case v.TextureFormat.ASTC12x12:case v.TextureFormat.ASTC12x12SRGB:case v.TextureFormat.KTXTEXTURE:this._pharseKTX(t);break;case v.TextureFormat.PVRTCRGB_2BPPV:case v.TextureFormat.PVRTCRGBA_2BPPV:case v.TextureFormat.PVRTCRGB_4BPPV:case v.TextureFormat.PVRTCRGBA_4BPPV:case v.TextureFormat.PVRTEXTURE:this._pharsePVR(t);break;default:throw"Texture2D:unkonwn format."}1==this.mipmapCount||this.width!=1<<this.mipmapCount-1&&this.height!=1<<this.mipmapCount?this._mipmap=!1:this._mipmap=!0;var e=d.LayaGL.instance;this._setWarpMode(e.TEXTURE_WRAP_S,this._wrapModeU),this._setWarpMode(e.TEXTURE_WRAP_T,this._wrapModeV),this._setFilterMode(this._filterMode)}},{key:"getPixels",value:function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")}}],i=[{key:"__init__",value:function(){var t=new Uint8Array(3);t[0]=128,t[1]=128,t[2]=128,a.grayTexture=new a(1,1,v.TextureFormat.R8G8B8,!1,!1),a.grayTexture.setPixels(t),a.grayTexture.lock=!0,t[0]=255,t[1]=255,t[2]=255,a.whiteTexture=new a(1,1,v.TextureFormat.R8G8B8,!1,!1),a.whiteTexture.setPixels(t),a.whiteTexture.lock=!0,t[0]=0,t[1]=0,t[2]=0,a.blackTexture=new a(1,1,v.TextureFormat.R8G8B8,!1,!1),a.blackTexture.setPixels(t),a.blackTexture.lock=!0,a.erroTextur=a.whiteTexture}},{key:"_parse",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=n?new a(n[0],n[1],n[2],n[3],n[4]):new a(0,0);switch(e&&(i.wrapModeU=e.wrapModeU,i.wrapModeV=e.wrapModeV,i.filterMode=e.filterMode,i.anisoLevel=e.anisoLevel),i._format){case v.TextureFormat.R8G8B8:case v.TextureFormat.R8G8B8A8:i.loadImageSource(t);break;case v.TextureFormat.DXT1:case v.TextureFormat.DXT5:case v.TextureFormat.ETC1RGB:case v.TextureFormat.PVRTCRGB_2BPPV:case v.TextureFormat.PVRTCRGBA_2BPPV:case v.TextureFormat.PVRTCRGB_4BPPV:case v.TextureFormat.PVRTCRGBA_4BPPV:case v.TextureFormat.ETC2RGB:case v.TextureFormat.ETC2RGBA:case v.TextureFormat.ETC2SRGB:case v.TextureFormat.ASTC4x4:case v.TextureFormat.ASTC6x6:case v.TextureFormat.ASTC8x8:case v.TextureFormat.ASTC10x10:case v.TextureFormat.ASTC12x12:case v.TextureFormat.KTXTEXTURE:case v.TextureFormat.PVRTEXTURE:i.setCompressData(t);break;default:throw"Texture2D:unkonwn format."}return i}},{key:"_SimpleAnimatorTextureParse",value:function(t){var e,n,i=new g.Byte(t),r=i.readUTFString();switch(r){case"LAYAANIMATORTEXTURE:0000":var o,s=i.readInt32(),u=i.readInt32();e=new Float32Array(s*s*4),n=new Float32Array(i.readArrayBuffer(4*u)),e.set(n,0),(o=new a(s,s,v.TextureFormat.R32G32B32A32,!1,!1)).setPixels(e,0),o.filterMode=m.FilterMode.Point;break;case"LAYACOMPRESSANIMATORTEXTURE:0000":if(s=i.readInt32(),u=i.readInt32(),e=new Uint16Array(i.readArrayBuffer(2*u)),b.SystemUtils.supportTextureFormat(v.TextureFormat.R16G16B16A16))(n=new Uint16Array(s*s*4)).set(e,0),(o=new a(s,s,v.TextureFormat.R16G16B16A16,!1,!1)).setPixels(n,0),o.filterMode=m.FilterMode.Point;else{console.log("The platform does not support 16-bit floating-point textures"),b.SystemUtils.supportTextureFormat(v.TextureFormat.R32G32B32A32)||console.error("The platform does not support 32-bit floating-point textures"),n=new Float32Array(s*s*4);for(var l=0,h=e.length;l<h;l++)n[l]=T.HalfFloatUtils.convertToNumber(e[l]);(o=new a(s,s,v.TextureFormat.R32G32B32A32,!1,!1)).setPixels(n,0),o.filterMode=m.FilterMode.Point}break;default:throw"Laya3D:unknow version."}return o}},{key:"load",value:function(t,e){_.ILaya.loader.create(t,e,null,_.ILaya.Loader.TEXTURE2D)}}],n&&k(e.prototype,n),i&&k(e,i),a}(y.BaseTexture);e.Texture2D=L,L.TEXTURE2D="TEXTURE2D",L.grayTexture=null,L.whiteTexture=null,L.blackTexture=null,L.erroTextur=null},73972:function(t,e,n){"use strict";var i;n(63978)(e,"__esModule",{value:!0}),e.TextureFormat=void 0,e.TextureFormat=i,function(t){t[t.R8G8B8=0]="R8G8B8",t[t.R8G8B8A8=1]="R8G8B8A8",t[t.R5G6B5=16]="R5G6B5",t[t.Alpha8=2]="Alpha8",t[t.DXT1=3]="DXT1",t[t.DXT5=4]="DXT5",t[t.ETC1RGB=5]="ETC1RGB",t[t.ETC2RGB=6]="ETC2RGB",t[t.ETC2RGBA=7]="ETC2RGBA",t[t.ETC2RGB_Alpha8=8]="ETC2RGB_Alpha8",t[t.ETC2SRGB=28]="ETC2SRGB",t[t.PVRTCRGB_2BPPV=9]="PVRTCRGB_2BPPV",t[t.PVRTCRGBA_2BPPV=10]="PVRTCRGBA_2BPPV",t[t.PVRTCRGB_4BPPV=11]="PVRTCRGB_4BPPV",t[t.PVRTCRGBA_4BPPV=12]="PVRTCRGBA_4BPPV",t[t.R32G32B32A32=15]="R32G32B32A32",t[t.R16G16B16A16=17]="R16G16B16A16",t[t.ASTC4x4=18]="ASTC4x4",t[t.ASTC4x4SRGB=23]="ASTC4x4SRGB",t[t.ASTC6x6=19]="ASTC6x6",t[t.ASTC6x6SRGB=24]="ASTC6x6SRGB",t[t.ASTC8x8=20]="ASTC8x8",t[t.ASTC8x8SRGB=25]="ASTC8x8SRGB",t[t.ASTC10x10=21]="ASTC10x10",t[t.ASTC10x10SRGB=26]="ASTC10x10SRGB",t[t.ASTC12x12=22]="ASTC12x12",t[t.ASTC12x12SRGB=27]="ASTC12x12SRGB",t[t.KTXTEXTURE=-1]="KTXTEXTURE",t[t.PVRTEXTURE=-2]="PVRTEXTURE"}(i||(e.TextureFormat=i={}))},95453:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.WebGLRTMgr=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(93894),o=n(57693);function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"getRT",value:function(t,e){return e|=0,(t|=0)>=1e4&&console.error("getRT error! w too big"),new a.RenderTexture2D(t,e,o.RenderTextureFormat.R8G8B8A8,-1)}},{key:"releaseRT",value:function(t){t.destroy()}}],(n=null)&&s(e.prototype,n),i&&s(e,i),t}();e.WebGLRTMgr=u,u.dict={}},69176:function(t,e,n){"use strict";var i;n(63978)(e,"__esModule",{value:!0}),e.WarpMode=void 0,e.WarpMode=i,function(t){t[t.Repeat=0]="Repeat",t[t.Clamp=1]="Clamp",t[t.Mirrored=2]="Mirrored"}(i||(e.WarpMode=i={}))},21995:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.AutoBitmap=void 0;var f=k(n(2991)),_=k(n(92762)),d=k(n(85507)),p=k(n(21611)),y=n(72276),v=n(54598),g=n(56083),m=n(23835),b=n(92493),T=n(94317),x=n(82994),w=n(43745);function k(t){return t&&t.__esModule?t:{default:t}}function C(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function E(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function S(){return S="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=M(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},S.apply(this,arguments)}function M(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=A(t)););return t}function L(t,e){return L=a||function(t,e){return t.__proto__=e,t},L(t,e)}function R(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=A(t);if(e){var a=A(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return I(this,n)}}function I(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function A(t){return A=d.default?p.default:function(t){return t.__proto__||(0,p.default)(t)},A(t)}var D=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&L(t,e)}(a,t);var e,n,i,r=R(a);function a(){var t;return C(this,a),(t=r.apply(this,arguments)).autoCacheCmd=!0,t._width=0,t._height=0,t.uv=null,t}return e=a,n=[{key:"destroy",value:function(){S(A(a.prototype),"destroy",this).call(this),this._source=null,this._sizeGrid=null,this._offset=null}},{key:"sizeGrid",get:function(){return this._sizeGrid},set:function(t){this._sizeGrid=(0,f.default)(t).call(t,(function(t){return+t})),this._setChanged()}},{key:"width",get:function(){return this._width?this._width:this._source?this._source.sourceWidth:0},set:function(t){this._width!=t&&(this._width=t,this._setChanged())}},{key:"height",get:function(){return this._height?this._height:this._source?this._source.sourceHeight:0},set:function(t){this._height!=t&&(this._height=t,this._setChanged())}},{key:"source",get:function(){return this._source},set:function(t){if(t)this._source=t,this._setChanged();else if(this._source=null,this._drawGridCmd){this._one&&this._one==this._drawGridCmd&&this.clear();var e=this.cmds;e&&e.length>0&&e[0]==this._drawGridCmd&&(0,_.default)(e).call(e,0,1)}}},{key:"_setChanged",value:function(){this._isChanged||(this._isChanged=!0,b.ILaya.timer.callLater(this,this.changeSource))}},{key:"_createDrawTexture",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,l=arguments.length>9?arguments[9]:void 0;if(!t||o<.01)return null;if(!t.getIsReady())return null;if(i||(i=t.sourceWidth),r||(r=t.sourceHeight),t.getIsReady()){var h=i/t.sourceWidth,c=r/t.sourceHeight;if(i=t.width*h,r=t.height*c,i<=0||r<=0)return null;e+=t.offsetX*h,n+=t.offsetY*c}return this._sp&&(this._sp._renderType|=w.SpriteConst.GRAPHICS,this._sp._setRenderType(this._sp._renderType)),x.DrawTextureCmd.create.call(this,t,e,n,i,r,a,o,s,u,l)}},{key:"changeSource",value:function(){this._isChanged=!1;var t=this._source;if(t&&t.bitmap){var e=this.width,n=this.height,i=this._sizeGrid,r=t.sourceWidth,a=t.sourceHeight;if(!i||r===e&&a===n){var o=this._createDrawTexture(t,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,e,n,null,1,null,null,this.uv);o&&this._setDrawGridCmd(o)}else{var s=T.Draw9GridTexture.create(t,0,0,e,n,i);this._setDrawGridCmd(s)}this._repaint()}}},{key:"drawBitmap",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;r<.1||a<.1||(!t||e.width==r&&e.height==a?this.drawImage(e,n,i,r,a):this.fillTexture(e,n,i,r,a))}},{key:"_setDrawGridCmd",value:function(t){var e=this._source;if(e&&e.bitmap){var n=this.cmds;if(this._one||n&&!(n.length<=0)){var i=this._one;i?i==this._drawGridCmd?this._one=t:(this.clear(),this._saveToCmd(null,t),this._saveToCmd(null,i)):(0,_.default)(n).call(n,0,0,t)}else this._saveToCmd(null,t);this._drawGridCmd=t}}}],i=[{key:"getTexture",value:function(t,e,n,i,r){var a;return i<=0&&(i=1),r<=0&&(r=1),t.$_GID||(t.$_GID=g.Utils.getGID()),a&&a._getSource()||(a=v.Texture.createFromTexture(t,e,n,i,r)),a}}],n&&E(e.prototype,n),i&&E(e,i),a}(y.Graphics);e.AutoBitmap=D,m.ClassUtils.regClass("laya.ui.AutoBitmap",D),m.ClassUtils.regClass("Laya.AutoBitmap",D)},93408:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.Box=void 0;var f=g(n(85507)),_=g(n(21611)),d=n(93615),p=n(89662),y=n(92493),v=n(23835);function g(t){return t&&t.__esModule?t:{default:t}}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function T(){return T="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=x(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},T.apply(this,arguments)}function x(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=E(t)););return t}function w(t,e){return w=a||function(t,e){return t.__proto__=e,t},w(t,e)}function k(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=E(t);if(e){var a=E(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return C(this,n)}}function C(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function E(t){return E=f.default?_.default:function(t){return t.__proto__||(0,_.default)(t)},E(t)}var S=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}(a,t);var e,n,i,r=k(a);function a(){return m(this,a),r.apply(this,arguments)}return e=a,(n=[{key:"dataSource",get:function(){return T(E(a.prototype),"dataSource",this)},set:function(t){for(var e in this._dataSource=t,t){var n=this.getChildByName(e);n?n.dataSource=t[e]:!(e in this)||this[e]instanceof Function||(this[e]=t[e])}}},{key:"bgColor",get:function(){return this._bgColor},set:function(t){this._bgColor=t,t?(this._onResize(null),this.on(p.Event.RESIZE,this,this._onResize)):(this.graphics.clear(),this.off(p.Event.RESIZE,this,this._onResize))}},{key:"_onResize",value:function(t){this.graphics.clear(),this.graphics.drawRect(0,0,this.width,this.height,this._bgColor)}}])&&b(e.prototype,n),i&&b(e,i),a}(d.UIComponent);e.Box=S,y.ILaya.regClass(S),v.ClassUtils.regClass("laya.ui.Box",S),v.ClassUtils.regClass("Laya.Box",S)},33879:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.Button=void 0;var f=L(n(94198)),_=L(n(85507)),d=L(n(21611)),p=n(93615),y=n(90335),v=n(13407),g=n(81870),m=n(89662),b=n(85096),T=n(54598),x=n(21995),w=n(6642),k=n(41107),C=n(56083),E=n(76006),S=n(92493),M=n(23835);function L(t){return t&&t.__esModule?t:{default:t}}function R(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function I(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function A(){return A="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=D(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},A.apply(this,arguments)}function D(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=F(t)););return t}function B(t,e){return B=a||function(t,e){return t.__proto__=e,t},B(t,e)}function P(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=F(t);if(e){var a=F(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return O(this,n)}}function O(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function F(t){return F=_.default?d.default:function(t){return t.__proto__||(0,d.default)(t)},F(t)}var U=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&B(t,e)}(a,t);var e,n,i,r=P(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return R(this,a),(t=r.call(this))._labelColors=y.Styles.buttonLabelColors,t._state=0,t._autoSize=!0,t._stateNum=y.Styles.buttonStateNum,t._stateChanged=!1,t.skin=e,t.label=n,t}return e=a,n=[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];A(F(a.prototype),"destroy",this).call(this,t),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(t),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null}},{key:"createChildren",value:function(){this.graphics=this._bitmap=new x.AutoBitmap}},{key:"createText",value:function(){this._text||(this._text=new g.Text,this._text.overflow=g.Text.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)}},{key:"initialize",value:function(){1!==this._mouseState&&(this.mouseEnabled=!0,this._setBit(v.Const.HAS_MOUSE,!0)),this._createListener(m.Event.MOUSE_OVER,this,this.onMouse,null,!1,!1),this._createListener(m.Event.MOUSE_OUT,this,this.onMouse,null,!1,!1),this._createListener(m.Event.MOUSE_DOWN,this,this.onMouse,null,!1,!1),this._createListener(m.Event.MOUSE_UP,this,this.onMouse,null,!1,!1),this._createListener(m.Event.CLICK,this,this.onMouse,null,!1,!1)}},{key:"onMouse",value:function(t){if(!1!==this.toggle||!this._selected)return t.type===m.Event.CLICK?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=a.stateMap[t.type]))}},{key:"skin",get:function(){return this._skin},set:function(t){this._skin!=t&&(this._skin=t,t?b.Loader.getRes(t)?this._skinLoaded():S.ILaya.loader.load(this._skin,k.Handler.create(this,this._skinLoaded),null,b.Loader.IMAGE,1):this._skinLoaded())}},{key:"_skinLoaded",value:function(){this.callLater(this.changeClips),this._setStateChanged(),this._sizeChanged(),this.event(m.Event.LOADED)}},{key:"stateNum",get:function(){return this._stateNum},set:function(t){"string"==typeof t&&(t=(0,f.default)(t)),this._stateNum!=t&&(this._stateNum=t<1?1:t>3?3:t,this.callLater(this.changeClips))}},{key:"changeClips",value:function(){var t=b.Loader.getRes(this._skin);if(t){var e=t.sourceWidth,n=t.sourceHeight/this._stateNum;t.$_GID||(t.$_GID=C.Utils.getGID());var i=t.$_GID+"-"+this._stateNum,r=E.WeakObject.I.get(i);if(C.Utils.isOkTextureList(r)||(r=null),r)this._sources=r;else{if(this._sources=[],1===this._stateNum)this._sources.push(t);else for(var a=0;a<this._stateNum;a++)this._sources.push(T.Texture.createFromTexture(t,0,n*a,e,n));E.WeakObject.I.set(i,this._sources)}this._autoSize?(this._bitmap.width=this._width||e,this._bitmap.height=this._height||n,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=e)}else console.log("lose skin",this._skin)}},{key:"measureWidth",value:function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}},{key:"measureHeight",value:function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}},{key:"label",get:function(){return this._text?this._text.text:null},set:function(t){(this._text||t)&&(this.createText(),this._text.text!=t&&(t&&!this._text.parent&&this.addChild(this._text),this._text.text=(t+"").replace(/\\n/g,"\n"),this._setStateChanged()))}},{key:"selected",get:function(){return this._selected},set:function(t){this._selected!=t&&(this._selected=t,this.state=this._selected?2:0,this.event(m.Event.CHANGE))}},{key:"state",get:function(){return this._state},set:function(t){this._state!=t&&(this._state=t,this._setStateChanged())}},{key:"changeState",value:function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var t=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[t]),this.label&&(this._text.color=this._labelColors[t],this._strokeColors&&(this._text.strokeColor=this._strokeColors[t]))}},{key:"labelColors",get:function(){return this._labelColors.join(",")},set:function(t){this._labelColors=w.UIUtils.fillArray(y.Styles.buttonLabelColors,t,String),this._setStateChanged()}},{key:"strokeColors",get:function(){return this._strokeColors?this._strokeColors.join(","):""},set:function(t){this._strokeColors=w.UIUtils.fillArray(y.Styles.buttonLabelColors,t,String),this._setStateChanged()}},{key:"labelPadding",get:function(){return this.createText(),this._text.padding.join(",")},set:function(t){this.createText(),this._text.padding=w.UIUtils.fillArray(y.Styles.labelPadding,t,Number)}},{key:"labelSize",get:function(){return this.createText(),this._text.fontSize},set:function(t){this.createText(),this._text.fontSize=t}},{key:"labelStroke",get:function(){return this.createText(),this._text.stroke},set:function(t){this.createText(),this._text.stroke=t}},{key:"labelStrokeColor",get:function(){return this.createText(),this._text.strokeColor},set:function(t){this.createText(),this._text.strokeColor=t}},{key:"labelBold",get:function(){return this.createText(),this._text.bold},set:function(t){this.createText(),this._text.bold=t}},{key:"labelFont",get:function(){return this.createText(),this._text.font},set:function(t){this.createText(),this._text.font=t}},{key:"labelAlign",get:function(){return this.createText(),this._text.align},set:function(t){this.createText(),this._text.align=t}},{key:"clickHandler",get:function(){return this._clickHandler},set:function(t){this._clickHandler=t}},{key:"text",get:function(){return this.createText(),this._text}},{key:"sizeGrid",get:function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},set:function(t){this._bitmap.sizeGrid=w.UIUtils.fillArray(y.Styles.defaultSizeGrid,t,Number)}},{key:"width",get:function(){return A(F(a.prototype),"get_width",this).call(this)},set:function(t){A(F(a.prototype),"set_width",this).call(this,t),this._autoSize&&(this._bitmap.width=t,this._text&&(this._text.width=t))}},{key:"height",get:function(){return A(F(a.prototype),"get_height",this).call(this)},set:function(t){A(F(a.prototype),"set_height",this).call(this,t),this._autoSize&&(this._bitmap.height=t,this._text&&(this._text.height=t))}},{key:"dataSource",get:function(){return A(F(a.prototype),"get_dataSource",this).call(this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.label=t+"":A(F(a.prototype),"set_dataSource",this).call(this,t)}},{key:"iconOffset",get:function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},set:function(t){this._bitmap._offset=t?w.UIUtils.fillArray([1,1],t,Number):[]}},{key:"_setStateChanged",value:function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))}}],n&&I(e.prototype,n),i&&I(e,i),a}(p.UIComponent);e.Button=U,U.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0},S.ILaya.regClass(U),M.ClassUtils.regClass("laya.ui.Button",U),M.ClassUtils.regClass("Laya.Button",U)},24830:function(t,e,n){"use strict";function i(t){return i="function"==typeof c&&"symbol"==typeof f?function(t){return typeof t}:function(t){return t&&"function"==typeof c&&t.constructor===c&&t!==c.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(9705),c=n(65420),f=n(98341);l(e,"__esModule",{value:!0}),e.CheckBox=void 0;var _=g(n(85507)),d=g(n(21611)),p=n(33879),y=n(92493),v=n(23835);function g(t){return t&&t.__esModule?t:{default:t}}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function T(t,e,n,i){return T="undefined"!=typeof Reflect&&h?h:function(t,e,n,i){var r,a=k(t,e);if(a){if((r=u(a,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=u(i,e)){if(!r.writable)return!1;r.value=n,l(i,e,r)}else!function(t,e,n){e in t?l(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0},T(t,e,n,i)}function x(t,e,n,i,r){if(!T(t,e,n,i||t)&&r)throw new Error("failed to set property");return n}function w(){return w="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=k(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},w.apply(this,arguments)}function k(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=M(t)););return t}function C(t,e){return C=a||function(t,e){return t.__proto__=e,t},C(t,e)}function E(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=M(t);if(e){var a=M(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return S(this,n)}}function S(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function M(t){return M=_.default?d.default:function(t){return t.__proto__||(0,d.default)(t)},M(t)}var L=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&C(t,e)}(a,t);var e,n,i,r=E(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return m(this,a),(t=r.call(this,e,n)).toggle=!0,t._autoSize=!1,t}return e=a,(n=[{key:"preinitialize",value:function(){w(M(a.prototype),"preinitialize",this).call(this),this.toggle=!0,this._autoSize=!1}},{key:"initialize",value:function(){w(M(a.prototype),"initialize",this).call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0}},{key:"dataSource",get:function(){return w(M(a.prototype),"dataSource",this)},set:function(t){this._dataSource=t,t instanceof Boolean?this.selected=t:"string"==typeof t?this.selected="true"===t:x(M(a.prototype),"dataSource",t,this,!0)}}])&&b(e.prototype,n),i&&b(e,i),a}(p.Button);e.CheckBox=L,y.ILaya.regClass(L),v.ClassUtils.regClass("laya.ui.CheckBox",L),v.ClassUtils.regClass("Laya.CheckBox",L)},70078:function(t,e,n){"use strict";function i(t){return i="function"==typeof c&&"symbol"==typeof f?function(t){return typeof t}:function(t){return t&&"function"==typeof c&&t.constructor===c&&t!==c.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(9705),c=n(65420),f=n(98341);l(e,"__esModule",{value:!0}),e.Clip=void 0;var _=L(n(94198)),d=L(n(85507)),p=L(n(21611)),y=n(93615),v=n(21995),g=n(6642),m=n(90335),b=n(13407),T=n(89662),x=n(85096),w=n(54598),k=n(41107),C=n(56083),E=n(76006),S=n(92493),M=n(23835);function L(t){return t&&t.__esModule?t:{default:t}}function R(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function I(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function A(t,e,n,i){return A="undefined"!=typeof Reflect&&h?h:function(t,e,n,i){var r,a=P(t,e);if(a){if((r=u(a,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=u(i,e)){if(!r.writable)return!1;r.value=n,l(i,e,r)}else!function(t,e,n){e in t?l(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0},A(t,e,n,i)}function D(t,e,n,i,r){if(!A(t,e,n,i||t)&&r)throw new Error("failed to set property");return n}function B(){return B="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=P(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},B.apply(this,arguments)}function P(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=N(t)););return t}function O(t,e){return O=a||function(t,e){return t.__proto__=e,t},O(t,e)}function F(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=N(t);if(e){var a=N(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return U(this,n)}}function U(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function N(t){return N=d.default?p.default:function(t){return t.__proto__||(0,p.default)(t)},N(t)}var G=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&O(t,e)}(a,t);var e,n,i,r=F(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return R(this,a),(t=r.call(this))._clipX=1,t._clipY=1,t._clipWidth=0,t._clipHeight=0,t._interval=50,t._index=0,t._toIndex=-1,t._clipX=n,t._clipY=i,t.skin=e,t}return e=a,n=[{key:"destroy",value:function(){B(N(a.prototype),"destroy",this).call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null}},{key:"dispose",value:function(){this.destroy(!0),S.ILaya.loader.clearRes(this._skin)}},{key:"createChildren",value:function(){this.graphics=this._bitmap=new v.AutoBitmap}},{key:"_onDisplay",value:function(t){this._isPlaying?this._getBit(b.Const.DISPLAYED_INSTAGE)?this.play():this.stop():this._autoPlay&&this.play()}},{key:"skin",get:function(){return this._skin},set:function(t){this._skin!=t&&(this._skin=t,t?x.Loader.getRes(t)?this._skinLoaded():S.ILaya.loader.load(this._skin,k.Handler.create(this,this._skinLoaded),null,x.Loader.IMAGE,1):this._bitmap.source=null)}},{key:"_skinLoaded",value:function(){this._setClipChanged(),this._sizeChanged(),this.event(T.Event.LOADED)}},{key:"clipX",get:function(){return this._clipX},set:function(t){this._clipX=t||1,this._setClipChanged()}},{key:"clipY",get:function(){return this._clipY},set:function(t){this._clipY=t||1,this._setClipChanged()}},{key:"clipWidth",get:function(){return this._clipWidth},set:function(t){this._clipWidth=t,this._setClipChanged()}},{key:"clipHeight",get:function(){return this._clipHeight},set:function(t){this._clipHeight=t,this._setClipChanged()}},{key:"changeClip",value:function(){if(this._clipChanged=!1,this._skin&&!this.destroyed){var t=x.Loader.getRes(this._skin);t?this.loadComplete(this._skin,t):S.ILaya.loader.load(this._skin,k.Handler.create(this,this.loadComplete,[this._skin]))}}},{key:"loadComplete",value:function(t,e){if(t===this._skin&&e){var n=this._clipWidth||Math.ceil(e.sourceWidth/this._clipX),i=this._clipHeight||Math.ceil(e.sourceHeight/this._clipY),r=this._skin+n+i,a=E.WeakObject.I.get(r);if(C.Utils.isOkTextureList(a)||(a=null),a)this._sources=a;else{this._sources=[];for(var o=0;o<this._clipY;o++)for(var s=0;s<this._clipX;s++)this._sources.push(w.Texture.createFromTexture(e,n*s,i*o,n,i));E.WeakObject.I.set(r,this._sources)}this.index=this._index,this.event(T.Event.LOADED),this.onCompResize()}}},{key:"sources",get:function(){return this._sources},set:function(t){this._sources=t,this.index=this._index,this.event(T.Event.LOADED)}},{key:"group",get:function(){return this._group},set:function(t){t&&this._skin&&x.Loader.setGroup(this._skin,t),this._group=t}},{key:"width",get:function(){return B(N(a.prototype),"width",this)},set:function(t){D(N(a.prototype),"width",t,this,!0),this._bitmap.width=t}},{key:"height",get:function(){return B(N(a.prototype),"height",this)},set:function(t){D(N(a.prototype),"height",t,this,!0),this._bitmap.height=t}},{key:"measureWidth",value:function(){return this.runCallLater(this.changeClip),this._bitmap.width}},{key:"measureHeight",value:function(){return this.runCallLater(this.changeClip),this._bitmap.height}},{key:"sizeGrid",get:function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},set:function(t){this._bitmap.sizeGrid=g.UIUtils.fillArray(m.Styles.defaultSizeGrid,t,Number)}},{key:"index",get:function(){return this._index},set:function(t){this._index=t,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[t]),this.event(T.Event.CHANGE)}},{key:"total",get:function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}},{key:"autoPlay",get:function(){return this._autoPlay},set:function(t){this._autoPlay!=t&&(this._autoPlay=t,t?this.play():this.stop())}},{key:"interval",get:function(){return this._interval},set:function(t){this._interval!=t&&(this._interval=t,this._isPlaying&&this.play())}},{key:"isPlaying",get:function(){return this._isPlaying},set:function(t){this._isPlaying=t}},{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this._isPlaying=!0,this.index=t,this._toIndex=e,this._index++,S.ILaya.timer.loop(this.interval,this,this._loop),this.on(T.Event.DISPLAY,this,this._onDisplay),this.on(T.Event.UNDISPLAY,this,this._onDisplay)}},{key:"_loop",value:function(){this._visible&&this._sources&&(this._index++,this._toIndex>-1&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)}},{key:"stop",value:function(){this._isPlaying=!1,S.ILaya.timer.clear(this,this._loop),this.event(T.Event.COMPLETE)}},{key:"dataSource",get:function(){return B(N(a.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.index=(0,_.default)(t):D(N(a.prototype),"dataSource",t,this,!0)}},{key:"bitmap",get:function(){return this._bitmap}},{key:"_setClipChanged",value:function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))}}],n&&I(e.prototype,n),i&&I(e,i),a}(y.UIComponent);e.Clip=G,S.ILaya.regClass(G),M.ClassUtils.regClass("laya.ui.Clip",G),M.ClassUtils.regClass("Laya.Clip",G)},25435:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.ColorPicker=void 0;var f=k(n(85507)),_=k(n(21611)),d=n(93615),p=n(93408),y=n(33879),v=n(6642),g=n(61891),m=n(78362),b=n(89662),T=n(85399),x=n(92493),w=n(23835);function k(t){return t&&t.__esModule?t:{default:t}}function C(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function E(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function S(){return S="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=M(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},S.apply(this,arguments)}function M(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=A(t)););return t}function L(t,e){return L=a||function(t,e){return t.__proto__=e,t},L(t,e)}function R(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=A(t);if(e){var a=A(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return I(this,n)}}function I(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function A(t){return A=f.default?_.default:function(t){return t.__proto__||(0,_.default)(t)},A(t)}var D=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&L(t,e)}(a,t);var e,n,i,r=R(a);function a(){var t,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return C(this,a),(t=r.call(this,!1))._gridSize=11,t._bgColor="#ffffff",t._borderColor="#000000",t._inputColor="#000000",t._inputBgColor="#efefef",t._colors=[],t._selectedColor="#000000",e&&(t.preinitialize(),t.createChildren(),t.initialize()),t}return e=a,n=[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];x.ILaya.stage.off(b.Event.MOUSE_DOWN,this,this.removeColorBox),S(A(a.prototype),"destroy",this).call(this,t),this._colorPanel&&this._colorPanel.destroy(t),this._colorButton&&this._colorButton.destroy(t),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null}},{key:"createChildren",value:function(){this.addChild(this._colorButton=new y.Button),this._colorPanel=new p.Box,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new m.Sprite),this._colorPanel.addChild(this._colorBlock=new m.Sprite),this._colorPanel.addChild(this._colorInput=new g.Input)}},{key:"initialize",value:function(){this._colorButton.on(b.Event.CLICK,this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on(b.Event.CHANGE,this,this.onColorInputChange),this._colorInput.on(b.Event.KEY_DOWN,this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on(b.Event.MOUSE_MOVE,this,this.onColorTilesMouseMove),this._colorTiles.on(b.Event.CLICK,this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on(b.Event.MOUSE_DOWN,this,this.onPanelMouseDown),this.bgColor=this._bgColor}},{key:"onPanelMouseDown",value:function(t){t.stopPropagation()}},{key:"changePanel",value:function(){this._panelChanged=!1;var t=this._colorPanel.graphics;t.clear(!0),t.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(t=this._colorTiles.graphics).clear(!0);for(var e=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],n=0;n<12;n++)for(var i=0;i<20;i++){var r;r=0===i?e[n]:1===i?0:51*(((3*n+i/6)%3<<0)+3*(n/6<<0))<<16|i%6*51<<8|(n<<0)%6*51;var a=v.UIUtils.toColor(r);this._colors.push(a);var o=i*this._gridSize,s=n*this._gridSize;t.drawRect(o,s,this._gridSize,this._gridSize,a,"#000000")}}},{key:"onColorButtonClick",value:function(t){this._colorPanel.parent?this.close():this.open()}},{key:"open",value:function(){var t=x.ILaya.stage,e=this.localToGlobal(new T.Point),n=e.x+this._colorPanel.width<=t.width?e.x:t.width-this._colorPanel.width,i=e.y+this._colorButton.height;i=i+this._colorPanel.height<=t.height?i:e.y-this._colorPanel.height,this._colorPanel.pos(n,i),this._colorPanel.zOrder=1001,t.addChild(this._colorPanel),t.on(b.Event.MOUSE_DOWN,this,this.removeColorBox)}},{key:"close",value:function(){x.ILaya.stage.off(b.Event.MOUSE_DOWN,this,this.removeColorBox),this._colorPanel.removeSelf()}},{key:"removeColorBox",value:function(){this.close()}},{key:"onColorFieldKeyDown",value:function(t){13==t.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),t.stopPropagation())}},{key:"onColorInputChange",value:function(){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")}},{key:"onColorTilesClick",value:function(t){this.selectedColor=this.getColorByMouse(),this.close()}},{key:"onColorTilesMouseMove",value:function(t){this._colorInput.focus=!1;var e=this.getColorByMouse();this._colorInput.text=e,this.drawBlock(e)}},{key:"getColorByMouse",value:function(){var t=this._colorTiles.getMousePoint(),e=Math.floor(t.x/this._gridSize),n=Math.floor(t.y/this._gridSize);return this._colors[20*n+e]}},{key:"drawBlock",value:function(t){var e=this._colorBlock.graphics;e.clear(!0);var n=t||"#ffffff";e.drawRect(0,0,50,20,n,this._borderColor),t||e.drawLine(0,0,50,20,"#ff0000")}},{key:"selectedColor",get:function(){return this._selectedColor},set:function(t){this._selectedColor!=t&&(this._selectedColor=this._colorInput.text=t,this.drawBlock(t),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event(b.Event.CHANGE,b.Event.EMPTY.setTo(b.Event.CHANGE,this,this)))}},{key:"skin",get:function(){return this._colorButton.skin},set:function(t){this._colorButton.once(b.Event.LOADED,this,this.changeColor),this._colorButton.skin=t}},{key:"changeColor",value:function(){var t=this.graphics;t.clear(!0);var e=this._selectedColor||"#000000";t.drawRect(0,0,this._colorButton.width,this._colorButton.height,e)}},{key:"bgColor",get:function(){return this._bgColor},set:function(t){this._bgColor=t,this._setPanelChanged()}},{key:"borderColor",get:function(){return this._borderColor},set:function(t){this._borderColor=t,this._setPanelChanged()}},{key:"inputColor",get:function(){return this._inputColor},set:function(t){this._inputColor=t,this._setPanelChanged()}},{key:"inputBgColor",get:function(){return this._inputBgColor},set:function(t){this._inputBgColor=t,this._setPanelChanged()}},{key:"_setPanelChanged",value:function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))}}],n&&E(e.prototype,n),i&&E(e,i),a}(d.UIComponent);e.ColorPicker=D,x.ILaya.regClass(D),w.ClassUtils.regClass("laya.ui.ColorPicker",D),w.ClassUtils.regClass("Laya.ColorPicker",D)},20079:function(t,e,n){"use strict";function i(t){return i="function"==typeof c&&"symbol"==typeof f?function(t){return typeof t}:function(t){return t&&"function"==typeof c&&t.constructor===c&&t!==c.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(9705),c=n(65420),f=n(98341);l(e,"__esModule",{value:!0}),e.ComboBox=void 0;var _=S(n(81643)),d=S(n(94198)),p=S(n(85507)),y=S(n(21611)),v=n(93615),g=n(33879),m=n(75485),b=n(90335),T=n(6642),x=n(89662),w=n(85399),k=n(41107),C=n(92493),E=n(23835);function S(t){return t&&t.__esModule?t:{default:t}}function M(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function L(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function R(t,e,n,i){return R="undefined"!=typeof Reflect&&h?h:function(t,e,n,i){var r,a=D(t,e);if(a){if((r=u(a,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=u(i,e)){if(!r.writable)return!1;r.value=n,l(i,e,r)}else!function(t,e,n){e in t?l(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0},R(t,e,n,i)}function I(t,e,n,i,r){if(!R(t,e,n,i||t)&&r)throw new Error("failed to set property");return n}function A(){return A="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=D(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},A.apply(this,arguments)}function D(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=F(t)););return t}function B(t,e){return B=a||function(t,e){return t.__proto__=e,t},B(t,e)}function P(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=F(t);if(e){var a=F(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return O(this,n)}}function O(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function F(t){return F=p.default?y.default:function(t){return t.__proto__||(0,y.default)(t)},F(t)}var U=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&B(t,e)}(a,t);var e,n,i,r=P(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return M(this,a),(t=r.call(this))._visibleNum=6,t._itemColors=b.Styles.comboBoxItemColors,t._itemSize=12,t._labels=[],t._selectedIndex=-1,t.itemRender=null,t.skin=e,t.labels=n,t}return e=a,n=[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];C.ILaya.stage.off(x.Event.MOUSE_DOWN,this,this.removeList),C.ILaya.stage.off(x.Event.MOUSE_WHEEL,this,this._onStageMouseWheel),A(F(a.prototype),"destroy",this).call(this,t),this._button&&this._button.destroy(t),this._list&&this._list.destroy(t),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null}},{key:"createChildren",value:function(){this.addChild(this._button=new g.Button),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on(x.Event.MOUSE_DOWN,this,this.onButtonMouseDown)}},{key:"_createList",value:function(){this._list=new m.List,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)}},{key:"_setListEvent",value:function(t){this._list.selectEnable=!0,this._list.on(x.Event.MOUSE_DOWN,this,this.onListDown),this._list.mouseHandler=k.Handler.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on(x.Event.MOUSE_DOWN,this,this.onScrollBarDown)}},{key:"onListDown",value:function(t){t.stopPropagation()}},{key:"onScrollBarDown",value:function(t){t.stopPropagation()}},{key:"onButtonMouseDown",value:function(t){this.callLater(this.switchTo,[!this._isOpen])}},{key:"skin",get:function(){return this._button.skin},set:function(t){this._button.skin!=t&&(this._button.skin=t,this._listChanged=!0)}},{key:"measureWidth",value:function(){return this._button.width}},{key:"measureHeight",value:function(){return this._button.height}},{key:"changeList",value:function(){this._listChanged=!1;var t=this.width-2,e=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:t,height:this._itemHeight,fontSize:this._itemSize,color:e}}]},this._list.repeatY=this._visibleNum,this._list.refresh()}},{key:"onlistItemMouse",value:function(t,e){var n=t.type;if(n===x.Event.MOUSE_OVER||n===x.Event.MOUSE_OUT){if(this._isCustomList)return;var i=this._list.getCell(e);if(!i)return;var r=i.getChildByName("label");r&&(n===x.Event.ROLL_OVER?(r.bgColor=this._itemColors[0],r.color=this._itemColors[1]):(r.bgColor=null,r.color=this._itemColors[2]))}else n===x.Event.CLICK&&(this.selectedIndex=e,this.isOpen=!1)}},{key:"switchTo",value:function(t){this.isOpen=t}},{key:"changeOpen",value:function(){this.isOpen=!this._isOpen}},{key:"width",get:function(){return A(F(a.prototype),"width",this)},set:function(t){I(F(a.prototype),"width",t,this,!0),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}},{key:"height",get:function(){return A(F(a.prototype),"height",this)},set:function(t){I(F(a.prototype),"height",t,this,!0),this._button.height=this._height}},{key:"labels",get:function(){return this._labels.join(",")},set:function(t){this._labels.length>0&&(this.selectedIndex=-1),t?this._labels=t.split(","):this._labels.length=0,this._itemChanged=!0}},{key:"changeItem",value:function(){if(this._itemChanged=!1,this._listHeight=this._labels.length>0?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var t=this._list.graphics;t.clear(!0),t.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}var e=this._list.array||[];e.length=0;for(var n=0,i=this._labels.length;n<i;n++)e.push({label:this._labels[n]});this._list.height=this._listHeight,this._list.array=e}},{key:"selectedIndex",get:function(){return this._selectedIndex},set:function(t){this._selectedIndex!=t&&(this._selectedIndex=t,this._labels.length>0?this.changeSelected():this.callLater(this.changeSelected),this.event(x.Event.CHANGE,[x.Event.EMPTY.setTo(x.Event.CHANGE,this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}},{key:"changeSelected",value:function(){this._button.label=this.selectedLabel}},{key:"selectHandler",get:function(){return this._selectHandler},set:function(t){this._selectHandler=t}},{key:"selectedLabel",get:function(){return this._selectedIndex>-1&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},set:function(t){var e;this.selectedIndex=(0,_.default)(e=this._labels).call(e,t)}},{key:"visibleNum",get:function(){return this._visibleNum},set:function(t){this._visibleNum=t,this._listChanged=!0}},{key:"itemColors",get:function(){return String(this._itemColors)},set:function(t){this._itemColors=T.UIUtils.fillArray(this._itemColors,t,String),this._listChanged=!0}},{key:"itemSize",get:function(){return this._itemSize},set:function(t){this._itemSize=t,this._listChanged=!0}},{key:"isOpen",get:function(){return this._isOpen},set:function(t){if(this._isOpen!=t)if(this._isOpen=t,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var e=this.localToGlobal(w.Point.TEMP.setTo(0,0)),n=e.y+this._button.height;n=n+this._listHeight<=C.ILaya.stage.height?n:e.y-this._listHeight,this._list.pos(e.x,n),this._list.zOrder=1001,C.ILaya.stage.addChild(this._list),C.ILaya.stage.once(x.Event.MOUSE_DOWN,this,this.removeList),C.ILaya.stage.on(x.Event.MOUSE_WHEEL,this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}},{key:"_onStageMouseWheel",value:function(t){this._list&&!this._list.contains(t.target)&&this.removeList(null)}},{key:"removeList",value:function(t){C.ILaya.stage.off(x.Event.MOUSE_DOWN,this,this.removeList),C.ILaya.stage.off(x.Event.MOUSE_WHEEL,this,this._onStageMouseWheel),this.isOpen=!1}},{key:"scrollBarSkin",get:function(){return this._scrollBarSkin},set:function(t){this._scrollBarSkin=t}},{key:"sizeGrid",get:function(){return this._button.sizeGrid},set:function(t){this._button.sizeGrid=t}},{key:"scrollBar",get:function(){return this.list.scrollBar}},{key:"button",get:function(){return this._button}},{key:"list",get:function(){return this._list||this._createList(),this._list},set:function(t){t&&(t.removeSelf(),this._isCustomList=!0,this._list=t,this._setListEvent(t),this._itemHeight=t.getCell(0).height+t.spaceY)}},{key:"dataSource",get:function(){return A(F(a.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.selectedIndex=(0,d.default)(t):t instanceof Array?this.labels=t.join(","):I(F(a.prototype),"dataSource",t,this,!0)}},{key:"labelColors",get:function(){return this._button.labelColors},set:function(t){this._button.labelColors!=t&&(this._button.labelColors=t)}},{key:"labelPadding",get:function(){return this._button.text.padding.join(",")},set:function(t){this._button.text.padding=T.UIUtils.fillArray(b.Styles.labelPadding,t,Number)}},{key:"labelSize",get:function(){return this._button.text.fontSize},set:function(t){this._button.text.fontSize=t}},{key:"labelBold",get:function(){return this._button.text.bold},set:function(t){this._button.text.bold=t}},{key:"labelFont",get:function(){return this._button.text.font},set:function(t){this._button.text.font=t}},{key:"stateNum",get:function(){return this._button.stateNum},set:function(t){this._button.stateNum=t}}],n&&L(e.prototype,n),i&&L(e,i),a}(v.UIComponent);e.ComboBox=U,C.ILaya.regClass(U),E.ClassUtils.regClass("laya.ui.ComboBox",U),E.ClassUtils.regClass("Laya.ComboBox",U)},75055:function(t,e,n){"use strict";function i(t){return i="function"==typeof c&&"symbol"==typeof f?function(t){return typeof t}:function(t){return t&&"function"==typeof c&&t.constructor===c&&t!==c.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(9705),c=n(65420),f=n(98341);l(e,"__esModule",{value:!0}),e.Dialog=void 0;var _=w(n(85507)),d=w(n(21611)),p=n(79698),y=n(78567),v=n(6642),g=n(89662),m=n(98693),b=n(73371),T=n(92493),x=n(23835);function w(t){return t&&t.__esModule?t:{default:t}}function k(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function C(t,e,n,i){return C="undefined"!=typeof Reflect&&h?h:function(t,e,n,i){var r,a=M(t,e);if(a){if((r=u(a,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=u(i,e)){if(!r.writable)return!1;r.value=n,l(i,e,r)}else!function(t,e,n){e in t?l(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0},C(t,e,n,i)}function E(t,e,n,i,r){if(!C(t,e,n,i||t)&&r)throw new Error("failed to set property");return n}function S(){return S="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=M(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},S.apply(this,arguments)}function M(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=D(t)););return t}function L(t,e){return L=a||function(t,e){return t.__proto__=e,t},L(t,e)}function R(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=D(t);if(e){var a=D(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return I(this,n)}}function I(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return A(t)}function A(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function D(t){return D=_.default?d.default:function(t){return t.__proto__||(0,d.default)(t)},D(t)}var B=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&L(t,e)}(a,t);var e,n,i,r=R(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this)).isShowEffect=!0,t.isPopupCenter=!0,t.popupEffect=a.manager.popupEffectHandler,t.closeEffect=a.manager.closeEffectHandler,t._dealDragArea(),t.on(g.Event.CLICK,A(t),t._onClick),t}return e=a,n=[{key:"_dealDragArea",value:function(){var t=this.getChildByName("drag");t&&(this.dragArea=t._x+","+t._y+","+t.width+","+t.height,t.removeSelf())}},{key:"dragArea",get:function(){return this._dragArea?this._dragArea.toString():null},set:function(t){if(t){var e=v.UIUtils.fillArray([0,0,0,0],t,Number);this._dragArea=new m.Rectangle(e[0],e[1],e[2],e[3]),this.on(g.Event.MOUSE_DOWN,this,this._onMouseDown)}else this._dragArea=null,this.off(g.Event.MOUSE_DOWN,this,this._onMouseDown)}},{key:"_onMouseDown",value:function(t){var e=this.getMousePoint();this._dragArea.contains(e.x,e.y)?this.startDrag():this.stopDrag()}},{key:"_onClick",value:function(t){var e=t.target;if(e)switch(e.name){case a.CLOSE:case a.CANCEL:case a.SURE:case a.NO:case a.OK:case a.YES:return void this.close(e.name)}}},{key:"open",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._dealDragArea(),this._param=e,a.manager.open(this,t,this.isShowEffect),a.manager.lock(!1)}},{key:"close",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.closeType=t,a.manager.close(this)}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this._dragArea=null,S(D(a.prototype),"destroy",this).call(this,t)}},{key:"show",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._open(!1,t,e)}},{key:"popup",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._open(!0,t,e)}},{key:"_open",value:function(t,e,n){this.isModal=t,this.isShowEffect=n,a.manager.lock(!0),this.open(e)}},{key:"isPopup",get:function(){return null!=this.parent}},{key:"zOrder",get:function(){return S(D(a.prototype),"zOrder",this)},set:function(t){E(D(a.prototype),"zOrder",t,this,!0),a.manager._checkMask()}}],i=[{key:"manager",get:function(){return a._manager=a._manager||new y.DialogManager},set:function(t){a._manager=t}},{key:"setLockView",value:function(t){a.manager.setLockView(t)}},{key:"lock",value:function(t){a.manager.lock(t)}},{key:"closeAll",value:function(){a.manager.closeAll()}},{key:"getDialogsByGroup",value:function(t){return a.manager.getDialogsByGroup(t)}},{key:"closeByGroup",value:function(t){return a.manager.closeByGroup(t)}}],n&&k(e.prototype,n),i&&k(e,i),a}(p.View);e.Dialog=B,B.CLOSE="close",B.CANCEL="cancel",B.SURE="sure",B.NO="no",B.YES="yes",B.OK="ok",b.IUI.Dialog=B,T.ILaya.regClass(B),x.ClassUtils.regClass("laya.ui.Dialog",B),x.ClassUtils.regClass("Laya.Dialog",B)},78567:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.DialogManager=void 0;var h=w(n(85507)),c=w(n(21611)),f=n(14529),_=n(13407),d=n(78362),p=n(89662),y=n(93408),v=n(45840),g=n(41107),m=n(84221),b=n(73371),T=n(23835),x=n(92493);function w(t){return t&&t.__esModule?t:{default:t}}function k(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function C(t,e){return C=a||function(t,e){return t.__proto__=e,t},C(t,e)}function E(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=L(t);if(e){var a=L(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return S(this,n)}}function S(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return M(t)}function M(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function L(t){return L=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},L(t)}var R=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&C(t,e)}(a,t);var e,n,i,r=E(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this)).maskLayer=new d.Sprite,t.popupEffect=function(e){e.scale(1,1),e._effectTween=m.Tween.from(e,{x:x.ILaya.stage.width/2,y:x.ILaya.stage.height/2,scaleX:0,scaleY:0},300,v.Ease.backOut,g.Handler.create(M(t),t.doOpen,[e]),0,!1,!1)},t.closeEffect=function(e){e._effectTween=m.Tween.to(e,{x:x.ILaya.stage.width/2,y:x.ILaya.stage.height/2,scaleX:0,scaleY:0},300,v.Ease.strongOut,g.Handler.create(M(t),t.doClose,[e]),0,!1,!1)},t.popupEffectHandler=new g.Handler(M(t),t.popupEffect),t.closeEffectHandler=new g.Handler(M(t),t.closeEffect),t.mouseEnabled=t.maskLayer.mouseEnabled=!0,t.zOrder=1e3,x.ILaya.stage.addChild(M(t)),x.ILaya.stage.on(p.Event.RESIZE,M(t),t._onResize),f.UIConfig.closeDialogOnSide&&t.maskLayer.on("click",M(t),t._closeOnSide),t._onResize(null),t}return e=a,n=[{key:"_closeOnSide",value:function(){var t=this.getChildAt(this.numChildren-1);t instanceof b.IUI.Dialog&&t.close("side")}},{key:"setLockView",value:function(t){this.lockLayer||(this.lockLayer=new y.Box,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(x.ILaya.stage.width,x.ILaya.stage.height)),this.lockLayer.removeChildren(),t&&(t.centerX=t.centerY=0,this.lockLayer.addChild(t))}},{key:"_onResize",value:function(){var t=this.maskLayer.width=x.ILaya.stage.width,e=this.maskLayer.height=x.ILaya.stage.height;this.lockLayer&&this.lockLayer.size(t,e),this.maskLayer.graphics.clear(!0),this.maskLayer.graphics.drawRect(0,0,t,e,f.UIConfig.popupBgColor),this.maskLayer.alpha=f.UIConfig.popupBgAlpha;for(var n=this.numChildren-1;n>-1;n--){var i=this.getChildAt(n);i.isPopupCenter&&this._centerDialog(i)}}},{key:"_centerDialog",value:function(t){t.x=Math.round((x.ILaya.stage.width-t.width>>1)+t.pivotX),t.y=Math.round((x.ILaya.stage.height-t.height>>1)+t.pivotY)}},{key:"open",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e&&this._closeAll(),this._clearDialogEffect(t),t.isPopupCenter&&this._centerDialog(t),this.addChild(t),(t.isModal||this._getBit(_.Const.HAS_ZORDER))&&x.ILaya.timer.callLater(this,this._checkMask),n&&null!=t.popupEffect?t.popupEffect.runWith(t):this.doOpen(t),this.event(p.Event.OPEN)}},{key:"_clearDialogEffect",value:function(t){t._effectTween&&(m.Tween.clear(t._effectTween),t._effectTween=null)}},{key:"doOpen",value:function(t){t.onOpened(t._param)}},{key:"lock",value:function(t){this.lockLayer&&(t?this.addChild(this.lockLayer):this.lockLayer.removeSelf())}},{key:"close",value:function(t){this._clearDialogEffect(t),t.isShowEffect&&null!=t.closeEffect?t.closeEffect.runWith([t]):this.doClose(t),this.event(p.Event.CLOSE)}},{key:"doClose",value:function(t){t.removeSelf(),t.isModal&&this._checkMask(),t.closeHandler&&t.closeHandler.runWith(t.closeType),t.onClosed(t.closeType),t.autoDestroyAtClosed&&t.destroy()}},{key:"closeAll",value:function(){this._closeAll(),this.event(p.Event.CLOSE)}},{key:"_closeAll",value:function(){for(var t=this.numChildren-1;t>-1;t--){var e=this.getChildAt(t);e&&null!=e.close&&this.doClose(e)}}},{key:"getDialogsByGroup",value:function(t){for(var e=[],n=this.numChildren-1;n>-1;n--){var i=this.getChildAt(n);i&&i.group===t&&e.push(i)}return e}},{key:"closeByGroup",value:function(t){for(var e=[],n=this.numChildren-1;n>-1;n--){var i=this.getChildAt(n);i&&i.group===t&&(i.close(),e.push(i))}return e}},{key:"_checkMask",value:function(){this.maskLayer.removeSelf();for(var t=this.numChildren-1;t>-1;t--){var e=this.getChildAt(t);if(e&&e.isModal)return void this.addChildAt(this.maskLayer,t)}}}],n&&k(e.prototype,n),i&&k(e,i),a}(d.Sprite);e.DialogManager=R,T.ClassUtils.regClass("laya.ui.DialogManager",R),T.ClassUtils.regClass("Laya.DialogManager",R)},31487:function(t,e,n){"use strict";function i(t){return i="function"==typeof c&&"symbol"==typeof f?function(t){return typeof t}:function(t){return t&&"function"==typeof c&&t.constructor===c&&t!==c.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(9705),l=n(34074),h=n(62734),c=n(65420),f=n(98341);s(e,"__esModule",{value:!0}),e.FontClip=void 0;var _=b(n(85507)),d=b(n(21611)),p=n(89662),y=n(21995),v=n(70078),g=n(92493),m=n(23835);function b(t){return t&&t.__esModule?t:{default:t}}function T(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function w(){return w="undefined"!=typeof Reflect&&h?h:function(t,e,n){var i=E(t,e);if(i){var r=l(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},w.apply(this,arguments)}function k(t,e,n,i){return k="undefined"!=typeof Reflect&&u?u:function(t,e,n,i){var r,a=E(t,e);if(a){if((r=l(a,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=l(i,e)){if(!r.writable)return!1;r.value=n,s(i,e,r)}else!function(t,e,n){e in t?s(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0},k(t,e,n,i)}function C(t,e,n,i,r){if(!k(t,e,n,i||t)&&r)throw new Error("failed to set property");return n}function E(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=R(t)););return t}function S(t,e){return S=a||function(t,e){return t.__proto__=e,t},S(t,e)}function M(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=R(t);if(e){var a=R(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return L(this,n)}}function L(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function R(t){return R=_.default?d.default:function(t){return t.__proto__||(0,d.default)(t)},R(t)}var I=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&S(t,e)}(a,t);var e,n,i,r=M(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return T(this,a),(t=r.call(this))._valueArr="",t._indexMap=null,t._sheet=null,t._direction="horizontal",t._spaceX=0,t._spaceY=0,t._align="left",t._wordsW=0,t._wordsH=0,e&&(t.skin=e),n&&(t.sheet=n),t}return e=a,n=[{key:"createChildren",value:function(){this._bitmap=new y.AutoBitmap,this.on(p.Event.LOADED,this,this._onClipLoaded)}},{key:"_onClipLoaded",value:function(){this.callLater(this.changeValue)}},{key:"sheet",get:function(){return this._sheet},set:function(t){t+="",this._sheet=t;var e=t.split(" ");this._clipX=String(e[0]).length,this.clipY=e.length,this._indexMap={};for(var n=0;n<this._clipY;n++)for(var i=e[n].split(""),r=0,a=i.length;r<a;r++)this._indexMap[i[r]]=n*this._clipX+r}},{key:"value",get:function(){return this._valueArr?this._valueArr:""},set:function(t){t+="",this._valueArr=t,this.callLater(this.changeValue)}},{key:"direction",get:function(){return this._direction},set:function(t){this._direction=t,this.callLater(this.changeValue)}},{key:"spaceX",get:function(){return this._spaceX},set:function(t){this._spaceX=t,"horizontal"===this._direction&&this.callLater(this.changeValue)}},{key:"spaceY",get:function(){return this._spaceY},set:function(t){this._spaceY=t,"horizontal"!==this._direction&&this.callLater(this.changeValue)}},{key:"align",get:function(){return this._align},set:function(t){this._align=t,this.callLater(this.changeValue)}},{key:"changeValue",value:function(){var t;if(this._sources&&this._valueArr&&(this.graphics.clear(!0),t=this._sources[0])){var e="horizontal"===this._direction;e?(this._wordsW=this._valueArr.length*(t.sourceWidth+this.spaceX),this._wordsH=t.sourceHeight):(this._wordsW=t.sourceWidth,this._wordsH=(t.sourceHeight+this.spaceY)*this._valueArr.length);var n=0;if(this._width)switch(this._align){case"center":n=.5*(this._width-this._wordsW);break;case"right":n=this._width-this._wordsW;break;default:n=0}for(var i=0,r=this._valueArr.length;i<r;i++){var a=this._indexMap[this._valueArr.charAt(i)];this.sources[a]&&(t=this.sources[a],e?this.graphics.drawImage(t,n+i*(t.sourceWidth+this.spaceX),0,t.sourceWidth,t.sourceHeight):this.graphics.drawImage(t,0+n,i*(t.sourceHeight+this.spaceY),t.sourceWidth,t.sourceHeight))}this._width||(this._widget.resetLayoutX(),this.callLater(this._sizeChanged)),this._height||(this._widget.resetLayoutY(),this.callLater(this._sizeChanged))}}},{key:"width",get:function(){return w(R(a.prototype),"width",this)},set:function(t){C(R(a.prototype),"width",t,this,!0),this.callLater(this.changeValue)}},{key:"height",get:function(){return w(R(a.prototype),"height",this)},set:function(t){C(R(a.prototype),"height",t,this,!0),this.callLater(this.changeValue)}},{key:"measureWidth",value:function(){return this._wordsW}},{key:"measureHeight",value:function(){return this._wordsH}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off(p.Event.LOADED,this,this._onClipLoaded),w(R(a.prototype),"destroy",this).call(this,t)}}],n&&x(e.prototype,n),i&&x(e,i),a}(v.Clip);e.FontClip=I,g.ILaya.regClass(I),m.ClassUtils.regClass("laya.ui.FontClip",I),m.ClassUtils.regClass("Laya.FontClip",I)},51582:function(t,e,n){"use strict";function i(t){return i="function"==typeof c&&"symbol"==typeof f?function(t){return typeof t}:function(t){return t&&"function"==typeof c&&t.constructor===c&&t!==c.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(9705),l=n(34074),h=n(62734),c=n(65420),f=n(98341);s(e,"__esModule",{value:!0}),e.HBox=void 0;var _=m(n(47302)),d=m(n(85507)),p=m(n(21611)),y=n(66754),v=n(92493),g=n(23835);function m(t){return t&&t.__esModule?t:{default:t}}function b(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function x(){return x="undefined"!=typeof Reflect&&h?h:function(t,e,n){var i=C(t,e);if(i){var r=l(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},x.apply(this,arguments)}function w(t,e,n,i){return w="undefined"!=typeof Reflect&&u?u:function(t,e,n,i){var r,a=C(t,e);if(a){if((r=l(a,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=l(i,e)){if(!r.writable)return!1;r.value=n,s(i,e,r)}else!function(t,e,n){e in t?s(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0},w(t,e,n,i)}function k(t,e,n,i,r){if(!w(t,e,n,i||t)&&r)throw new Error("failed to set property");return n}function C(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=L(t)););return t}function E(t,e){return E=a||function(t,e){return t.__proto__=e,t},E(t,e)}function S(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=L(t);if(e){var a=L(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return M(this,n)}}function M(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function L(t){return L=d.default?p.default:function(t){return t.__proto__||(0,p.default)(t)},L(t)}var R=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&E(t,e)}(a,t);var e,n,i,r=S(a);function a(){return b(this,a),r.apply(this,arguments)}return e=a,(n=[{key:"sortItem",value:function(t){t&&(0,_.default)(t).call(t,(function(t,e){return t.x-e.x}))}},{key:"height",get:function(){return x(L(a.prototype),"height",this)},set:function(t){this._height!=t&&(k(L(a.prototype),"height",t,this,!0),this.callLater(this.changeItems))}},{key:"changeItems",value:function(){this._itemChanged=!1;for(var t=[],e=0,n=0,i=this.numChildren;n<i;n++){var r=this.getChildAt(n);r&&(t.push(r),e=this._height?this._height:Math.max(e,r.height*r.scaleY))}this.sortItem(t);var o=0;for(n=0,i=t.length;n<i;n++)(r=t[n]).x=o,o+=r.width*r.scaleX+this._space,this._align==a.TOP?r.y=0:this._align==a.MIDDLE?r.y=.5*(e-r.height*r.scaleY):this._align==a.BOTTOM&&(r.y=e-r.height*r.scaleY);this._sizeChanged()}}])&&T(e.prototype,n),i&&T(e,i),a}(y.LayoutBox);e.HBox=R,R.NONE="none",R.TOP="top",R.MIDDLE="middle",R.BOTTOM="bottom",v.ILaya.regClass(R),g.ClassUtils.regClass("laya.ui.HBox",R),g.ClassUtils.regClass("Laya.HBox",R)},8255:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.HScrollBar=void 0;var f=v(n(85507)),_=v(n(21611)),d=n(72978),p=n(92493),y=n(23835);function v(t){return t&&t.__esModule?t:{default:t}}function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function b(){return b="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=T(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},b.apply(this,arguments)}function T(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=C(t)););return t}function x(t,e){return x=a||function(t,e){return t.__proto__=e,t},x(t,e)}function w(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=C(t);if(e){var a=C(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return k(this,n)}}function k(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function C(t){return C=f.default?_.default:function(t){return t.__proto__||(0,_.default)(t)},C(t)}var E=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&x(t,e)}(a,t);var e,n,i,r=w(a);function a(){return g(this,a),r.apply(this,arguments)}return e=a,(n=[{key:"initialize",value:function(){b(C(a.prototype),"initialize",this).call(this),this.slider.isVertical=!1}}])&&m(e.prototype,n),i&&m(e,i),a}(d.ScrollBar);e.HScrollBar=E,p.ILaya.regClass(E),y.ClassUtils.regClass("laya.ui.HScrollBar",E),y.ClassUtils.regClass("Laya.HScrollBar",E)},48181:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.HSlider=void 0;var h=p(n(85507)),c=p(n(21611)),f=n(36895),_=n(92493),d=n(23835);function p(t){return t&&t.__esModule?t:{default:t}}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){return v=a||function(t,e){return t.__proto__=e,t},v(t,e)}function g(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b(t);if(e){var a=b(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return m(this,n)}}function m(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function b(t){return b=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},b(t)}var T=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(n,t);var e=g(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return y(this,n),(t=e.call(this,i)).isVertical=!1,t}return n}(f.Slider);e.HSlider=T,_.ILaya.regClass(T),d.ClassUtils.regClass("laya.ui.HSlider",T),d.ClassUtils.regClass("Laya.HSlider",T)},73371:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.IUI=void 0;e.IUI=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}},44476:function(t,e,n){"use strict";function i(t){return i="function"==typeof c&&"symbol"==typeof f?function(t){return typeof t}:function(t){return t&&"function"==typeof c&&t.constructor===c&&t!==c.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(9705),c=n(65420),f=n(98341);l(e,"__esModule",{value:!0}),e.Image=void 0;var _=k(n(85507)),d=k(n(21611)),p=n(90335),y=n(89662),v=n(85096),g=n(21995),m=n(93615),b=n(6642),T=n(41107),x=n(92493),w=n(23835);function k(t){return t&&t.__esModule?t:{default:t}}function C(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function E(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function S(t,e,n,i){return S="undefined"!=typeof Reflect&&h?h:function(t,e,n,i){var r,a=R(t,e);if(a){if((r=u(a,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=u(i,e)){if(!r.writable)return!1;r.value=n,l(i,e,r)}else!function(t,e,n){e in t?l(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0},S(t,e,n,i)}function M(t,e,n,i,r){if(!S(t,e,n,i||t)&&r)throw new Error("failed to set property");return n}function L(){return L="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=R(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},L.apply(this,arguments)}function R(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=B(t)););return t}function I(t,e){return I=a||function(t,e){return t.__proto__=e,t},I(t,e)}function A(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=B(t);if(e){var a=B(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return D(this,n)}}function D(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function B(t){return B=_.default?d.default:function(t){return t.__proto__||(0,d.default)(t)},B(t)}var P=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&I(t,e)}(a,t);var e,n,i,r=A(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return C(this,a),(t=r.call(this)).skin=e,t}return e=a,n=[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];L(B(a.prototype),"destroy",this).call(this,t),this._bitmap&&this._bitmap.destroy(),this._bitmap=null}},{key:"dispose",value:function(){this.destroy(!0),x.ILaya.loader.clearRes(this._skin)}},{key:"createChildren",value:function(){this.graphics=this._bitmap=new g.AutoBitmap,this._bitmap.autoCacheCmd=!1}},{key:"skin",get:function(){return this._skin},set:function(t){if(this._skin!=t)if(this._skin=t,t){var e=v.Loader.getRes(t);e?(this.source=e,this.onCompResize()):x.ILaya.loader.load(this._skin,T.Handler.create(this,this.setSource,[this._skin]),null,v.Loader.IMAGE,1,!0,this._group)}else this.source=null}},{key:"source",get:function(){return this._bitmap.source},set:function(t){this._bitmap&&(this._bitmap.source=t,this.event(y.Event.LOADED),this.repaint())}},{key:"group",get:function(){return this._group},set:function(t){t&&this._skin&&v.Loader.setGroup(this._skin,t),this._group=t}},{key:"setSource",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t===this._skin&&e&&(this.source=e,this.onCompResize())}},{key:"measureWidth",value:function(){return this._bitmap.width}},{key:"measureHeight",value:function(){return this._bitmap.height}},{key:"width",get:function(){return L(B(a.prototype),"width",this)},set:function(t){M(B(a.prototype),"width",t,this,!0),this._bitmap.width=0==t?1e-7:t}},{key:"height",get:function(){return L(B(a.prototype),"height",this)},set:function(t){M(B(a.prototype),"height",t,this,!0),this._bitmap.height=0==t?1e-7:t}},{key:"sizeGrid",get:function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},set:function(t){this._bitmap.sizeGrid=b.UIUtils.fillArray(p.Styles.defaultSizeGrid,t,Number)}},{key:"dataSource",get:function(){return L(B(a.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"string"==typeof t?this.skin=t:M(B(a.prototype),"dataSource",t,this,!0)}}],n&&E(e.prototype,n),i&&E(e,i),a}(m.UIComponent);e.Image=P,x.ILaya.regClass(P),w.ClassUtils.regClass("laya.ui.Image",P),w.ClassUtils.regClass("Laya.Image",P)},96530:function(t,e,n){"use strict";function i(t){return i="function"==typeof c&&"symbol"==typeof f?function(t){return typeof t}:function(t){return t&&"function"==typeof c&&t.constructor===c&&t!==c.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(9705),c=n(65420),f=n(98341);l(e,"__esModule",{value:!0}),e.Label=void 0;var _=x(n(85507)),d=x(n(21611)),p=n(90335),y=n(81870),v=n(89662),g=n(93615),m=n(6642),b=n(92493),T=n(23835);function x(t){return t&&t.__esModule?t:{default:t}}function w(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function k(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function C(t,e,n,i){return C="undefined"!=typeof Reflect&&h?h:function(t,e,n,i){var r,a=M(t,e);if(a){if((r=u(a,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=u(i,e)){if(!r.writable)return!1;r.value=n,l(i,e,r)}else!function(t,e,n){e in t?l(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0},C(t,e,n,i)}function E(t,e,n,i,r){if(!C(t,e,n,i||t)&&r)throw new Error("failed to set property");return n}function S(){return S="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=M(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},S.apply(this,arguments)}function M(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=A(t)););return t}function L(t,e){return L=a||function(t,e){return t.__proto__=e,t},L(t,e)}function R(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=A(t);if(e){var a=A(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return I(this,n)}}function I(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function A(t){return A=_.default?d.default:function(t){return t.__proto__||(0,d.default)(t)},A(t)}var D=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&L(t,e)}(a,t);var e,n,i,r=R(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return w(this,a),(t=r.call(this)).text=e,t}return e=a,n=[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];S(A(a.prototype),"destroy",this).call(this,t),this._tf=null}},{key:"createChildren",value:function(){this.addChild(this._tf=new y.Text)}},{key:"text",get:function(){return this._tf.text},set:function(t){this._tf.text!=t&&(t&&(t=m.UIUtils.adptString(t+"")),this._tf.text=t,this.event(v.Event.CHANGE),this._width&&this._height||this.onCompResize())}},{key:"changeText",value:function(t){this._tf.changeText(t)}},{key:"wordWrap",get:function(){return this._tf.wordWrap},set:function(t){this._tf.wordWrap=t}},{key:"color",get:function(){return this._tf.color},set:function(t){this._tf.color=t}},{key:"font",get:function(){return this._tf.font},set:function(t){this._tf.font=t}},{key:"align",get:function(){return this._tf.align},set:function(t){this._tf.align=t}},{key:"valign",get:function(){return this._tf.valign},set:function(t){this._tf.valign=t}},{key:"bold",get:function(){return this._tf.bold},set:function(t){this._tf.bold=t}},{key:"italic",get:function(){return this._tf.italic},set:function(t){this._tf.italic=t}},{key:"leading",get:function(){return this._tf.leading},set:function(t){this._tf.leading=t}},{key:"fontSize",get:function(){return this._tf.fontSize},set:function(t){this._tf.fontSize=t}},{key:"padding",get:function(){return this._tf.padding.join(",")},set:function(t){this._tf.padding=m.UIUtils.fillArray(p.Styles.labelPadding,t,Number)}},{key:"bgColor",get:function(){return this._tf.bgColor},set:function(t){this._tf.bgColor=t}},{key:"borderColor",get:function(){return this._tf.borderColor},set:function(t){this._tf.borderColor=t}},{key:"stroke",get:function(){return this._tf.stroke},set:function(t){this._tf.stroke=t}},{key:"strokeColor",get:function(){return this._tf.strokeColor},set:function(t){this._tf.strokeColor=t}},{key:"textField",get:function(){return this._tf}},{key:"measureWidth",value:function(){return this._tf.width}},{key:"measureHeight",value:function(){return this._tf.height}},{key:"width",get:function(){return this._width||this._tf.text?S(A(a.prototype),"width",this):0},set:function(t){E(A(a.prototype),"width",t,this,!0),this._tf.width=t}},{key:"height",get:function(){return this._height||this._tf.text?S(A(a.prototype),"height",this):0},set:function(t){E(A(a.prototype),"height",t,this,!0),this._tf.height=t}},{key:"dataSource",get:function(){return S(A(a.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.text=t+"":E(A(a.prototype),"dataSource",t,this,!0)}},{key:"overflow",get:function(){return this._tf.overflow},set:function(t){this._tf.overflow=t}},{key:"underline",get:function(){return this._tf.underline},set:function(t){this._tf.underline=t}},{key:"underlineColor",get:function(){return this._tf.underlineColor},set:function(t){this._tf.underlineColor=t}}],n&&k(e.prototype,n),i&&k(e,i),a}(g.UIComponent);e.Label=D,b.ILaya.regClass(D),T.ClassUtils.regClass("laya.ui.Label",D),T.ClassUtils.regClass("Laya.Label",D)},66754:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.LayoutBox=void 0;var f=m(n(47302)),_=m(n(85507)),d=m(n(21611)),p=n(93408),y=n(89662),v=n(92493),g=n(23835);function m(t){return t&&t.__esModule?t:{default:t}}function b(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function x(){return x="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=w(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},x.apply(this,arguments)}function w(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=S(t)););return t}function k(t,e){return k=a||function(t,e){return t.__proto__=e,t},k(t,e)}function C(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=S(t);if(e){var a=S(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return E(this,n)}}function E(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function S(t){return S=_.default?d.default:function(t){return t.__proto__||(0,d.default)(t)},S(t)}var M=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&k(t,e)}(a,t);var e,n,i,r=C(a);function a(){var t;return b(this,a),(t=r.apply(this,arguments))._space=0,t._align="none",t._itemChanged=!1,t}return e=a,(n=[{key:"addChild",value:function(t){return t.on(y.Event.RESIZE,this,this.onResize),this._setItemChanged(),x(S(a.prototype),"addChild",this).call(this,t)}},{key:"onResize",value:function(t){this._setItemChanged()}},{key:"addChildAt",value:function(t,e){return t.on(y.Event.RESIZE,this,this.onResize),this._setItemChanged(),x(S(a.prototype),"addChildAt",this).call(this,t,e)}},{key:"removeChildAt",value:function(t){return this.getChildAt(t).off(y.Event.RESIZE,this,this.onResize),this._setItemChanged(),x(S(a.prototype),"removeChildAt",this).call(this,t)}},{key:"refresh",value:function(){this._setItemChanged()}},{key:"changeItems",value:function(){this._itemChanged=!1}},{key:"space",get:function(){return this._space},set:function(t){this._space=t,this._setItemChanged()}},{key:"align",get:function(){return this._align},set:function(t){this._align=t,this._setItemChanged()}},{key:"sortItem",value:function(t){t&&(0,f.default)(t).call(t,(function(t,e){return t.y-e.y}))}},{key:"_setItemChanged",value:function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))}}])&&T(e.prototype,n),i&&T(e,i),a}(p.Box);e.LayoutBox=M,v.ILaya.regClass(M),g.ClassUtils.regClass("laya.ui.LayoutBox",M),g.ClassUtils.regClass("Laya.LayoutBox",M)},75485:function(t,e,n){"use strict";function i(t){return i="function"==typeof c&&"symbol"==typeof f?function(t){return typeof t}:function(t){return t&&"function"==typeof c&&t.constructor===c&&t!==c.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(9705),c=n(65420),f=n(98341);l(e,"__esModule",{value:!0}),e.List=void 0;var _=L(n(81643)),d=L(n(94198)),p=L(n(92762)),y=L(n(85507)),v=L(n(21611)),g=n(93408),m=n(37277),b=n(8255),T=n(6642),x=n(89662),w=n(85399),k=n(98693),C=n(21383),E=n(84221),S=n(92493),M=n(23835);function L(t){return t&&t.__esModule?t:{default:t}}function R(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function I(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function A(t,e,n,i){return A="undefined"!=typeof Reflect&&h?h:function(t,e,n,i){var r,a=P(t,e);if(a){if((r=u(a,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=u(i,e)){if(!r.writable)return!1;r.value=n,l(i,e,r)}else!function(t,e,n){e in t?l(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0},A(t,e,n,i)}function D(t,e,n,i,r){if(!A(t,e,n,i||t)&&r)throw new Error("failed to set property");return n}function B(){return B="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=P(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},B.apply(this,arguments)}function P(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=N(t)););return t}function O(t,e){return O=a||function(t,e){return t.__proto__=e,t},O(t,e)}function F(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=N(t);if(e){var a=N(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return U(this,n)}}function U(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function N(t){return N=y.default?v.default:function(t){return t.__proto__||(0,v.default)(t)},N(t)}var G=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&O(t,e)}(a,t);var e,n,i,r=F(a);function a(){var t;return R(this,a),(t=r.apply(this,arguments)).selectEnable=!1,t.totalPage=0,t._$componentType="List",t._repeatX=0,t._repeatY=0,t._repeatX2=0,t._repeatY2=0,t._spaceX=0,t._spaceY=0,t._cells=[],t._startIndex=0,t._selectedIndex=-1,t._page=0,t._isVertical=!0,t._cellSize=20,t._cellOffset=0,t._createdLine=0,t._offset=new w.Point,t._usedCache=null,t._elasticEnabled=!1,t._preLen=0,t}return e=a,n=[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._content&&this._content.destroy(t),this._scrollBar&&this._scrollBar.destroy(t),B(N(a.prototype),"destroy",this).call(this,t),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null}},{key:"createChildren",value:function(){this.addChild(this._content=new g.Box)}},{key:"cacheAs",get:function(){return B(N(a.prototype),"cacheAs",this)},set:function(t){D(N(a.prototype),"cacheAs",t,this,!0),this._scrollBar&&(this._usedCache=null,"none"!==t?this._scrollBar.on(x.Event.START,this,this.onScrollStart):this._scrollBar.off(x.Event.START,this,this.onScrollStart))}},{key:"onScrollStart",value:function(){this._usedCache||(this._usedCache=B(N(a.prototype),"cacheAs",this)),D(N(a.prototype),"cacheAs","none",this,!0),this._scrollBar.once(x.Event.END,this,this.onScrollEnd)}},{key:"onScrollEnd",value:function(){D(N(a.prototype),"cacheAs",this._usedCache||"none",this,!0)}},{key:"content",get:function(){return this._content}},{key:"vScrollBarSkin",get:function(){return this._scrollBar?this._scrollBar.skin:null},set:function(t){this._removePreScrollBar();var e=new m.VScrollBar;e.name="scrollBar",e.right=0,e.skin=t,e.elasticDistance=this._elasticEnabled?200:0,this.scrollBar=e,this.addChild(e),this._setCellChanged()}},{key:"_removePreScrollBar",value:function(){var t=this.removeChildByName("scrollBar");t&&t.destroy(!0)}},{key:"hScrollBarSkin",get:function(){return this._scrollBar?this._scrollBar.skin:null},set:function(t){this._removePreScrollBar();var e=new b.HScrollBar;e.name="scrollBar",e.bottom=0,e.skin=t,e.elasticDistance=this._elasticEnabled?200:0,this.scrollBar=e,this.addChild(e),this._setCellChanged()}},{key:"scrollBar",get:function(){return this._scrollBar},set:function(t){this._scrollBar!=t&&(this._scrollBar=t,t&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on(x.Event.CHANGE,this,this.onScrollBarChange)))}},{key:"itemRender",get:function(){return this._itemRender},set:function(t){if(this._itemRender!=t){this._itemRender=t;for(var e=this._cells.length-1;e>-1;e--)this._cells[e].destroy();this._cells.length=0,this._setCellChanged()}}},{key:"width",get:function(){return B(N(a.prototype),"width",this)},set:function(t){t!=this._width&&(D(N(a.prototype),"width",t,this,!0),this._setCellChanged())}},{key:"height",get:function(){return B(N(a.prototype),"height",this)},set:function(t){t!=this._height&&(D(N(a.prototype),"height",t,this,!0),this._setCellChanged())}},{key:"repeatX",get:function(){return this._repeatX>0?this._repeatX:this._repeatX2>0?this._repeatX2:1},set:function(t){this._repeatX=t,this._setCellChanged()}},{key:"repeatY",get:function(){return this._repeatY>0?this._repeatY:this._repeatY2>0?this._repeatY2:1},set:function(t){this._repeatY=t,this._setCellChanged()}},{key:"spaceX",get:function(){return this._spaceX},set:function(t){this._spaceX=t,this._setCellChanged()}},{key:"spaceY",get:function(){return this._spaceY},set:function(t){this._spaceY=t,this._setCellChanged()}},{key:"changeCells",value:function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var t=this._getOneCell(),e=t.width+this._spaceX||1,n=t.height+this._spaceY||1;this._width>0&&(this._repeatX2=this._isVertical?Math.round(this._width/e):Math.ceil(this._width/e)),this._height>0&&(this._repeatY2=this._isVertical?Math.ceil(this._height/n):Math.round(this._height/n));var i=this._width?this._width:e*this.repeatX-this._spaceX,r=this._height?this._height:n*this.repeatY-this._spaceY;this._cellSize=this._isVertical?n:e,this._cellOffset=this._isVertical?n*Math.max(this._repeatY2,this._repeatY)-r-this._spaceY:e*Math.max(this._repeatX2,this._repeatX)-i-this._spaceX,this._isVertical&&this.vScrollBarSkin?this._scrollBar.height=r:!this._isVertical&&this.hScrollBarSkin&&(this._scrollBar.width=i),this.setContentSize(i,r);var a=this._isVertical?this.repeatX:this.repeatY,o=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,a,o),this._createdLine=o,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}}},{key:"_getOneCell",value:function(){if(0===this._cells.length){var t=this.createItem();if(this._offset.setTo(t._x,t._y),this.cacheContent)return t;this._cells.push(t)}return this._cells[0]}},{key:"_createItems",value:function(t,e,n){var i=this._content,r=this._getOneCell(),a=r.width+this._spaceX,o=r.height+this._spaceY;if(this.cacheContent){var s=new g.Box;s.cacheAs="normal",s.pos((this._isVertical?0:t)*a,(this._isVertical?t:0)*o),this._content.addChild(s),i=s}else{for(var u=[],l=this._cells.length-1;l>-1;l--){var h=this._cells[l];h.removeSelf(),u.push(h)}this._cells.length=0}for(var c=t;c<n;c++)for(var f=0;f<e;f++)(r=u&&u.length?u.pop():this.createItem()).x=(this._isVertical?f:c)*a-i._x,r.y=(this._isVertical?c:f)*o-i._y,r.name="item"+(c*e+f),i.addChild(r),this.addCell(r)}},{key:"createItem",value:function(){var t=[];if("function"==typeof this._itemRender)var e=new this._itemRender;else e=C.SceneUtils.createComp(this._itemRender,null,null,t);if(0==t.length&&e._watchMap){var n=e._watchMap;for(var i in n)for(var r=n[i],a=0;a<r.length;a++){var o=r[a];t.push(o.comp,o.prop,o.value)}}return t.length&&(e._$bindData=t),e}},{key:"addCell",value:function(t){t.on(x.Event.CLICK,this,this.onCellMouse),t.on(x.Event.RIGHT_CLICK,this,this.onCellMouse),t.on(x.Event.MOUSE_OVER,this,this.onCellMouse),t.on(x.Event.MOUSE_OUT,this,this.onCellMouse),t.on(x.Event.MOUSE_DOWN,this,this.onCellMouse),t.on(x.Event.MOUSE_UP,this,this.onCellMouse),this._cells.push(t)}},{key:"_afterInited",value:function(){this.initItems()}},{key:"initItems",value:function(){if(!this._itemRender&&null!=this.getChildByName("item0")){var t;this.repeatX=1,t=0;for(var e=0;e<1e4;e++){var n=this.getChildByName("item"+e);if(!n)break;this.addCell(n),t++}this.repeatY=t}}},{key:"setContentSize",value:function(t,e){this._content.width=t,this._content.height=e,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content._style.scrollRect||(this._content.scrollRect=k.Rectangle.create()),this._content._style.scrollRect.setTo(-this._offset.x,-this._offset.y,t,e),this._content.scrollRect=this._content.scrollRect),this.event(x.Event.RESIZE)}},{key:"onCellMouse",value:function(t){var e;t.type===x.Event.MOUSE_DOWN&&(this._isMoved=!1);var n=t.currentTarget,i=this._startIndex+(0,_.default)(e=this._cells).call(e,n);i<0||(t.type===x.Event.CLICK||t.type===x.Event.RIGHT_CLICK?this.selectEnable&&!this._isMoved?this.selectedIndex=i:this.changeCellState(n,!0,0):t.type!==x.Event.MOUSE_OVER&&t.type!==x.Event.MOUSE_OUT||this._selectedIndex===i||this.changeCellState(n,t.type===x.Event.MOUSE_OVER,0),this.mouseHandler&&this.mouseHandler.runWith([t,i]))}},{key:"changeCellState",value:function(t,e,n){var i=t.getChildByName("selectBox");i&&(this.selectEnable=!0,i.visible=e,i.index=n)}},{key:"_sizeChanged",value:function(){B(N(a.prototype),"_sizeChanged",this).call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)}},{key:"onScrollBarChange",value:function(){this.runCallLater(this.changeCells);var t=this._scrollBar.value,e=this._isVertical?this.repeatX:this.repeatY,n=this._isVertical?this.repeatY:this.repeatX,i=Math.floor(t/this._cellSize);if(this.cacheContent)a=n+1,this._createdLine-i<a&&(this._createItems(this._createdLine,e,this._createdLine+a),this.renderItems(this._createdLine*e,0),this._createdLine+=a);else{var r=i*e,a=0,o=!0,s=0;r>this._startIndex?(a=r-this._startIndex,s=this._startIndex+e*(n+1),this._isMoved=!0):r<this._startIndex&&(a=this._startIndex-r,o=!1,s=this._startIndex-1,this._isMoved=!0);for(var u=0;u<a;u++){if(o){var l=this._cells.shift();this._cells[this._cells.length]=l;var h=s+u}else l=this._cells.pop(),this._cells.unshift(l),h=s-u;var c=Math.floor(h/e)*this._cellSize;this._isVertical?l.y=c:l.x=c,this.renderItem(l,h)}this._startIndex=r,this.changeSelectStatus()}var f=this._content._style.scrollRect;this._isVertical?(f.y=t-this._offset.y,f.x=-this._offset.x):(f.y=-this._offset.y,f.x=t-this._offset.x),this._content.scrollRect=f}},{key:"posCell",value:function(t,e){if(this._scrollBar){var n=this._isVertical?this.repeatX:this.repeatY,i=Math.floor(e/n)*this._cellSize;this._isVertical?t._y=i:t.x=i}}},{key:"selectedIndex",get:function(){return this._selectedIndex},set:function(t){this._selectedIndex!=t&&(this._selectedIndex=t,this.changeSelectStatus(),this.event(x.Event.CHANGE),this.selectHandler&&this.selectHandler.runWith(t),this.startIndex=this._startIndex)}},{key:"changeSelectStatus",value:function(){for(var t=0,e=this._cells.length;t<e;t++)this.changeCellState(this._cells[t],this._selectedIndex===this._startIndex+t,1)}},{key:"selectedItem",get:function(){return this._array&&-1!=this._selectedIndex?this._array[this._selectedIndex]:null},set:function(t){var e;this._array&&(this.selectedIndex=(0,_.default)(e=this._array).call(e,t))}},{key:"selection",get:function(){return this.getCell(this._selectedIndex)},set:function(t){var e;this.selectedIndex=this._startIndex+(0,_.default)(e=this._cells).call(e,t)}},{key:"startIndex",get:function(){return this._startIndex},set:function(t){this._startIndex=t>0?t:0,this.callLater(this.renderItems)}},{key:"renderItems",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t,i=e||this._cells.length;n<i;n++)this.renderItem(this._cells[n],this._startIndex+n);this.changeSelectStatus()}},{key:"renderItem",value:function(t,e){this._array&&e>=0&&e<this._array.length?(t.visible=!0,t._$bindData?(t._dataSource=this._array[e],this._bindData(t,this._array[e])):t.dataSource=this._array[e],this.cacheContent||this.posCell(t,e),this.hasListener(x.Event.RENDER)&&this.event(x.Event.RENDER,[t,e]),this.renderHandler&&this.renderHandler.runWith([t,e])):(t.visible=!1,t.dataSource=null)}},{key:"_bindData",value:function(t,e){for(var n=t._$bindData,i=0,r=n.length;i<r;i++){var a=n[i++],o=n[i++],s=n[i],u=T.UIUtils.getBindFun(s);a[o]=u.call(this,e)}}},{key:"array",get:function(){return this._array},set:function(t){this.runCallLater(this.changeCells),this._array=t||[],this._preLen=this._array.length;var e=this._array.length;if(this.totalPage=Math.ceil(e/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<e?this._selectedIndex:e-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var n=this._isVertical?this.repeatX:this.repeatY,i=this._isVertical?this.repeatY:this.repeatX,r=Math.ceil(e/n);(this._cellOffset>0?this.totalPage+1:this.totalPage)>1&&r>=i?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=i/r,this._scrollBar.setScroll(0,(r-i)*this._cellSize+this._cellOffset,this._scrollBar.value),this._scrollBar.target=this._content):(this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content)}}},{key:"updateArray",value:function(t){if(this._array=t,this._array){var e=this._preLen-this._startIndex;e>=0&&this.renderItems(e),this._preLen=this._array.length}if(this._scrollBar){var n=t.length,i=this._isVertical?this.repeatX:this.repeatY,r=this._isVertical?this.repeatY:this.repeatX,a=Math.ceil(n/i);a>=r&&(this._scrollBar.thumbPercent=r/a,this._scrollBar.slider._max=(a-r)*this._cellSize+this._cellOffset)}}},{key:"page",get:function(){return this._page},set:function(t){this._page=t,this._array&&(this._page=t>0?t:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}},{key:"length",get:function(){return this._array?this._array.length:0}},{key:"dataSource",get:function(){return B(N(a.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.selectedIndex=(0,d.default)(t):t instanceof Array?this.array=t:D(N(a.prototype),"dataSource",t,this,!0)}},{key:"cells",get:function(){return this.runCallLater(this.changeCells),this._cells}},{key:"elasticEnabled",get:function(){return this._elasticEnabled},set:function(t){this._elasticEnabled=t,this._scrollBar&&(this._scrollBar.elasticDistance=t?200:0)}},{key:"refresh",value:function(){this.array=this._array}},{key:"getItem",value:function(t){return this._array&&t>-1&&t<this._array.length?this._array[t]:null}},{key:"changeItem",value:function(t,e){t>-1&&this._array&&t<this._array.length&&(this._array[t]=e,t>=this._startIndex&&t<this._startIndex+this._cells.length&&this.renderItem(this.getCell(t),t))}},{key:"setItem",value:function(t,e){this.changeItem(t,e)}},{key:"addItem",value:function(t){this.array?this._array.push(t):this.array=[t],this.array=this._array}},{key:"addItemAt",value:function(t,e){var n;(0,p.default)(n=this._array).call(n,e,0,t),this.array=this._array}},{key:"deleteItem",value:function(t){var e;this._array&&((0,p.default)(e=this._array).call(e,t,1),this.array=this._array)}},{key:"getCell",value:function(t){return this.runCallLater(this.changeCells),t>-1&&this._cells?this._cells[(t-this._startIndex)%this._cells.length]:null}},{key:"scrollTo",value:function(t){if(this._scrollBar){var e=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(t/e)*this._cellSize}else this.startIndex=t}},{key:"tweenTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this._scrollBar){this._scrollBar.stopScroll();var i=this._isVertical?this.repeatX:this.repeatY;E.Tween.to(this._scrollBar,{value:Math.floor(t/i)*this._cellSize},e,null,n,0,!0)}else this.startIndex=t,n&&n.run()}},{key:"_setCellChanged",value:function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))}},{key:"commitMeasure",value:function(){this.runCallLater(this.changeCells)}}],n&&I(e.prototype,n),i&&I(e,i),a}(g.Box);e.List=G,S.ILaya.regClass(G),M.ClassUtils.regClass("laya.ui.List",G),M.ClassUtils.regClass("Laya.List",G)},29084:function(t,e,n){"use strict";function i(t){return i="function"==typeof c&&"symbol"==typeof f?function(t){return typeof t}:function(t){return t&&"function"==typeof c&&t.constructor===c&&t!==c.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(9705),c=n(65420),f=n(98341);l(e,"__esModule",{value:!0}),e.Panel=void 0;var _=x(n(85507)),d=x(n(21611)),p=n(93408),y=n(37277),v=n(8255),g=n(89662),m=n(98693),b=n(92493),T=n(23835);function x(t){return t&&t.__esModule?t:{default:t}}function w(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function k(t,e,n,i){return k="undefined"!=typeof Reflect&&h?h:function(t,e,n,i){var r,a=S(t,e);if(a){if((r=u(a,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=u(i,e)){if(!r.writable)return!1;r.value=n,l(i,e,r)}else!function(t,e,n){e in t?l(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0},k(t,e,n,i)}function C(t,e,n,i,r){if(!k(t,e,n,i||t)&&r)throw new Error("failed to set property");return n}function E(){return E="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=S(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},E.apply(this,arguments)}function S(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=I(t)););return t}function M(t,e){return M=a||function(t,e){return t.__proto__=e,t},M(t,e)}function L(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=I(t);if(e){var a=I(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return R(this,n)}}function R(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function I(t){return I=_.default?d.default:function(t){return t.__proto__||(0,d.default)(t)},I(t)}var A=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&M(t,e)}(a,t);var e,n,i,r=L(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this))._usedCache=null,t._elasticEnabled=!1,t.width=t.height=100,t}return e=a,n=[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];E(I(a.prototype),"destroy",this).call(this,t),this._content&&this._content.destroy(t),this._vScrollBar&&this._vScrollBar.destroy(t),this._hScrollBar&&this._hScrollBar.destroy(t),this._vScrollBar=null,this._hScrollBar=null,this._content=null}},{key:"destroyChildren",value:function(){this._content.destroyChildren()}},{key:"createChildren",value:function(){E(I(a.prototype),"addChild",this).call(this,this._content=new p.Box)}},{key:"addChild",value:function(t){return t.on(g.Event.RESIZE,this,this.onResize),this._setScrollChanged(),this._content.addChild(t)}},{key:"onResize",value:function(){this._setScrollChanged()}},{key:"addChildAt",value:function(t,e){return t.on(g.Event.RESIZE,this,this.onResize),this._setScrollChanged(),this._content.addChildAt(t,e)}},{key:"removeChild",value:function(t){return t.off(g.Event.RESIZE,this,this.onResize),this._setScrollChanged(),this._content.removeChild(t)}},{key:"removeChildAt",value:function(t){return this.getChildAt(t).off(g.Event.RESIZE,this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(t)}},{key:"removeChildren",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2147483647;return this._content.removeChildren(t,e),this._setScrollChanged(),this}},{key:"getChildAt",value:function(t){return this._content.getChildAt(t)}},{key:"getChildByName",value:function(t){return this._content.getChildByName(t)}},{key:"getChildIndex",value:function(t){return this._content.getChildIndex(t)}},{key:"numChildren",get:function(){return this._content.numChildren}},{key:"changeScroll",value:function(){this._scrollChanged=!1;var t=this.contentWidth||1,e=this.contentHeight||1,n=this._vScrollBar,i=this._hScrollBar,r=n&&e>this._height,a=i&&t>this._width,o=r?this._width-n.width:this._width,s=a?this._height-i.height:this._height;n&&(n.x=this._width-n.width,n.y=0,n.height=this._height-(a?i.height:0),n.scrollSize=Math.max(.033*this._height,1),n.thumbPercent=s/e,n.setScroll(0,e-s,n.value)),i&&(i.x=0,i.y=this._height-i.height,i.width=this._width-(r?n.width:0),i.scrollSize=Math.max(.033*this._width,1),i.thumbPercent=o/t,i.setScroll(0,t-o,i.value))}},{key:"_sizeChanged",value:function(){E(I(a.prototype),"_sizeChanged",this).call(this),this.setContentSize(this._width,this._height)}},{key:"contentWidth",get:function(){for(var t=0,e=this._content.numChildren-1;e>-1;e--){var n=this._content.getChildAt(e);t=Math.max(n._x+n.width*n.scaleX-n.pivotX,t)}return t}},{key:"contentHeight",get:function(){for(var t=0,e=this._content.numChildren-1;e>-1;e--){var n=this._content.getChildAt(e);t=Math.max(n._y+n.height*n.scaleY-n.pivotY,t)}return t}},{key:"setContentSize",value:function(t,e){var n=this._content;n.width=t,n.height=e,n._style.scrollRect||(n.scrollRect=m.Rectangle.create()),n._style.scrollRect.setTo(0,0,t,e),n.scrollRect=n.scrollRect}},{key:"width",get:function(){return E(I(a.prototype),"width",this)},set:function(t){C(I(a.prototype),"width",t,this,!0),this._setScrollChanged()}},{key:"height",get:function(){return E(I(a.prototype),"height",this)},set:function(t){C(I(a.prototype),"height",t,this,!0),this._setScrollChanged()}},{key:"vScrollBarSkin",get:function(){return this._vScrollBar?this._vScrollBar.skin:null},set:function(t){null==this._vScrollBar&&(E(I(a.prototype),"addChild",this).call(this,this._vScrollBar=new y.VScrollBar),this._vScrollBar.on(g.Event.CHANGE,this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._vScrollBar.elasticDistance=this._elasticEnabled?200:0,this._setScrollChanged()),this._vScrollBar.skin=t}},{key:"hScrollBarSkin",get:function(){return this._hScrollBar?this._hScrollBar.skin:null},set:function(t){null==this._hScrollBar&&(E(I(a.prototype),"addChild",this).call(this,this._hScrollBar=new v.HScrollBar),this._hScrollBar.on(g.Event.CHANGE,this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._hScrollBar.elasticDistance=this._elasticEnabled?200:0,this._setScrollChanged()),this._hScrollBar.skin=t}},{key:"vScrollBar",get:function(){return this._vScrollBar}},{key:"hScrollBar",get:function(){return this._hScrollBar}},{key:"content",get:function(){return this._content}},{key:"onScrollBarChange",value:function(t){var e=this._content._style.scrollRect;if(e){var n=Math.round(t.value);t.isVertical?e.y=n:e.x=n,this._content.scrollRect=e}}},{key:"scrollTo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.vScrollBar&&(this.vScrollBar.value=e),this.hScrollBar&&(this.hScrollBar.value=t)}},{key:"refresh",value:function(){this.changeScroll()}},{key:"cacheAs",get:function(){return E(I(a.prototype),"cacheAs",this)},set:function(t){C(I(a.prototype),"cacheAs",t,this,!0),this._usedCache=null,"none"!==t?(this._hScrollBar&&this._hScrollBar.on(g.Event.START,this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on(g.Event.START,this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off(g.Event.START,this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off(g.Event.START,this,this.onScrollStart))}},{key:"elasticEnabled",get:function(){return this._elasticEnabled},set:function(t){this._elasticEnabled=t,this._vScrollBar&&(this._vScrollBar.elasticDistance=t?200:0),this._hScrollBar&&(this._hScrollBar.elasticDistance=t?200:0)}},{key:"onScrollStart",value:function(){this._usedCache||(this._usedCache=E(I(a.prototype),"cacheAs",this)),C(I(a.prototype),"cacheAs","none",this,!0),this._hScrollBar&&this._hScrollBar.once(g.Event.END,this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once(g.Event.END,this,this.onScrollEnd)}},{key:"onScrollEnd",value:function(){C(I(a.prototype),"cacheAs",this._usedCache,this,!0)}},{key:"_setScrollChanged",value:function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))}}],n&&w(e.prototype,n),i&&w(e,i),a}(p.Box);e.Panel=A,b.ILaya.regClass(A),T.ClassUtils.regClass("laya.ui.Panel",A),T.ClassUtils.regClass("Laya.Panel",A)},58336:function(t,e,n){"use strict";function i(t){return i="function"==typeof c&&"symbol"==typeof f?function(t){return typeof t}:function(t){return t&&"function"==typeof c&&t.constructor===c&&t!==c.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(9705),c=n(65420),f=n(98341);l(e,"__esModule",{value:!0}),e.ProgressBar=void 0;var _=x(n(85507)),d=x(n(21611)),p=n(89662),y=n(85096),v=n(93615),g=n(44476),m=n(41107),b=n(92493),T=n(23835);function x(t){return t&&t.__esModule?t:{default:t}}function w(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function k(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function C(t,e,n,i){return C="undefined"!=typeof Reflect&&h?h:function(t,e,n,i){var r,a=M(t,e);if(a){if((r=u(a,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=u(i,e)){if(!r.writable)return!1;r.value=n,l(i,e,r)}else!function(t,e,n){e in t?l(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0},C(t,e,n,i)}function E(t,e,n,i,r){if(!C(t,e,n,i||t)&&r)throw new Error("failed to set property");return n}function S(){return S="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=M(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},S.apply(this,arguments)}function M(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=A(t)););return t}function L(t,e){return L=a||function(t,e){return t.__proto__=e,t},L(t,e)}function R(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=A(t);if(e){var a=A(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return I(this,n)}}function I(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function A(t){return A=_.default?d.default:function(t){return t.__proto__||(0,d.default)(t)},A(t)}var D=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&L(t,e)}(a,t);var e,n,i,r=R(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return w(this,a),(t=r.call(this))._value=.5,t.skin=e,t}return e=a,n=[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];S(A(a.prototype),"destroy",this).call(this,t),this._bg&&this._bg.destroy(t),this._bar&&this._bar.destroy(t),this._bg=this._bar=null,this.changeHandler=null}},{key:"createChildren",value:function(){this.addChild(this._bg=new g.Image),this.addChild(this._bar=new g.Image),this._bar._bitmap.autoCacheCmd=!1}},{key:"skin",get:function(){return this._skin},set:function(t){this._skin!=t&&(this._skin=t,this._skin&&!y.Loader.getRes(this._skin)?b.ILaya.loader.load(this._skin,m.Handler.create(this,this._skinLoaded),null,y.Loader.IMAGE,1):this._skinLoaded())}},{key:"_skinLoaded",value:function(){this.destroyed||(this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue),this._sizeChanged(),this.event(p.Event.LOADED))}},{key:"measureWidth",value:function(){return this._bg.width}},{key:"measureHeight",value:function(){return this._bg.height}},{key:"value",get:function(){return this._value},set:function(t){this._value!=t&&(t=t>1?1:t<0?0:t,this._value=t,this.callLater(this.changeValue),this.event(p.Event.CHANGE),this.changeHandler&&this.changeHandler.runWith(t))}},{key:"changeValue",value:function(){if(this.sizeGrid){var t=this.sizeGrid.split(","),e=Number(t[3]),n=Number(t[1]),i=(this.width-e-n)*this._value;this._bar.width=e+n+i,this._bar.visible=this._bar.width>e+n}else this._bar.width=this.width*this._value}},{key:"bar",get:function(){return this._bar}},{key:"bg",get:function(){return this._bg}},{key:"sizeGrid",get:function(){return this._bg.sizeGrid},set:function(t){this._bg.sizeGrid=this._bar.sizeGrid=t}},{key:"width",get:function(){return S(A(a.prototype),"width",this)},set:function(t){E(A(a.prototype),"width",t,this,!0),this._bg.width=this._width,this.callLater(this.changeValue)}},{key:"height",get:function(){return S(A(a.prototype),"height",this)},set:function(t){E(A(a.prototype),"height",t,this,!0),this._bg.height=this._height,this._bar.height=this._height}},{key:"dataSource",get:function(){return S(A(a.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.value=Number(t):E(A(a.prototype),"dataSource",t,this,!0)}}],n&&k(e.prototype,n),i&&k(e,i),a}(v.UIComponent);e.ProgressBar=D,b.ILaya.regClass(D),T.ClassUtils.regClass("laya.ui.ProgressBar",D),T.ClassUtils.regClass("Laya.ProgressBar",D)},82201:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.Radio=void 0;var f=g(n(85507)),_=g(n(21611)),d=n(89662),p=n(33879),y=n(92493),v=n(23835);function g(t){return t&&t.__esModule?t:{default:t}}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function T(){return T="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=x(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},T.apply(this,arguments)}function x(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=E(t)););return t}function w(t,e){return w=a||function(t,e){return t.__proto__=e,t},w(t,e)}function k(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=E(t);if(e){var a=E(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return C(this,n)}}function C(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function E(t){return E=f.default?_.default:function(t){return t.__proto__||(0,_.default)(t)},E(t)}var S=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}(a,t);var e,n,i,r=k(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return m(this,a),(t=r.call(this,e,n)).toggle=!1,t._autoSize=!1,t}return e=a,n=[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];T(E(a.prototype),"destroy",this).call(this,t),this._value=null}},{key:"preinitialize",value:function(){T(E(a.prototype),"preinitialize",this).call(this),this.toggle=!1,this._autoSize=!1}},{key:"initialize",value:function(){T(E(a.prototype),"initialize",this).call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on(d.Event.CLICK,this,this.onClick)}},{key:"onClick",value:function(t){this.selected=!0}},{key:"value",get:function(){return null!=this._value?this._value:this.label},set:function(t){this._value=t}}],n&&b(e.prototype,n),i&&b(e,i),a}(p.Button);e.Radio=S,y.ILaya.regClass(S),v.ClassUtils.regClass("laya.ui.Radio",S),v.ClassUtils.regClass("Laya.Radio",S)},50250:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.RadioGroup=void 0;var h=y(n(85507)),c=y(n(21611)),f=n(9570),_=n(82201),d=n(92493),p=n(23835);function y(t){return t&&t.__esModule?t:{default:t}}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function m(t,e){return m=a||function(t,e){return t.__proto__=e,t},m(t,e)}function b(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return T(this,n)}}function T(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function x(t){return x=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},x(t)}var w=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(a,t);var e,n,i,r=b(a);function a(){return v(this,a),r.apply(this,arguments)}return e=a,(n=[{key:"createItem",value:function(t,e){return new _.Radio(t,e)}}])&&g(e.prototype,n),i&&g(e,i),a}(f.UIGroup);e.RadioGroup=w,d.ILaya.regClass(w),p.ClassUtils.regClass("laya.ui.RadioGroup",w),p.ClassUtils.regClass("Laya.RadioGroup",w)},2292:function(t,e,n){"use strict";function i(t){return i="function"==typeof c&&"symbol"==typeof f?function(t){return typeof t}:function(t){return t&&"function"==typeof c&&t.constructor===c&&t!==c.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(9705),l=n(34074),h=n(62734),c=n(65420),f=n(98341);s(e,"__esModule",{value:!0}),e.ScaleBox=void 0;var _=g(n(85507)),d=g(n(21611)),p=n(93408),y=n(92493),v=n(23835);function g(t){return t&&t.__esModule?t:{default:t}}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function T(){return T="undefined"!=typeof Reflect&&h?h:function(t,e,n){var i=k(t,e);if(i){var r=l(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},T.apply(this,arguments)}function x(t,e,n,i){return x="undefined"!=typeof Reflect&&u?u:function(t,e,n,i){var r,a=k(t,e);if(a){if((r=l(a,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=l(i,e)){if(!r.writable)return!1;r.value=n,s(i,e,r)}else!function(t,e,n){e in t?s(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0},x(t,e,n,i)}function w(t,e,n,i,r){if(!x(t,e,n,i||t)&&r)throw new Error("failed to set property");return n}function k(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=M(t)););return t}function C(t,e){return C=a||function(t,e){return t.__proto__=e,t},C(t,e)}function E(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=M(t);if(e){var a=M(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return S(this,n)}}function S(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function M(t){return M=_.default?d.default:function(t){return t.__proto__||(0,d.default)(t)},M(t)}var L=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&C(t,e)}(a,t);var e,n,i,r=E(a);function a(){var t;return m(this,a),(t=r.apply(this,arguments))._oldW=0,t._oldH=0,t}return e=a,(n=[{key:"onEnable",value:function(){y.ILaya.stage.on("resize",this,this.onResize),this.onResize()}},{key:"onDisable",value:function(){y.ILaya.stage.off("resize",this,this.onResize)}},{key:"onResize",value:function(){var t=y.ILaya.stage;if(this.width>0&&this.height>0){var e=Math.min(t.width/this._oldW,t.height/this._oldH);w(M(a.prototype),"width",t.width,this,!0),w(M(a.prototype),"height",t.height,this,!0),this.scale(e,e)}}},{key:"width",get:function(){return T(M(a.prototype),"width",this)},set:function(t){w(M(a.prototype),"width",t,this,!0),this._oldW=t}},{key:"height",get:function(){return T(M(a.prototype),"height",this)},set:function(t){w(M(a.prototype),"height",t,this,!0),this._oldH=t}}])&&b(e.prototype,n),i&&b(e,i),a}(p.Box);e.ScaleBox=L,y.ILaya.regClass(L),v.ClassUtils.regClass("laya.ui.ScaleBox",L),v.ClassUtils.regClass("Laya.ScaleBox",L)},72978:function(t,e,n){"use strict";function i(t){return i="function"==typeof c&&"symbol"==typeof f?function(t){return typeof t}:function(t){return t&&"function"==typeof c&&t.constructor===c&&t!==c.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(9705),c=n(65420),f=n(98341);l(e,"__esModule",{value:!0}),e.ScrollBar=void 0;var _=M(n(85507)),d=M(n(21611)),p=n(93615),y=n(33879),v=n(36895),g=n(14529),m=n(90335),b=n(89662),T=n(85399),x=n(85096),w=n(45840),k=n(41107),C=n(84221),E=n(92493),S=n(23835);function M(t){return t&&t.__esModule?t:{default:t}}function L(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function R(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function I(t,e,n,i){return I="undefined"!=typeof Reflect&&h?h:function(t,e,n,i){var r,a=B(t,e);if(a){if((r=u(a,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=u(i,e)){if(!r.writable)return!1;r.value=n,l(i,e,r)}else!function(t,e,n){e in t?l(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0},I(t,e,n,i)}function A(t,e,n,i,r){if(!I(t,e,n,i||t)&&r)throw new Error("failed to set property");return n}function D(){return D="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=B(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},D.apply(this,arguments)}function B(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=U(t)););return t}function P(t,e){return P=a||function(t,e){return t.__proto__=e,t},P(t,e)}function O(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=U(t);if(e){var a=U(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return F(this,n)}}function F(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function U(t){return U=_.default?d.default:function(t){return t.__proto__||(0,d.default)(t)},U(t)}var N=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&P(t,e)}(a,t);var e,n,i,r=O(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return L(this,a),(t=r.call(this)).rollRatio=.97,t.scaleBar=!0,t.autoHide=!1,t.elasticDistance=0,t.elasticBackTime=500,t._showButtons=g.UIConfig.showButtons,t._scrollSize=1,t._thumbPercent=1,t._lastOffset=0,t._checkElastic=!1,t._isElastic=!1,t._hide=!1,t._clickOnly=!0,t._touchScrollEnable=g.UIConfig.touchScrollEnable,t._mouseWheelEnable=g.UIConfig.mouseWheelEnable,t.skin=e,t.max=1,t}return e=a,n=[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.stopScroll(),this.target=null,D(U(a.prototype),"destroy",this).call(this,t),this.upButton&&this.upButton.destroy(t),this.downButton&&this.downButton.destroy(t),this.slider&&this.slider.destroy(t),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null}},{key:"createChildren",value:function(){this.addChild(this.slider=new v.Slider),this.addChild(this.upButton=new y.Button),this.addChild(this.downButton=new y.Button)}},{key:"initialize",value:function(){this.slider.showLabel=!1,this.slider.tick=0,this.slider.on(b.Event.CHANGE,this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on(b.Event.MOUSE_DOWN,this,this.onButtonMouseDown),this.downButton.on(b.Event.MOUSE_DOWN,this,this.onButtonMouseDown)}},{key:"onSliderChange",value:function(){this._value!=this.slider.value&&(this.value=this.slider.value)}},{key:"onButtonMouseDown",value:function(t){var e=t.currentTarget===this.upButton;this.slide(e),E.ILaya.timer.once(m.Styles.scrollBarDelayTime,this,this.startLoop,[e]),E.ILaya.stage.once(b.Event.MOUSE_UP,this,this.onStageMouseUp)}},{key:"startLoop",value:function(t){E.ILaya.timer.frameLoop(1,this,this.slide,[t])}},{key:"slide",value:function(t){t?this.value-=this._scrollSize:this.value+=this._scrollSize}},{key:"onStageMouseUp",value:function(t){E.ILaya.timer.clear(this,this.startLoop),E.ILaya.timer.clear(this,this.slide)}},{key:"skin",get:function(){return this._skin},set:function(t){" "!=t&&this._skin!=t&&(this._skin=t,this._skin&&!x.Loader.getRes(this._skin)?E.ILaya.loader.load([this._skin,this._skin.replace(".png","$up.png"),this._skin.replace(".png","$down.png"),this._skin.replace(".png","$bar.png")],k.Handler.create(this,this._skinLoaded)):this._skinLoaded())}},{key:"_skinLoaded",value:function(){this.destroyed||(this.slider.skin=this._skin,this.callLater(this.changeScrollBar),this._sizeChanged(),this.event(b.Event.LOADED))}},{key:"changeScrollBar",value:function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()}},{key:"_sizeChanged",value:function(){D(U(a.prototype),"_sizeChanged",this).call(this),this.repaint(),this.resetPositions(),this.event(b.Event.CHANGE),this.changeHandler&&this.changeHandler.runWith(this.value)}},{key:"resetPositions",value:function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()}},{key:"resetButtonPosition",value:function(){this.slider.isVertical?this.downButton.y=this.slider._y+this.slider.height:this.downButton.x=this.slider._x+this.slider.width}},{key:"measureWidth",value:function(){return this.slider.isVertical?this.slider.width:100}},{key:"measureHeight",value:function(){return this.slider.isVertical?100:this.slider.height}},{key:"setScroll",value:function(t,e,n){this.runCallLater(this._sizeChanged),this.slider.setSlider(t,e,n),this.slider.bar.visible=e>0,!this._hide&&this.autoHide&&(this.visible=!1)}},{key:"max",get:function(){return this.slider.max},set:function(t){this.slider.max=t}},{key:"min",get:function(){return this.slider.min},set:function(t){this.slider.min=t}},{key:"value",get:function(){return this._value},set:function(t){t!==this._value&&(this._value=t,this._isElastic||(this.slider._value!=t&&(this.slider._value=t,this.slider.changeValue()),this._value=this.slider._value),this.event(b.Event.CHANGE),this.changeHandler&&this.changeHandler.runWith(this._value))}},{key:"isVertical",get:function(){return this.slider.isVertical},set:function(t){this.slider.isVertical=t}},{key:"sizeGrid",get:function(){return this.slider.sizeGrid},set:function(t){this.slider.sizeGrid=t}},{key:"scrollSize",get:function(){return this._scrollSize},set:function(t){this._scrollSize=t}},{key:"dataSource",get:function(){return D(U(a.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.value=Number(t):A(U(a.prototype),"dataSource",t,this,!0)}},{key:"thumbPercent",get:function(){return this._thumbPercent},set:function(t){this.runCallLater(this.changeScrollBar),this.runCallLater(this._sizeChanged),t=t>=1?.99:t,this._thumbPercent=t,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*t,m.Styles.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*t,m.Styles.scrollBarMinNum))}},{key:"target",get:function(){return this._target},set:function(t){this._target&&(this._target.off(b.Event.MOUSE_WHEEL,this,this.onTargetMouseWheel),this._target.off(b.Event.MOUSE_DOWN,this,this.onTargetMouseDown)),this._target=t,t&&(this._mouseWheelEnable&&this._target.on(b.Event.MOUSE_WHEEL,this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on(b.Event.MOUSE_DOWN,this,this.onTargetMouseDown))}},{key:"hide",get:function(){return this._hide},set:function(t){this._hide=t,this.visible=!t}},{key:"showButtons",get:function(){return this._showButtons},set:function(t){this._showButtons=t,this.callLater(this.changeScrollBar)}},{key:"touchScrollEnable",get:function(){return this._touchScrollEnable},set:function(t){this._touchScrollEnable=t,this.target=this._target}},{key:"mouseWheelEnable",get:function(){return this._mouseWheelEnable},set:function(t){this._mouseWheelEnable=t,this.target=this._target}},{key:"onTargetMouseWheel",value:function(t){this.value-=t.delta*this._scrollSize,this.target=this._target}},{key:"onTargetMouseDown",value:function(t){this.isLockedFun&&!this.isLockedFun(t)||(this.event(b.Event.END),this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new T.Point),this._lastPoint.setTo(E.ILaya.stage.mouseX,E.ILaya.stage.mouseY),E.ILaya.timer.clear(this,this.tweenMove),C.Tween.clearTween(this),E.ILaya.stage.once(b.Event.MOUSE_UP,this,this.onStageMouseUp2),E.ILaya.stage.once(b.Event.MOUSE_OUT,this,this.onStageMouseUp2),E.ILaya.timer.frameLoop(1,this,this.loop))}},{key:"startDragForce",value:function(){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new T.Point),this._lastPoint.setTo(E.ILaya.stage.mouseX,E.ILaya.stage.mouseY),E.ILaya.timer.clear(this,this.tweenMove),C.Tween.clearTween(this),E.ILaya.stage.once(b.Event.MOUSE_UP,this,this.onStageMouseUp2),E.ILaya.stage.once(b.Event.MOUSE_OUT,this,this.onStageMouseUp2),E.ILaya.timer.frameLoop(1,this,this.loop)}},{key:"cancelDragOp",value:function(){E.ILaya.stage.off(b.Event.MOUSE_UP,this,this.onStageMouseUp2),E.ILaya.stage.off(b.Event.MOUSE_OUT,this,this.onStageMouseUp2),E.ILaya.timer.clear(this,this.tweenMove),E.ILaya.timer.clear(this,this.loop),this._target.mouseEnabled=!0}},{key:"checkTriggers",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.value>=0&&this.value-this._lastOffset<=0&&this.triggerDownDragLimit&&this.triggerDownDragLimit(t)?(this.cancelDragOp(),this.value=0,!0):!!(this.value<=this.max&&this.value-this._lastOffset>=this.max&&this.triggerUpDragLimit&&this.triggerUpDragLimit(t))&&(this.cancelDragOp(),this.value=this.max,!0)}},{key:"lastOffset",get:function(){return this._lastOffset}},{key:"startTweenMoveForce",value:function(t){this._lastOffset=t,E.ILaya.timer.frameLoop(1,this,this.tweenMove,[200])}},{key:"loop",value:function(){var t=E.ILaya.stage.mouseY,e=E.ILaya.stage.mouseX;if(this._lastOffset=this.isVertical?t-this._lastPoint.y:e-this._lastPoint.x,this._clickOnly){if(!(Math.abs(this._lastOffset*(this.isVertical?E.ILaya.stage._canvasTransform.getScaleY():E.ILaya.stage._canvasTransform.getScaleX()))>1))return;if(this._clickOnly=!1,this.checkTriggers())return;this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event(b.Event.START)}else if(this.checkTriggers())return;this._offsets.push(this._lastOffset),this._lastPoint.x=e,this._lastPoint.y=t,0!==this._lastOffset&&(this._checkElastic||(this.elasticDistance>0?this._checkElastic||0==this._lastOffset||(this._lastOffset>0&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this._lastOffset>0?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):(this.value-=.5*this._lastOffset,this._value>=this.min&&(this._checkElastic=!1)):this._value>=this.max&&(this._lastOffset<0?this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance):(this.value-=.5*this._lastOffset,this._value<=this.max&&(this._checkElastic=!1))):this.value-=this._lastOffset)}},{key:"onStageMouseUp2",value:function(t){if(E.ILaya.stage.off(b.Event.MOUSE_UP,this,this.onStageMouseUp2),E.ILaya.stage.off(b.Event.MOUSE_OUT,this,this.onStageMouseUp2),E.ILaya.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?C.Tween.to(this,{value:this.min},this.elasticBackTime,w.Ease.sineOut,k.Handler.create(this,this.elasticOver)):this._value>this.max&&C.Tween.to(this,{value:this.max},this.elasticBackTime,w.Ease.sineOut,k.Handler.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?E.ILaya.stage.mouseY-this._lastPoint.y:E.ILaya.stage.mouseX-this._lastPoint.x);for(var e=0,n=Math.min(this._offsets.length,3),i=0;i<n;i++)e+=this._offsets[this._offsets.length-1-i];if(this._lastOffset=e/n,(e=Math.abs(this._lastOffset))<2)return void this.event(b.Event.END);e>250&&(this._lastOffset=this._lastOffset>0?250:-250);var r=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/150)));E.ILaya.timer.frameLoop(1,this,this.tweenMove,[r])}}},{key:"elasticOver",value:function(){this._isElastic=!1,!this.hide&&this.autoHide&&C.Tween.to(this,{alpha:0},500),this.event(b.Event.END)}},{key:"tweenMove",value:function(t){var e;if(this._lastOffset*=this.rollRatio,!this.checkTriggers(!0)&&(t>0&&(this._lastOffset>0&&this.value<=this.min?(this._isElastic=!0,e=.5*-(this.min-t-this.value),this._lastOffset>e&&(this._lastOffset=e)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,e=.5*-(this.max+t-this.value),this._lastOffset<e&&(this._lastOffset=e))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<.1)){if(E.ILaya.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?C.Tween.to(this,{value:this.min},this.elasticBackTime,w.Ease.sineOut,k.Handler.create(this,this.elasticOver)):this._value>this.max?C.Tween.to(this,{value:this.max},this.elasticBackTime,w.Ease.sineOut,k.Handler.create(this,this.elasticOver)):this.elasticOver());this.event(b.Event.END),!this.hide&&this.autoHide&&C.Tween.to(this,{alpha:0},500)}}},{key:"stopScroll",value:function(){this.onStageMouseUp2(null),E.ILaya.timer.clear(this,this.tweenMove),C.Tween.clearTween(this)}},{key:"tick",get:function(){return this.slider.tick},set:function(t){this.slider.tick=t}}],n&&R(e.prototype,n),i&&R(e,i),a}(p.UIComponent);e.ScrollBar=N,E.ILaya.regClass(N),S.ClassUtils.regClass("laya.ui.ScrollBar",N),S.ClassUtils.regClass("Laya.ScrollBar",N)},36895:function(t,e,n){"use strict";function i(t){return i="function"==typeof c&&"symbol"==typeof f?function(t){return typeof t}:function(t){return t&&"function"==typeof c&&t.constructor===c&&t!==c.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(9705),c=n(65420),f=n(98341);l(e,"__esModule",{value:!0}),e.Slider=void 0;var _=C(n(85507)),d=C(n(21611)),p=n(93615),y=n(96530),v=n(44476),g=n(33879),m=n(89662),b=n(85399),T=n(85096),x=n(41107),w=n(92493),k=n(23835);function C(t){return t&&t.__esModule?t:{default:t}}function E(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function S(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function M(t,e,n,i){return M="undefined"!=typeof Reflect&&h?h:function(t,e,n,i){var r,a=I(t,e);if(a){if((r=u(a,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=u(i,e)){if(!r.writable)return!1;r.value=n,l(i,e,r)}else!function(t,e,n){e in t?l(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0},M(t,e,n,i)}function L(t,e,n,i,r){if(!M(t,e,n,i||t)&&r)throw new Error("failed to set property");return n}function R(){return R="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=I(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},R.apply(this,arguments)}function I(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=P(t)););return t}function A(t,e){return A=a||function(t,e){return t.__proto__=e,t},A(t,e)}function D(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=P(t);if(e){var a=P(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return B(this,n)}}function B(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function P(t){return P=_.default?d.default:function(t){return t.__proto__||(0,d.default)(t)},P(t)}var O=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&A(t,e)}(a,t);var e,n,i,r=D(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return E(this,a),(t=r.call(this)).isVertical=!0,t.showLabel=!0,t._max=100,t._min=0,t._tick=1,t._value=0,a.label||(a.label=new y.Label),t.skin=e,t}return e=a,n=[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];R(P(a.prototype),"destroy",this).call(this,t),this._bg&&this._bg.destroy(t),this._bar&&this._bar.destroy(t),this._progress&&this._progress.destroy(t),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null}},{key:"createChildren",value:function(){this.addChild(this._bg=new v.Image),this.addChild(this._bar=new g.Button)}},{key:"initialize",value:function(){this._bar.on(m.Event.MOUSE_DOWN,this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0}},{key:"onBarMouseDown",value:function(t){var e=w.ILaya;this._globalSacle||(this._globalSacle=new b.Point),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=e.stage.mouseX,this._ty=e.stage.mouseY,e.stage.on(m.Event.MOUSE_MOVE,this,this.mouseMove),e.stage.once(m.Event.MOUSE_UP,this,this.mouseUp),e.stage.once(m.Event.MOUSE_OUT,this,this.mouseUp),this.showValueText()}},{key:"showValueText",value:function(){if(this.showLabel){var t=a.label;this.addChild(t),t.textField.changeText(this._value+""),this.isVertical?(t.x=this._bar._x+20,t.y=.5*(this._bar.height-t.height)+this._bar._y):(t.y=this._bar._y-20,t.x=.5*(this._bar.width-t.width)+this._bar._x)}}},{key:"hideValueText",value:function(){a.label&&a.label.removeSelf()}},{key:"mouseUp",value:function(t){var e=w.ILaya.stage;e.off(m.Event.MOUSE_MOVE,this,this.mouseMove),e.off(m.Event.MOUSE_UP,this,this.mouseUp),e.off(m.Event.MOUSE_OUT,this,this.mouseUp),this.sendChangeEvent(m.Event.CHANGED),this.hideValueText()}},{key:"mouseMove",value:function(t){var e=w.ILaya.stage,n=this._value;if(this.isVertical?(this._bar.y+=(e.mouseY-this._ty)/this._globalSacle.y,this._bar._y>this._maxMove?this._bar.y=this._maxMove:this._bar._y<0&&(this._bar.y=0),this._value=this._bar._y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar._y+.5*this._bar.height)):(this._bar.x+=(e.mouseX-this._tx)/this._globalSacle.x,this._bar._x>this._maxMove?this._bar.x=this._maxMove:this._bar._x<0&&(this._bar.x=0),this._value=this._bar._x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar._x+.5*this._bar.width)),this._tx=e.mouseX,this._ty=e.mouseY,0!=this._tick){var i=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*i)/i}this._value!=n&&this.sendChangeEvent(),this.showValueText()}},{key:"sendChangeEvent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m.Event.CHANGE;this.event(t),this.changeHandler&&this.changeHandler.runWith(this._value)}},{key:"skin",get:function(){return this._skin},set:function(t){this._skin!=t&&(this._skin=t,this._skin&&!T.Loader.getRes(this._skin)?w.ILaya.loader.load([this._skin,this._skin.replace(".png","$bar.png")],x.Handler.create(this,this._skinLoaded)):this._skinLoaded())}},{key:"_skinLoaded",value:function(){this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var t=this._skin.replace(".png","$progress.png");T.Loader.getRes(t)&&(this._progress||(this.addChild(this._progress=new v.Image),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=t),this.setBarPoint(),this.callLater(this.changeValue),this._sizeChanged(),this.event(m.Event.LOADED)}},{key:"setBarPoint",value:function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))}},{key:"measureWidth",value:function(){return Math.max(this._bg.width,this._bar.width)}},{key:"measureHeight",value:function(){return Math.max(this._bg.height,this._bar.height)}},{key:"_sizeChanged",value:function(){R(P(a.prototype),"_sizeChanged",this).call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()}},{key:"sizeGrid",get:function(){return this._bg.sizeGrid},set:function(t){this._bg.sizeGrid=t,this._bar.sizeGrid=t,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}},{key:"setSlider",value:function(t,e,n){this._value=-1,this._min=t,this._max=e>t?e:t,this.value=n<t?t:n>e?e:n}},{key:"tick",get:function(){return this._tick},set:function(t){this._tick!=t&&(this._tick=t,this.callLater(this.changeValue))}},{key:"changeValue",value:function(){if(0!=this.tick){var t=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*t)/t}this._max>=this._max?this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value:this._value=this._value>this._min?this._min:this._value<this._max?this._max:this._value;var e=this._max-this._min;0===e&&(e=1),this.isVertical?(this._bar.y=(this._value-this._min)/e*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar._y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/e*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar._x+.5*this._bar.width))}},{key:"max",get:function(){return this._max},set:function(t){this._max!=t&&(this._max=t,this.callLater(this.changeValue))}},{key:"min",get:function(){return this._min},set:function(t){this._min!=t&&(this._min=t,this.callLater(this.changeValue))}},{key:"value",get:function(){return this._value},set:function(t){if(this._value!=t){var e=this._value;this._value=t,this.changeValue(),this._value!=e&&this.sendChangeEvent()}}},{key:"allowClickBack",get:function(){return this._allowClickBack},set:function(t){this._allowClickBack!=t&&(this._allowClickBack=t,t?this._bg.on(m.Event.MOUSE_DOWN,this,this.onBgMouseDown):this._bg.off(m.Event.MOUSE_DOWN,this,this.onBgMouseDown))}},{key:"onBgMouseDown",value:function(t){var e=this._bg.getMousePoint();this.isVertical?this.value=e.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=e.x/(this.width-this._bar.width)*(this._max-this._min)+this._min}},{key:"dataSource",get:function(){return R(P(a.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.value=Number(t):L(P(a.prototype),"dataSource",t,this,!0)}},{key:"bar",get:function(){return this._bar}}],n&&S(e.prototype,n),i&&S(e,i),a}(p.UIComponent);e.Slider=O,O.label=null,w.ILaya.regClass(O),k.ClassUtils.regClass("laya.ui.Slider",O),k.ClassUtils.regClass("Laya.Slider",O)},90335:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Styles=void 0;var i=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)};e.Styles=i,i.defaultSizeGrid=[4,4,4,4,0],i.labelColor="#000000",i.labelPadding=[2,2,2,2],i.inputLabelPadding=[1,1,1,3],i.buttonStateNum=3,i.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"],i.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"],i.scrollBarMinNum=15,i.scrollBarDelayTime=500},51931:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.Tab=void 0;var h=y(n(85507)),c=y(n(21611)),f=n(33879),_=n(9570),d=n(92493),p=n(23835);function y(t){return t&&t.__esModule?t:{default:t}}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function m(t,e){return m=a||function(t,e){return t.__proto__=e,t},m(t,e)}function b(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return T(this,n)}}function T(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function x(t){return x=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},x(t)}var w=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(a,t);var e,n,i,r=b(a);function a(){return v(this,a),r.apply(this,arguments)}return e=a,(n=[{key:"createItem",value:function(t,e){return new f.Button(t,e)}}])&&g(e.prototype,n),i&&g(e,i),a}(_.UIGroup);e.Tab=w,d.ILaya.regClass(w),p.ClassUtils.regClass("laya.ui.Tab",w),p.ClassUtils.regClass("Laya.Tab",w)},52357:function(t,e,n){"use strict";function i(t){return i="function"==typeof c&&"symbol"==typeof f?function(t){return typeof t}:function(t){return t&&"function"==typeof c&&t.constructor===c&&t!==c.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(9705),c=n(65420),f=n(98341);l(e,"__esModule",{value:!0}),e.TextArea=void 0;var _=x(n(85507)),d=x(n(21611)),p=n(89658),y=n(37277),v=n(8255),g=n(90335),m=n(89662),b=n(92493),T=n(23835);function x(t){return t&&t.__esModule?t:{default:t}}function w(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function k(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function C(t,e,n,i){return C="undefined"!=typeof Reflect&&h?h:function(t,e,n,i){var r,a=M(t,e);if(a){if((r=u(a,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=u(i,e)){if(!r.writable)return!1;r.value=n,l(i,e,r)}else!function(t,e,n){e in t?l(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0},C(t,e,n,i)}function E(t,e,n,i,r){if(!C(t,e,n,i||t)&&r)throw new Error("failed to set property");return n}function S(){return S="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=M(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},S.apply(this,arguments)}function M(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=D(t)););return t}function L(t,e){return L=a||function(t,e){return t.__proto__=e,t},L(t,e)}function R(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=D(t);if(e){var a=D(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return I(this,n)}}function I(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return A(t)}function A(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function D(t){return D=_.default?d.default:function(t){return t.__proto__||(0,d.default)(t)},D(t)}var B=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&L(t,e)}(a,t);var e,n,i,r=R(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return w(this,a),(t=r.call(this,e)).on(m.Event.CHANGE,A(t),t._onTextChange),t}return e=a,n=[{key:"_onTextChange",value:function(){this.callLater(this.changeScroll)}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null,S(D(a.prototype),"destroy",this).call(this,t)}},{key:"initialize",value:function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0}},{key:"width",get:function(){return S(D(a.prototype),"width",this)},set:function(t){E(D(a.prototype),"width",t,this,!0),this.callLater(this.changeScroll)}},{key:"height",get:function(){return S(D(a.prototype),"height",this)},set:function(t){E(D(a.prototype),"height",t,this,!0),this.callLater(this.changeScroll)}},{key:"vScrollBarSkin",get:function(){return this._vScrollBar?this._vScrollBar.skin:null},set:function(t){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new y.VScrollBar),this._vScrollBar.on(m.Event.CHANGE,this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=t}},{key:"hScrollBarSkin",get:function(){return this._hScrollBar?this._hScrollBar.skin:null},set:function(t){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new v.HScrollBar),this._hScrollBar.on(m.Event.CHANGE,this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=t}},{key:"onVBarChanged",value:function(t){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)}},{key:"onHBarChanged",value:function(t){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)}},{key:"vScrollBar",get:function(){return this._vScrollBar}},{key:"hScrollBar",get:function(){return this._hScrollBar}},{key:"maxScrollY",get:function(){return this._tf.maxScrollY}},{key:"scrollY",get:function(){return this._tf.scrollY}},{key:"maxScrollX",get:function(){return this._tf.maxScrollX}},{key:"scrollX",get:function(){return this._tf.scrollX}},{key:"changeScroll",value:function(){var t=this._vScrollBar&&this._tf.maxScrollY>0,e=this._hScrollBar&&this._tf.maxScrollX>0,n=t?this._width-this._vScrollBar.width:this._width,i=e?this._height-this._hScrollBar.height:this._height,r=this._tf.padding||g.Styles.labelPadding;this._tf.width=n,this._tf.height=i,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-r[2],this._vScrollBar.y=r[1],this._vScrollBar.height=this._height-(e?this._hScrollBar.height:0)-r[1]-r[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=i/Math.max(this._tf.textHeight,i),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=t),this._hScrollBar&&(this._hScrollBar.x=r[0],this._hScrollBar.y=this._height-this._hScrollBar.height-r[3],this._hScrollBar.width=this._width-(t?this._vScrollBar.width:0)-r[0]-r[2],this._hScrollBar.scrollSize=Math.max(.033*n,1),this._hScrollBar.thumbPercent=n/Math.max(this._tf.textWidth,n),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=e)}},{key:"scrollTo",value:function(t){this.commitMeasure(),this._tf.scrollY=t}}],n&&k(e.prototype,n),i&&k(e,i),a}(p.TextInput);e.TextArea=B,b.ILaya.regClass(B),T.ClassUtils.regClass("laya.ui.TextArea",B),T.ClassUtils.regClass("Laya.TextArea",B)},89658:function(t,e,n){"use strict";function i(t){return i="function"==typeof c&&"symbol"==typeof f?function(t){return typeof t}:function(t){return t&&"function"==typeof c&&t.constructor===c&&t!==c.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(9705),c=n(65420),f=n(98341);l(e,"__esModule",{value:!0}),e.TextInput=void 0;var _=C(n(85507)),d=C(n(21611)),p=n(96530),y=n(61891),v=n(89662),g=n(85096),m=n(21995),b=n(90335),T=n(6642),x=n(41107),w=n(92493),k=n(23835);function C(t){return t&&t.__esModule?t:{default:t}}function E(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function S(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function M(t,e,n,i){return M="undefined"!=typeof Reflect&&h?h:function(t,e,n,i){var r,a=I(t,e);if(a){if((r=u(a,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=u(i,e)){if(!r.writable)return!1;r.value=n,l(i,e,r)}else!function(t,e,n){e in t?l(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0},M(t,e,n,i)}function L(t,e,n,i,r){if(!M(t,e,n,i||t)&&r)throw new Error("failed to set property");return n}function R(){return R="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=I(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},R.apply(this,arguments)}function I(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=P(t)););return t}function A(t,e){return A=a||function(t,e){return t.__proto__=e,t},A(t,e)}function D(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=P(t);if(e){var a=P(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return B(this,n)}}function B(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function P(t){return P=_.default?d.default:function(t){return t.__proto__||(0,d.default)(t)},P(t)}var O=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&A(t,e)}(a,t);var e,n,i,r=D(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return E(this,a),(t=r.call(this)).text=e,t.skin=t.skin,t}return e=a,n=[{key:"preinitialize",value:function(){this.mouseEnabled=!0}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];R(P(a.prototype),"destroy",this).call(this,t),this._bg&&this._bg.destroy(),this._bg=null}},{key:"createChildren",value:function(){this.addChild(this._tf=new y.Input),this._tf.padding=b.Styles.inputLabelPadding,this._tf.on(v.Event.INPUT,this,this._onInput),this._tf.on(v.Event.ENTER,this,this._onEnter),this._tf.on(v.Event.BLUR,this,this._onBlur),this._tf.on(v.Event.FOCUS,this,this._onFocus)}},{key:"_onFocus",value:function(){this.event(v.Event.FOCUS,this)}},{key:"_onBlur",value:function(){this.event(v.Event.BLUR,this)}},{key:"_onInput",value:function(){this.event(v.Event.INPUT,this)}},{key:"_onEnter",value:function(){this.event(v.Event.ENTER,this)}},{key:"initialize",value:function(){this.width=128,this.height=22}},{key:"bg",get:function(){return this._bg},set:function(t){this.graphics=this._bg=t}},{key:"skin",get:function(){return this._skin},set:function(t){this._skin!=t&&(this._skin=t,this._skin&&!g.Loader.getRes(this._skin)?w.ILaya.loader.load(this._skin,x.Handler.create(this,this._skinLoaded),null,g.Loader.IMAGE,1):this._skinLoaded())}},{key:"_skinLoaded",value:function(){this._bg||(this.graphics=this._bg=new m.AutoBitmap),this._bg.source=g.Loader.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height),this._sizeChanged(),this.event(v.Event.LOADED)}},{key:"sizeGrid",get:function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},set:function(t){this._bg||(this.graphics=this._bg=new m.AutoBitmap),this._bg.sizeGrid=T.UIUtils.fillArray(b.Styles.defaultSizeGrid,t,Number)}},{key:"text",get:function(){return R(P(a.prototype),"text",this)},set:function(t){this._tf.text!=t&&(t+="",this._tf.text=t,this.event(v.Event.CHANGE))}},{key:"width",get:function(){return R(P(a.prototype),"width",this)},set:function(t){L(P(a.prototype),"width",t,this,!0),this._bg&&(this._bg.width=t)}},{key:"height",get:function(){return R(P(a.prototype),"height",this)},set:function(t){L(P(a.prototype),"height",t,this,!0),this._bg&&(this._bg.height=t)}},{key:"multiline",get:function(){return this._tf.multiline},set:function(t){this._tf.multiline=t}},{key:"editable",get:function(){return this._tf.editable},set:function(t){this._tf.editable=t}},{key:"select",value:function(){this._tf.select()}},{key:"restrict",get:function(){return this._tf.restrict},set:function(t){this._tf.restrict=t}},{key:"prompt",get:function(){return this._tf.prompt},set:function(t){this._tf.prompt=t}},{key:"promptColor",get:function(){return this._tf.promptColor},set:function(t){this._tf.promptColor=t}},{key:"maxChars",get:function(){return this._tf.maxChars},set:function(t){this._tf.maxChars=t}},{key:"focus",get:function(){return this._tf.focus},set:function(t){this._tf.focus=t}},{key:"type",get:function(){return this._tf.type},set:function(t){this._tf.type=t}},{key:"setSelection",value:function(t,e){this._tf.setSelection(t,e)}}],n&&S(e.prototype,n),i&&S(e,i),a}(p.Label);e.TextInput=O,w.ILaya.regClass(O),k.ClassUtils.regClass("laya.ui.TextInput",O),k.ClassUtils.regClass("Laya.TextInput",O)},61241:function(t,e,n){"use strict";function i(t){return i="function"==typeof _&&"symbol"==typeof y?function(t){return typeof t}:function(t){return t&&"function"==typeof _&&t.constructor===_&&t!==_.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(9705),c=n(3649),f=n(66419),_=n(65420),d=n(19996),p=n(41511),y=n(98341);l(e,"__esModule",{value:!0}),e.Tree=void 0;var v=E(n(81643)),g=E(n(85507)),m=E(n(21611)),b=n(93408),T=n(75485),x=n(89662),w=n(41107),k=n(92493),C=n(23835);function E(t){return t&&t.__esModule?t:{default:t}}function S(t,e){var n=void 0!==_&&d(t)||t["@@iterator"];if(!n){if(p(t)||(n=function(t,e){var n;if(!t)return;if("string"==typeof t)return M(t,e);var i=c(n=Object.prototype.toString.call(t)).call(n,8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return f(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return M(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function M(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function L(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function R(t,e,n,i){return R="undefined"!=typeof Reflect&&h?h:function(t,e,n,i){var r,a=D(t,e);if(a){if((r=u(a,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=u(i,e)){if(!r.writable)return!1;r.value=n,l(i,e,r)}else!function(t,e,n){e in t?l(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0},R(t,e,n,i)}function I(t,e,n,i,r){if(!R(t,e,n,i||t)&&r)throw new Error("failed to set property");return n}function A(){return A="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=D(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},A.apply(this,arguments)}function D(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=F(t)););return t}function B(t,e){return B=a||function(t,e){return t.__proto__=e,t},B(t,e)}function P(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=F(t);if(e){var a=F(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return O(this,n)}}function O(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function F(t){return F=g.default?m.default:function(t){return t.__proto__||(0,m.default)(t)},F(t)}var U=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&B(t,e)}(a,t);var e,n,i,r=P(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this))._spaceLeft=10,t._spaceBottom=0,t._keepStatus=!0,t.width=t.height=200,t}return e=a,n=[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];A(F(a.prototype),"destroy",this).call(this,t),this._list&&this._list.destroy(t),this._list=null,this._source=null,this._renderHandler=null}},{key:"createChildren",value:function(){this.addChild(this._list=new T.List),this._list.renderHandler=w.Handler.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on(x.Event.CHANGE,this,this.onListChange)}},{key:"onListChange",value:function(){this.event(x.Event.CHANGE)}},{key:"keepStatus",get:function(){return this._keepStatus},set:function(t){this._keepStatus=t}},{key:"array",get:function(){return this._list.array},set:function(t){this._keepStatus&&this._list.array&&t&&this.parseOpenStatus(this._list.array,t),this._source=t,this._list.array=this.getArray()}},{key:"source",get:function(){return this._source}},{key:"list",get:function(){return this._list}},{key:"itemRender",get:function(){return this._list.itemRender},set:function(t){this._list.itemRender=t}},{key:"scrollBarSkin",get:function(){return this._list.vScrollBarSkin},set:function(t){this._list.vScrollBarSkin=t}},{key:"scrollBar",get:function(){return this._list.scrollBar}},{key:"mouseHandler",get:function(){return this._list.mouseHandler},set:function(t){this._list.mouseHandler=t}},{key:"renderHandler",get:function(){return this._renderHandler},set:function(t){this._renderHandler=t}},{key:"spaceLeft",get:function(){return this._spaceLeft},set:function(t){this._spaceLeft=t}},{key:"spaceBottom",get:function(){return this._list.spaceY},set:function(t){this._list.spaceY=t}},{key:"selectedIndex",get:function(){return this._list.selectedIndex},set:function(t){this._list.selectedIndex=t}},{key:"selectedItem",get:function(){return this._list.selectedItem},set:function(t){this._list.selectedItem=t}},{key:"width",get:function(){return A(F(a.prototype),"width",this)},set:function(t){I(F(a.prototype),"width",t,this,!0),this._list.width=t}},{key:"height",get:function(){return A(F(a.prototype),"height",this)},set:function(t){I(F(a.prototype),"height",t,this,!0),this._list.height=t}},{key:"getArray",value:function(){var t=[];for(var e in this._source){var n=this._source[e];this.getParentOpenStatus(n)&&(n.x=this._spaceLeft*this.getDepth(n),t.push(n))}return t}},{key:"getDepth",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null==t.nodeParent?e:this.getDepth(t.nodeParent,e+1)}},{key:"getParentOpenStatus",value:function(t){var e=t.nodeParent;return null==e||!!e.isOpen&&(null==e.nodeParent||this.getParentOpenStatus(e))}},{key:"renderItem",value:function(t,e){var n=t.dataSource;if(n){t.left=n.x;var i=t.getChildByName("arrow");i&&(n.hasChild?(i.visible=!0,i.index=n.isOpen?1:0,i.tag=e,i.off(x.Event.CLICK,this,this.onArrowClick),i.on(x.Event.CLICK,this,this.onArrowClick)):i.visible=!1);var r=t.getChildByName("folder");r&&(2==r.clipY?r.index=n.isDirectory?0:1:r.index=n.isDirectory?n.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([t,e])}}},{key:"onArrowClick",value:function(t){var e=t.currentTarget.tag;this._list.array[e].isOpen=!this._list.array[e].isOpen,this.event(x.Event.OPEN),this._list.array=this.getArray()}},{key:"setItemState",value:function(t,e){this._list.array[t]&&(this._list.array[t].isOpen=e,this._list.array=this.getArray())}},{key:"fresh",value:function(){this._list.array=this.getArray(),this.repaint()}},{key:"dataSource",get:function(){return A(F(a.prototype),"dataSource",this)},set:function(t){this._dataSource=t,I(F(a.prototype),"dataSource",t,this,!0)}},{key:"xml",set:function(t){var e=[];this.parseXml(t.childNodes[0],e,null,!0),this.array=e}},{key:"parseXml",value:function(t,e,n,i){var r,a=t.childNodes,o=a.length;if(!i){r={};var s=t.attributes;for(var u in s){var l=s[u],h=l.nodeName,c=l.nodeValue;r[h]="true"==c||"false"!=c&&c}r.nodeParent=n,o>0&&(r.isDirectory=!0),r.hasChild=o>0,e.push(r)}for(var f=0;f<o;f++){var _=a[f];this.parseXml(_,e,r,!1)}}},{key:"parseOpenStatus",value:function(t,e){for(var n=0,i=e.length;n<i;n++){var r=e[n];if(r.isDirectory)for(var a=0,o=t.length;a<o;a++){var s=t[a];if(s.isDirectory&&this.isSameParent(s,r)&&r.label==s.label){r.isOpen=s.isOpen;break}}}}},{key:"isSameParent",value:function(t,e){return null==t.nodeParent&&null==e.nodeParent||null!=t.nodeParent&&null!=e.nodeParent&&t.nodeParent.label==e.nodeParent.label&&this.isSameParent(t.nodeParent,e.nodeParent)}},{key:"selectedPath",get:function(){return this._list.selectedItem?this._list.selectedItem.path:null}},{key:"filter",value:function(t){if(Boolean(t)){var e=[];this.getFilterSource(this._source,e,t),this._list.array=e}else this._list.array=this.getArray()}},{key:"getFilterSource",value:function(t,e,n){n=n.toLocaleLowerCase();var i,r=S(t);try{for(r.s();!(i=r.n()).done;){var a,o=i.value;!o.isDirectory&&(0,v.default)(a=String(o.label).toLowerCase()).call(a,n)>-1&&(o.x=0,e.push(o)),o.child&&o.child.length>0&&this.getFilterSource(o.child,e,n)}}catch(t){r.e(t)}finally{r.f()}}}],n&&L(e.prototype,n),i&&L(e,i),a}(b.Box);e.Tree=U,k.ILaya.regClass(U),C.ClassUtils.regClass("laya.ui.Tree",U),C.ClassUtils.regClass("Laya.Tree",U)},93615:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.UIComponent=void 0;var f=T(n(85507)),_=T(n(21611)),d=n(72601),p=n(60082),y=n(6642),v=n(78362),g=n(89662),m=n(92493),b=n(23835);function T(t){return t&&t.__esModule?t:{default:t}}function x(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function k(){return k="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=C(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},k.apply(this,arguments)}function C(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=L(t)););return t}function E(t,e){return E=a||function(t,e){return t.__proto__=e,t},E(t,e)}function S(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=L(t);if(e){var a=L(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return M(this,n)}}function M(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function L(t){return L=f.default?_.default:function(t){return t.__proto__||(0,_.default)(t)},L(t)}var R=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&E(t,e)}(a,t);var e,n,i,r=S(a);function a(){var t,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return x(this,a),(t=r.call(this))._anchorX=NaN,t._anchorY=NaN,t._widget=d.Widget.EMPTY,e&&(t.preinitialize(),t.createChildren(),t.initialize()),t}return e=a,n=[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];k(L(a.prototype),"destroy",this).call(this,t),this._dataSource=null,this._tag=null,this._toolTip=null}},{key:"preinitialize",value:function(){}},{key:"createChildren",value:function(){}},{key:"initialize",value:function(){}},{key:"width",get:function(){return this.get_width()},set:function(t){this.set_width(t)}},{key:"get_width",value:function(){return this._width?this._width:this.measureWidth()}},{key:"measureWidth",value:function(){var t=0;this.commitMeasure();for(var e=this.numChildren-1;e>-1;e--){var n=this.getChildAt(e);n._visible&&(t=Math.max(n._x+n.width*n.scaleX,t))}return t}},{key:"commitMeasure",value:function(){}},{key:"height",get:function(){return this.get_height()},set:function(t){this.set_height(t)}},{key:"get_height",value:function(){return this._height?this._height:this.measureHeight()}},{key:"measureHeight",value:function(){var t=0;this.commitMeasure();for(var e=this.numChildren-1;e>-1;e--){var n=this.getChildAt(e);n._visible&&(t=Math.max(n._y+n.height*n.scaleY,t))}return t}},{key:"dataSource",get:function(){return this.get_dataSource()},set:function(t){this.set_dataSource(t)}},{key:"get_dataSource",value:function(){return this._dataSource}},{key:"set_dataSource",value:function(t){for(var e in this._dataSource=t,this._dataSource)e in this&&"function"!=typeof this[e]&&(this[e]=this._dataSource[e])}},{key:"top",get:function(){return this.get_top()},set:function(t){this.set_top(t)}},{key:"get_top",value:function(){return this._widget.top}},{key:"set_top",value:function(t){t!=this._widget.top&&(this._getWidget().top=t)}},{key:"bottom",get:function(){return this.get_bottom()},set:function(t){this.set_bottom(t)}},{key:"get_bottom",value:function(){return this._widget.bottom}},{key:"set_bottom",value:function(t){t!=this._widget.bottom&&(this._getWidget().bottom=t)}},{key:"left",get:function(){return this._widget.left},set:function(t){t!=this._widget.left&&(this._getWidget().left=t)}},{key:"right",get:function(){return this._widget.right},set:function(t){t!=this._widget.right&&(this._getWidget().right=t)}},{key:"centerX",get:function(){return this._widget.centerX},set:function(t){t!=this._widget.centerX&&(this._getWidget().centerX=t)}},{key:"centerY",get:function(){return this._widget.centerY},set:function(t){t!=this._widget.centerY&&(this._getWidget().centerY=t)}},{key:"_sizeChanged",value:function(){isNaN(this._anchorX)||(this.pivotX=this.anchorX*this.width),isNaN(this._anchorY)||(this.pivotY=this.anchorY*this.height),this.event(g.Event.RESIZE),this._widget!==d.Widget.EMPTY&&this._widget.resetLayout()}},{key:"tag",get:function(){return this._tag},set:function(t){this._tag=t}},{key:"toolTip",get:function(){return this._toolTip},set:function(t){this._toolTip!=t&&(this._toolTip=t,null!=t?(this.on(g.Event.MOUSE_OVER,this,this.onMouseOver),this.on(g.Event.MOUSE_OUT,this,this.onMouseOut)):(this.off(g.Event.MOUSE_OVER,this,this.onMouseOver),this.off(g.Event.MOUSE_OUT,this,this.onMouseOut)))}},{key:"onMouseOver",value:function(t){m.ILaya.stage.event(p.UIEvent.SHOW_TIP,this._toolTip)}},{key:"onMouseOut",value:function(t){m.ILaya.stage.event(p.UIEvent.HIDE_TIP,this._toolTip)}},{key:"gray",get:function(){return this._gray},set:function(t){t!==this._gray&&(this._gray=t,y.UIUtils.gray(this,t))}},{key:"disabled",get:function(){return this._disabled},set:function(t){t!==this._disabled&&(this.gray=this._disabled=t,this.mouseEnabled=!t)}},{key:"_getWidget",value:function(){return this._widget===d.Widget.EMPTY&&(this._widget=this.addComponent(d.Widget)),this._widget}},{key:"scaleX",get:function(){return k(L(a.prototype),"scaleX",this)},set:function(t){this.set_scaleX(t)}},{key:"set_scaleX",value:function(t){k(L(a.prototype),"get_scaleX",this).call(this)!=t&&(k(L(a.prototype),"set_scaleX",this).call(this,t),this.callLater(this._sizeChanged))}},{key:"scaleY",get:function(){return k(L(a.prototype),"scaleY",this)},set:function(t){this.set_scaleY(t)}},{key:"set_scaleY",value:function(t){k(L(a.prototype),"get_scaleY",this).call(this)!=t&&(k(L(a.prototype),"set_scaleY",this).call(this,t),this.callLater(this._sizeChanged))}},{key:"onCompResize",value:function(){this._sizeChanged()}},{key:"set_width",value:function(t){k(L(a.prototype),"get_width",this).call(this)!=t&&(k(L(a.prototype),"set_width",this).call(this,t),this.callLater(this._sizeChanged))}},{key:"set_height",value:function(t){k(L(a.prototype),"get_height",this).call(this)!=t&&(k(L(a.prototype),"set_height",this).call(this,t),this.callLater(this._sizeChanged))}},{key:"anchorX",get:function(){return this.get_anchorX()},set:function(t){this.set_anchorX(t)}},{key:"get_anchorX",value:function(){return this._anchorX}},{key:"set_anchorX",value:function(t){this._anchorX!=t&&(this._anchorX=t,this.callLater(this._sizeChanged))}},{key:"anchorY",get:function(){return this.get_anchorY()},set:function(t){this.set_anchorY(t)}},{key:"get_anchorY",value:function(){return this._anchorY}},{key:"set_anchorY",value:function(t){this._anchorY!=t&&(this._anchorY=t,this.callLater(this._sizeChanged))}},{key:"_childChanged",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.callLater(this._sizeChanged),k(L(a.prototype),"_childChanged",this).call(this,t)}}],n&&w(e.prototype,n),i&&w(e,i),a}(v.Sprite);e.UIComponent=R,m.ILaya.regClass(R),b.ClassUtils.regClass("laya.ui.UIComponent",R),b.ClassUtils.regClass("Laya.UIComponent",R)},60082:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.UIEvent=void 0;var h=p(n(85507)),c=p(n(21611)),f=n(89662),_=n(92493),d=n(23835);function p(t){return t&&t.__esModule?t:{default:t}}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){return v=a||function(t,e){return t.__proto__=e,t},v(t,e)}function g(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b(t);if(e){var a=b(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return m(this,n)}}function m(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function b(t){return b=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},b(t)}var T=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(n,t);var e=g(n);function n(){return y(this,n),e.apply(this,arguments)}return n}(f.Event);e.UIEvent=T,T.SHOW_TIP="showtip",T.HIDE_TIP="hidetip",_.ILaya.regClass(T),d.ClassUtils.regClass("laya.ui.UIEvent",T),d.ClassUtils.regClass("Laya.UIEvent",T)},9570:function(t,e,n){"use strict";function i(t){return i="function"==typeof c&&"symbol"==typeof f?function(t){return typeof t}:function(t){return t&&"function"==typeof c&&t.constructor===c&&t!==c.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(9705),c=n(65420),f=n(98341);l(e,"__esModule",{value:!0}),e.UIGroup=void 0;var _=w(n(81643)),d=w(n(94198)),p=w(n(85507)),y=w(n(21611)),v=n(93408),g=n(89662),m=n(85096),b=n(41107),T=n(92493),x=n(23835);function w(t){return t&&t.__esModule?t:{default:t}}function k(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function C(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function E(t,e,n,i){return E="undefined"!=typeof Reflect&&h?h:function(t,e,n,i){var r,a=L(t,e);if(a){if((r=u(a,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=u(i,e)){if(!r.writable)return!1;r.value=n,l(i,e,r)}else!function(t,e,n){e in t?l(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0},E(t,e,n,i)}function S(t,e,n,i,r){if(!E(t,e,n,i||t)&&r)throw new Error("failed to set property");return n}function M(){return M="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=L(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},M.apply(this,arguments)}function L(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=D(t)););return t}function R(t,e){return R=a||function(t,e){return t.__proto__=e,t},R(t,e)}function I(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=D(t);if(e){var a=D(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return A(this,n)}}function A(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function D(t){return D=p.default?y.default:function(t){return t.__proto__||(0,y.default)(t)},D(t)}var B=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&R(t,e)}(a,t);var e,n,i,r=I(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return k(this,a),(t=r.call(this))._selectedIndex=-1,t._direction="horizontal",t._space=0,t.skin=n,t.labels=e,t}return e=a,n=[{key:"preinitialize",value:function(){this.mouseEnabled=!0}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];M(D(a.prototype),"destroy",this).call(this,t),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null}},{key:"addItem",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t,i=this._items.length;if(n.name="item"+i,this.addChild(n),this.initItems(),e&&i>0){var r=this._items[i-1];"horizontal"==this._direction?n.x=r._x+r.width+this._space:n.y=r._y+r.height+this._space}else e&&(n.x=0,n.y=0);return i}},{key:"delItem",value:function(t){var e,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=(0,_.default)(e=this._items).call(e,t);if(-1!=i){var r,a=t;this.removeChild(a);for(var o=i+1,s=this._items.length;o<s;o++){var u=this._items[o];u.name="item"+(o-1),n&&("horizontal"==this._direction?u.x-=a.width+this._space:u.y-=a.height+this._space)}this.initItems(),this._selectedIndex>-1&&(r=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=r)}}},{key:"_afterInited",value:function(){this.initItems()}},{key:"initItems",value:function(){this._items||(this._items=[]),this._items.length=0;for(var t=0;t<1e4;t++){var e=this.getChildByName("item"+t);if(null==e)break;this._items.push(e),e.selected=t===this._selectedIndex,e.clickHandler=b.Handler.create(this,this.itemClick,[t],!1)}}},{key:"itemClick",value:function(t){this.selectedIndex=t}},{key:"selectedIndex",get:function(){return this._selectedIndex},set:function(t){this._selectedIndex!=t&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=t,this.setSelect(t,!0),this.event(g.Event.CHANGE),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}},{key:"setSelect",value:function(t,e){this._items&&t>-1&&t<this._items.length&&(this._items[t].selected=e)}},{key:"skin",get:function(){return this._skin},set:function(t){this._skin!=t&&(this._skin=t,this._skin&&!m.Loader.getRes(this._skin)?T.ILaya.loader.load(this._skin,b.Handler.create(this,this._skinLoaded),null,m.Loader.IMAGE,1):this._skinLoaded())}},{key:"_skinLoaded",value:function(){this._setLabelChanged(),this.event(g.Event.LOADED)}},{key:"labels",get:function(){return this._labels},set:function(t){if(this._labels!=t){if(this._labels=t,this.removeChildren(),this._setLabelChanged(),this._labels)for(var e=this._labels.split(","),n=0,i=e.length;n<i;n++){var r=this.createItem(this._skin,e[n]);r.name="item"+n,this.addChild(r)}this.initItems()}}},{key:"createItem",value:function(t,e){return null}},{key:"labelColors",get:function(){return this._labelColors},set:function(t){this._labelColors!=t&&(this._labelColors=t,this._setLabelChanged())}},{key:"labelStroke",get:function(){return this._labelStroke},set:function(t){this._labelStroke!=t&&(this._labelStroke=t,this._setLabelChanged())}},{key:"labelStrokeColor",get:function(){return this._labelStrokeColor},set:function(t){this._labelStrokeColor!=t&&(this._labelStrokeColor=t,this._setLabelChanged())}},{key:"strokeColors",get:function(){return this._strokeColors},set:function(t){this._strokeColors!=t&&(this._strokeColors=t,this._setLabelChanged())}},{key:"labelSize",get:function(){return this._labelSize},set:function(t){this._labelSize!=t&&(this._labelSize=t,this._setLabelChanged())}},{key:"stateNum",get:function(){return this._stateNum},set:function(t){this._stateNum!=t&&(this._stateNum=t,this._setLabelChanged())}},{key:"labelBold",get:function(){return this._labelBold},set:function(t){this._labelBold!=t&&(this._labelBold=t,this._setLabelChanged())}},{key:"labelFont",get:function(){return this._labelFont},set:function(t){this._labelFont!=t&&(this._labelFont=t,this._setLabelChanged())}},{key:"labelPadding",get:function(){return this._labelPadding},set:function(t){this._labelPadding!=t&&(this._labelPadding=t,this._setLabelChanged())}},{key:"direction",get:function(){return this._direction},set:function(t){this._direction=t,this._setLabelChanged()}},{key:"space",get:function(){return this._space},set:function(t){this._space=t,this._setLabelChanged()}},{key:"changeLabels",value:function(){if(this._labelChanged=!1,this._items)for(var t=0,e=0,n=this._items.length;e<n;e++){var i=this._items[e];this._skin&&(i.skin=this._skin),this._labelColors&&(i.labelColors=this._labelColors),this._labelSize&&(i.labelSize=this._labelSize),this._labelStroke&&(i.labelStroke=this._labelStroke),this._labelStrokeColor&&(i.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(i.strokeColors=this._strokeColors),this._labelBold&&(i.labelBold=this._labelBold),this._labelPadding&&(i.labelPadding=this._labelPadding),this._labelAlign&&(i.labelAlign=this._labelAlign),this._stateNum&&(i.stateNum=this._stateNum),this._labelFont&&(i.labelFont=this._labelFont),"horizontal"===this._direction?(i.y=0,i.x=t,t+=i.width+this._space):(i.x=0,i.y=t,t+=i.height+this._space)}this._sizeChanged()}},{key:"commitMeasure",value:function(){this.runCallLater(this.changeLabels)}},{key:"items",get:function(){return this._items}},{key:"selection",get:function(){return this._selectedIndex>-1&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},set:function(t){var e;this.selectedIndex=(0,_.default)(e=this._items).call(e,t)}},{key:"dataSource",get:function(){return M(D(a.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.selectedIndex=(0,d.default)(t):t instanceof Array?this.labels=t.join(","):S(D(a.prototype),"dataSource",t,this,!0)}},{key:"_setLabelChanged",value:function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))}}],n&&C(e.prototype,n),i&&C(e,i),a}(v.Box);e.UIGroup=B,T.ILaya.regClass(B),x.ClassUtils.regClass("laya.ui.UIGroup",B),x.ClassUtils.regClass("Laya.UIGroup",B)},6642:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.UIUtils=void 0;var i=h(n(77766)),r=h(n(92762)),a=h(n(63978)),o=n(20084),s=n(56083),u=n(76006),l=n(23835);function h(t){return t&&t.__esModule?t:{default:t}}function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,a.default)(t,i.key,i)}}var f=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,a;return e=t,a=[{key:"fillArray",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=(0,i.default)(t).call(t);if(e)for(var a=e.split(","),o=0,s=Math.min(r.length,a.length);o<s;o++){var u=a[o];r[o]="true"==u||"false"!=u&&u,null!=n&&(r[o]=n(u))}return r}},{key:"toColor",value:function(t){return s.Utils.toHexColor(t)}},{key:"gray",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];n?t.addFilter(e,t.grayFilter):t.clearFilter(e,o.ColorFilter)}},{key:"addFilter",value:function(t,e){var n=t.filters||[];n.push(e),t.filters=n}},{key:"clearFilter",value:function(t,e){var n=t.filters;if(null!=n&&n.length>0){for(var i=n.length-1;i>-1;i--)n[i]instanceof e&&(0,r.default)(n).call(n,i,1);t.filters=n}}},{key:"_getReplaceStr",value:function(e){return t.escapeSequence[e]}},{key:"adptString",value:function(e){return e.replace(/\\(\w)/g,t._getReplaceStr)}},{key:"getBindFun",value:function(e){t._funMap||(t._funMap=new u.WeakObject);var n=t._funMap.get(e);if(null==n){var i='"'+e+'"',r="(function(data){if(data==null)return;with(data){try{\nreturn "+(i=i.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";n=window.Laya._runScript(r),t._funMap.set(e,n)}return n}}],(n=null)&&c(e.prototype,n),a&&c(e,a),t}();e.UIUtils=f,f.grayFilter=new o.ColorFilter([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0]),f.escapeSequence={"\\n":"\n","\\t":"\t"},f._funMap=null,l.ClassUtils.regClass("laya.ui.UIUtils",f),l.ClassUtils.regClass("Laya.UIUtils",f)},42595:function(t,e,n){"use strict";function i(t){return i="function"==typeof c&&"symbol"==typeof f?function(t){return typeof t}:function(t){return t&&"function"==typeof c&&t.constructor===c&&t!==c.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(9705),l=n(34074),h=n(62734),c=n(65420),f=n(98341);s(e,"__esModule",{value:!0}),e.VBox=void 0;var _=g(n(85507)),d=g(n(21611)),p=n(66754),y=n(92493),v=n(23835);function g(t){return t&&t.__esModule?t:{default:t}}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function T(){return T="undefined"!=typeof Reflect&&h?h:function(t,e,n){var i=k(t,e);if(i){var r=l(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},T.apply(this,arguments)}function x(t,e,n,i){return x="undefined"!=typeof Reflect&&u?u:function(t,e,n,i){var r,a=k(t,e);if(a){if((r=l(a,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=l(i,e)){if(!r.writable)return!1;r.value=n,s(i,e,r)}else!function(t,e,n){e in t?s(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0},x(t,e,n,i)}function w(t,e,n,i,r){if(!x(t,e,n,i||t)&&r)throw new Error("failed to set property");return n}function k(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=M(t)););return t}function C(t,e){return C=a||function(t,e){return t.__proto__=e,t},C(t,e)}function E(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=M(t);if(e){var a=M(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return S(this,n)}}function S(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function M(t){return M=_.default?d.default:function(t){return t.__proto__||(0,d.default)(t)},M(t)}var L=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&C(t,e)}(a,t);var e,n,i,r=E(a);function a(){var t;return m(this,a),(t=r.apply(this,arguments)).isSortItem=!1,t}return e=a,(n=[{key:"width",get:function(){return T(M(a.prototype),"width",this)},set:function(t){this._width!=t&&(w(M(a.prototype),"width",t,this,!0),this.callLater(this.changeItems))}},{key:"changeItems",value:function(){this._itemChanged=!1;for(var t=[],e=0,n=0,i=this.numChildren;n<i;n++){var r=this.getChildAt(n);r&&(t.push(r),e=this._width?this._width:Math.max(e,r.width*r.scaleX))}this.isSortItem&&this.sortItem(t);var o=0;for(n=0,i=t.length;n<i;n++)(r=t[n]).y=o,o+=r.height*r.scaleY+this._space,this._align==a.LEFT?r.x=0:this._align==a.CENTER?r.x=.5*(e-r.width*r.scaleX):this._align==a.RIGHT&&(r.x=e-r.width*r.scaleX);this._sizeChanged()}}])&&b(e.prototype,n),i&&b(e,i),a}(p.LayoutBox);e.VBox=L,L.NONE="none",L.LEFT="left",L.CENTER="center",L.RIGHT="right",y.ILaya.regClass(L),v.ClassUtils.regClass("laya.ui.VBox",L),v.ClassUtils.regClass("Laya.VBox",L)},37277:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.VScrollBar=void 0;var h=p(n(85507)),c=p(n(21611)),f=n(72978),_=n(92493),d=n(23835);function p(t){return t&&t.__esModule?t:{default:t}}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){return v=a||function(t,e){return t.__proto__=e,t},v(t,e)}function g(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b(t);if(e){var a=b(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return m(this,n)}}function m(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function b(t){return b=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},b(t)}var T=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(n,t);var e=g(n);function n(){return y(this,n),e.apply(this,arguments)}return n}(f.ScrollBar);e.VScrollBar=T,_.ILaya.regClass(T),d.ClassUtils.regClass("laya.ui.VScrollBar",T),d.ClassUtils.regClass("Laya.VScrollBar",T)},70710:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.VSlider=void 0;var h=p(n(85507)),c=p(n(21611)),f=n(36895),_=n(92493),d=n(23835);function p(t){return t&&t.__esModule?t:{default:t}}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){return v=a||function(t,e){return t.__proto__=e,t},v(t,e)}function g(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b(t);if(e){var a=b(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return m(this,n)}}function m(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function b(t){return b=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},b(t)}var T=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(n,t);var e=g(n);function n(){return y(this,n),e.apply(this,arguments)}return n}(f.Slider);e.VSlider=T,_.ILaya.regClass(T),d.ClassUtils.regClass("laya.ui.VSlider",T),d.ClassUtils.regClass("Laya.VSlider",T)},79698:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.View=void 0;var f=Z(n(85507)),_=Z(n(21611)),d=n(72601),p=n(31249),y=n(28294),v=n(81870),g=n(89662),m=n(93408),b=n(33879),T=n(24830),x=n(44476),w=n(96530),k=n(58336),C=n(82201),E=n(50250),S=n(51931),M=n(93615),L=n(57768),R=n(52357),I=n(25435),A=n(2292),D=n(70078),B=n(20079),P=n(8255),O=n(48181),F=n(75485),U=n(29084),N=n(72978),G=n(36895),H=n(89658),W=n(37277),V=n(70710),Y=n(61241),X=n(51582),z=n(42595),j=n(31487),K=n(92493),q=n(23835);function Z(t){return t&&t.__esModule?t:{default:t}}function Q(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function $(){return $="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=J(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},$.apply(this,arguments)}function J(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=it(t)););return t}function tt(t,e){return tt=a||function(t,e){return t.__proto__=e,t},tt(t,e)}function et(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=it(t);if(e){var a=it(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return nt(this,n)}}function nt(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function it(t){return it=f.default?_.default:function(t){return t.__proto__||(0,_.default)(t)},it(t)}var rt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tt(t,e)}(a,t);var e,n,i,r=et(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,!1))._watchMap={},t._anchorX=NaN,t._anchorY=NaN,t._widget=d.Widget.EMPTY,t.createChildren(),t}return e=a,n=[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._watchMap=null,$(it(a.prototype),"destroy",this).call(this,t)}},{key:"changeData",value:function(t){var e=this._watchMap[t];if(e)for(var n=0,i=e.length;n<i;n++)e[n].exe(this)}},{key:"top",get:function(){return this._widget.top},set:function(t){t!=this._widget.top&&(this._getWidget().top=t)}},{key:"bottom",get:function(){return this._widget.bottom},set:function(t){t!=this._widget.bottom&&(this._getWidget().bottom=t)}},{key:"left",get:function(){return this._widget.left},set:function(t){t!=this._widget.left&&(this._getWidget().left=t)}},{key:"right",get:function(){return this._widget.right},set:function(t){t!=this._widget.right&&(this._getWidget().right=t)}},{key:"centerX",get:function(){return this._widget.centerX},set:function(t){t!=this._widget.centerX&&(this._getWidget().centerX=t)}},{key:"centerY",get:function(){return this._widget.centerY},set:function(t){t!=this._widget.centerY&&(this._getWidget().centerY=t)}},{key:"anchorX",get:function(){return this._anchorX},set:function(t){this._anchorX!=t&&(this._anchorX=t,this.callLater(this._sizeChanged))}},{key:"anchorY",get:function(){return this._anchorY},set:function(t){this._anchorY!=t&&(this._anchorY=t,this.callLater(this._sizeChanged))}},{key:"_sizeChanged",value:function(){isNaN(this._anchorX)||(this.pivotX=this.anchorX*this.width),isNaN(this._anchorY)||(this.pivotY=this.anchorY*this.height),this.event(g.Event.RESIZE)}},{key:"_getWidget",value:function(){return this._widget===d.Widget.EMPTY&&(this._widget=this.addComponent(d.Widget)),this._widget}},{key:"loadUI",value:function(t){var e=a.uiMap[t];a.uiMap&&this.createView(e)}},{key:"dataSource",get:function(){return this._dataSource},set:function(t){for(var e in this._dataSource=t,t){var n=this.getChildByName(e);n instanceof M.UIComponent?n.dataSource=t[e]:!(e in this)||this[e]instanceof Function||(this[e]=t[e])}}}],i=[{key:"__init__",value:function(){K.ILaya.ClassUtils.regShortClassName([L.ViewStack,b.Button,R.TextArea,I.ColorPicker,m.Box,A.ScaleBox,T.CheckBox,D.Clip,B.ComboBox,M.UIComponent,P.HScrollBar,O.HSlider,x.Image,w.Label,F.List,U.Panel,k.ProgressBar,C.Radio,E.RadioGroup,N.ScrollBar,G.Slider,S.Tab,H.TextInput,a,W.VScrollBar,V.VSlider,Y.Tree,X.HBox,z.VBox,p.Animation,v.Text,j.FontClip])}},{key:"regComponent",value:function(t,e){K.ILaya.ClassUtils.regClass(t,e)}},{key:"regViewRuntime",value:function(t,e){K.ILaya.ClassUtils.regClass(t,e)}},{key:"regUI",value:function(t,e){K.ILaya.loader.cacheRes(t,e)}}],n&&Q(e.prototype,n),i&&Q(e,i),a}(y.Scene);e.View=rt,rt.uiMap={},K.ILaya.regClass(rt),q.ClassUtils.regClass("laya.ui.View",rt),q.ClassUtils.regClass("Laya.View",rt)},57768:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.ViewStack=void 0;var f=b(n(81643)),_=b(n(94198)),d=b(n(85507)),p=b(n(21611)),y=n(93408),v=n(41107),g=n(92493),m=n(23835);function b(t){return t&&t.__esModule?t:{default:t}}function T(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function w(){return w="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=k(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},w.apply(this,arguments)}function k(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=L(t)););return t}function C(t,e){return C=a||function(t,e){return t.__proto__=e,t},C(t,e)}function E(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=L(t);if(e){var a=L(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return S(this,n)}}function S(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return M(t)}function M(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function L(t){return L=d.default?p.default:function(t){return t.__proto__||(0,p.default)(t)},L(t)}var R=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&C(t,e)}(a,t);var e,n,i,r=E(a);function a(){var t;return T(this,a),(t=r.apply(this,arguments))._setIndexHandler=v.Handler.create(M(t),t.setIndex,null,!1),t}return e=a,(n=[{key:"setItems",value:function(t){this.removeChildren();for(var e=0,n=0,i=t.length;n<i;n++){var r=t[n];r&&(r.name="item"+e,this.addChild(r),e++)}this.initItems()}},{key:"addItem",value:function(t){t.name="item"+this._items.length,this.addChild(t),this.initItems()}},{key:"_afterInited",value:function(){this.initItems()}},{key:"initItems",value:function(){this._items=[];for(var t=0;t<1e4;t++){var e=this.getChildByName("item"+t);if(null==e)break;this._items.push(e),e.visible=t==this._selectedIndex}}},{key:"selectedIndex",get:function(){return this._selectedIndex},set:function(t){this._selectedIndex!=t&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=t,this.setSelect(this._selectedIndex,!0))}},{key:"setSelect",value:function(t,e){this._items&&t>-1&&t<this._items.length&&(this._items[t].visible=e)}},{key:"selection",get:function(){return this._selectedIndex>-1&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},set:function(t){var e;this.selectedIndex=(0,f.default)(e=this._items).call(e,t)}},{key:"setIndexHandler",get:function(){return this._setIndexHandler},set:function(t){this._setIndexHandler=t}},{key:"setIndex",value:function(t){this.selectedIndex=t}},{key:"items",get:function(){return this._items}},{key:"dataSource",get:function(){return w(L(a.prototype),"dataSource",this)},set:function(t){if(this._dataSource=t,"number"==typeof t||"string"==typeof t)this.selectedIndex=(0,_.default)(t);else for(var e in this._dataSource)e in this&&(this[e]=this._dataSource[e])}}])&&x(e.prototype,n),i&&x(e,i),a}(y.Box);e.ViewStack=R,g.ILaya.regClass(R),m.ClassUtils.regClass("laya.ui.ViewStack",R),m.ClassUtils.regClass("Laya.ViewStack",R)},72601:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.Widget=void 0;var h=y(n(85507)),c=y(n(21611)),f=n(42255),_=n(89662),d=n(92493),p=n(23835);function y(t){return t&&t.__esModule?t:{default:t}}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function m(t,e){return m=a||function(t,e){return t.__proto__=e,t},m(t,e)}function b(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return T(this,n)}}function T(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function x(t){return x=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},x(t)}var w=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(a,t);var e,n,i,r=b(a);function a(){var t;return v(this,a),(t=r.apply(this,arguments))._top=NaN,t._bottom=NaN,t._left=NaN,t._right=NaN,t._centerX=NaN,t._centerY=NaN,t}return e=a,(n=[{key:"onReset",value:function(){this._top=this._bottom=this._left=this._right=this._centerX=this._centerY=NaN}},{key:"_onEnable",value:function(){this.owner.parent?this._onAdded():this.owner.once(_.Event.ADDED,this,this._onAdded)}},{key:"_onDisable",value:function(){this.owner.off(_.Event.ADDED,this,this._onAdded),this.owner.parent&&this.owner.parent.off(_.Event.RESIZE,this,this._onParentResize)}},{key:"_onAdded",value:function(){this.owner.parent&&this.owner.parent.on(_.Event.RESIZE,this,this._onParentResize),this.resetLayoutX(),this.resetLayoutY()}},{key:"_onParentResize",value:function(){var t=this.resetLayoutX(),e=this.resetLayoutY();(t||e)&&this.owner.event(_.Event.RESIZE)}},{key:"resetLayoutX",value:function(){var t=this.owner;if(!t)return!1;var e=t.parent;if(e)if(isNaN(this.centerX)){if(isNaN(this.left))isNaN(this.right)||(t.x=Math.round(e.width-t.displayWidth-this.right+t.pivotX*t.scaleX));else if(t.x=Math.round(this.left+t.pivotX*t.scaleX),!isNaN(this.right)){if(!e._width)return!1;var n=(e._width-this.left-this.right)/(t.scaleX||.01);if(n!=t.width)return t.width=n,!0}}else t.x=Math.round(.5*(e.width-t.displayWidth)+this.centerX+t.pivotX*t.scaleX);return!1}},{key:"resetLayoutY",value:function(){var t=this.owner;if(!t)return!1;var e=t.parent;if(e)if(isNaN(this.centerY)){if(isNaN(this.top))isNaN(this.bottom)||(t.y=Math.round(e.height-t.displayHeight-this.bottom+t.pivotY*t.scaleY));else if(t.y=Math.round(this.top+t.pivotY*t.scaleY),!isNaN(this.bottom)){if(!e._height)return!1;var n=(e._height-this.top-this.bottom)/(t.scaleY||.01);if(n!=t.height)return t.height=n,!0}}else t.y=Math.round(.5*(e.height-t.displayHeight)+this.centerY+t.pivotY*t.scaleY);return!1}},{key:"resetLayout",value:function(){this.owner&&(this.resetLayoutX(),this.resetLayoutY())}},{key:"top",get:function(){return this._top},set:function(t){this._top!=t&&(this._top=t,this.resetLayoutY())}},{key:"bottom",get:function(){return this._bottom},set:function(t){this._bottom!=t&&(this._bottom=t,this.resetLayoutY())}},{key:"left",get:function(){return this._left},set:function(t){this._left!=t&&(this._left=t,this.resetLayoutX())}},{key:"right",get:function(){return this._right},set:function(t){this._right!=t&&(this._right=t,this.resetLayoutX())}},{key:"centerX",get:function(){return this._centerX},set:function(t){this._centerX!=t&&(this._centerX=t,this.resetLayoutX())}},{key:"centerY",get:function(){return this._centerY},set:function(t){this._centerY!=t&&(this._centerY=t,this.resetLayoutY())}}])&&g(e.prototype,n),i&&g(e,i),a}(f.Component);e.Widget=w,w.EMPTY=null,d.ILaya.regClass(w),w.EMPTY=new w,p.ClassUtils.regClass("laya.ui.Widget",w),p.ClassUtils.regClass("Laya.Widget",w)},93568:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Browser=void 0;var i=s(n(81643)),r=s(n(11128)),a=s(n(63978)),o=n(92493);function s(t){return t&&t.__esModule?t:{default:t}}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,a.default)(t,i.key,i)}}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,a;return e=t,a=[{key:"__init__",value:function(){var e=window.Laya||o.ILaya.Laya;if(t._window)return t._window;var n=t._window=window,r=t._document=n.document,a=t.userAgent=n.navigator.userAgent,s=n.navigator.maxTouchPoints||0,u=n.navigator.platform;"my"in t.window&&((0,i.default)(a).call(a,"TB/")>-1||(0,i.default)(a).call(a,"Taobao/")>-1||(0,i.default)(a).call(a,"TM/")>-1?(window.tbMiniGame(e,e),e.TBMiniAdapter?e.TBMiniAdapter.enable():console.error("请先添加淘宝适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-6-0")):(0,i.default)(a).call(a,"AlipayMiniGame")>-1&&(window.aliPayMiniGame(e,e),e.ALIMiniAdapter?e.ALIMiniAdapter.enable():console.error("请先添加阿里小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-6-0"))),-1==(0,i.default)(a).call(a,"OPPO")&&(0,i.default)(a).call(a,"MiniGame")>-1&&"wx"in t.window&&("tt"in t.window?(window.ttMiniGame(e,e),e.TTMiniAdapter?e.TTMiniAdapter.enable():console.error("请引入字节跳动小游戏的适配库")):"bl"in t.window?(window.biliMiniGame(e,e),e.BLMiniAdapter?e.BLMiniAdapter.enable():console.error("请引入bilibili小游戏的适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-7-0")):"qq"in t.window?(window.qqMiniGame(e,e),e.QQMiniAdapter?e.QQMiniAdapter.enable():console.error("请引入手机QQ小游戏的适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-0-0")):(window.wxMiniGame(e,e),e.MiniAdpter?e.MiniAdpter.enable():console.error("请先添加小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?nav=zh-ts-5-0-0"))),"hbs"in t.window&&(window.hwMiniGame(e,e),e.HWMiniAdapter?e.HWMiniAdapter.enable():console.error("请先添加小游戏适配库!")),(0,i.default)(a).call(a,"SwanGame")>-1&&(window.bdMiniGame(e,e),e.BMiniAdapter?e.BMiniAdapter.enable():console.error("请先添加百度小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-1-0")),(0,i.default)(a).call(a,"QuickGame")>-1&&(window.miMiniGame(e,e),e.KGMiniAdapter?e.KGMiniAdapter.enable():console.error("请先添加小米小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-2-0")),(0,i.default)(a).call(a,"OPPO")>-1&&(0,i.default)(a).call(a,"MiniGame")>-1&&(window.qgMiniGame(e,e),e.QGMiniAdapter?e.QGMiniAdapter.enable():console.error("请先添加OPPO小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-3-0")),(0,i.default)(a).call(a,"VVGame")>-1&&(window.vvMiniGame(e,e),e.VVMiniAdapter?e.VVMiniAdapter.enable():console.error("请先添加VIVO小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-4-0")),n.trace=console.log,n.requestAnimationFrame=n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame||function(t){return n.setTimeout(t,1e3/60)};var l=r.body.style;l.margin=0,l.overflow="hidden",l["-webkit-user-select"]="none",l["-webkit-tap-highlight-color"]="rgba(200,200,200,0)";for(var h=r.getElementsByTagName("meta"),c=0,f=!1,_="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no";c<h.length;){var d=h[c];if("viewport"==d.name){d.content=_,f=!0;break}c++}return f||((d=r.createElement("meta")).name="viewport",d.content=_,r.getElementsByTagName("head")[0].appendChild(d)),t.onMobile=!!window.conch||(0,i.default)(a).call(a,"Mobile")>-1,t.onIOS=!!a.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),t.onIPhone=(0,i.default)(a).call(a,"iPhone")>-1,t.onMac=(0,i.default)(a).call(a,"Mac OS X")>-1,t.onIPad=(0,i.default)(a).call(a,"iPad")>-1||"MacIntel"===u&&s>1,t.onAndroid=(0,i.default)(a).call(a,"Android")>-1||(0,i.default)(a).call(a,"Adr")>-1,t.onWP=(0,i.default)(a).call(a,"Windows Phone")>-1,t.onQQBrowser=(0,i.default)(a).call(a,"QQBrowser")>-1,t.onMQQBrowser=(0,i.default)(a).call(a,"MQQBrowser")>-1||(0,i.default)(a).call(a,"Mobile")>-1&&(0,i.default)(a).call(a,"QQ")>-1,t.onIE=!!n.ActiveXObject||"ActiveXObject"in n,t.onWeiXin=(0,i.default)(a).call(a,"MicroMessenger")>-1,t.onSafari=(0,i.default)(a).call(a,"Safari")>-1,t.onPC=!t.onMobile,t.onFirefox=(0,i.default)(a).call(a,"Firefox")>-1,t.onEdge=(0,i.default)(a).call(a,"Edge")>-1,t.onMiniGame=(0,i.default)(a).call(a,"MiniGame")>-1,t.onBDMiniGame=(0,i.default)(a).call(a,"SwanGame")>-1,t.onLayaRuntime=!!window.conch,(0,i.default)(a).call(a,"OPPO")>-1&&(0,i.default)(a).call(a,"MiniGame")>-1?(t.onQGMiniGame=!0,t.onMiniGame=!1):"qq"in t.window&&(0,i.default)(a).call(a,"MiniGame")>-1?(t.onQQMiniGame=!0,t.onMiniGame=!1):"bl"in t.window&&(0,i.default)(a).call(a,"MiniGame")>-1?(t.onBLMiniGame=!0,t.onMiniGame=!1):"tt"in t.window&&(0,i.default)(a).call(a,"MiniGame")>-1&&(t.onTTMiniGame=!0,t.onMiniGame=!1),t.onHWMiniGame="hbs"in t.window,t.onVVMiniGame=(0,i.default)(a).call(a,"VVGame")>-1,t.onKGMiniGame=(0,i.default)(a).call(a,"QuickGame")>-1,(0,i.default)(a).call(a,"AlipayMiniGame")>-1&&(t.onAlipayMiniGame=!0,t.onMiniGame=!1),((0,i.default)(a).call(a,"TB/")>-1||(0,i.default)(a).call(a,"Taobao/")>-1||(0,i.default)(a).call(a,"TM/")>-1)&&(t.onTBMiniGame=!0),n}},{key:"_isMiniGame",get:function(){return t.onMiniGame||t.onBDMiniGame||t.onQGMiniGame||t.onKGMiniGame||t.onVVMiniGame||t.onAlipayMiniGame||t.onQQMiniGame||t.onBLMiniGame||t.onTTMiniGame||t.onHWMiniGame||t.onTBMiniGame}},{key:"createElement",value:function(e){return t.__init__(),t._document.createElement(e)}},{key:"getElementById",value:function(e){return t.__init__(),t._document.getElementById(e)}},{key:"removeElement",value:function(t){t&&t.parentNode&&t.parentNode.removeChild(t)}},{key:"now",value:function(){return(0,r.default)()}},{key:"clientWidth",get:function(){return t.__init__(),t._window.innerWidth||t._document.body.clientWidth}},{key:"clientHeight",get:function(){return t.__init__(),t._window.innerHeight||t._document.body.clientHeight||t._document.documentElement.clientHeight}},{key:"width",get:function(){return t.__init__(),(o.ILaya.stage&&o.ILaya.stage.canvasRotation?t.clientHeight:t.clientWidth)*t.pixelRatio}},{key:"height",get:function(){return t.__init__(),(o.ILaya.stage&&o.ILaya.stage.canvasRotation?t.clientWidth:t.clientHeight)*t.pixelRatio}},{key:"pixelRatio",get:function(){var e;return t._pixelRatio<0&&(t.__init__(),(0,i.default)(e=t.userAgent).call(e,"Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")>-1?t._pixelRatio=2:(t._pixelRatio=t._window.devicePixelRatio||1,t._pixelRatio<1&&(t._pixelRatio=1))),t._pixelRatio}},{key:"container",get:function(){return t._container||(t.__init__(),t._container=t.createElement("div"),t._container.id="layaContainer",t._document.body.appendChild(t._container)),t._container},set:function(e){t._container=e}},{key:"window",get:function(){return t._window||t.__init__()}},{key:"document",get:function(){return t.__init__(),t._document}}],(n=null)&&u(e.prototype,n),a&&u(e,a),t}();e.Browser=l,l._pixelRatio=-1,l.mainCanvas=null,l.hanzi=new RegExp("^[一-龥]$"),l.fontMap={},l.measureText=function(t,e){var n=l.hanzi.test(t);if(n&&l.fontMap[e])return l.fontMap[e];var i=l.context;i.font=e;var r=i.measureText(t);return n&&(l.fontMap[e]=r),r}},14002:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Byte=void 0;var i=s(n(3649)),r=s(n(98926)),a=s(n(63978)),o=n(18008);function s(t){return t&&t.__esModule?t:{default:t}}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,a.default)(t,i.key,i)}}var h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;u(this,t),this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,e?(this._u8d_=new Uint8Array(e),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this._resizeBuffer(this._allocated_)}var e,n,a;return e=t,n=[{key:"buffer",get:function(){var t=this._d_.buffer;return t.byteLength===this._length?t:(0,i.default)(t).call(t,0,this._length)}},{key:"endian",get:function(){return this._xd_?t.LITTLE_ENDIAN:t.BIG_ENDIAN},set:function(e){this._xd_=e===t.LITTLE_ENDIAN}},{key:"length",get:function(){return this._length},set:function(t){this._allocated_<t?this._resizeBuffer(this._allocated_=Math.floor(Math.max(t,2*this._allocated_))):this._allocated_>t&&this._resizeBuffer(this._allocated_=t),this._length=t}},{key:"_resizeBuffer",value:function(t){try{var e=new Uint8Array(t);null!=this._u8d_&&(this._u8d_.length<=t?e.set(this._u8d_):e.set(this._u8d_.subarray(0,t))),this._u8d_=e,this._d_=new DataView(e.buffer)}catch(e){throw"Invalid typed array length:"+t}}},{key:"getString",value:function(){return this.readString()}},{key:"readString",value:function(){return this._rUTF(this.getUint16())}},{key:"getFloat32Array",value:function(t,e){return this.readFloat32Array(t,e)}},{key:"readFloat32Array",value:function(t,e){var n,r=t+e;r=r>this._length?this._length:r;var a=new Float32Array((0,i.default)(n=this._d_.buffer).call(n,t,r));return this._pos_=r,a}},{key:"getUint8Array",value:function(t,e){return this.readUint8Array(t,e)}},{key:"readUint8Array",value:function(t,e){var n,r=t+e;r=r>this._length?this._length:r;var a=new Uint8Array((0,i.default)(n=this._d_.buffer).call(n,t,r));return this._pos_=r,a}},{key:"getInt16Array",value:function(t,e){return this.readInt16Array(t,e)}},{key:"readInt16Array",value:function(t,e){var n,r=t+e;r=r>this._length?this._length:r;var a=new Int16Array((0,i.default)(n=this._d_.buffer).call(n,t,r));return this._pos_=r,a}},{key:"getFloat32",value:function(){return this.readFloat32()}},{key:"readFloat32",value:function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var t=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,t}},{key:"getFloat64",value:function(){return this.readFloat64()}},{key:"readFloat64",value:function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var t=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,t}},{key:"writeFloat32",value:function(t){this._ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,t,this._xd_),this._pos_+=4}},{key:"writeFloat64",value:function(t){this._ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,t,this._xd_),this._pos_+=8}},{key:"getInt32",value:function(){return this.readInt32()}},{key:"readInt32",value:function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var t=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,t}},{key:"getUint32",value:function(){return this.readUint32()}},{key:"readUint32",value:function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var t=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,t}},{key:"writeInt32",value:function(t){this._ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,t,this._xd_),this._pos_+=4}},{key:"writeUint32",value:function(t){this._ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,t,this._xd_),this._pos_+=4}},{key:"getInt16",value:function(){return this.readInt16()}},{key:"readInt16",value:function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var t=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,t}},{key:"getUint16",value:function(){return this.readUint16()}},{key:"readUint16",value:function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var t=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,t}},{key:"writeUint16",value:function(t){this._ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,t,this._xd_),this._pos_+=2}},{key:"writeInt16",value:function(t){this._ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,t,this._xd_),this._pos_+=2}},{key:"getUint8",value:function(){return this.readUint8()}},{key:"readUint8",value:function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._u8d_[this._pos_++]}},{key:"writeUint8",value:function(t){this._ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,t),this._pos_++}},{key:"_getUInt8",value:function(t){return this._readUInt8(t)}},{key:"_readUInt8",value:function(t){return this._d_.getUint8(t)}},{key:"_getUint16",value:function(t){return this._readUint16(t)}},{key:"_readUint16",value:function(t){return this._d_.getUint16(t,this._xd_)}},{key:"_getMatrix",value:function(){return this._readMatrix()}},{key:"_readMatrix",value:function(){return new o.Matrix(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())}},{key:"_rUTF",value:function(t){var e,n,i=this._pos_+t,r=String.fromCharCode,a=this._u8d_,o=[],s=0;for(o.length=1e3;this._pos_<i;)if((e=a[this._pos_++])<128)0!=e&&(o[s++]=r(e));else if(e<224)o[s++]=r((63&e)<<6|127&a[this._pos_++]);else if(e<240)n=a[this._pos_++],o[s++]=r((31&e)<<12|(127&n)<<6|127&a[this._pos_++]);else{var u=(15&e)<<18|(127&(n=a[this._pos_++]))<<12|(127&a[this._pos_++])<<6|127&a[this._pos_++];if(u>=65536){var l=u-65536,h=55296|l>>10,c=56320|1023&l;o[s++]=r(h),o[s++]=r(c)}else o[s++]=r(u)}return o.length=s,o.join("")}},{key:"getCustomString",value:function(t){return this.readCustomString(t)}},{key:"readCustomString",value:function(t){for(var e,n="",i=0,r=String.fromCharCode,a=this._u8d_;t>0;)if((e=a[this._pos_])<128)n+=r(e),this._pos_++,t--;else for(i=e-128,this._pos_++,t-=i;i>0;)e=a[this._pos_++],n+=r(a[this._pos_++]<<8|e),i--;return n}},{key:"pos",get:function(){return this._pos_},set:function(t){this._pos_=t}},{key:"bytesAvailable",get:function(){return this._length-this._pos_}},{key:"clear",value:function(){this._pos_=0,this.length=0}},{key:"__getBuffer",value:function(){return this._d_.buffer}},{key:"writeUTFBytes",value:function(t){for(var e=0,n=(t+="").length;e<n;e++){var i=t.charCodeAt(e);if(i<=127)this.writeByte(i);else if(i<=2047)this._ensureWrite(this._pos_+2),this._u8d_.set([192|i>>6,128|63&i],this._pos_),this._pos_+=2;else if(i>=55296&&i<=56319){e++;var a=t.charCodeAt(e);if(!(0,r.default)(a)&&a>=56320&&a<=57343){var o=64+(1023&i),s=1023&a,u=240|o>>8&63,l=128|o>>2&63,h=128|(3&o)<<4|s>>6&15,c=128|63&s;this._ensureWrite(this._pos_+4),this._u8d_.set([u,l,h,c],this._pos_),this._pos_+=4}}else i<=65535?(this._ensureWrite(this._pos_+3),this._u8d_.set([224|i>>12,128|i>>6&63,128|63&i],this._pos_),this._pos_+=3):(this._ensureWrite(this._pos_+4),this._u8d_.set([240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i],this._pos_),this._pos_+=4)}}},{key:"writeUTFString",value:function(t){var e=this.pos;this.writeUint16(1),this.writeUTFBytes(t);var n=this.pos-e-2;this._d_.setUint16(e,n,this._xd_)}},{key:"writeUTFString32",value:function(t){var e=this.pos;this.writeUint32(1),this.writeUTFBytes(t);var n=this.pos-e-4;this._d_.setUint32(e,n,this._xd_)}},{key:"readUTFString",value:function(){return this.readUTFBytes(this.getUint16())}},{key:"readUTFString32",value:function(){return this.readUTFBytes(this.getUint32())}},{key:"getUTFString",value:function(){return this.readUTFString()}},{key:"readUTFBytes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;if(0===t)return"";var e=this.bytesAvailable;if(t>e)throw"readUTFBytes error - Out of bounds";return t=t>0?t:e,this._rUTF(t)}},{key:"getUTFBytes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;return this.readUTFBytes(t)}},{key:"writeByte",value:function(t){this._ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,t),this._pos_+=1}},{key:"readByte",value:function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)}},{key:"getByte",value:function(){return this.readByte()}},{key:"_ensureWrite",value:function(t){this._length<t&&(this._length=t),this._allocated_<t&&(this.length=t)}},{key:"writeArrayBuffer",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(e<0||n<0)throw"writeArrayBuffer error - Out of bounds";0==n&&(n=t.byteLength-e),this._ensureWrite(this._pos_+n);var i=new Uint8Array(t);this._u8d_.set(i.subarray(e,e+n),this._pos_),this._pos_+=n}},{key:"readArrayBuffer",value:function(t){var e,n;return n=(0,i.default)(e=this._u8d_.buffer).call(e,this._pos_,this._pos_+t),this._pos_=this._pos_+t,n}}],a=[{key:"getSystemEndian",value:function(){if(!t._sysEndian){var e=new ArrayBuffer(2);new DataView(e).setInt16(0,256,!0),t._sysEndian=256===new Int16Array(e)[0]?t.LITTLE_ENDIAN:t.BIG_ENDIAN}return t._sysEndian}}],n&&l(e.prototype,n),a&&l(e,a),t}();e.Byte=h,h.BIG_ENDIAN="bigEndian",h.LITTLE_ENDIAN="littleEndian",h._sysEndian=null},17939:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.CacheManger=void 0;var i=o(n(92762)),r=o(n(63978)),a=n(92493);function o(t){return t&&t.__esModule?t:{default:t}}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,r=[{key:"regCacheByFunction",value:function(e,n){var i;t.unRegCacheByFunction(e,n),i={tryDispose:e,getCacheList:n},t._cacheList.push(i)}},{key:"unRegCacheByFunction",value:function(e,n){var r,a;for(a=t._cacheList.length,r=0;r<a;r++){var o;if(t._cacheList[r].tryDispose==e&&t._cacheList[r].getCacheList==n)return void(0,i.default)(o=t._cacheList).call(o,r,1)}}},{key:"forceDispose",value:function(){var e,n=t._cacheList.length;for(e=0;e<n;e++)t._cacheList[e].tryDispose(!0)}},{key:"beginCheck",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15e3;a.ILaya.systemTimer.loop(e,null,t._checkLoop)}},{key:"stopCheck",value:function(){a.ILaya.systemTimer.clear(null,t._checkLoop)}},{key:"_checkLoop",value:function(){var e=t._cacheList;if(!(e.length<1)){var n,i,r=a.ILaya.Browser.now();for(i=n=e.length;n>0&&(t._index++,t._index=t._index%i,e[t._index].tryDispose(!1),!(a.ILaya.Browser.now()-r>t.loopTimeLimit));)n--}}}],(n=null)&&s(e.prototype,n),r&&s(e,r),t}();e.CacheManger=u,u.loopTimeLimit=2,u._cacheList=[],u._index=0},38022:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.CallLater=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(92493);function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}function u(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}var l=function(){function t(){o(this,t),this._pool=[],this._map={},this._laters=[]}return u(t,[{key:"_update",value:function(){var t=this._laters,e=t.length;if(e>0){for(var n=0,i=e-1;n<=i;n++){var r=t[n];this._map[r.key]=null,null!==r.method&&(r.run(),r.clear()),this._pool.push(r),n===i&&(i=t.length-1)}t.length=0}}},{key:"_getHandler",value:function(t,e){var n=t?t.$_GID||(t.$_GID=a.ILaya.Utils.getGID()):0,i=e.$_TID||(e.$_TID=a.ILaya.Timer._mid++);return this._map[n+"."+i]}},{key:"callLater",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null==this._getHandler(t,e)){var i;(i=this._pool.length?this._pool.pop():new h).caller=t,i.method=e,i.args=n;var r=t?t.$_GID:0,a=e.$_TID;i.key=r+"."+a,this._map[i.key]=i,this._laters.push(i)}}},{key:"runCallLater",value:function(t,e){var n=this._getHandler(t,e);n&&null!=n.method&&(this._map[n.key]=null,n.run(),n.clear())}}]),t}();e.CallLater=l,l.I=new l;var h=function(){function t(){o(this,t)}return u(t,[{key:"clear",value:function(){this.caller=null,this.method=null,this.args=null}},{key:"run",value:function(){var t=this.caller;if(t&&t.destroyed)return this.clear();var e=this.method,n=this.args;null!=e&&(n?e.apply(t,n):e.call(t))}}]),t}()},23835:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.ClassUtils=void 0;var i=l(n(31238)),r=l(n(63978)),a=n(18008),o=n(72276),s=n(92493),u=n(71706);function l(t){return t&&t.__esModule?t:{default:t}}function h(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var c=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,r=[{key:"regClass",value:function(e,n){t._classMap[e]=n}},{key:"regShortClassName",value:function(e){for(var n=0;n<e.length;n++){var i=e[n],r=i.name;t._classMap[r]=i}}},{key:"getRegClass",value:function(e){return t._classMap[e]}},{key:"getClass",value:function(e){var n=t._classMap[e]||t._classMap["Laya."+e]||e,i=s.ILaya.Laya;return"string"==typeof n?s.ILaya.__classMap[n]||i[e]:n}},{key:"getInstance",value:function(e){var n=t.getClass(e);return n?new n:(console.warn("[error] Undefined class:",e),null)}},{key:"createByJson",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;"string"==typeof e&&(e=JSON.parse(e));var o=e.props;if(!n&&!(n=a?a.runWith(e):t.getInstance(o.runtime||e.type)))return null;var s=e.child;if(s)for(var u=0,l=s.length;u<l;u++){var h=s[u];if("render"!==h.props.name&&"render"!==h.props.renderType||!n._$set_itemRender)if("Graphic"==h.type)t._addGraphicsToSprite(h,n);else if(t._isDrawType(h.type))t._addGraphicToSprite(h,n,!0);else{var c=t.createByJson(h,null,i,r,a);"Script"===h.type?"owner"in c?c.owner=n:"target"in c&&(c.target=n):"mask"==h.props.renderType?n.mask=c:n.addChild(c)}else n.itemRender=h}if(o)for(var f in o){var _=o[f];"var"===f&&i?i[_]=n:_ instanceof Array&&n[f]instanceof Function?n[f].apply(n,_):n[f]=_}return r&&e.customProps&&r.runWith([n,e]),n.created&&n.created(),n}},{key:"_addGraphicsToSprite",value:function(e,n){var i=e.child;if(i&&!(i.length<1)){var r,a,o=t._getGraphicsFromSprite(e,n),s=0,u=0;for(e.props&&(s=t._getObjVar(e.props,"x",0),u=t._getObjVar(e.props,"y",0)),0!=s&&0!=u&&o.translate(s,u),a=i.length,r=0;r<a;r++)t._addGraphicToGraphics(i[r],o);0!=s&&0!=u&&o.translate(-s,-u)}}},{key:"_addGraphicToSprite",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=i?t._getGraphicsFromSprite(e,n):n.graphics;t._addGraphicToGraphics(e,r)}},{key:"_getGraphicsFromSprite",value:function(t,e){if(!t||!t.props)return e.graphics;var n=t.props.renderType;if("hit"===n||"unHit"===n){var i=e._style.hitArea||(e.hitArea=new u.HitArea);i[n]||(i[n]=new o.Graphics);var r=i[n]}return r||(r=e.graphics),r}},{key:"_getTransformData",value:function(e){var n;("pivotX"in e||"pivotY"in e)&&(n=n||new a.Matrix).translate(-t._getObjVar(e,"pivotX",0),-t._getObjVar(e,"pivotY",0));var i=t._getObjVar(e,"scaleX",1),r=t._getObjVar(e,"scaleY",1),o=t._getObjVar(e,"rotation",0);return t._getObjVar(e,"skewX",0),t._getObjVar(e,"skewY",0),1==i&&1==r&&0==o||((n=n||new a.Matrix).scale(i,r),n.rotate(.0174532922222222*o)),n}},{key:"_addGraphicToGraphics",value:function(e,n){var i,r;if((i=e.props)&&(r=t.DrawTypeDic[e.type])){var a=n,o=t._getParams(i,r[1],r[2],r[3]),s=t._tM;(s||1!=t._alpha)&&(a.save(),s&&a.transform(s),1!=t._alpha&&a.alpha(t._alpha)),a[r[0]].apply(a,o),(s||1!=t._alpha)&&a.restore()}}},{key:"_adptLineData",value:function(t){return t[2]=(0,i.default)(t[0])+(0,i.default)(t[2]),t[3]=(0,i.default)(t[1])+(0,i.default)(t[3]),t}},{key:"_adptTextureData",value:function(t){return t[0]=s.ILaya.Loader.getRes(t[0]),t}},{key:"_adptLinesData",value:function(e){return e[2]=t._getPointListByStr(e[2]),e}},{key:"_isDrawType",value:function(e){return"Image"!==e&&e in t.DrawTypeDic}},{key:"_getParams",value:function(e,n){var i,r,a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=t._temParam;for(u.length=n.length,r=n.length,i=0;i<r;i++)u[i]=t._getObjVar(e,n[i][0],n[i][1]);return t._alpha=t._getObjVar(e,"alpha",1),(a=t._getTransformData(e))?(o||(o=0),a.translate(u[o],u[o+1]),u[o]=u[o+1]=0,t._tM=a):t._tM=null,s&&t[s]&&(u=t[s](u)),u}},{key:"_getPointListByStr",value:function(t){var e,n,r=t.split(",");for(n=r.length,e=0;e<n;e++)r[e]=(0,i.default)(r[e]);return r}},{key:"_getObjVar",value:function(t,e,n){return e in t?t[e]:n}}],(n=null)&&h(e.prototype,n),r&&h(e,r),t}();e.ClassUtils=c,c.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]},c._temParam=[],c._classMap={}},13104:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.ColorUtils=void 0;var i=u(n(81643)),r=u(n(31238)),a=u(n(94198)),o=u(n(63978)),s=n(56083);function u(t){return t&&t.__esModule?t:{default:t}}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,o.default)(t,i.key,i)}}var h=function(){function t(e){var n,o,u,l;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.arrColor=[],null==e||"none"==e)return this.strColor="#00000000",this.numColor=0,void(this.arrColor=[0,0,0,0]);if("string"==typeof e)if((0,i.default)(e).call(e,"rgba(")>=0||(0,i.default)(e).call(e,"rgb(")>=0){var h,c,f=e;for(h=(0,i.default)(f).call(f,"("),c=(0,i.default)(f).call(f,")"),f=f.substring(h+1,c),this.arrColor=f.split(","),u=this.arrColor.length,o=0;o<u;o++)this.arrColor[o]=(0,r.default)(this.arrColor[o]),o<3&&(this.arrColor[o]=Math.round(this.arrColor[o]));l=4==this.arrColor.length?256*(256*(256*this.arrColor[0]+this.arrColor[1])+this.arrColor[2])+Math.round(255*this.arrColor[3]):256*(256*this.arrColor[0]+this.arrColor[1])+this.arrColor[2],this.strColor=e}else{if(this.strColor=e,"#"===e.charAt(0)&&(e=e.substr(1)),3===(u=e.length)||4===u){var _="";for(o=0;o<u;o++)_+=e[o]+e[o];e=_}l=(0,a.default)(e,16)}else l=e,this.strColor=s.Utils.toHexColor(l);(0,i.default)(n=this.strColor).call(n,"rgba")>=0||9===this.strColor.length?(this.arrColor=[((4278190080&l)>>>24)/255,((16711680&l)>>16)/255,((65280&l)>>8)/255,(255&l)/255],this.numColor=(4278190080&l)>>>24|(16711680&l)>>8|(65280&l)<<8|(255&l)<<24):(this.arrColor=[((16711680&l)>>16)/255,((65280&l)>>8)/255,(255&l)/255,1],this.numColor=4278190080|(16711680&l)>>16|65280&l|(255&l)<<16),this.arrColor.__id=++t._COLODID}var e,n,o;return e=t,o=[{key:"_initDefault",value:function(){for(var e in t._DEFAULT={},t._COLOR_MAP)t._SAVE[e]=t._DEFAULT[e]=new t(t._COLOR_MAP[e]);return t._DEFAULT}},{key:"_initSaveMap",value:function(){for(var e in t._SAVE_SIZE=0,t._SAVE={},t._DEFAULT)t._SAVE[e]=t._DEFAULT[e]}},{key:"create",value:function(e){var n=e+"",i=t._SAVE[n];return null!=i?i:(t._SAVE_SIZE<1e3&&t._initSaveMap(),t._SAVE[n]=new t(e))}}],(n=null)&&l(e.prototype,n),o&&l(e,o),t}();e.ColorUtils=h,h._SAVE={},h._SAVE_SIZE=0,h._COLOR_MAP={purple:"#800080",orange:"#ffa500",white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#808080"},h._DEFAULT=h._initDefault(),h._COLODID=1},97617:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Dragging=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(89662),o=n(47002),s=n(92493),u=n(45840),l=n(41107),h=n(84221);function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var f=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}var e,n,i;return e=t,n=[{key:"start",value:function(t,e,n,i,r,o,u){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:.92;this.clearTimer(),this.target=t,this.area=e,this.hasInertia=n,this.elasticDistance=e?i:0,this.elasticBackTime=r,this.data=o,this._disableMouseEvent=u,this.ratio=l,this._parent=t.parent,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,s.ILaya.stage.on(a.Event.MOUSE_UP,this,this.onStageMouseUp),s.ILaya.stage.on(a.Event.MOUSE_OUT,this,this.onStageMouseUp),s.ILaya.systemTimer.frameLoop(1,this,this.loop)}},{key:"clearTimer",value:function(){s.ILaya.systemTimer.clear(this,this.loop),s.ILaya.systemTimer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)}},{key:"stop",value:function(){this._dragging&&(o.MouseManager.instance.disableMouseEvent=!1,s.ILaya.stage.off(a.Event.MOUSE_UP,this,this.onStageMouseUp),s.ILaya.stage.off(a.Event.MOUSE_OUT,this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())}},{key:"loop",value:function(){var t=this._parent.getMousePoint(),e=t.x,n=t.y,i=e-this._lastX,r=n-this._lastY;if(this._clickOnly){if(!(Math.abs(i*s.ILaya.stage._canvasTransform.getScaleX())>1||Math.abs(r*s.ILaya.stage._canvasTransform.getScaleY())>1))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event(a.Event.DRAG_START,this.data),o.MouseManager.instance.disableMouseEvent=this._disableMouseEvent}else this._offsets.push(i,r);0===i&&0===r||(this._lastX=e,this._lastY=n,this.target.x+=i*this._elasticRateX,this.target.y+=r*this._elasticRateY,this.area&&this.checkArea(),this.target.event(a.Event.DRAG_MOVE,this.data))}},{key:"checkArea",value:function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target._x<this.area.x)var t=this.area.x-this.target._x;else t=this.target._x>this.area.x+this.area.width?this.target._x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-t/this.elasticDistance),this.target._y<this.area.y)var e=this.area.y-this.target.y;else e=this.target._y>this.area.y+this.area.height?this.target._y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-e/this.elasticDistance)}}},{key:"backToArea",value:function(){this.target.x=Math.min(Math.max(this.target._x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target._y,this.area.y),this.area.y+this.area.height)}},{key:"onStageMouseUp",value:function(t){if(o.MouseManager.instance.disableMouseEvent=!1,s.ILaya.stage.off(a.Event.MOUSE_UP,this,this.onStageMouseUp),s.ILaya.stage.off(a.Event.MOUSE_OUT,this,this.onStageMouseUp),s.ILaya.systemTimer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var e=this._offsets.length,n=Math.min(e,6),i=this._offsets.length-n,r=e-1;r>i;r--)this._offsetY+=this._offsets[r--],this._offsetX+=this._offsets[r];this._offsetX=this._offsetX/n*2,this._offsetY=this._offsetY/n*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=this._offsetX>0?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=this._offsetY>0?this.maxOffset:-this.maxOffset),s.ILaya.systemTimer.frameLoop(1,this,this.tweenMove)}else this.elasticDistance>0?this.checkElastic():this.clear()}},{key:"checkElastic",value:function(){var t=NaN,e=NaN;if(this.target.x<this.area.x?t=this.area.x:this.target._x>this.area.x+this.area.width&&(t=this.area.x+this.area.width),this.target.y<this.area.y?e=this.area.y:this.target._y>this.area.y+this.area.height&&(e=this.area.y+this.area.height),isNaN(t)&&isNaN(e))this.clear();else{var n={};isNaN(t)||(n.x=t),isNaN(e)||(n.y=e),this._tween=h.Tween.to(this.target,n,this.elasticBackTime,u.Ease.sineOut,l.Handler.create(this,this.clear),0,!1,!1)}}},{key:"tweenMove",value:function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event(a.Event.DRAG_MOVE,this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(s.ILaya.systemTimer.clear(this,this.tweenMove),this.elasticDistance>0?this.checkElastic():this.clear())}},{key:"clear",value:function(){if(this.target){this.clearTimer();var t=this.target;this.target=null,this._parent=null,t.event(a.Event.DRAG_END,this.data)}}}],n&&c(e.prototype,n),i&&c(e,i),t}();e.Dragging=f},45840:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Ease=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i};function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"linearNone",value:function(t,e,n,i){return n*t/i+e}},{key:"linearIn",value:function(t,e,n,i){return n*t/i+e}},{key:"linearInOut",value:function(t,e,n,i){return n*t/i+e}},{key:"linearOut",value:function(t,e,n,i){return n*t/i+e}},{key:"bounceIn",value:function(e,n,i,r){return i-t.bounceOut(r-e,0,i,r)+n}},{key:"bounceInOut",value:function(e,n,i,r){return e<.5*r?.5*t.bounceIn(2*e,0,i,r)+n:.5*t.bounceOut(2*e-r,0,i,r)+.5*i+n}},{key:"bounceOut",value:function(t,e,n,i){return(t/=i)<1/2.75?n*(7.5625*t*t)+e:t<2/2.75?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e}},{key:"backIn",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1.70158;return n*(t/=i)*t*((r+1)*t-r)+e}},{key:"backInOut",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1.70158;return(t/=.5*i)<1?.5*n*(t*t*((1+(r*=1.525))*t-r))+e:n/2*((t-=2)*t*((1+(r*=1.525))*t+r)+2)+e}},{key:"backOut",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1.70158;return n*((t=t/i-1)*t*((r+1)*t+r)+1)+e}},{key:"elasticIn",value:function(e,n,i,r){var a,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return 0==e?n:1==(e/=r)?n+i:(s||(s=.3*r),!o||i>0&&o<i||i<0&&o<-i?(o=i,a=s/4):a=s/t.PI2*Math.asin(i/o),-o*Math.pow(2,10*(e-=1))*Math.sin((e*r-a)*t.PI2/s)+n)}},{key:"elasticInOut",value:function(e,n,i,r){var a,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return 0==e?n:2==(e/=.5*r)?n+i:(s||(s=r*(.3*1.5)),!o||i>0&&o<i||i<0&&o<-i?(o=i,a=s/4):a=s/t.PI2*Math.asin(i/o),e<1?o*Math.pow(2,10*(e-=1))*Math.sin((e*r-a)*t.PI2/s)*-.5+n:o*Math.pow(2,-10*(e-=1))*Math.sin((e*r-a)*t.PI2/s)*.5+i+n)}},{key:"elasticOut",value:function(e,n,i,r){var a,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return 0==e?n:1==(e/=r)?n+i:(s||(s=.3*r),!o||i>0&&o<i||i<0&&o<-i?(o=i,a=s/4):a=s/t.PI2*Math.asin(i/o),o*Math.pow(2,-10*e)*Math.sin((e*r-a)*t.PI2/s)+i+n)}},{key:"strongIn",value:function(t,e,n,i){return n*(t/=i)*t*t*t*t+e}},{key:"strongInOut",value:function(t,e,n,i){return(t/=.5*i)<1?.5*n*t*t*t*t*t+e:.5*n*((t-=2)*t*t*t*t+2)+e}},{key:"strongOut",value:function(t,e,n,i){return n*((t=t/i-1)*t*t*t*t+1)+e}},{key:"sineInOut",value:function(t,e,n,i){return.5*-n*(Math.cos(Math.PI*t/i)-1)+e}},{key:"sineIn",value:function(e,n,i,r){return-i*Math.cos(e/r*t.HALF_PI)+i+n}},{key:"sineOut",value:function(e,n,i,r){return i*Math.sin(e/r*t.HALF_PI)+n}},{key:"quintIn",value:function(t,e,n,i){return n*(t/=i)*t*t*t*t+e}},{key:"quintInOut",value:function(t,e,n,i){return(t/=.5*i)<1?.5*n*t*t*t*t*t+e:.5*n*((t-=2)*t*t*t*t+2)+e}},{key:"quintOut",value:function(t,e,n,i){return n*((t=t/i-1)*t*t*t*t+1)+e}},{key:"quartIn",value:function(t,e,n,i){return n*(t/=i)*t*t*t+e}},{key:"quartInOut",value:function(t,e,n,i){return(t/=.5*i)<1?.5*n*t*t*t*t+e:.5*-n*((t-=2)*t*t*t-2)+e}},{key:"quartOut",value:function(t,e,n,i){return-n*((t=t/i-1)*t*t*t-1)+e}},{key:"cubicIn",value:function(t,e,n,i){return n*(t/=i)*t*t+e}},{key:"cubicInOut",value:function(t,e,n,i){return(t/=.5*i)<1?.5*n*t*t*t+e:.5*n*((t-=2)*t*t+2)+e}},{key:"cubicOut",value:function(t,e,n,i){return n*((t=t/i-1)*t*t+1)+e}},{key:"quadIn",value:function(t,e,n,i){return n*(t/=i)*t+e}},{key:"quadInOut",value:function(t,e,n,i){return(t/=.5*i)<1?.5*n*t*t+e:.5*-n*(--t*(t-2)-1)+e}},{key:"quadOut",value:function(t,e,n,i){return-n*(t/=i)*(t-2)+e}},{key:"expoIn",value:function(t,e,n,i){return 0==t?e:n*Math.pow(2,10*(t/i-1))+e-.001*n}},{key:"expoInOut",value:function(t,e,n,i){return 0==t?e:t==i?e+n:(t/=.5*i)<1?.5*n*Math.pow(2,10*(t-1))+e:.5*n*(2-Math.pow(2,-10*--t))+e}},{key:"expoOut",value:function(t,e,n,i){return t==i?e+n:n*(1-Math.pow(2,-10*t/i))+e}},{key:"circIn",value:function(t,e,n,i){return-n*(Math.sqrt(1-(t/=i)*t)-1)+e}},{key:"circInOut",value:function(t,e,n,i){return(t/=.5*i)<1?.5*-n*(Math.sqrt(1-t*t)-1)+e:.5*n*(Math.sqrt(1-(t-=2)*t)+1)+e}},{key:"circOut",value:function(t,e,n,i){return n*Math.sqrt(1-(t=t/i-1)*t)+e}}],(n=null)&&a(e.prototype,n),i&&a(e,i),t}();e.Ease=o,o.HALF_PI=.5*Math.PI,o.PI2=2*Math.PI},75494:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.FontInfo=void 0;var i=o(n(81643)),r=o(n(94198)),a=o(n(63978));function o(t){return t&&t.__esModule?t:{default:t}}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,a.default)(t,i.key,i)}}var u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._font="14px Arial",this._family="Arial",this._size=14,this._italic=!1,this._bold=!1,this._id=t._gfontID++,this.setFont(e||this._font)}var e,n,a;return e=t,a=[{key:"Parse",value:function(e){if(e===t._lastFont)return t._lastFontInfo;var n=t._cache[e];return n||(n=t._cache[e]=new t(e)),t._lastFont=e,t._lastFontInfo=n,n}}],(n=[{key:"setFont",value:function(t){this._font=t;var e=t.split(" "),n=e.length;if(n<2){var a;1==n&&(0,i.default)(a=e[0]).call(a,"px")>0&&(this._size=(0,r.default)(e[0]))}else{for(var o=-1,s=0;s<n;s++){var u,l;if((0,i.default)(u=e[s]).call(u,"px")>0||(0,i.default)(l=e[s]).call(l,"pt")>0){o=s,this._size=(0,r.default)(e[s]),this._size<=0&&(console.error("font parse error:"+t),this._size=14);break}}var h=o+1,c=e[h];for(h++;h<n;h++)c+=" "+e[h];this._family=c.split(",")[0],this._italic=(0,i.default)(e).call(e,"italic")>=0,this._bold=(0,i.default)(e).call(e,"bold")>=0}}}])&&s(e.prototype,n),a&&s(e,a),t}();e.FontInfo=u,u.EMPTY=new u(null),u._cache={},u._gfontID=0,u._lastFont=""},22847:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.GraphicAnimation=void 0;var f=g(n(85507)),_=g(n(21611)),d=n(24288),p=n(72276),y=n(18008),v=n(85096);function g(t){return t&&t.__esModule?t:{default:t}}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function T(){return T="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=x(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},T.apply(this,arguments)}function x(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=E(t)););return t}function w(t,e){return w=a||function(t,e){return t.__proto__=e,t},w(t,e)}function k(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=E(t);if(e){var a=E(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return C(this,n)}}function C(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function E(t){return E=f.default?_.default:function(t){return t.__proto__||(0,_.default)(t)},E(t)}var S=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}(a,t);var e,n,i,r=k(a);function a(){var t;return m(this,a),(t=r.apply(this,arguments))._nodeIDAniDic={},t}return e=a,n=[{key:"_parseNodeList",value:function(t){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[t.compId]=t.props,t.compId&&this._nodeList.push(t.compId);var e=t.child;if(e){var n,i=e.length;for(n=0;n<i;n++)this._parseNodeList(e[n])}}},{key:"_calGraphicData",value:function(t){var e;if(this._setUp(null,t),this._createGraphicData(),this._nodeIDAniDic)for(e in this._nodeIDAniDic)this._nodeIDAniDic[e]=null}},{key:"_createGraphicData",value:function(){var t,e,n=[],i=this.count,r=this._usedFrames;for(r||(r=[]),t=0;t<i;t++)!r[t]&&e||(e=this._createFrameGraphic(t)),n.push(e);this._gList=n}},{key:"_createFrameGraphic",value:function(t){var e=new p.Graphics;return a._rootMatrix||(a._rootMatrix=new y.Matrix),this._updateNodeGraphic(this._rootNode,t,a._rootMatrix,e),e}},{key:"_updateNodeGraphic",value:function(t,e,n,i){var r,a,o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;(r=this._nodeGDic[t.compId]=this._getNodeGraphicData(t.compId,e,this._nodeGDic[t.compId])).resultTransform||(r.resultTransform=new y.Matrix),a=r.resultTransform,y.Matrix.mul(r.transform,n,a);var u=r.alpha*s;if(!(u<.01)){r.skin&&(o=this._getTextureByUrl(r.skin))&&(a._checkTransform()?(i.drawTexture(o,0,0,r.width,r.height,a,u),r.resultTransform=null):i.drawTexture(o,a.tx,a.ty,r.width,r.height,null,u));var l,h,c=t.child;if(c)for(h=c.length,l=0;l<h;l++)this._updateNodeGraphic(c[l],e,a,i,u)}}},{key:"_updateNoChilds",value:function(t,e){if(t.skin){var n=this._getTextureByUrl(t.skin);if(n){var i=t.transform;i._checkTransform(),i._bTransform?e.drawTexture(n,0,0,t.width,t.height,i.clone(),t.alpha):e.drawTexture(n,i.tx,i.ty,t.width,t.height,null,t.alpha)}}}},{key:"_updateNodeGraphic2",value:function(t,e,n){var i;if(i=this._nodeGDic[t.compId]=this._getNodeGraphicData(t.compId,e,this._nodeGDic[t.compId]),t.child){var r,a,o,s=i.transform;s._checkTransform(),a=(r=!s._bTransform)&&(0!=s.tx||0!=s.ty),(o=s._bTransform||1!=i.alpha)&&n.save(),1!=i.alpha&&n.alpha(i.alpha),r?a&&n.translate(s.tx,s.ty):n.transform(s.clone());var u,l,h,c=t.child;if(i.skin&&(u=this._getTextureByUrl(i.skin))&&n.drawImage(u,0,0,i.width,i.height),c)for(h=c.length,l=0;l<h;l++)this._updateNodeGraphic2(c[l],e,n);o?n.restore():r?a&&n.translate(-s.tx,-s.ty):n.transform(s.clone().invert())}else this._updateNoChilds(i,n)}},{key:"_calculateKeyFrames",value:function(t){T(E(a.prototype),"_calculateKeyFrames",this).call(this,t),this._nodeIDAniDic[t.target]=t}},{key:"getNodeDataByID",value:function(t){return this._nodeIDAniDic[t]}},{key:"_getParams",value:function(t,e,n,i){var r=a._temParam;r.length=e.length;var o,s=e.length;for(o=0;o<s;o++)r[o]=this._getObjVar(t,e[o][0],n,e[o][1],i);return r}},{key:"_getObjVar",value:function(t,e,n,i,r){if(e in t){var a=t[e];return n>=a.length&&(n=a.length-1),t[e][n]}return e in r?r[e]:i}},{key:"_getNodeGraphicData",value:function(t,e,n){n||(n=new M),n.transform?n.transform.identity():n.transform=new y.Matrix;var i=this.getNodeDataByID(t);if(!i)return n;var r,o,s,u=i.frames,l=this._getParams(u,a._drawTextureCmd,e,this._nodeDefaultProps[t]),h=l[0],c=l[5],f=l[6],_=l[13],d=l[14],p=l[7],v=l[8],g=l[9],m=l[11],b=l[12];r=l[3],o=l[4],0!=r&&0!=o||(h=null),-1==r&&(r=0),-1==o&&(o=0),n.skin=h,n.width=r,n.height=o,h&&((s=this._getTextureByUrl(h))?(r||(r=s.sourceWidth),o||(o=s.sourceHeight)):console.warn("lost skin:",h,",you may load pics first")),n.alpha=l[10];var T=n.transform;0!=_&&(c=_*r),0!=d&&(f=d*o),0==c&&0==f||T.translate(-c,-f);var x=null;if(g||1!==p||1!==v||m||b){(x=a._tempMt).identity(),x._bTransform=!0;var w=.0174532922222222*(g-m),k=.0174532922222222*(g+b),C=Math.cos(k),E=Math.sin(k),S=Math.sin(w),L=Math.cos(w);x.a=p*C,x.b=p*E,x.c=-v*S,x.d=v*L,x.tx=x.ty=0}return x&&(T=y.Matrix.mul(T,x,T)),T.translate(l[1],l[2]),n}},{key:"_getTextureByUrl",value:function(t){return v.Loader.getRes(t)}},{key:"setAniData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=t,this._parseNodeList(t);var n,i,r={},o=[],s=t.animations,u=s.length;for(n=0;n<u;n++)if(i=s[n],this._labels=null,(!e||e==i.name)&&i){try{this._calGraphicData(i)}catch(t){console.warn("parse animation fail:"+i.name+",empty animation created"),this._gList=[]}var l={};l.interval=1e3/i.frameRate,l.frames=this._gList,l.labels=this._labels,l.name=i.name,o.push(l),r[i.name]=l}this.animationList=o,this.animationDic=r}a._temParam.length=0}},{key:"parseByData",value:function(t){var e,n;e=t.nodeRoot,n=t.aniO,delete t.nodeRoot,delete t.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=e,this._parseNodeList(e),this._labels=null;try{this._calGraphicData(n)}catch(t){console.warn("parse animation fail:"+n.name+",empty animation created"),this._gList=[]}var i=t;return i.interval=1e3/n.frameRate,i.frames=this._gList,i.labels=this._labels,i.name=n.name,i}},{key:"setUpAniData",value:function(t){if(t.animations){var e,n,i={},r=[],a=t.animations,o=a.length;for(e=0;e<o;e++)if(n=a[e]){var s={};s.name=n.name,s.aniO=n,s.nodeRoot=t,r.push(s),i[n.name]=s}this.animationList=r,this.animationDic=i}}},{key:"_clear",value:function(){this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic=null}}],i=[{key:"parseAnimationByData",value:function(t){var e;return a._I||(a._I=new a),e=a._I.parseByData(t),a._I._clear(),e}},{key:"parseAnimationData",value:function(t){var e;return a._I||(a._I=new a),a._I.setUpAniData(t),(e={}).animationList=a._I.animationList,e.animationDic=a._I.animationDic,a._I._clear(),e}}],n&&b(e.prototype,n),i&&b(e,i),a}(d.FrameAnimation);e.GraphicAnimation=S,S._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],S._temParam=[],S._tempMt=new y.Matrix;var M=function t(){m(this,t),this.alpha=1}},25810:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.HTMLChar=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(64210);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.reset()}var e,n,i;return e=t,i=[{key:"create",value:function(){return a.Pool.getItemByClass("HTMLChar",t)}}],(n=[{key:"setData",value:function(e,n,i,r){return this.char=e,this.charNum=e.charCodeAt(0),this.x=this.y=0,this.width=n,this.height=i,this.style=r,this.isWord=!t._isWordRegExp.test(e),this}},{key:"reset",value:function(){return this.x=this.y=this.width=this.height=0,this.isWord=!1,this.char=null,this.charNum=0,this.style=null,this}},{key:"recover",value:function(){a.Pool.recover("HTMLChar",this.reset())}},{key:"_isChar",value:function(){return!0}},{key:"_getCSSStyle",value:function(){return this.style}}])&&o(e.prototype,n),i&&o(e,i),t}();e.HTMLChar=s,s._isWordRegExp=new RegExp("[\\w.]","")},34277:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.HalfFloatUtils=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i};function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"__init__",value:function(){for(var e=0;e<256;++e){var n=e-127;n<-27?(t._baseTable[0|e]=0,t._baseTable[256|e]=32768,t._shiftTable[0|e]=24,t._shiftTable[256|e]=24):n<-14?(t._baseTable[0|e]=1024>>-n-14,t._baseTable[256|e]=1024>>-n-14|32768,t._shiftTable[0|e]=-n-1,t._shiftTable[256|e]=-n-1):n<=15?(t._baseTable[0|e]=n+15<<10,t._baseTable[256|e]=n+15<<10|32768,t._shiftTable[0|e]=13,t._shiftTable[256|e]=13):n<128?(t._baseTable[0|e]=31744,t._baseTable[256|e]=64512,t._shiftTable[0|e]=24,t._shiftTable[256|e]=24):(t._baseTable[0|e]=31744,t._baseTable[256|e]=64512,t._shiftTable[0|e]=13,t._shiftTable[256|e]=13)}for(t._mantissaTable[0]=0,e=1;e<1024;++e){var i=e<<13;for(n=0;0==(8388608&i);)n-=8388608,i<<=1;i&=-8388609,n+=947912704,t._mantissaTable[e]=i|n}for(e=1024;e<2048;++e)t._mantissaTable[e]=939524096+(e-1024<<13);for(t._exponentTable[0]=0,e=1;e<31;++e)t._exponentTable[e]=e<<23;for(t._exponentTable[31]=1199570944,t._exponentTable[32]=2147483648,e=33;e<63;++e)t._exponentTable[e]=2147483648+(e-32<<23);for(t._exponentTable[63]=3347054592,t._offsetTable[0]=0,e=1;e<64;++e)t._offsetTable[e]=32===e?0:1024}},{key:"roundToFloat16Bits",value:function(e){t._floatView[0]=e;var n=t._uint32View[0],i=n>>23&511;return t._baseTable[i]+((8388607&n)>>t._shiftTable[i])}},{key:"convertToNumber",value:function(e){var n=e>>10;return t._uint32View[0]=t._mantissaTable[t._offsetTable[n]+(1023&e)]+t._exponentTable[n],t._floatView[0]}}],(n=null)&&a(e.prototype,n),i&&a(e,i),t}();e.HalfFloatUtils=o,o._buffer=new ArrayBuffer(4),o._floatView=new Float32Array(o._buffer),o._uint32View=new Uint32Array(o._buffer),o._baseTable=new Uint32Array(512),o._shiftTable=new Uint32Array(512),o._mantissaTable=new Uint32Array(2048),o._exponentTable=new Uint32Array(64),o._offsetTable=new Uint32Array(64)},41107:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Handler=void 0;var i=a(n(77766)),r=a(n(63978));function a(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];o(this,t),this.once=!1,this._id=0,this.setTo(e,n,i,r)}var e,n,r;return e=t,n=[{key:"setTo",value:function(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this._id=t._gid++,this.caller=e,this.method=n,this.args=i,this.once=r,this}},{key:"run",value:function(){if(null==this.method)return null;var t=this._id,e=this.method.apply(this.caller,this.args);return this._id===t&&this.once&&this.recover(),e}},{key:"runWith",value:function(t){var e;if(null==this.method)return null;var n=this._id;if(null==t)var r=this.method.apply(this.caller,this.args);else r=this.args||t.unshift?this.args?this.method.apply(this.caller,(0,i.default)(e=this.args).call(e,t)):this.method.apply(this.caller,t):this.method.call(this.caller,t);return this._id===n&&this.once&&this.recover(),r}},{key:"clear",value:function(){return this.caller=null,this.method=null,this.args=null,this}},{key:"recover",value:function(){this._id>0&&(this._id=0,t._pool.push(this.clear()))}}],r=[{key:"create",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return t._pool.length?t._pool.pop().setTo(e,n,i,r):new t(e,n,i,r)}}],n&&s(e.prototype,n),r&&s(e,r),t}();e.Handler=u,u._pool=[],u._gid=1},71706:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.HitArea=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(85399),o=n(98693),s=n(92493);function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"_isHitGraphic",value:function(e,n,i){if(!i)return!1;var r,a,o,s=i.cmds;if(!s&&i._one&&((s=t._cmds).length=1,s[0]=i._one),!s)return!1;for(a=s.length,r=0;r<a;r++)if((o=s[r])&&("Translate"===o.cmdID&&(e-=o.tx,n-=o.ty),t._isHitCmd(e,n,o)))return!0;return!1}},{key:"_isHitCmd",value:function(e,n,i){if(!i)return!1;var r=!1;switch(i.cmdID){case"DrawRect":t._rect.setTo(i.x,i.y,i.width,i.height),r=t._rect.contains(e,n);break;case"DrawCircle":r=(e-=i.x)*e+(n-=i.y)*n<i.radius*i.radius;break;case"DrawPoly":e-=i.x,n-=i.y,r=t._ptInPolygon(e,n,i.points)}return r}},{key:"_ptInPolygon",value:function(e,n,i){var r=t._ptPoint;r.setTo(e,n);var a,o,s,u,l,h=0;l=i.length;for(var c=0;c<l;c+=2)a=i[c],o=i[c+1],s=i[(c+2)%l],o!=(u=i[(c+3)%l])&&(r.y<Math.min(o,u)||r.y>=Math.max(o,u)||(r.y-o)*(s-a)/(u-o)+a>r.x&&h++);return h%2==1}}],(n=[{key:"contains",value:function(e,n){return!!t._isHitGraphic(e,n,this.hit)&&!t._isHitGraphic(e,n,this.unHit)}},{key:"hit",get:function(){return this._hit||(this._hit=new s.ILaya.Graphics),this._hit},set:function(t){this._hit=t}},{key:"unHit",get:function(){return this._unHit||(this._unHit=new s.ILaya.Graphics),this._unHit},set:function(t){this._unHit=t}}])&&u(e.prototype,n),i&&u(e,i),t}();e.HitArea=l,l._cmds=[],l._rect=new o.Rectangle,l._ptPoint=new a.Point},82671:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.IStatRender=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i};function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,(n=[{key:"show",value:function(){}},{key:"enable",value:function(){}},{key:"hide",value:function(){}},{key:"set_onclick",value:function(t){}},{key:"isCanvasRender",value:function(){return!0}},{key:"renderNotCanvas",value:function(t,e,n){}}])&&a(e.prototype,n),i&&a(e,i),t}();e.IStatRender=o},32996:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Mouse=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(93568);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"cursor",get:function(){return t._style.cursor},set:function(e){t._style.cursor=e}},{key:"__init__",value:function(){t._style=a.Browser.document.body.style}},{key:"hide",value:function(){"none"!=t.cursor&&(t._preCursor=t.cursor,t.cursor="none")}},{key:"show",value:function(){"none"==t.cursor&&(t._preCursor?t.cursor=t._preCursor:t.cursor="auto")}}],(n=null)&&o(e.prototype,n),i&&o(e,i),t}();e.Mouse=s},23877:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.PerformancePlugin=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i};function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"setPerformanceDataTool",value:function(t){this.performanceTool=t}},{key:"begainSample",value:function(t){this.performanceTool&&this.performanceTool.enable&&this.performanceTool.BegainSample(t)}},{key:"endSample",value:function(t){return this.performanceTool&&this.performanceTool.enable?this.performanceTool.EndSample(t):0}},{key:"expoertFile",value:function(t){if(this.performanceTool)return this.performanceTool.enable?this.performanceTool.exportPerformanceFile():null}},{key:"showFunSampleFun",value:function(t){this.performanceTool.showFunSampleFun(t)}},{key:"enable",get:function(){return!!this.performanceTool&&this._enable},set:function(t){this.performanceTool&&(this.performanceTool.enable=t)}},{key:"enableDataExport",get:function(){return!!this.performanceTool&&this.performanceTool.enableDataExport},set:function(t){this.performanceTool&&(this.performanceTool.enableDataExport=t)}}],(n=null)&&a(e.prototype,n),i&&a(e,i),t}();e.PerformancePlugin=o,o.performanceTool=null,o._enable=!1,o.PERFORMANCE_LAYA="Laya",o.PERFORMANCE_LAYA_3D="Laya/3D",o.PERFORMANCE_LAYA_2D="Laya/2D",o.PERFORMANCE_LAYA_3D_PRERENDER="Laya/3D/PreRender",o.PERFORMANCE_LAYA_3D_UPDATESCRIPT="Laya/3D/UpdateScript",o.PERFORMANCE_LAYA_3D_PHYSICS="Laya/3D/Physics",o.PERFORMANCE_LAYA_3D_PHYSICS_SIMULATE="Laya/3D/Physics/simulate",o.PERFORMANCE_LAYA_3D_PHYSICS_CHARACTORCOLLISION="Laya/3D/Physics/updataCharacters&Collisions",o.PERFORMANCE_LAYA_3D_PHYSICS_EVENTSCRIPTS="Laya/3D/Physics/eventScripts",o.PERFORMANCE_LAYA_3D_RENDER="Laya/3D/Render",o.PERFORMANCE_LAYA_3D_RENDER_SHADOWMAP="Laya/3D/Render/ShadowMap",o.PERFORMANCE_LAYA_3D_RENDER_CLUSTER="Laya/3D/Render/Cluster",o.PERFORMANCE_LAYA_3D_RENDER_CULLING="Laya/3D/Render/Culling",o.PERFORMANCE_LAYA_3D_RENDER_RENDERDEPTHMDOE="Laya/3D/Render/RenderDepthMode",o.PERFORMANCE_LAYA_3D_RENDER_RENDEROPAQUE="Laya/3D/Render/RenderOpaque",o.PERFORMANCE_LAYA_3D_RENDER_RENDERCOMMANDBUFFER="Laya/3D/Render/RenderCommandBuffer",o.PERFORMANCE_LAYA_3D_RENDER_RENDERTRANSPARENT="Laya/3D/Render/RenderTransparent",o.PERFORMANCE_LAYA_3D_RENDER_POSTPROCESS="Laya/3D/Render/PostProcess",window.PerformancePlugin=o},64210:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Pool=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i};function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"getPoolBySign",value:function(e){return t._poolDic[e]||(t._poolDic[e]=[])}},{key:"clearBySign",value:function(e){t._poolDic[e]&&(t._poolDic[e].length=0)}},{key:"recover",value:function(e,n){n[t.POOLSIGN]||(n[t.POOLSIGN]=!0,t.getPoolBySign(e).push(n))}},{key:"recoverByClass",value:function(e){if(e){var n=e.__className||e.constructor._$gid;n&&t.recover(n,e)}}},{key:"_getClassSign",value:function(e){var n=e.__className||e._$gid;return n||(e._$gid=n=t._CLSID+"",t._CLSID++),n}},{key:"createByClass",value:function(e){return t.getItemByClass(t._getClassSign(e),e)}},{key:"getItemByClass",value:function(e,n){if(!t._poolDic[e])return new n;var i=t.getPoolBySign(e);if(i.length){var r=i.pop();r[t.POOLSIGN]=!1}else r=new n;return r}},{key:"getItemByCreateFun",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=t.getPoolBySign(e),a=r.length?r.pop():n.call(i);return a[t.POOLSIGN]=!1,a}},{key:"getItem",value:function(e){var n=t.getPoolBySign(e),i=n.length?n.pop():null;return i&&(i[t.POOLSIGN]=!1),i}}],(n=null)&&a(e.prototype,n),i&&a(e,i),t}();e.Pool=o,o._CLSID=0,o.POOLSIGN="__InPool",o._poolDic={}},14400:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.RunDriver=void 0;var i=n(62285);var r=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)};e.RunDriver=r,r.createShaderCondition=function(t){var e="(function() {return "+t+";})";return window.Laya._runScript(e)},r.changeWebGLSize=function(t,e){i.WebGL.onStageResize(t,e)}},21383:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.SceneUtils=void 0;var i=d(n(81643)),r=d(n(63978)),a=n(64210),o=n(13407),s=n(42255),u=n(24288),l=n(54190),h=n(76006),c=n(85096),f=n(41107),_=n(92493);function d(t){return t&&t.__esModule?t:{default:t}}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}function v(t,e,n){return e&&y(t.prototype,e),n&&y(t,n),t}var g=function(){function t(){p(this,t)}return v(t,null,[{key:"__init",value:function(){t._funMap=new h.WeakObject}},{key:"getBindFun",value:function(e){var n=t._funMap.get(e);if(null==n){var i='"'+e+'"',r="(function(data){if(data==null)return;with(data){try{\nreturn "+(i=i.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";n=window.Laya._runScript(r),t._funMap.set(e,n)}return n}},{key:"createByData",value:function(e,n){var i=b.create();if((e=t.createComp(n,e,e,null,i))._setBit(o.Const.NOT_READY,!0),"_idMap"in e&&(e._idMap=i._idMap),n.animations){var r,a,s,l=[],h=n.animations,c=h.length;for(r=0;r<c;r++){switch(a=new u.FrameAnimation,s=h[r],a._setUp(i._idMap,s),e[s.name]=a,a._setControlNode(e),s.action){case 1:a.play(0,!1);break;case 2:a.play(0,!0)}l.push(a)}e._aniList=l}return"Scene"===e._$componentType&&e._width>0&&null==n.props.hitTestPrior&&!e.mouseThrough&&(e.hitTestPrior=!0),i.beginLoad(e),e}},{key:"createInitTool",value:function(){return b.create()}},{key:"createComp",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if("Scene3D"==e.type||"Sprite3D"==e.type){var u=[],h=_.ILaya.Laya.Utils3D._createSceneByJsonForMaker(e,u,o);return"Sprite3D"==e.type?_.ILaya.Laya.StaticBatchManager.combine(h,u):_.ILaya.Laya.StaticBatchManager.combine(null,u),h}if(!(n=n||t.getCompInstance(e)))return e.props&&e.props.runtime?console.warn("runtime not found:"+e.props.runtime):console.warn("can not create:"+e.type),null;var c=e.child;if(c)for(var f="List"==n._$componentType,d=0,p=c.length;d<p;d++){var y=c[d];if(!("itemRender"in n)||"render"!=y.props.name&&"render"!==y.props.renderType)if("Graphic"==y.type)_.ILaya.ClassUtils._addGraphicsToSprite(y,n);else if(_.ILaya.ClassUtils._isDrawType(y.type))_.ILaya.ClassUtils._addGraphicToSprite(y,n,!0);else{if(f){var v=[],g=t.createComp(y,null,r,v,o);v.length&&(g._$bindData=v)}else g=t.createComp(y,null,r,a,o);"Script"==y.type?g instanceof s.Component?n._addComponentInstance(g):"owner"in g?g.owner=n:"target"in g&&(g.target=n):"mask"==y.props.renderType||"mask"==y.props.name?n.mask=g:g instanceof l.Node&&n.addChild(g)}else n.itemRender=y}var m=e.props;for(var b in m){var T=m[b];"string"==typeof T&&((0,i.default)(T).call(T,"@node:")>=0||(0,i.default)(T).call(T,"@Prefab:")>=0)?o&&o.addNodeRef(n,b,T):t.setCompValue(n,b,T,r,a)}return n._afterInited&&n._afterInited(),e.compId&&o&&o._idMap&&(o._idMap[e.compId]=n),n}},{key:"setCompValue",value:function(e,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if("string"==typeof r&&(0,i.default)(r).call(r,"${")>-1){if(t._sheet||(t._sheet=_.ILaya.ClassUtils.getClass("laya.data.Table")),!t._sheet)return void console.warn("Can not find class Sheet");if(o)o.push(e,n,r);else if(a){-1==(0,i.default)(r).call(r,"].")&&(r=r.replace(".","[0]."));var s,u,l=new m(e,n,r);l.exe(a);for(var h=r.replace(/\[.*?\]\./g,".");null!=(s=t._parseWatchData.exec(h));){for(var c=s[1];null!=(u=t._parseKeyWord.exec(c));){var f=u[0],d=a._watchMap[f]||(a._watchMap[f]=[]);d.push(l),t._sheet.I.notifer.on(f,a,a.changeData,[f])}(d=a._watchMap[c]||(a._watchMap[c]=[])).push(l),t._sheet.I.notifer.on(c,a,a.changeData,[c])}}}else"var"===n&&a?a[r]=e:e[n]="true"===r||"false"!==r&&r}},{key:"getCompInstance",value:function(e){if("UIView"==e.type&&e.props&&e.props.pageData)return t.createByData(null,e.props.pageData);var n=e.props&&e.props.runtime||e.type,i=_.ILaya.ClassUtils.getClass(n);if(!i)throw"Can not find class "+n;if("Script"===e.type&&i.prototype._doAwake){var r=a.Pool.createByClass(i);return r._destroyed=!1,r}return e.props&&"renderType"in e.props&&"instance"==e.props.renderType?(i.instance||(i.instance=new i),i.instance):new i}}]),t}();e.SceneUtils=g,g._parseWatchData=/\${(.*?)}/g,g._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g;var m=function(){function t(e,n,i){p(this,t),this.comp=e,this.prop=n,this.value=i}return v(t,[{key:"exe",value:function(t){var e=g.getBindFun(this.value);this.comp[this.prop]=e.call(this,t)}}]),t}(),b=function(){function t(){p(this,t)}return v(t,[{key:"reset",value:function(){this._nodeRefList=null,this._initList=null,this._idMap=null,this._loadList=null,this._scene=null}},{key:"recover",value:function(){this.reset(),a.Pool.recover("InitTool",this)}},{key:"addLoadRes",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._loadList||(this._loadList=[]),_.ILaya.loader.getRes(t)||(e?this._loadList.push({url:t,type:e}):this._loadList.push(t))}},{key:"addNodeRef",value:function(t,e,n){this._nodeRefList||(this._nodeRefList=[]),this._nodeRefList.push([t,e,n]),(0,i.default)(n).call(n,"@Prefab:")>=0&&this.addLoadRes(n.replace("@Prefab:",""),c.Loader.PREFAB)}},{key:"setNodeRef",value:function(){if(this._nodeRefList)if(this._idMap){var t,e,n;for(e=this._nodeRefList.length,t=0;t<e;t++)(n=this._nodeRefList[t])[0][n[1]]=this.getReferData(n[2]);this._nodeRefList=null}else this._nodeRefList=null}},{key:"getReferData",value:function(t){if((0,i.default)(t).call(t,"@Prefab:")>=0)return c.Loader.getRes(t.replace("@Prefab:",""));if((0,i.default)(t).call(t,"@arr:")>=0){var e,n,r,a;for(r=(e=(t=t.replace("@arr:","")).split(",")).length,n=0;n<r;n++)a=e[n],e[n]=a?this._idMap[a.replace("@node:","")]:null;return e}return this._idMap[t.replace("@node:","")]}},{key:"addInitItem",value:function(t){this._initList||(this._initList=[]),this._initList.push(t)}},{key:"doInits",value:function(){this._initList&&(this._initList=null)}},{key:"finish",value:function(){this.setNodeRef(),this.doInits(),this._scene._setBit(o.Const.NOT_READY,!1),this._scene.parent&&this._scene.parent.activeInHierarchy&&this._scene.active&&this._scene._processActive(),this._scene.event("onViewCreated"),this.recover()}},{key:"beginLoad",value:function(t){this._scene=t,!this._loadList||this._loadList.length<1?this.finish():_.ILaya.loader.load(this._loadList,f.Handler.create(this,this.finish))}}],[{key:"create",value:function(){var e=a.Pool.getItemByClass("InitTool",t);return e._idMap={},e}}]),t}()},683:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Stat=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i};function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t._StatRender.show(e,n)}},{key:"enable",value:function(){t._StatRender.enable()}},{key:"hide",value:function(){t._StatRender.hide()}},{key:"clear",value:function(){t.trianglesFaces=t.renderBatches=t.savedRenderBatches=t.shaderCall=t.spriteRenderUseCacheCount=t.frustumCulling=t.octreeNodeCulling=t.canvasNormal=t.canvasBitmap=t.canvasReCache=0}},{key:"onclick",set:function(e){t._StatRender.set_onclick(e)}}],(n=null)&&a(e.prototype,n),i&&a(e,i),t}();e.Stat=o,o.FPS=0,o.loopCount=0,o.shaderCall=0,o.renderBatches=0,o.savedRenderBatches=0,o.trianglesFaces=0,o.spriteCount=0,o.spriteRenderUseCacheCount=0,o.frustumCulling=0,o.octreeNodeCulling=0,o.canvasNormal=0,o.canvasBitmap=0,o.canvasReCache=0,o.renderSlow=!1,o._fpsData=[],o._timer=0,o._count=0,o._StatRender=null},14334:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.StatUI=void 0;var h=T(n(85507)),c=T(n(21611)),f=n(82671),_=n(93568),d=n(78362),p=n(81870),y=n(85136),v=n(26776),g=n(25883),m=n(683),b=n(92493);function T(t){return t&&t.__esModule?t:{default:t}}function x(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function k(t,e){return k=a||function(t,e){return t.__proto__=e,t},k(t,e)}function C(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=S(t);if(e){var a=S(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return E(this,n)}}function E(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function S(t){return S=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},S(t)}var M=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&k(t,e)}(a,t);var e,n,i,r=C(a);function a(){var t;return x(this,a),(t=r.apply(this,arguments))._show=!1,t._useCanvas=!1,t._height=100,t._view=[],t}return e=a,n=[{key:"show",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;m.Stat,_.Browser._isMiniGame||b.ILaya.Render.isConchApp||(this._useCanvas=!0),this._show=!0,m.Stat._fpsData.length=60,this._view[0]={title:"FPS(WebGL)",value:"_fpsStr",color:"yellow",units:"int"},this._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},this._view[2]={title:"RenderBatches",value:"renderBatches",color:"white",units:"int"},this._view[3]={title:"SavedRenderBatches",value:"savedRenderBatches",color:"white",units:"int"},this._view[4]={title:"CPUMemory",value:"cpuMemory",color:"yellow",units:"M"},this._view[5]={title:"GPUMemory",value:"gpuMemory",color:"yellow",units:"M"},this._view[6]={title:"Shader",value:"shaderCall",color:"white",units:"int"},this._view[7]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"},y.Render.is3DMode&&(this._view[0].title="FPS(3D)",this._view[8]={title:"TriFaces",value:"trianglesFaces",color:"white",units:"int"},this._view[9]={title:"FrustumCulling",value:"frustumCulling",color:"white",units:"int"},this._view[10]={title:"OctreeNodeCulling",value:"octreeNodeCulling",color:"white",units:"int"}),this._useCanvas?this.createUIPre(t,e):this.createUI(t,e),this.enable()}},{key:"createUIPre",value:function(t,e){var n=_.Browser.pixelRatio;this._width=180*n,this._vx=120*n,this._height=n*(12*this._view.length+3*n)+4,a._fontSize=12*n;for(var i=0;i<this._view.length;i++)this._view[i].x=4,this._view[i].y=i*a._fontSize+2*n;this._canvas||(this._canvas=new v.HTMLCanvas(!0),this._canvas.size(this._width,this._height),this._ctx=this._canvas.getContext("2d"),this._ctx.textBaseline="top",this._ctx.font=a._fontSize+"px Arial",this._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+t+"px;top:"+e+"px;width:"+this._width/n+"px;height:"+this._height/n+"px;"),_.Browser.onKGMiniGame||_.Browser.container.appendChild(this._canvas.source),this._first=!0,this.loop(),this._first=!1}},{key:"createUI",value:function(t,e){var n=this._sp,i=_.Browser.pixelRatio;n||(n=new d.Sprite,this._leftText=new p.Text,this._leftText.pos(5,5),this._leftText.color="#ffffff",n.addChild(this._leftText),this._txt=new p.Text,this._txt.pos(130*i,5),this._txt.color="#ffffff",n.addChild(this._txt),this._sp=n),n.pos(t,e);for(var r="",o=0;o<this._view.length;o++)r+=this._view[o].title+"\n";this._leftText.text=r;var s=138*i,u=i*(12*this._view.length+3*i)+4;this._txt.fontSize=a._fontSize*i,this._leftText.fontSize=a._fontSize*i,n.size(s,u),n.graphics.clear(),n.graphics.alpha(.5),n.graphics.drawRect(0,0,s+110,u+30,"#999999"),n.graphics.alpha(2),this.loop()}},{key:"enable",value:function(){b.ILaya.systemTimer.frameLoop(1,this,this.loop)}},{key:"hide",value:function(){this._show=!1,b.ILaya.systemTimer.clear(this,this.loop),this._canvas&&_.Browser.removeElement(this._canvas.source)}},{key:"set_onclick",value:function(t){this._sp&&this._sp.on("click",this._sp,t),this._canvas&&(this._canvas.source.onclick=t,this._canvas.source.style.pointerEvents="")}},{key:"loop",value:function(){m.Stat._count++;var t=_.Browser.now();if(!(t-m.Stat._timer<1e3)){var e=m.Stat._count;if(m.Stat.FPS=Math.round(1e3*e/(t-m.Stat._timer)),this._show){m.Stat.trianglesFaces=Math.round(m.Stat.trianglesFaces/e),this._useCanvas?m.Stat.renderBatches=Math.round(m.Stat.renderBatches/e):m.Stat.renderBatches=Math.round(m.Stat.renderBatches/e)-1,m.Stat.savedRenderBatches=Math.round(m.Stat.savedRenderBatches/e),m.Stat.shaderCall=Math.round(m.Stat.shaderCall/e),m.Stat.spriteRenderUseCacheCount=Math.round(m.Stat.spriteRenderUseCacheCount/e),m.Stat.canvasNormal=Math.round(m.Stat.canvasNormal/e),m.Stat.canvasBitmap=Math.round(m.Stat.canvasBitmap/e),m.Stat.canvasReCache=Math.ceil(m.Stat.canvasReCache/e),m.Stat.frustumCulling=Math.round(m.Stat.frustumCulling/e),m.Stat.octreeNodeCulling=Math.round(m.Stat.octreeNodeCulling/e);var n=m.Stat.FPS>0?Math.floor(1e3/m.Stat.FPS).toString():" ";m.Stat._fpsStr=m.Stat.FPS+(m.Stat.renderSlow?" slow":"")+" "+n,m.Stat._spriteStr=m.Stat.spriteCount+(m.Stat.spriteRenderUseCacheCount?"/"+m.Stat.spriteRenderUseCacheCount:""),m.Stat._canvasStr=m.Stat.canvasReCache+"/"+m.Stat.canvasNormal+"/"+m.Stat.canvasBitmap,m.Stat.cpuMemory=g.Resource.cpuMemory,m.Stat.gpuMemory=g.Resource.gpuMemory,this._useCanvas?this.renderInfoPre():this.renderInfo(),m.Stat.clear()}m.Stat._count=0,m.Stat._timer=t}}},{key:"renderInfoPre",value:function(){var t,e,n=0;if(this._canvas){var i=this._ctx;for(i.clearRect(this._first?0:this._vx,0,this._width,this._height),n=0;n<this._view.length;n++)t=this._view[n],this._first&&(i.fillStyle="white",i.fillText(t.title,t.x,t.y)),i.fillStyle=t.color,e=m.Stat[t.value],"M"==t.units&&(e=Math.floor(e/1048576*100)/100+" M"),i.fillText(e+"",t.x+this._vx,t.y)}}},{key:"renderInfo",value:function(){for(var t="",e=0;e<this._view.length;e++){var n=this._view[e],i=m.Stat[n.value];"M"==n.units&&(i=Math.floor(i/1048576*100)/100+" M"),"K"==n.units&&(i=Math.floor(i/1024*100)/100+" K"),t+=i+"\n"}this._txt.text=t}},{key:"isCanvasRender",value:function(){return this._useCanvas}},{key:"renderNotCanvas",value:function(t,e,n){this._show&&this._sp&&this._sp.render(t,0,0)}}],n&&w(e.prototype,n),i&&w(e,i),a}(f.IStatRender);e.StatUI=M,M._fontSize=12},61791:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.StringKey=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i};function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._strsToID={},this._idToStrs=[],this._length=0}var e,n,i;return e=t,(n=[{key:"add",value:function(t){var e=this._strsToID[t];return null!=e?e:(this._idToStrs[this._length]=t,this._strsToID[t]=this._length++)}},{key:"getID",value:function(t){var e=this._strsToID[t];return null==e?-1:e}},{key:"getName",value:function(t){var e=this._idToStrs[t];return null==e?void 0:e}}])&&a(e.prototype,n),i&&a(e,i),t}();e.StringKey=o},52842:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Timer=void 0;var i=u(n(11128)),r=u(n(39291)),a=u(n(63978)),o=n(38022),s=n(92493);function u(t){return t&&t.__esModule?t:{default:t}}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,a.default)(t,i.key,i)}}function c(t,e,n){return e&&h(t.prototype,e),n&&h(t,n),t}var f=function(){function t(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];l(this,t),this.scale=1,this.currTimer=(0,i.default)(),this.currFrame=0,this._delta=0,this._lastTimer=(0,i.default)(),this._map={},this._handlers=[],this._temp=[],this._count=0,e&&t.gSysTimer&&t.gSysTimer.frameLoop(1,this,this._update)}return c(t,[{key:"delta",get:function(){return this._delta}},{key:"_update",value:function(){if(this.scale<=0)return this._lastTimer=(0,i.default)(),void(this._delta=0);var t=this.currFrame=this.currFrame+this.scale,e=(0,i.default)(),n=e-this._lastTimer>3e4;this._delta=(e-this._lastTimer)*this.scale;var a=this.currTimer=this.currTimer+this._delta;this._lastTimer=e;var o=this._handlers;this._count=0;for(var s=0,u=o.length;s<u;s++){var l=o[s];if(null!==l.method){var h=l.userFrame?t:a;if(h>=l.exeTime)if((0,r.default)(l))if(!l.jumpFrame||n)l.exeTime+=l.delay,l.run(!1),h>l.exeTime&&(l.exeTime+=Math.ceil((h-l.exeTime)/l.delay)*l.delay);else for(;h>=l.exeTime;)l.exeTime+=l.delay,l.run(!1);else l.run(!0)}else this._count++}(this._count>30||t%200==0)&&this._clearHandlers()}},{key:"_clearHandlers",value:function(){for(var t=this._handlers,e=0,n=t.length;e<n;e++){var i=t[e];null!==i.method?this._temp.push(i):this._recoverHandler(i)}this._handlers=this._temp,t.length=0,this._temp=t}},{key:"_recoverHandler",value:function(e){this._map[e.key]==e&&(this._map[e.key]=null),e.clear(),t._pool.push(e)}},{key:"_create",value:function(e,n,r,a,o,s,u){if(!r)return o.apply(a,s),null;if(u){var l=this._getHandler(a,o);if(l)return l.repeat=n,l.userFrame=e,l.delay=r,l.caller=a,l.method=o,l.args=s,l.exeTime=r+(e?this.currFrame:this.currTimer+(0,i.default)()-this._lastTimer),l}return(l=t._pool.length>0?t._pool.pop():new _).repeat=n,l.userFrame=e,l.delay=r,l.caller=a,l.method=o,l.args=s,l.exeTime=r+(e?this.currFrame:this.currTimer+(0,i.default)()-this._lastTimer),this._indexHandler(l),this._handlers.push(l),l}},{key:"_indexHandler",value:function(e){var n=e.caller,i=e.method,r=n?n.$_GID||(n.$_GID=s.ILaya.Utils.getGID()):0,a=i.$_TID||(i.$_TID=t._mid++);e.key=r+"_"+a,this._map[e.key]=e}},{key:"once",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this._create(!1,!1,t,e,n,i,r)}},{key:"loop",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=this._create(!1,!0,t,e,n,i,r);o&&(o.jumpFrame=a)}},{key:"frameOnce",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this._create(!0,!1,t,e,n,i,r)}},{key:"frameLoop",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this._create(!0,!0,t,e,n,i,r)}},{key:"toString",value:function(){return" handlers:"+this._handlers.length+" pool:"+t._pool.length}},{key:"clear",value:function(t,e){var n=this._getHandler(t,e);n&&(this._map[n.key]=null,n.key="",n.clear())}},{key:"clearAll",value:function(t){if(t)for(var e=0,n=this._handlers.length;e<n;e++){var i=this._handlers[e];i.caller===t&&(this._map[i.key]=null,i.key="",i.clear())}}},{key:"_getHandler",value:function(e,n){var i=(e?e.$_GID||(e.$_GID=s.ILaya.Utils.getGID()):0)+"_"+(n.$_TID||(n.$_TID=t._mid++));return this._map[i]}},{key:"callLater",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;o.CallLater.I.callLater(t,e,n)}},{key:"runCallLater",value:function(t,e){o.CallLater.I.runCallLater(t,e)}},{key:"runTimer",value:function(t,e){var n=this._getHandler(t,e);n&&null!=n.method&&(this._map[n.key]=null,n.run(!0))}},{key:"pause",value:function(){this.scale=0}},{key:"resume",value:function(){this.scale=1}}]),t}();e.Timer=f,f.gSysTimer=null,f._pool=[],f._mid=1;var _=function(){function t(){l(this,t)}return c(t,[{key:"clear",value:function(){this.caller=null,this.method=null,this.args=null}},{key:"run",value:function(t){var e=this.caller;if(e&&e.destroyed)return this.clear();var n=this.method,i=this.args;t&&this.clear(),null!=n&&(i?n.apply(e,i):n.call(e))}}]),t}()},84221:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Tween=void 0;var i=h(n(39291)),r=h(n(92762)),a=h(n(63978)),o=n(64210),s=n(93568),u=n(56083),l=n(92493);function h(t){return t&&t.__esModule?t:{default:t}}function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,a.default)(t,i.key,i)}}var f=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gid=0,this.repeat=1,this._count=0}var e,n,a;return e=t,n=[{key:"to",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return this._create(t,e,n,i,r,a,o,!0,!1,!0)}},{key:"from",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return this._create(t,e,n,i,r,a,o,!1,!1,!0)}},{key:"_create",value:function(e,n,i,r,a,o,h,c,f,_){if(!e)throw new Error("Tween:target is null");this._target=e,this._duration=i,this._ease=r||n.ease||t.easeNone,this._complete=a||n.complete,this._delay=o,this._props=[],this._usedTimer=0,this._startTimer=s.Browser.now(),this._usedPool=f,this._delayParam=null,this.update=n.update;var d=e.$_GID||(e.$_GID=u.Utils.getGID());return t.tweenMap[d]?(h&&t.clearTween(e),t.tweenMap[d].push(this)):t.tweenMap[d]=[this],_?o<=0?this.firstStart(e,n,c):(this._delayParam=[e,n,c],l.ILaya.timer.once(o,this,this.firstStart,this._delayParam)):this._initProps(e,n,c),this}},{key:"firstStart",value:function(t,e,n){this._delayParam=null,t.destroyed?this.clear():(this._initProps(t,e,n),this._beginLoop())}},{key:"_initProps",value:function(t,e,n){for(var i in e)if("number"==typeof t[i]){var r=n?t[i]:e[i],a=n?e[i]:t[i];this._props.push([i,r,a-r]),n||(t[i]=r)}}},{key:"_beginLoop",value:function(){l.ILaya.timer.frameLoop(1,this,this._doEase)}},{key:"_doEase",value:function(){this._updateEase(s.Browser.now())}},{key:"_updateEase",value:function(e){var n=this._target;if(n){if(n.destroyed)return t.clearTween(n);var i=this._usedTimer=e-this._startTimer-this._delay;if(!(i<0)){if(i>=this._duration)return this.complete();for(var r=i>0?this._ease(i,0,1,this._duration):0,a=this._props,o=0,s=a.length;o<s;o++){var u=a[o];n[u[0]]=u[1]+r*u[2]}this.update&&this.update.run()}}}},{key:"progress",set:function(t){var e=t*this._duration;this._startTimer=s.Browser.now()-this._delay-e}},{key:"complete",value:function(){if(this._target){l.ILaya.timer.runTimer(this,this.firstStart);for(var t=this._target,e=this._props,n=this._complete,r=0,a=e.length;r<a;r++){var o=e[r];t[o[0]]=o[1]+o[2]}this.update&&this.update.run(),this._count++,0!=(0,i.default)(this)&&this._count>=(0,i.default)(this)?(this.clear(),n&&n.run()):this.restart()}}},{key:"pause",value:function(){var t;l.ILaya.timer.clear(this,this._beginLoop),l.ILaya.timer.clear(this,this._doEase),l.ILaya.timer.clear(this,this.firstStart),(t=s.Browser.now()-this._startTimer-this._delay)<0&&(this._usedTimer=t)}},{key:"setStartTime",value:function(t){this._startTimer=t}},{key:"clear",value:function(){this._target&&(this._remove(),this._clear())}},{key:"_clear",value:function(){this.pause(),l.ILaya.timer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this.repeat=1,this._usedPool&&(this.update=null,o.Pool.recover("tween",this))}},{key:"recover",value:function(){this._usedPool=!0,this._clear()}},{key:"_remove",value:function(){var e=t.tweenMap[this._target.$_GID];if(e)for(var n=0,i=e.length;n<i;n++)if(e[n]===this){(0,r.default)(e).call(e,n,1);break}}},{key:"restart",value:function(){if(this.pause(),this._usedTimer=0,this._startTimer=s.Browser.now(),this._delayParam)l.ILaya.timer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var t=this._props,e=0,n=t.length;e<n;e++){var i=t[e];this._target[i[0]]=i[1]}l.ILaya.timer.once(this._delay,this,this._beginLoop)}}},{key:"resume",value:function(){this._usedTimer>=this._duration||(this._startTimer=s.Browser.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?l.ILaya.timer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())}}],a=[{key:"to",value:function(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];return o.Pool.getItemByClass("tween",t)._create(e,n,i,r,a,s,u,!0,l,!0)}},{key:"from",value:function(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];return o.Pool.getItemByClass("tween",t)._create(e,n,i,r,a,s,u,!1,l,!0)}},{key:"clearAll",value:function(e){if(e&&e.$_GID){var n=t.tweenMap[e.$_GID];if(n){for(var i=0,r=n.length;i<r;i++)n[i]._clear();n.length=0}}}},{key:"clear",value:function(t){t.clear()}},{key:"clearTween",value:function(e){t.clearAll(e)}},{key:"easeNone",value:function(t,e,n,i){return n*t/i+e}}],n&&c(e.prototype,n),a&&c(e,a),t}();e.Tween=f,f.tweenMap=[]},56083:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Utils=void 0;var i=c(n(54103)),r=c(n(94198)),a=c(n(23054)),o=c(n(81643)),s=c(n(63978)),u=n(85399),l=n(98693),h=n(92493);function c(t){return t&&t.__esModule?t:{default:t}}function f(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,s.default)(t,i.key,i)}}var _=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,o;return e=t,n=null,o=[{key:"toRadian",value:function(e){return e*t._pi2}},{key:"toAngle",value:function(e){return e*t._pi}},{key:"toHexColor",value:function(t){if(t<0||isNaN(t))return null;for(var e=t.toString(16);e.length<6;)e="0"+e;return"#"+e}},{key:"getGID",value:function(){return t._gid++}},{key:"concatArray",value:function(t,e){if(!e)return t;if(!t)return e;var n,i=e.length;for(n=0;n<i;n++)t.push(e[n]);return t}},{key:"clearArray",value:function(t){return t?(t.length=0,t):t}},{key:"copyArray",value:function(t,e){if(t||(t=[]),!e)return t;t.length=e.length;var n,i=e.length;for(n=0;n<i;n++)t[n]=e[n];return t}},{key:"getGlobalRecByPoints",value:function(t,e,n,i,r){var a,o;a=u.Point.create().setTo(e,n),a=t.localToGlobal(a),o=u.Point.create().setTo(i,r),o=t.localToGlobal(o);var s=l.Rectangle._getWrapRec([a.x,a.y,o.x,o.y]);return a.recover(),o.recover(),s}},{key:"getGlobalPosAndScale",value:function(e){return t.getGlobalRecByPoints(e,0,0,1,1)}},{key:"bind",value:function(t,e){return(0,i.default)(t).call(t,e)}},{key:"updateOrder",value:function(t){if(!t||t.length<2)return!1;for(var e,n,i,r=1,a=t.length;r<a;){for(i=t[e=r],n=t[e]._zOrder;--e>-1&&t[e]._zOrder>n;)t[e+1]=t[e];t[e+1]=i,r++}return!0}},{key:"transPointList",value:function(t,e,n){var i,r=t.length;for(i=0;i<r;i+=2)t[i]+=e,t[i+1]+=n}},{key:"parseInt",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,r.default)(t,e);return isNaN(n)?0:n}))},{key:"getFileExtension",value:function(e){t._extReg.lastIndex=(0,a.default)(e).call(e,".");var n=t._extReg.exec(e);return n&&n.length>1?n[1].toLowerCase():null}},{key:"getFilecompatibleExtension",value:function(t){var e=t.split("."),n=e.length;return e.length>2?e[n-2]+"."+e[n-1]:null}},{key:"getTransformRelativeToWindow",value:function(e,n,i){var r=t.gStage,a=t.getGlobalPosAndScale(e),o=r._canvasTransform.clone(),s=o.tx,u=o.ty;o.rotate(-Math.PI/180*r.canvasDegree),o.scale(r.clientScaleX,r.clientScaleY);var l,h,c,f,_=r.canvasDegree%180!=0;return _?(l=i+a.y,h=n+a.x,l*=o.d,h*=o.a,90==r.canvasDegree?(l=s-l,h+=u):(l+=s,h=u-h)):(l=n+a.x,h=i+a.y,l*=o.a,h*=o.d,l+=s,h+=u),h+=r._safariOffsetY,_?(c=o.d*a.height,f=o.a*a.width):(c=o.a*a.width,f=o.d*a.height),{x:l,y:h,scaleX:c,scaleY:f}}},{key:"fitDOMElementInArea",value:function(e,n,i,r,a,o){e._fitLayaAirInitialized||(e._fitLayaAirInitialized=!0,e.style.transformOrigin=e.style.webKittransformOrigin="left top",e.style.position="absolute");var s=t.getTransformRelativeToWindow(n,i,r);e.style.transform=e.style.webkitTransform="scale("+s.scaleX+","+s.scaleY+") rotate("+t.gStage.canvasDegree+"deg)",e.style.width=a+"px",e.style.height=o+"px",e.style.left=s.x+"px",e.style.top=s.y+"px"}},{key:"isOkTextureList",value:function(t){if(!t)return!1;var e,n,i=t.length;for(e=0;e<i;e++)if(!(n=t[e])||!n._getSource())return!1;return!0}},{key:"isOKCmdList",value:function(t){if(!t)return!1;var e,n=t.length;for(e=0;e<n;e++)t[e];return!0}},{key:"getQueryString",value:function(t){if(h.ILaya.Browser.onMiniGame)return null;if(!window.location||!window.location.search)return null;var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(e);return null!=n?unescape(n[2]):null}}],n&&f(e.prototype,n),o&&f(e,o),t}();e.Utils=_,_.gStage=null,_._gid=1,_._pi=180/Math.PI,_._pi2=Math.PI/180,_._extReg=/\.(\w+)\??/g,_.parseXMLFromString=function(t){var e,n;if(t=t.replace(/>\s+</g,"><"),n=(new DOMParser).parseFromString(t,"text/xml"),(0,o.default)(e=n.firstChild.textContent).call(e,"This page contains the following errors")>-1)throw new Error(n.firstChild.firstChild.textContent);return n}},25670:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.VectorGraphManager=void 0;var i=o(n(54103)),r=o(n(63978)),a=n(17939);function o(t){return t&&t.__esModule?t:{default:t}}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var u=function(){function t(){var e,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],a.CacheManger.regCacheByFunction((0,i.default)(e=this.startDispose).call(e,this),(0,i.default)(n=this.getCacheList).call(n,this))}var e,n,r;return e=t,r=[{key:"getInstance",value:function(){return t.instance=t.instance||new t}}],(n=[{key:"getId",value:function(){return this._id++}},{key:"addShape",value:function(t,e){this.shapeDic[t]=e,this.useDic[t]||(this.useDic[t]=!0)}},{key:"addLine",value:function(t,e){this.shapeLineDic[t]=e,this.shapeLineDic[t]||(this.shapeLineDic[t]=!0)}},{key:"getShape",value:function(t){this._checkKey&&null!=this.useDic[t]&&(this.useDic[t]=!0)}},{key:"deleteShape",value:function(t){this.shapeDic[t]&&(this.shapeDic[t]=null,delete this.shapeDic[t]),this.shapeLineDic[t]&&(this.shapeLineDic[t]=null,delete this.shapeLineDic[t]),null!=this.useDic[t]&&delete this.useDic[t]}},{key:"getCacheList",value:function(){var t,e=[];for(t in this.shapeDic)e.push(this.shapeDic[t]);for(t in this.shapeLineDic)e.push(this.shapeLineDic[t]);return e}},{key:"startDispose",value:function(t){var e;for(e in this.useDic)this.useDic[e]=!1;this._checkKey=!0}},{key:"endDispose",value:function(){if(this._checkKey){var t;for(t in this.useDic)this.useDic[t]||this.deleteShape(t);this._checkKey=!1}}}])&&s(e.prototype,n),r&&s(e,r),t}();e.VectorGraphManager=u},76006:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.WeakObject=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(56083),o=n(92493);function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._obj={},t._maps.push(this)}var e,n,i;return e=t,i=[{key:"__init__",value:function(){t.I=new t,t.supportWeakMap||o.ILaya.systemTimer.loop(t.delInterval,null,t.clearCache)}},{key:"clearCache",value:function(){for(var e=0,n=t._maps.length;e<n;e++)t._maps[e]._obj={}}}],(n=[{key:"set",value:function(e,n){null!=e&&(t.supportWeakMap||("string"==typeof e||"number"==typeof e?this._obj[e]=n:(e.$_GID||(e.$_GID=a.Utils.getGID()),this._obj[e.$_GID]=n)))}},{key:"get",value:function(e){return null==e?null:t.supportWeakMap?void 0:"string"==typeof e||"number"==typeof e?this._obj[e]:this._obj[e.$_GID]}},{key:"del",value:function(e){null!=e&&(t.supportWeakMap||("string"==typeof e||"number"==typeof e?delete this._obj[e]:delete this._obj[this._obj.$_GID]))}},{key:"has",value:function(e){return null!=e&&!t.supportWeakMap&&("string"==typeof e||"number"==typeof e?null!=this._obj[e]:null!=this._obj[this._obj.$_GID])}}])&&s(e.prototype,n),i&&s(e,i),t}();e.WeakObject=u,u.supportWeakMap=!1,u.delInterval=6e5,u._maps=[]},80651:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.WordText=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i};function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.save=[],this.toUpperCase=null,this.width=-1,this.pageChars=[],this.startID=0,this.startIDStroke=0,this.lastGCCnt=0,this.splitRender=!1,this.scalex=1,this.scaley=1}var e,n,i;return e=t,(n=[{key:"setText",value:function(t){this.changed=!0,this._text=t,this.width=-1,this.cleanCache()}},{key:"toString",value:function(){return this._text}},{key:"length",get:function(){return this._text?this._text.length:0}},{key:"charCodeAt",value:function(t){return this._text?this._text.charCodeAt(t):NaN}},{key:"charAt",value:function(t){return this._text?this._text.charAt(t):null}},{key:"cleanCache",value:function(){var t=this.pageChars;for(var e in t){var n=t[e],i=n.tex;1==n.words.length&&i&&i.ri&&i.destroy()}this.pageChars=[],this.startID=0,this.scalex=1,this.scaley=1}}])&&a(e.prototype,n),i&&a(e,i),t}();e.WordText=o},32488:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.BufferState2D=void 0;var h=f(n(85507)),c=f(n(21611));function f(t){return t&&t.__esModule?t:{default:t}}function _(t,e){return _=a||function(t,e){return t.__proto__=e,t},_(t,e)}function d(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=y(t);if(e){var a=y(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return p(this,n)}}function p(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function y(t){return y=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},y(t)}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_(t,e)}(n,t);var e=d(n);function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this)}return n}(n(5245).BufferStateBase);e.BufferState2D=v},5245:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.BufferStateBase=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(33873);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._nativeVertexArrayObject=a.LayaGL.layaGPUInstance.createVertexArray()}var e,n,i;return e=t,(n=[{key:"bind",value:function(){t._curBindedBufferState!==this&&(a.LayaGL.layaGPUInstance.bindVertexArray(this._nativeVertexArrayObject),t._curBindedBufferState=this)}},{key:"unBind",value:function(){if(t._curBindedBufferState!==this)throw"BufferState: must call bind() function first.";a.LayaGL.layaGPUInstance.bindVertexArray(null),t._curBindedBufferState=null}},{key:"destroy",value:function(){a.LayaGL.layaGPUInstance.deleteVertexArray(this._nativeVertexArrayObject)}},{key:"bindForNative",value:function(){a.LayaGL.instance.bindVertexArray(this._nativeVertexArrayObject),t._curBindedBufferState=this}},{key:"unBindForNative",value:function(){a.LayaGL.instance.bindVertexArray(null),t._curBindedBufferState=null}}])&&o(e.prototype,n),i&&o(e,i),t}();e.BufferStateBase=s},46996:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.LayaGPU=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(80340),o=n(92493),s=n(79782),u=n(86877);function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var h=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._gl=null,this._vaoExt=null,this._angleInstancedArrays=null,this._isWebGL2=!1,this._oesTextureHalfFloat=null,this._oes_element_index_uint=null,this._oesTextureHalfFloatLinear=null,this._oesTextureFloat=null,this._extShaderTextureLod=null,this._extTextureFilterAnisotropic=null,this._compressedTextureS3tc=null,this._compressedTexturePvrtc=null,this._compressedTextureEtc1=null,this._compressedTextureETC=null,this._compressedTextureASTC=null,this._webgl_depth_texture=null,this._extColorBufferFloat=null,this._gl=e,this._isWebGL2=n;var i=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),r=e.getParameter(e.MAX_TEXTURE_SIZE);n?(this._extColorBufferFloat=this._getExtension("EXT_color_buffer_float"),u.SystemUtils._shaderCapailityLevel=35):(o.ILaya.Render.isConchApp||(s.VertexArrayObject,window._setupVertexArrayObject&&window._setupVertexArrayObject(e)),this._vaoExt=this._getExtension("OES_vertex_array_object"),this._angleInstancedArrays=this._getExtension("ANGLE_instanced_arrays"),this._oesTextureHalfFloat=this._getExtension("OES_texture_half_float"),this._oesTextureHalfFloatLinear=this._getExtension("OES_texture_half_float_linear"),this._oesTextureFloat=this._getExtension("OES_texture_float"),this._oes_element_index_uint=this._getExtension("OES_element_index_uint"),this._extShaderTextureLod=this._getExtension("EXT_shader_texture_lod"),this._webgl_depth_texture=this._getExtension("WEBGL_depth_texture"),u.SystemUtils._shaderCapailityLevel=30),this._extTextureFilterAnisotropic=this._getExtension("EXT_texture_filter_anisotropic"),this._compressedTextureS3tc=this._getExtension("WEBGL_compressed_texture_s3tc"),this._compressedTexturePvrtc=this._getExtension("WEBGL_compressed_texture_pvrtc"),this._compressedTextureEtc1=this._getExtension("WEBGL_compressed_texture_etc1"),this._compressedTextureETC=this._getExtension("WEBGL_compressed_texture_etc"),this._compressedTextureASTC=this._getExtension("WEBGL_compressed_texture_astc"),u.SystemUtils._maxTextureCount=i,u.SystemUtils._maxTextureSize=r}var e,n,i;return e=t,(n=[{key:"_getExtension",value:function(e){var n=t._extentionVendorPrefixes;for(var i in n){var r=this._gl.getExtension(n[i]+e);if(r)return r}return null}},{key:"createVertexArray",value:function(){return this._isWebGL2?this._gl.createVertexArray():this._vaoExt.createVertexArrayOES()}},{key:"bindVertexArray",value:function(t){this._isWebGL2?this._gl.bindVertexArray(t):this._vaoExt.bindVertexArrayOES(t)}},{key:"deleteVertexArray",value:function(t){this._isWebGL2?this._gl.deleteVertexArray(t):this._vaoExt.deleteVertexArrayOES(t)}},{key:"isVertexArray",value:function(t){this._isWebGL2?this._gl.isVertexArray(t):this._vaoExt.isVertexArrayOES(t)}},{key:"drawElementsInstanced",value:function(t,e,n,i,r){this._isWebGL2?this._gl.drawElementsInstanced(t,e,n,i,r):this._angleInstancedArrays.drawElementsInstancedANGLE(t,e,n,i,r)}},{key:"drawArraysInstanced",value:function(t,e,n,i){this._isWebGL2?this._gl.drawArraysInstanced(t,e,n,i):this._angleInstancedArrays.drawArraysInstancedANGLE(t,e,n,i)}},{key:"vertexAttribDivisor",value:function(t,e){this._isWebGL2?this._gl.vertexAttribDivisor(t,e):this._angleInstancedArrays.vertexAttribDivisorANGLE(t,e)}},{key:"supportInstance",value:function(){return!(!this._isWebGL2&&!this._angleInstancedArrays||!a.Config.allowGPUInstanceDynamicBatch)}},{key:"supportElementIndexUint32",value:function(){return!(!this._isWebGL2&&!this._oes_element_index_uint)}}])&&l(e.prototype,n),i&&l(e,i),t}();e.LayaGPU=h,h._extentionVendorPrefixes=["","WEBKIT_","MOZ_"]},86877:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.SystemUtils=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(33873),o=n(73972),s=n(57693);function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"maxTextureCount",get:function(){return this._maxTextureCount}},{key:"maxTextureSize",get:function(){return this._maxTextureSize}},{key:"shaderCapailityLevel",get:function(){return this._shaderCapailityLevel}},{key:"supportTextureFormat",value:function(t){switch(t){case o.TextureFormat.R32G32B32A32:return!(!a.LayaGL.layaGPUInstance._isWebGL2&&!a.LayaGL.layaGPUInstance._oesTextureFloat);case o.TextureFormat.R16G16B16A16:return!(!a.LayaGL.layaGPUInstance._isWebGL2&&!a.LayaGL.layaGPUInstance._oesTextureHalfFloat);default:return!0}}},{key:"supportRenderTextureFormat",value:function(t){switch(t){case s.RenderTextureFormat.R16G16B16A16:return!!(a.LayaGL.layaGPUInstance._isWebGL2&&a.LayaGL.layaGPUInstance._extColorBufferFloat||a.LayaGL.layaGPUInstance._oesTextureHalfFloat&&a.LayaGL.layaGPUInstance._oesTextureHalfFloatLinear);case s.RenderTextureFormat.Depth:return!(!a.LayaGL.layaGPUInstance._isWebGL2&&!a.LayaGL.layaGPUInstance._webgl_depth_texture);case s.RenderTextureFormat.ShadowMap:return!!a.LayaGL.layaGPUInstance._isWebGL2;default:return!0}}}],(n=null)&&u(e.prototype,n),i&&u(e,i),t}();e.SystemUtils=l},79782:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.VertexArrayObject=void 0;var i=o(n(94198)),r=o(n(92762)),a=o(n(81643));function o(t){return t&&t.__esModule?t:{default:t}}e.VertexArrayObject=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},function(){var t={};function e(e,n){var i;t[e]=!0,void 0!==n&&(i=n,window.console&&window.console.error&&window.console.error(i))}var n=function t(e){var n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(var i=0;i<this.attribs.length;i++){var r=new t.VertexAttrib(n);this.attribs[i]=r}this.maxAttrib=0};(n.VertexAttrib=function(t){this.enabled=!1,this.buffer=null,this.size=4,this.type=t.FLOAT,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};var o=function(e){var n=this;this.gl=e,function(e){var n=e.getError;e.getError=function(){var r;do{(r=n.apply(e))!=e.NO_ERROR&&(t[r]=!0)}while(r!=e.NO_ERROR);for(var a in t)if(t[a])return delete t[a],(0,i.default)(a);return e.NO_ERROR}}(e);var r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(t){return t==n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject==n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(t){var e=n.currentVertexArrayObject;e.maxAttrib=Math.max(e.maxAttrib,t);var i=e.attribs[t];return i.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(t){var e=n.currentVertexArrayObject;e.maxAttrib=Math.max(e.maxAttrib,t);var i=e.attribs[t];return i.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(t,i){switch(t){case e.ARRAY_BUFFER:n.currentArrayBuffer=i;break;case e.ELEMENT_ARRAY_BUFFER:n.currentVertexArrayObject.elementArrayBuffer=i}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(t,i){var a=n.currentVertexArrayObject,o=a.attribs[t];switch(i){case e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:return o.buffer;case e.VERTEX_ATTRIB_ARRAY_ENABLED:return o.enabled;case e.VERTEX_ATTRIB_ARRAY_SIZE:return o.size;case e.VERTEX_ATTRIB_ARRAY_STRIDE:return o.stride;case e.VERTEX_ATTRIB_ARRAY_TYPE:return o.type;case e.VERTEX_ATTRIB_ARRAY_NORMALIZED:return o.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(t,e,i,a,o,s){var u=n.currentVertexArrayObject;u.maxAttrib=Math.max(u.maxAttrib,t);var l=u.attribs[t];return l.buffer=n.currentArrayBuffer,l.size=e,l.type=i,l.normalized=a,l.stride=o,l.offset=s,l.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas.addEventListener("webglcontextrestored",(function(){var t;t="OESVertexArrayObject emulation library context restored",window.console&&window.console.log&&window.console.log(t),n.reset_()}),!0),this.reset_()};o.prototype.VERTEX_ARRAY_BINDING_OES=34229,o.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(var t=0;t<this.vertexArrayObjects.length;++t)this.vertexArrayObjects.isAlive=!1;var e=this.gl;this.maxVertexAttribs=e.getParameter(e.MAX_VERTEX_ATTRIBS),this.defaultVertexArrayObject=new n(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},o.prototype.createVertexArrayOES=function(){var t=new n(this);return this.vertexArrayObjects.push(t),t},o.prototype.deleteVertexArrayOES=function(t){var e,n;t.isAlive=!1,(0,r.default)(e=this.vertexArrayObjects).call(e,(0,a.default)(n=this.vertexArrayObjects).call(n,t),1),this.currentVertexArrayObject==t&&this.bindVertexArrayOES(null)},o.prototype.isVertexArrayOES=function(t){return!!(t&&t instanceof n&&t.hasBeenBound&&t.ext==this)},o.prototype.bindVertexArrayOES=function(t){var n=this.gl;if(!t||t.isAlive){var i=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=t||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;var a=this.currentVertexArrayObject;if(r!=a){r&&a.elementArrayBuffer==r.elementArrayBuffer||i.bindBuffer.call(n,n.ELEMENT_ARRAY_BUFFER,a.elementArrayBuffer);for(var o=this.currentArrayBuffer,s=Math.max(r?r.maxAttrib:0,a.maxAttrib),u=0;u<=s;u++){var l=a.attribs[u],h=r?r.attribs[u]:null;if(r&&l.enabled==h.enabled||(l.enabled?i.enableVertexAttribArray.call(n,u):i.disableVertexAttribArray.call(n,u)),l.enabled){var c=!1;r&&l.buffer==h.buffer||(o!=l.buffer&&(i.bindBuffer.call(n,n.ARRAY_BUFFER,l.buffer),o=l.buffer),c=!0),(c||l.cached!=h.cached)&&i.vertexAttribPointer.call(n,u,l.size,l.type,l.normalized,l.stride,l.offset)}}this.currentArrayBuffer!=o&&i.bindBuffer.call(n,n.ARRAY_BUFFER,this.currentArrayBuffer)}}else e(n.INVALID_OPERATION,"bindVertexArrayOES: attempt to bind deleted arrayObject")},window._setupVertexArrayObject=function(t){var e=t.getSupportedExtensions;t.getSupportedExtensions=function(){var t=e.call(this)||[];return(0,a.default)(t).call(t,"OES_vertex_array_object")<0&&t.push("OES_vertex_array_object"),t};var n=t.getExtension;t.getExtension=function(t){var e=n.call(this,t);return e||("OES_vertex_array_object"!==t?null:(this.__OESVertexArrayObject||(console.log("Setup OES_vertex_array_object polyfill"),this.__OESVertexArrayObject=new o(this)),this.__OESVertexArrayObject))}}}()},62285:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.WebGL=void 0;var i=s(n(3649)),r=s(n(63978)),a=n(56161),o=n(61266);function s(t){return t&&t.__esModule?t:{default:t}}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,r=[{key:"_uint8ArraySlice",value:function(){for(var t=this,e=t.length,n=new Uint8Array(t.length),i=0;i<e;i++)n[i]=t[i];return n}},{key:"_float32ArraySlice",value:function(){for(var t=this,e=t.length,n=new Float32Array(t.length),i=0;i<e;i++)n[i]=t[i];return n}},{key:"_uint16ArraySlice",value:function(){var t,e,n,i=this;if(0===arguments.length)for(t=i.length,e=new Uint16Array(t),n=0;n<t;n++)e[n]=i[n];else if(2===arguments.length){var r=arguments.length<=0?void 0:arguments[0],a=arguments.length<=1?void 0:arguments[1];if(a>r)for(t=a-r,e=new Uint16Array(t),n=r;n<a;n++)e[n-r]=i[n];else e=new Uint16Array(0)}return e}},{key:"_nativeRender_enable",value:function(){}},{key:"enable",value:function(){return!0}},{key:"inner_enable",value:function(){return(0,i.default)(Float32Array.prototype)||(Float32Array.prototype.slice=t._float32ArraySlice),(0,i.default)(Uint16Array.prototype)||(Uint16Array.prototype.slice=t._uint16ArraySlice),(0,i.default)(Uint8Array.prototype)||(Uint8Array.prototype.slice=t._uint8ArraySlice),!0}},{key:"onStageResize",value:function(t,e){null!=o.WebGLContext.mainContext&&(o.WebGLContext.mainContext.viewport(0,0,t,e),a.RenderState2D.width=t,a.RenderState2D.height=e)}}],(n=null)&&u(e.prototype,n),r&&u(e,r),t}();e.WebGL=l,l._isWebGL2=!1,l.isNativeRender_enable=!1},61266:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.WebGLContext=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(92493),o=n(33873);function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var u=1,l=0,h=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"__init__",value:function(){var e=o.LayaGL.instance;t._depthFunc=e.LESS,t._blendEquation=e.FUNC_ADD,t._blendEquationRGB=e.FUNC_ADD,t._blendEquationAlpha=e.FUNC_ADD,u=e.ONE,l=e.ZERO,t._sFactorAlpha=e.ONE,t._dFactorAlpha=e.ZERO,t._activedTextureID=e.TEXTURE0;var n=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS);t._activeTextures=new Array(n),t._glTextureIDs=[e.TEXTURE0,e.TEXTURE1,e.TEXTURE2,e.TEXTURE3,e.TEXTURE4,e.TEXTURE5,e.TEXTURE6,e.TEXTURE7,e.TEXTURE8,e.TEXTURE9,e.TEXTURE10,e.TEXTURE11,e.TEXTURE12,e.TEXTURE13,e.TEXTURE14,e.TEXTURE15,e.TEXTURE16,e.TEXTURE17,e.TEXTURE18,e.TEXTURE19,e.TEXTURE20,e.TEXTURE21,e.TEXTURE22,e.TEXTURE23,e.TEXTURE24,e.TEXTURE25,e.TEXTURE26,e.TEXTURE27,e.TEXTURE28,e.TEXTURE29,e.TEXTURE30,e.TEXTURE31];var i=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),r=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS);t._maxUniformFragmentVectors=Math.min(i,r)}},{key:"useProgram",value:function(e,n){return t._useProgram!==n&&(e.useProgram(n),t._useProgram=n,!0)}},{key:"setDepthTest",value:function(e,n){n!==t._depthTest&&(t._depthTest=n,n?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST))}},{key:"setDepthMask",value:function(e,n){n!==t._depthMask&&(t._depthMask=n,e.depthMask(n))}},{key:"setDepthFunc",value:function(e,n){n!==t._depthFunc&&(t._depthFunc=n,e.depthFunc(n))}},{key:"setBlend",value:function(e,n){n!==t._blend&&(t._blend=n,n?e.enable(e.BLEND):e.disable(e.BLEND))}},{key:"setBlendEquation",value:function(e,n){n!==t._blendEquation&&(t._blendEquation=n,t._blendEquationRGB=t._blendEquationAlpha=null,e.blendEquation(n))}},{key:"setBlendEquationSeparate",value:function(e,n,i){n===t._blendEquationRGB&&i===t._blendEquationAlpha||(t._blendEquationRGB=n,t._blendEquationAlpha=i,t._blendEquation=null,e.blendEquationSeparate(n,i))}},{key:"setBlendFunc",value:function(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(r||n!==u||i!==l)&&(u=n,l=i,t._sFactorRGB=null,t._dFactorRGB=null,t._sFactorAlpha=null,t._dFactorAlpha=null,e.blendFunc(n,i))}},{key:"setBlendFuncSeperate",value:function(e,n,i,r,a){n===t._sFactorRGB&&i===t._dFactorRGB&&r===t._sFactorAlpha&&a===t._dFactorAlpha||(t._sFactorRGB=n,t._dFactorRGB=i,t._sFactorAlpha=r,t._dFactorAlpha=a,u=null,l=null,e.blendFuncSeparate(n,i,r,a))}},{key:"setCullFace",value:function(e,n){n!==t._cullFace&&(t._cullFace=n,n?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE))}},{key:"setFrontFace",value:function(e,n){n!==t._frontFace&&(t._frontFace=n,e.frontFace(n))}},{key:"activeTexture",value:function(e,n){t._activedTextureID!==n&&(e.activeTexture(n),t._activedTextureID=n)}},{key:"bindTexture",value:function(e,n,i){t._activeTextures[t._activedTextureID-e.TEXTURE0]!==i&&(e.bindTexture(n,i),t._activeTextures[t._activedTextureID-e.TEXTURE0]=i)}},{key:"__init_native",value:function(){if(a.ILaya.Render.supportWebGLPlusRendering){var e=t;e.activeTexture=e.activeTextureForNative,e.bindTexture=e.bindTextureForNative}}},{key:"useProgramForNative",value:function(t,e){return t.useProgram(e),!0}},{key:"setDepthTestForNative",value:function(t,e){e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST)}},{key:"setDepthMaskForNative",value:function(t,e){t.depthMask(e)}},{key:"setDepthFuncForNative",value:function(t,e){t.depthFunc(e)}},{key:"setBlendForNative",value:function(t,e){e?t.enable(t.BLEND):t.disable(t.BLEND)}},{key:"setBlendFuncForNative",value:function(t,e,n){t.blendFunc(e,n)}},{key:"setCullFaceForNative",value:function(t,e){e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE)}},{key:"setFrontFaceForNative",value:function(t,e){t.frontFace(e)}},{key:"activeTextureForNative",value:function(t,e){t.activeTexture(e)}},{key:"bindTextureForNative",value:function(t,e,n){t.bindTexture(e,n)}},{key:"bindVertexArrayForNative",value:function(t,e){t.bindVertexArray(e)}},{key:"getUniformMaxVector",value:function(){return t._maxUniformFragmentVectors}}],(n=null)&&s(e.prototype,n),i&&s(e,i),t}();e.WebGLContext=h,h._activeTextures=new Array(1),h._useProgram=null,h._depthTest=!0,h._depthMask=!0,h._blend=!1,h._cullFace=!1,h.mainContext=null},91700:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.BlendMode=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(61266);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"_init_",value:function(e){t.fns=[t.BlendNormal,t.BlendAdd,t.BlendMultiply,t.BlendScreen,t.BlendOverlay,t.BlendLight,t.BlendMask,t.BlendDestinationOut,t.BlendAddOld],t.targetFns=[t.BlendNormalTarget,t.BlendAddTarget,t.BlendMultiplyTarget,t.BlendScreenTarget,t.BlendOverlayTarget,t.BlendLightTarget,t.BlendMask,t.BlendDestinationOut,t.BlendAddTargetOld]}},{key:"BlendNormal",value:function(t){a.WebGLContext.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_ALPHA,!0)}},{key:"BlendAddOld",value:function(t){a.WebGLContext.setBlendFunc(t,t.ONE,t.DST_ALPHA,!0)}},{key:"BlendAdd",value:function(t){a.WebGLContext.setBlendFunc(t,t.ONE,t.ONE,!0)}},{key:"BlendMultiply",value:function(t){a.WebGLContext.setBlendFunc(t,t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,!0)}},{key:"BlendScreen",value:function(t){a.WebGLContext.setBlendFunc(t,t.ONE,t.ONE,!0)}},{key:"BlendOverlay",value:function(t){a.WebGLContext.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_COLOR,!0)}},{key:"BlendLight",value:function(t){a.WebGLContext.setBlendFunc(t,t.ONE,t.ONE,!0)}},{key:"BlendNormalTarget",value:function(t){a.WebGLContext.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_ALPHA,!0)}},{key:"BlendAddTargetOld",value:function(t){a.WebGLContext.setBlendFunc(t,t.ONE,t.DST_ALPHA,!0)}},{key:"BlendAddTarget",value:function(t){a.WebGLContext.setBlendFunc(t,t.ONE,t.ONE,!0)}},{key:"BlendMultiplyTarget",value:function(t){a.WebGLContext.setBlendFunc(t,t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,!0)}},{key:"BlendScreenTarget",value:function(t){a.WebGLContext.setBlendFunc(t,t.ONE,t.ONE,!0)}},{key:"BlendOverlayTarget",value:function(t){a.WebGLContext.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_COLOR,!0)}},{key:"BlendLightTarget",value:function(t){a.WebGLContext.setBlendFunc(t,t.ONE,t.ONE,!0)}},{key:"BlendMask",value:function(t){a.WebGLContext.setBlendFunc(t,t.ZERO,t.SRC_ALPHA,!0)}},{key:"BlendDestinationOut",value:function(t){a.WebGLContext.setBlendFunc(t,t.ZERO,t.ZERO,!0)}}],(n=null)&&o(e.prototype,n),i&&o(e,i),t}();e.BlendMode=s,s.activeBlendFunction=null,s.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out","add_old"],s.TOINT={normal:0,add:1,multiply:2,screen:3,overlay:4,light:5,mask:6,"destination-out":7,lighter:1,lighter_old:8,add_old:8},s.NORMAL="normal",s.MASK="mask",s.LIGHTER="lighter"},4629:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.DrawStyle=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(13104);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.setValue(e)}var e,n,i;return e=t,i=[{key:"create",value:function(e){if(e){var n=e instanceof a.ColorUtils?e:a.ColorUtils.create(e);return n._drawStyle||(n._drawStyle=new t(e))}return t.DEFAULT}}],(n=[{key:"setValue",value:function(t){this._color=t?t instanceof a.ColorUtils?t:a.ColorUtils.create(t):a.ColorUtils.create("#000000")}},{key:"reset",value:function(){this._color=a.ColorUtils.create("#000000")}},{key:"toInt",value:function(){return this._color.numColor}},{key:"equal",value:function(t){return"string"==typeof t?this._color.strColor===t:t instanceof a.ColorUtils&&this._color.numColor===t.numColor}},{key:"toColorStr",value:function(){return this._color.strColor}}])&&o(e.prototype,n),i&&o(e,i),t}();e.DrawStyle=s,s.DEFAULT=new s("#000000")},91902:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Path=void 0;var i=a(n(3649)),r=a(n(63978));function a(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var u=function(){function t(){o(this,t),this._lastOriX=0,this._lastOriY=0,this.paths=[],this._curPath=null}var e,n,r;return e=t,(n=[{key:"beginPath",value:function(t){this.paths.length=1,this._curPath=this.paths[0]=new l,this._curPath.convex=t}},{key:"closePath",value:function(){this._curPath.loop=!0}},{key:"newPath",value:function(){this._curPath=new l,this.paths.push(this._curPath)}},{key:"addPoint",value:function(t,e){this._curPath.path.push(t,e)}},{key:"push",value:function(t,e){this._curPath?this._curPath.path.length>0&&(this._curPath=new l,this.paths.push(this._curPath)):(this._curPath=new l,this.paths.push(this._curPath));var n=this._curPath;n.path=(0,i.default)(t).call(t),n.convex=e}},{key:"reset",value:function(){this.paths.length=0}}])&&s(e.prototype,n),r&&s(e,r),t}();e.Path=u;var l=function t(){o(this,t),this.path=[],this.loop=!1,this.convex=!1}},37560:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.WebGLCacheAsNormalCanvas=void 0;var i=h(n(78914)),r=h(n(63978)),a=n(18008),o=n(93055),s=n(94286),u=n(30966),l=n(86044);function h(t){return t&&t.__esModule?t:{default:t}}function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var f=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.submitStartPos=0,this.submitEndPos=0,this.touches=[],this.submits=[],this.sprite=null,this.meshlist=[],this.cachedClipInfo=new a.Matrix,this.oldTx=0,this.oldTy=0,this.invMat=new a.Matrix,this.context=e,this.sprite=n,e._globalClipMatrix.copyTo(this.cachedClipInfo)}var e,n,r;return e=t,(n=[{key:"startRec",value:function(){var t=this.context;t._charSubmitCache&&t._charSubmitCache._enable&&(t._charSubmitCache.enable(!1,t),t._charSubmitCache.enable(!0,t)),t._incache=!0,this.touches.length=0,t.touches=this.touches,t._globalClipMatrix.copyTo(this.cachedClipInfo),this.submits.length=0,this.submitStartPos=t._submits._length;for(var e=0,n=this.meshlist.length;e<n;e++){var i=this.meshlist[e];i.canReuse?i.releaseMesh():i.destroy()}this.meshlist.length=0,this._mesh=s.MeshQuadTexture.getAMesh(!1),this._pathMesh=l.MeshVG.getAMesh(!1),this._triangleMesh=u.MeshTexture.getAMesh(!1),this.meshlist.push(this._mesh),this.meshlist.push(this._pathMesh),this.meshlist.push(this._triangleMesh),t._curSubmit=o.SubmitBase.RENDERBASE,this._oldMesh=t._mesh,this._oldPathMesh=t._pathMesh,this._oldTriMesh=t._triangleMesh,this._oldMeshList=t.meshlist,t._mesh=this._mesh,t._pathMesh=this._pathMesh,t._triangleMesh=this._triangleMesh,t.meshlist=this.meshlist,this.oldTx=t._curMat.tx,this.oldTy=t._curMat.ty,t._curMat.tx=0,t._curMat.ty=0,t._curMat.copyTo(this.invMat),this.invMat.invert()}},{key:"endRec",value:function(){var t=this.context;t._charSubmitCache&&t._charSubmitCache._enable&&(t._charSubmitCache.enable(!1,t),t._charSubmitCache.enable(!0,t));var e=t._submits;this.submitEndPos=e._length;for(var n=this.submitEndPos-this.submitStartPos,i=0;i<n;i++)this.submits.push(e[this.submitStartPos+i]);e._length-=n,t._mesh=this._oldMesh,t._pathMesh=this._oldPathMesh,t._triangleMesh=this._oldTriMesh,t.meshlist=this._oldMeshList,t._curSubmit=o.SubmitBase.RENDERBASE,t._curMat.tx=this.oldTx,t._curMat.ty=this.oldTy,t.touches=null,t._incache=!1}},{key:"isCacheValid",value:function(){var t=this.context._globalClipMatrix;return t.a==this.cachedClipInfo.a&&t.b==this.cachedClipInfo.b&&t.c==this.cachedClipInfo.c&&t.d==this.cachedClipInfo.d&&t.tx==this.cachedClipInfo.tx&&t.ty==this.cachedClipInfo.ty}},{key:"flushsubmit",value:function(){var t,e=o.SubmitBase.RENDERBASE;(0,i.default)(t=this.submits).call(t,(function(t){t!=o.SubmitBase.RENDERBASE&&(o.SubmitBase.preRender=e,e=t,t.renderSubmit())}))}},{key:"releaseMem",value:function(){}}])&&c(e.prototype,n),r&&c(e,r),t}();e.WebGLCacheAsNormalCanvas=f,f.matI=new a.Matrix},94961:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.SaveBase=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(93055);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"_createArray",value:function(){var t=[];return t._length=0,t}},{key:"_init",value:function(){var e=t._namemap={};return e[t.TYPE_ALPHA]="ALPHA",e[t.TYPE_FILESTYLE]="fillStyle",e[t.TYPE_FONT]="font",e[t.TYPE_LINEWIDTH]="lineWidth",e[t.TYPE_STROKESTYLE]="strokeStyle",e[t.TYPE_ENABLEMERGE]="_mergeID",e[t.TYPE_MARK]=e[t.TYPE_TRANSFORM]=e[t.TYPE_TRANSLATE]=[],e[t.TYPE_TEXTBASELINE]="textBaseline",e[t.TYPE_TEXTALIGN]="textAlign",e[t.TYPE_GLOBALCOMPOSITEOPERATION]="_nBlendType",e[t.TYPE_SHADER]="shader",e[t.TYPE_FILTERS]="filters",e[t.TYPE_COLORFILTER]="_colorFiler",e}},{key:"save",value:function(e,n,i,r){if((e._saveMark._saveuse&n)!==n){e._saveMark._saveuse|=n;var a=t.POOL,o=a._length>0?a[--a._length]:new t;o._value=i[o._valueName=t._namemap[n]],o._dataObj=i,o._newSubmit=r;var s=e._save;s[s._length++]=o}}}],(n=[{key:"isSaveMark",value:function(){return!1}},{key:"restore",value:function(e){this._dataObj[this._valueName]=this._value,t.POOL[t.POOL._length++]=this,this._newSubmit&&(e._curSubmit=a.SubmitBase.RENDERBASE)}}])&&o(e.prototype,n),i&&o(e,i),t}();e.SaveBase=s,s.TYPE_ALPHA=1,s.TYPE_FILESTYLE=2,s.TYPE_FONT=8,s.TYPE_LINEWIDTH=256,s.TYPE_STROKESTYLE=512,s.TYPE_MARK=1024,s.TYPE_TRANSFORM=2048,s.TYPE_TRANSLATE=4096,s.TYPE_ENABLEMERGE=8192,s.TYPE_TEXTBASELINE=16384,s.TYPE_TEXTALIGN=32768,s.TYPE_GLOBALCOMPOSITEOPERATION=65536,s.TYPE_CLIPRECT=131072,s.TYPE_CLIPRECT_STENCIL=262144,s.TYPE_IBVB=524288,s.TYPE_SHADER=1048576,s.TYPE_FILTERS=2097152,s.TYPE_FILTERS_TYPE=4194304,s.TYPE_COLORFILTER=8388608,s.POOL=s._createArray(),s._namemap=s._init()},64554:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.SaveClipRect=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(94961),o=n(18008),s=n(98693);function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._globalClipMatrix=new o.Matrix,this._clipInfoID=-1,this._clipRect=new s.Rectangle,this.incache=!1}var e,n,i;return e=t,i=[{key:"save",value:function(e){if((e._saveMark._saveuse&a.SaveBase.TYPE_CLIPRECT)!=a.SaveBase.TYPE_CLIPRECT){e._saveMark._saveuse|=a.SaveBase.TYPE_CLIPRECT;var n=t.POOL,i=n._length>0?n[--n._length]:new t;e._globalClipMatrix.copyTo(i._globalClipMatrix),e._clipRect.clone(i._clipRect),i._clipInfoID=e._clipInfoID,i.incache=e._clipInCache;var r=e._save;r[r._length++]=i}}}],(n=[{key:"isSaveMark",value:function(){return!1}},{key:"restore",value:function(e){this._globalClipMatrix.copyTo(e._globalClipMatrix),this._clipRect.clone(e._clipRect),e._clipInfoID=this._clipInfoID,t.POOL[t.POOL._length++]=this,e._clipInCache=this.incache}}])&&u(e.prototype,n),i&&u(e,i),t}();e.SaveClipRect=l,l.POOL=a.SaveBase._createArray()},43719:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.SaveMark=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(94961);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._saveuse=0}var e,n,i;return e=t,i=[{key:"Create",value:function(e){var n=t.POOL,i=n._length>0?n[--n._length]:new t;return i._saveuse=0,i._preSaveMark=e._saveMark,e._saveMark=i,i}}],(n=[{key:"isSaveMark",value:function(){return!0}},{key:"restore",value:function(e){e._saveMark=this._preSaveMark,t.POOL[t.POOL._length++]=this}}])&&o(e.prototype,n),i&&o(e,i),t}();e.SaveMark=s,s.POOL=a.SaveBase._createArray()},55307:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.SaveTransform=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(94961),o=n(18008);function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._matrix=new o.Matrix}var e,n,i;return e=t,i=[{key:"save",value:function(e){var n=e._saveMark;if((n._saveuse&a.SaveBase.TYPE_TRANSFORM)!==a.SaveBase.TYPE_TRANSFORM){n._saveuse|=a.SaveBase.TYPE_TRANSFORM;var i=t.POOL,r=i._length>0?i[--i._length]:new t;r._savematrix=e._curMat,e._curMat=e._curMat.copyTo(r._matrix);var o=e._save;o[o._length++]=r}}}],(n=[{key:"isSaveMark",value:function(){return!1}},{key:"restore",value:function(e){e._curMat=this._savematrix,t.POOL[t.POOL._length++]=this}}])&&s(e.prototype,n),i&&s(e,i),t}();e.SaveTransform=u,u.POOL=a.SaveBase._createArray()},87948:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.SaveTranslate=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(94961),o=n(18008);function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._mat=new o.Matrix}var e,n,i;return e=t,i=[{key:"save",value:function(e){var n=t.POOL,i=n._length>0?n[--n._length]:new t;e._curMat.copyTo(i._mat);var r=e._save;r[r._length++]=i}}],(n=[{key:"isSaveMark",value:function(){return!1}},{key:"restore",value:function(e){this._mat.copyTo(e._curMat),t.POOL[t.POOL._length++]=this}}])&&s(e.prototype,n),i&&s(e,i),t}();e.SaveTranslate=u,u.POOL=a.SaveBase._createArray()},20541:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.BaseShader=void 0;var h=f(n(85507)),c=f(n(21611));function f(t){return t&&t.__esModule?t:{default:t}}function _(t,e){return _=a||function(t,e){return t.__proto__=e,t},_(t,e)}function d(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=y(t);if(e){var a=y(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return p(this,n)}}function p(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function y(t){return y=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},y(t)}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_(t,e)}(n,t);var e=d(n);function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this)}return n}(n(25883).Resource);e.BaseShader=v},17:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.Shader=void 0;var h=b(n(81643)),c=b(n(54103)),f=b(n(85507)),_=b(n(21611)),d=n(92493),p=n(683),y=n(61791),v=n(61266),g=n(20541),m=n(33873);function b(t){return t&&t.__esModule?t:{default:t}}function T(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function w(t,e){return w=a||function(t,e){return t.__proto__=e,t},w(t,e)}function k(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=S(t);if(e){var a=S(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return C(this,n)}}function C(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return E(t)}function E(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function S(t){return S=f.default?_.default:function(t){return t.__proto__||(0,_.default)(t)},S(t)}var M=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}(a,t);var e,n,i,r=k(a);function a(t,e){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(T(this,a),(n=r.call(this))._attribInfo=null,n.customCompile=!1,n._curActTexIndex=0,n.tag={},n._program=null,n._params=null,n._paramsMap={},!t||!e)throw"Shader Error";return n._attribInfo=s,n._id=++a._count,n._vs=t,n._ps=e,n._nameMap=o||{},null!=i&&(a.sharders[i]=E(n)),n.recreateResource(),n.lock=!0,n}return e=a,n=[{key:"recreateResource",value:function(){this._compile(),this._setGPUMemory(0)}},{key:"_disposeResource",value:function(){v.WebGLContext.mainContext.deleteShader(this._vshader),v.WebGLContext.mainContext.deleteShader(this._pshader),v.WebGLContext.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this._setGPUMemory(0),this._curActTexIndex=0}},{key:"_compile",value:function(){if(this._vs&&this._ps&&!this._params){var t;this._reCompile=!0,this._params=[],this.customCompile&&(t=d.ILaya.ShaderCompile.preGetParams(this._vs,this._ps));var e,n,i,r=v.WebGLContext.mainContext;this._program=r.createProgram(),this._vshader=a._createShader(r,this._vs,r.VERTEX_SHADER),this._pshader=a._createShader(r,this._ps,r.FRAGMENT_SHADER),r.attachShader(this._program,this._vshader),r.attachShader(this._program,this._pshader);var o=this._attribInfo?this._attribInfo.length:0;for(n=0;n<o;n+=2)r.bindAttribLocation(this._program,this._attribInfo[n+1],this._attribInfo[n]);if(r.linkProgram(this._program),!this.customCompile&&!r.getProgramParameter(this._program,r.LINK_STATUS))throw r.getProgramInfoLog(this._program);var s=this.customCompile?t.uniforms.length:r.getProgramParameter(this._program,r.ACTIVE_UNIFORMS);for(n=0;n<s;n++){var u,l=this.customCompile?t.uniforms[n]:r.getActiveUniform(this._program,n);e={vartype:"uniform",glfun:null,ivartype:1,location:r.getUniformLocation(this._program,l.name),name:l.name,type:l.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},(0,h.default)(u=e.name).call(u,"[0]")>0&&(e.name=e.name.substr(0,e.name.length-3),e.isArray=!0,e.location=r.getUniformLocation(this._program,e.name)),this._params.push(e)}for(n=0,i=this._params.length;n<i;n++)switch((e=this._params[n]).indexOfParams=n,e.index=1,e.value=[e.location,null],e.codename=e.name,e.name=this._nameMap[e.codename]?this._nameMap[e.codename]:e.codename,this._paramsMap[e.name]=e,e._this=this,e.uploadedValue=[],e.type){case r.INT:e.fun=e.isArray?this._uniform1iv:this._uniform1i;break;case r.FLOAT:e.fun=e.isArray?this._uniform1fv:this._uniform1f;break;case r.FLOAT_VEC2:e.fun=e.isArray?this._uniform_vec2v:this._uniform_vec2;break;case r.FLOAT_VEC3:e.fun=e.isArray?this._uniform_vec3v:this._uniform_vec3;break;case r.FLOAT_VEC4:e.fun=e.isArray?this._uniform_vec4v:this._uniform_vec4;break;case r.SAMPLER_2D:e.fun=this._uniform_sampler2D;break;case r.SAMPLER_CUBE:e.fun=this._uniform_samplerCube;break;case r.FLOAT_MAT4:e.glfun=r.uniformMatrix4fv,e.fun=this._uniformMatrix4fv;break;case r.BOOL:e.fun=this._uniform1i;break;case r.FLOAT_MAT2:case r.FLOAT_MAT3:default:throw new Error("compile shader err!")}}}},{key:"getUniform",value:function(t){return this._paramsMap[t]}},{key:"_uniform1f",value:function(t,e){var n=t.uploadedValue;return n[0]!==e?(v.WebGLContext.mainContext.uniform1f(t.location,n[0]=e),1):0}},{key:"_uniform1fv",value:function(t,e){if(e.length<4){var n=t.uploadedValue;return n[0]!==e[0]||n[1]!==e[1]||n[2]!==e[2]||n[3]!==e[3]?(v.WebGLContext.mainContext.uniform1fv(t.location,e),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],1):0}return v.WebGLContext.mainContext.uniform1fv(t.location,e),1}},{key:"_uniform_vec2",value:function(t,e){var n=t.uploadedValue;return n[0]!==e[0]||n[1]!==e[1]?(v.WebGLContext.mainContext.uniform2f(t.location,n[0]=e[0],n[1]=e[1]),1):0}},{key:"_uniform_vec2v",value:function(t,e){if(e.length<2){var n=t.uploadedValue;return n[0]!==e[0]||n[1]!==e[1]||n[2]!==e[2]||n[3]!==e[3]?(v.WebGLContext.mainContext.uniform2fv(t.location,e),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],1):0}return v.WebGLContext.mainContext.uniform2fv(t.location,e),1}},{key:"_uniform_vec3",value:function(t,e){var n=t.uploadedValue;return n[0]!==e[0]||n[1]!==e[1]||n[2]!==e[2]?(v.WebGLContext.mainContext.uniform3f(t.location,n[0]=e[0],n[1]=e[1],n[2]=e[2]),1):0}},{key:"_uniform_vec3v",value:function(t,e){return v.WebGLContext.mainContext.uniform3fv(t.location,e),1}},{key:"_uniform_vec4",value:function(t,e){var n=t.uploadedValue;return n[0]!==e[0]||n[1]!==e[1]||n[2]!==e[2]||n[3]!==e[3]?(v.WebGLContext.mainContext.uniform4f(t.location,n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3]),1):0}},{key:"_uniform_vec4v",value:function(t,e){return v.WebGLContext.mainContext.uniform4fv(t.location,e),1}},{key:"_uniformMatrix2fv",value:function(t,e){return v.WebGLContext.mainContext.uniformMatrix2fv(t.location,!1,e),1}},{key:"_uniformMatrix3fv",value:function(t,e){return v.WebGLContext.mainContext.uniformMatrix3fv(t.location,!1,e),1}},{key:"_uniformMatrix4fv",value:function(t,e){return v.WebGLContext.mainContext.uniformMatrix4fv(t.location,!1,e),1}},{key:"_uniform1i",value:function(t,e){var n=t.uploadedValue;return n[0]!==e?(v.WebGLContext.mainContext.uniform1i(t.location,n[0]=e),1):0}},{key:"_uniform1iv",value:function(t,e){return v.WebGLContext.mainContext.uniform1iv(t.location,e),1}},{key:"_uniform_ivec2",value:function(t,e){var n=t.uploadedValue;return n[0]!==e[0]||n[1]!==e[1]?(v.WebGLContext.mainContext.uniform2i(t.location,n[0]=e[0],n[1]=e[1]),1):0}},{key:"_uniform_ivec2v",value:function(t,e){return v.WebGLContext.mainContext.uniform2iv(t.location,e),1}},{key:"_uniform_vec3i",value:function(t,e){var n=t.uploadedValue;return n[0]!==e[0]||n[1]!==e[1]||n[2]!==e[2]?(v.WebGLContext.mainContext.uniform3i(t.location,n[0]=e[0],n[1]=e[1],n[2]=e[2]),1):0}},{key:"_uniform_vec3vi",value:function(t,e){return v.WebGLContext.mainContext.uniform3iv(t.location,e),1}},{key:"_uniform_vec4i",value:function(t,e){var n=t.uploadedValue;return n[0]!==e[0]||n[1]!==e[1]||n[2]!==e[2]||n[3]!==e[3]?(v.WebGLContext.mainContext.uniform4i(t.location,n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3]),1):0}},{key:"_uniform_vec4vi",value:function(t,e){return v.WebGLContext.mainContext.uniform4iv(t.location,e),1}},{key:"_uniform_sampler2D",value:function(t,e){var n=v.WebGLContext.mainContext,i=t.uploadedValue;return null==i[0]?(i[0]=this._curActTexIndex,n.uniform1i(t.location,this._curActTexIndex),v.WebGLContext.activeTexture(n,n.TEXTURE0+this._curActTexIndex),v.WebGLContext.bindTexture(n,n.TEXTURE_2D,e),this._curActTexIndex++,1):(v.WebGLContext.activeTexture(n,n.TEXTURE0+i[0]),v.WebGLContext.bindTexture(n,n.TEXTURE_2D,e),0)}},{key:"_uniform_samplerCube",value:function(t,e){var n=v.WebGLContext.mainContext,i=t.uploadedValue;return null==i[0]?(i[0]=this._curActTexIndex,n.uniform1i(t.location,this._curActTexIndex),v.WebGLContext.activeTexture(n,n.TEXTURE0+this._curActTexIndex),v.WebGLContext.bindTexture(n,n.TEXTURE_CUBE_MAP,e),this._curActTexIndex++,1):(v.WebGLContext.activeTexture(n,n.TEXTURE0+i[0]),v.WebGLContext.bindTexture(n,n.TEXTURE_CUBE_MAP,e),0)}},{key:"_noSetValue",value:function(t){console.log("no....:"+t.name)}},{key:"uploadOne",value:function(t,e){v.WebGLContext.useProgram(v.WebGLContext.mainContext,this._program);var n=this._paramsMap[t];n.fun.call(this,n,e)}},{key:"uploadTexture2D",value:function(t){var e=v.WebGLContext;e._activeTextures[0]!==t&&(e.bindTexture(v.WebGLContext.mainContext,m.LayaGL.instance.TEXTURE_2D,t),e._activeTextures[0]=t)}},{key:"upload",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;g.BaseShader.activeShader=g.BaseShader.bindShader=this;var n=v.WebGLContext.mainContext;v.WebGLContext.useProgram(n,this._program),this._reCompile?(e=this._params,this._reCompile=!1):e=e||this._params;for(var i,r,a=e.length,o=0,s=0;s<a;s++)null!==(r=t[(i=e[s]).name])&&(o+=i.fun.call(this,i,r));p.Stat.shaderCall+=o}},{key:"uploadArray",value:function(t,e,n){g.BaseShader.activeShader=this,g.BaseShader.bindShader=this,v.WebGLContext.useProgram(v.WebGLContext.mainContext,this._program),this._params;for(var i,r,a=0,o=e-2;o>=0;o-=2){var s;(r=this._paramsMap[t[o]])&&null!=(i=t[o+1])&&(n&&n[r.name]&&(0,c.default)(s=n[r.name]).call(s),a+=r.fun.call(this,r,i))}p.Stat.shaderCall+=a}},{key:"getParams",value:function(){return this._params}},{key:"setAttributesLocation",value:function(t){this._attribInfo=t}}],i=[{key:"getShader",value:function(t){return a.sharders[t]}},{key:"create",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return new a(t,e,n,i,r)}},{key:"withCompile",value:function(t,e,n,i){if(n&&a.sharders[n])return a.sharders[n];var r=a._preCompileShader[a.SHADERNAME2ID*t];if(!r)throw new Error("withCompile shader err!"+t);return r.createShader(e,n,i,null)}},{key:"withCompile2D",value:function(t,e,n,i,r){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(i&&a.sharders[i])return a.sharders[i];var s=a._preCompileShader[a.SHADERNAME2ID*t+e];if(!s)throw new Error("withCompile shader err!"+t+" "+e);return s.createShader(n,i,r,o)}},{key:"addInclude",value:function(t,e){d.ILaya.ShaderCompile.addInclude(t,e)}},{key:"preCompile",value:function(t,e,n,i){var r=a.SHADERNAME2ID*t;a._preCompileShader[r]=new d.ILaya.ShaderCompile(e,n,i)}},{key:"preCompile2D",value:function(t,e,n,i,r){var o=a.SHADERNAME2ID*t+e;a._preCompileShader[o]=new d.ILaya.ShaderCompile(n,i,r)}},{key:"_createShader",value:function(t,e,n){var i=t.createShader(n);return t.shaderSource(i,e),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)?i:(console.log(t.getShaderInfoLog(i)),null)}}],n&&x(e.prototype,n),i&&x(e,i),a}(g.BaseShader);e.Shader=M,M._count=0,M._preCompileShader={},M.SHADERNAME2ID=2e-4,M.nameKey=new y.StringKey,M.sharders=new Array(32)},805:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.ShaderDefinesBase=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i};function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var o=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._value=0,this._name2int=e,this._int2name=n,this._int2nameMap=i}var e,n,i;return e=t,i=[{key:"_reg",value:function(t,e,n,i){n[t]=e,i[e]=t}},{key:"_toText",value:function(t,e,n){var i=n[t];if(i)return i;for(var r={},a=1,o=0;o<32&&!((a=1<<o)>t);o++)if(t&a){var s=e[a];s&&(r[s]="")}return n[t]=r,r}},{key:"_toInt",value:function(t,e){for(var n=t.split("."),i=0,r=0,a=n.length;r<a;r++){var o=e[n[r]];if(!o)throw new Error("Defines to int err:"+t+"/"+n[r]);i|=o}return i}}],(n=[{key:"add",value:function(t){return this._value|="string"==typeof t?this._name2int[t]:t,this._value}},{key:"addInt",value:function(t){return this._value|=t,this._value}},{key:"remove",value:function(t){return this._value&="string"==typeof t?~this._name2int[t]:~t,this._value}},{key:"isDefine",value:function(t){return(this._value&t)===t}},{key:"getValue",value:function(){return this._value}},{key:"setValue",value:function(t){this._value=t}},{key:"toNameDic",value:function(){var e=this._int2nameMap[this._value];return e||t._toText(this._value,this._int2name,this._int2nameMap)}}])&&a(e.prototype,n),i&&a(e,i),t}();e.ShaderDefinesBase=o},97246:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Shader2D=void 0;var i=_(n(63978)),r=n(43989),a=n(4629),o=n(17),s=_(n(13867)),u=_(n(1793)),l=_(n(18962)),h=_(n(46011)),c=_(n(50347)),f=_(n(45301));function _(t){return t&&t.__esModule?t:{default:t}}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,i.default)(t,r.key,r)}}var p=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ALPHA=1,this.defines=new r.ShaderDefines2D,this.shaderType=0,this.fillStyle=a.DrawStyle.DEFAULT,this.strokeStyle=a.DrawStyle.DEFAULT}var e,n,i;return e=t,i=[{key:"__init__",value:function(){o.Shader.preCompile2D(0,r.ShaderDefines2D.TEXTURE2D,s.default,u.default,null),o.Shader.preCompile2D(0,r.ShaderDefines2D.PRIMITIVE,l.default,h.default,null),o.Shader.preCompile2D(0,r.ShaderDefines2D.SKINMESH,c.default,f.default,null)}}],(n=[{key:"destroy",value:function(){this.defines=null,this.filters=null}}])&&d(e.prototype,n),i&&d(e,i),t}();e.Shader2D=p},76839:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.Shader2X=void 0;var f=d(n(85507)),_=d(n(21611));function d(t){return t&&t.__esModule?t:{default:t}}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function v(){return v="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=g(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},v.apply(this,arguments)}function g(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=x(t)););return t}function m(t,e){return m=a||function(t,e){return t.__proto__=e,t},m(t,e)}function b(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return T(this,n)}}function T(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function x(t){return x=f.default?_.default:function(t){return t.__proto__||(0,_.default)(t)},x(t)}var w=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(a,t);var e,n,i,r=b(a);function a(t,e){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return p(this,a),(n=r.call(this,t,e,i,o,s))._params2dQuick2=null,n._shaderValueWidth=0,n._shaderValueHeight=0,n}return e=a,i=[{key:"create",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return new a(t,e,n,i,r)}}],(n=[{key:"_disposeResource",value:function(){v(x(a.prototype),"_disposeResource",this).call(this),this._params2dQuick2=null}},{key:"upload2dQuick2",value:function(t){this.upload(t,this._params2dQuick2||this._make2dQuick2())}},{key:"_make2dQuick2",value:function(){if(!this._params2dQuick2){this._params2dQuick2=[];for(var t,e=this._params,n=0,i=e.length;n<i;n++)"size"!==(t=e[n]).name&&this._params2dQuick2.push(t)}return this._params2dQuick2}}])&&y(e.prototype,n),i&&y(e,i),a}(n(17).Shader);e.Shader2X=w},43989:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.ShaderDefines2D=void 0;var h=f(n(85507)),c=f(n(21611));function f(t){return t&&t.__esModule?t:{default:t}}function _(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function d(t,e){return d=a||function(t,e){return t.__proto__=e,t},d(t,e)}function p(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=v(t);if(e){var a=v(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}function y(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function v(t){return v=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},v(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(a,t);var e,n,i,r=p(a);function a(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),r.call(this,a.__name2int,a.__int2name,a.__int2nameMap)}return e=a,i=[{key:"__init__",value:function(){a.reg("TEXTURE2D",a.TEXTURE2D),a.reg("PRIMITIVE",a.PRIMITIVE),a.reg("GLOW_FILTER",a.FILTERGLOW),a.reg("BLUR_FILTER",a.FILTERBLUR),a.reg("COLOR_FILTER",a.FILTERCOLOR),a.reg("COLOR_ADD",a.COLORADD),a.reg("WORLDMAT",a.WORLDMAT),a.reg("FILLTEXTURE",a.FILLTEXTURE),a.reg("MVP3D",a.MVP3D)}},{key:"reg",value:function(t,e){this._reg(t,e,a.__name2int,a.__int2name)}},{key:"toText",value:function(t,e,n){return this._toText(t,e,n)}},{key:"toInt",value:function(t){return this._toInt(t,a.__name2int)}}],(n=null)&&_(e.prototype,n),i&&_(e,i),a}(n(805).ShaderDefinesBase);e.ShaderDefines2D=g,g.TEXTURE2D=1,g.PRIMITIVE=4,g.FILTERGLOW=8,g.FILTERBLUR=16,g.FILTERCOLOR=32,g.COLORADD=64,g.WORLDMAT=128,g.FILLTEXTURE=256,g.SKINMESH=512,g.MVP3D=2048,g.NOOPTMASK=g.FILTERGLOW|g.FILTERBLUR|g.FILTERCOLOR|g.FILLTEXTURE,g.__name2int={},g.__int2name=[],g.__int2nameMap=[]},28434:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.SkinMeshBuffer=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(86152),o=n(53778),s=n(33873);function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var e=s.LayaGL.instance;this.ib=a.IndexBuffer2D.create(e.DYNAMIC_DRAW),this.vb=o.VertexBuffer2D.create(8)}var e,n,i;return e=t,i=[{key:"getInstance",value:function(){return t.instance=t.instance||new t}}],(n=[{key:"addSkinMesh",value:function(t){t.getData2(this.vb,this.ib,this.vb._byteLength/32)}},{key:"reset",value:function(){this.vb.clear(),this.ib.clear()}}])&&u(e.prototype,n),i&&u(e,i),t}();e.SkinMeshBuffer=l},2717:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.SkinSV=void 0;var h=y(n(85507)),c=y(n(21611)),f=n(43989),_=n(22245),d=n(70053),p=n(61266);function y(t){return t&&t.__esModule?t:{default:t}}function v(t,e){return v=a||function(t,e){return t.__proto__=e,t},v(t,e)}function g(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b(t);if(e){var a=b(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return m(this,n)}}function m(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function b(t){return b=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},b(t)}var T=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(n,t);var e=g(n);function n(t){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(i=e.call(this,f.ShaderDefines2D.SKINMESH,0)).offsetX=300,i.offsetY=0;var r=p.WebGLContext.mainContext,a=8*d.CONST3D2D.BYTES_PE;return i.position=[2,r.FLOAT,!1,a,0],i.texcoord=[2,r.FLOAT,!1,a,2*d.CONST3D2D.BYTES_PE],i.color=[4,r.FLOAT,!1,a,4*d.CONST3D2D.BYTES_PE],i}return n}(_.Value2D);e.SkinSV=T},11984:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.PrimitiveSV=void 0;var h=d(n(85507)),c=d(n(21611)),f=n(22245),_=n(43989);function d(t){return t&&t.__esModule?t:{default:t}}function p(t,e){return p=a||function(t,e){return t.__proto__=e,t},p(t,e)}function y(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=g(t);if(e){var a=g(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return v(this,n)}}function v(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function g(t){return g=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},g(t)}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(n,t);var e=y(n);function n(t){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(i=e.call(this,_.ShaderDefines2D.PRIMITIVE,0))._attribLocation=["position",0,"attribColor",1],i}return n}(f.Value2D);e.PrimitiveSV=m},56978:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.TextureSV=void 0;var h=d(n(85507)),c=d(n(21611)),f=n(22245),_=n(43989);function d(t){return t&&t.__esModule?t:{default:t}}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function v(t,e){return v=a||function(t,e){return t.__proto__=e,t},v(t,e)}function g(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b(t);if(e){var a=b(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return m(this,n)}}function m(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function b(t){return b=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},b(t)}var T=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(a,t);var e,n,i,r=g(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return p(this,a),(t=r.call(this,_.ShaderDefines2D.TEXTURE2D,e)).strength=0,t.blurInfo=null,t.colorMat=null,t.colorAlpha=null,t._attribLocation=["posuv",0,"attribColor",1,"attribFlags",2],t}return e=a,(n=[{key:"clear",value:function(){this.texture=null,this.shader=null,this.defines._value=this.subID}}])&&y(e.prototype,n),i&&y(e,i),a}(f.Value2D);e.TextureSV=T},22245:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Value2D=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(17),o=n(76839),s=n(43989),u=n(56161),l=n(92493);function h(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var c=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.defines=new s.ShaderDefines2D,this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this.ref=1,this._cacheID=0,this.clipMatDir=[l.ILaya.Context._MAXSIZE,0,0,l.ILaya.Context._MAXSIZE],this.clipMatPos=[0,0],this.clipOff=[0,0],this.mainID=e,this.subID=n,this.textureHost=null,this.texture=null,this.color=null,this.colorAdd=null,this.u_mmat2=null,this._cacheID=e|n,this._inClassCache=t._cache[this._cacheID],e>0&&!this._inClassCache&&(this._inClassCache=t._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}var e,n,i;return e=t,i=[{key:"_initone",value:function(e,n){t._typeClass[e]=n,t._cache[e]=[],t._cache[e]._length=0}},{key:"__init__",value:function(){}},{key:"create",value:function(e,n){var i=t._cache[e|n];return i._length?i[--i._length]:new t._typeClass[e|n](n)}}],(n=[{key:"setValue",value:function(t){}},{key:"_ShaderWithCompile",value:function(){return a.Shader.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,o.Shader2X.create,this._attribLocation)}},{key:"upload",value:function(){var t=u.RenderState2D;u.RenderState2D.worldMatrix4===u.RenderState2D.TEMPMAT4_ARRAY||this.defines.addInt(s.ShaderDefines2D.WORLDMAT),this.mmat=t.worldMatrix4,u.RenderState2D.matWVP&&(this.defines.addInt(s.ShaderDefines2D.MVP3D),this.u_MvpMatrix=u.RenderState2D.matWVP.elements);var e=a.Shader.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();e._shaderValueWidth!==t.width||e._shaderValueHeight!==t.height?(this.size[0]=t.width,this.size[1]=t.height,e._shaderValueWidth=t.width,e._shaderValueHeight=t.height,e.upload(this,null)):e.upload(this,e._params2dQuick2||e._make2dQuick2())}},{key:"setFilters",value:function(t){if(this.filters=t,t)for(var e,n=t.length,i=0;i<n;i++)(e=t[i])&&(this.defines.add(e.type),e.action.setValue(this))}},{key:"clear",value:function(){this.defines._value=this.subID,this.clipOff[0]=0}},{key:"release",value:function(){--this.ref<1&&(this._inClassCache&&(this._inClassCache[this._inClassCache._length++]=this),this.clear(),this.filters=null,this.ref=1,this.clipOff[0]=0)}}])&&h(e.prototype,n),i&&h(e,i),t}();e.Value2D=c,c._cache=[],c._typeClass=[],c.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},46322:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.BasePoly=void 0;var i=a(n(3649)),r=a(n(63978));function a(t){return t&&t.__esModule?t:{default:t}}function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,r=[{key:"createLine2",value:function(e,n,i,r,a,o){if(e.length<4)return null;var s=t.tempData.length>e.length+2?t.tempData:new Array(e.length+2);s[0]=e[0],s[1]=e[1];var u=2,l=0,h=e.length;for(l=2;l<h;l+=2)Math.abs(e[l]-e[l-2])+Math.abs(e[l+1]-e[l-1])>.01&&(s[u++]=e[l],s[u++]=e[l+1]);o&&Math.abs(e[0]-s[u-2])+Math.abs(e[1]-s[u-1])>.01&&(s[u++]=e[0],s[u++]=e[1]);var c=a;h=u/2;var f,_,d,p,y,v,g,m,b,T,x,w,k,C,E,S,M,L,R,I,A=i/2;for(d=s[0],p=s[1],T=d-(y=s[2]),b=(b=-(p-(v=s[3])))/(I=Math.sqrt(b*b+T*T))*A,T=T/I*A,c.push(d-b,p-T,d+b,p+T),l=1;l<h-1;l++)d=s[2*(l-1)],p=s[2*(l-1)+1],y=s[2*l],v=s[2*l+1],g=s[2*(l+1)],m=s[2*(l+1)+1],T=d-y,w=y-g,E=(-(b=(b=-(p-v))/(I=Math.sqrt(b*b+T*T))*A)+d)*(-(T=T/I*A)+v)-(-b+y)*(-T+p),L=(-(x=(x=-(v-m))/(I=Math.sqrt(x*x+w*w))*A)+g)*(-(w=w/I*A)+v)-(-x+y)*(-w+m),R=(k=-T+p-(-T+v))*(M=-x+y-(-x+g))-(S=-w+m-(-w+v))*(C=-b+y-(-b+d)),Math.abs(R)<.1?(R+=10.1,c.push(y-b,v-T,y+b,v+T)):(f=(C*L-M*E)/R,_=(S*E-k*L)/R,c.push(f,_,y-(f-y),v-(_-v)));for(d=s[u-4],p=s[u-3],T=d-(y=s[u-2]),b=(b=-(p-(v=s[u-1])))/(I=Math.sqrt(b*b+T*T))*A,T=T/I*A,c.push(y-b,v-T,y+b,v+T),l=1;l<h;l++)n.push(r+2*(l-1),r+2*(l-1)+1,r+2*l+1,r+2*l+1,r+2*l,r+2*(l-1));return c}},{key:"createLineTriangle",value:function(t,e,n,r,a,o,s){var u=(0,i.default)(t).call(t),l=u.length,h=u[0],c=u[1],f=u[2],_=(u[2],0),d=0,p=0,y=0,v=l/2;if(!(v<=1)&&2!=v){for(var g=new Array(4*v),m=0,b=0,T=0;T<v-1;T++)h=u[b++],c=u[b++],f=u[b++],y=u[b++]-c,0!=(p=f-h)&&0!=y&&(_=Math.sqrt(p*p+y*y))>.001&&(g[d=4*m]=h,g[d+1]=c,g[d+2]=p/_,g[d+3]=y/_,m++);for(r?(h=u[l-2],c=u[l-1],f=u[0],y=u[1]-c,0!=(p=f-h)&&0!=y&&(_=Math.sqrt(p*p+y*y))>.001&&(g[d=4*m]=h,g[d+1]=c,g[d+2]=p/_,g[d+3]=y/_,m++)):(g[d=4*m]=h,g[d+1]=c,g[d+2]=p/_,g[d+3]=y/_,m++),b=0,T=0;T<v;T++)h=u[b],c=u[b+1],f=u[b+2],u[b+3]}}}],(n=null)&&o(e.prototype,n),r&&o(e,r),t}();e.BasePoly=s,s.tempData=new Array(256)},30347:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Earcut=void 0;var i=o(n(47302)),r=o(n(63978)),a=n(15698);function o(t){return t&&t.__esModule?t:{default:t}}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,r=[{key:"earcut",value:function(e,n,i){i=i||2;var r,a,o,s,u,l,h,c=n&&n.length,f=c?n[0]*i:e.length,_=t.linkedList(e,0,f,i,!0),d=[];if(!_)return d;if(c&&(_=t.eliminateHoles(e,n,_,i)),e.length>80*i){r=o=e[0],a=s=e[1];for(var p=i;p<f;p+=i)(u=e[p])<r&&(r=u),(l=e[p+1])<a&&(a=l),u>o&&(o=u),l>s&&(s=l);h=0!==(h=Math.max(o-r,s-a))?1/h:0}return t.earcutLinked(_,d,i,r,a,h),d}},{key:"linkedList",value:function(e,n,i,r,a){var o,s;if(a===t.signedArea(e,n,i,r)>0)for(o=n;o<i;o+=r)s=t.insertNode(o,e[o],e[o+1],s);else for(o=i-r;o>=n;o-=r)s=t.insertNode(o,e[o],e[o+1],s);return s&&t.equals(s,s.next)&&(t.removeNode(s),s=s.next),s}},{key:"filterPoints",value:function(e,n){if(!e)return e;n||(n=e);var i,r=e;do{if(i=!1,r.steiner||!t.equals(r,r.next)&&0!==t.area(r.prev,r,r.next))r=r.next;else{if(t.removeNode(r),(r=n=r.prev)===r.next)break;i=!0}}while(i||r!==n);return n}},{key:"earcutLinked",value:function(e,n,i,r,a,o){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if(e){!s&&o&&t.indexCurve(e,r,a,o);for(var u,l,h=e;e.prev!==e.next;)if(u=e.prev,l=e.next,o?t.isEarHashed(e,r,a,o):t.isEar(e))n.push(u.i/i),n.push(e.i/i),n.push(l.i/i),t.removeNode(e),e=l.next,h=l.next;else if((e=l)===h){s?1===s?(e=t.cureLocalIntersections(e,n,i),t.earcutLinked(e,n,i,r,a,o,2)):2===s&&t.splitEarcut(e,n,i,r,a,o):t.earcutLinked(t.filterPoints(e,null),n,i,r,a,o,1);break}}}},{key:"isEar",value:function(e){var n=e.prev,i=e,r=e.next;if(t.area(n,i,r)>=0)return!1;for(var a=e.next.next;a!==e.prev;){if(t.pointInTriangle(n.x,n.y,i.x,i.y,r.x,r.y,a.x,a.y)&&t.area(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}},{key:"isEarHashed",value:function(e,n,i,r){var a=e.prev,o=e,s=e.next;if(t.area(a,o,s)>=0)return!1;for(var u=a.x<o.x?a.x<s.x?a.x:s.x:o.x<s.x?o.x:s.x,l=a.y<o.y?a.y<s.y?a.y:s.y:o.y<s.y?o.y:s.y,h=a.x>o.x?a.x>s.x?a.x:s.x:o.x>s.x?o.x:s.x,c=a.y>o.y?a.y>s.y?a.y:s.y:o.y>s.y?o.y:s.y,f=t.zOrder(u,l,n,i,r),_=t.zOrder(h,c,n,i,r),d=e.nextZ;d&&d.z<=_;){if(d!==e.prev&&d!==e.next&&t.pointInTriangle(a.x,a.y,o.x,o.y,s.x,s.y,d.x,d.y)&&t.area(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(d=e.prevZ;d&&d.z>=f;){if(d!==e.prev&&d!==e.next&&t.pointInTriangle(a.x,a.y,o.x,o.y,s.x,s.y,d.x,d.y)&&t.area(d.prev,d,d.next)>=0)return!1;d=d.prevZ}return!0}},{key:"cureLocalIntersections",value:function(e,n,i){var r=e;do{var a=r.prev,o=r.next.next;!t.equals(a,o)&&t.intersects(a,r,r.next,o)&&t.locallyInside(a,o)&&t.locallyInside(o,a)&&(n.push(a.i/i),n.push(r.i/i),n.push(o.i/i),t.removeNode(r),t.removeNode(r.next),r=e=o),r=r.next}while(r!==e);return r}},{key:"splitEarcut",value:function(e,n,i,r,a,o){var s=e;do{for(var u=s.next.next;u!==s.prev;){if(s.i!==u.i&&t.isValidDiagonal(s,u)){var l=t.splitPolygon(s,u);return s=t.filterPoints(s,s.next),l=t.filterPoints(l,l.next),t.earcutLinked(s,n,i,r,a,o),void t.earcutLinked(l,n,i,r,a,o)}u=u.next}s=s.next}while(s!==e)}},{key:"eliminateHoles",value:function(e,n,r,a){var o,s,u,l,h,c=[];for(o=0,s=n.length;o<s;o++)u=n[o]*a,l=o<s-1?n[o+1]*a:e.length,(h=t.linkedList(e,u,l,a,!1))===h.next&&(h.steiner=!0),c.push(t.getLeftmost(h));for((0,i.default)(c).call(c,t.compareX),o=0;o<c.length;o++)t.eliminateHole(c[o],r),r=t.filterPoints(r,r.next);return r}},{key:"compareX",value:function(t,e){return t.x-e.x}},{key:"eliminateHole",value:function(e,n){if(n=t.findHoleBridge(e,n)){var i=t.splitPolygon(n,e);t.filterPoints(i,i.next)}}},{key:"findHoleBridge",value:function(e,n){var i,r=n,a=e.x,o=e.y,s=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var u=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(u<=a&&u>s){if(s=u,u===a){if(o===r.y)return r;if(o===r.next.y)return r.next}i=r.x<r.next.x?r:r.next}}r=r.next}while(r!==n);if(!i)return null;if(a===s)return i.prev;var l,h=i,c=i.x,f=i.y,_=1/0;for(r=i.next;r!==h;)a>=r.x&&r.x>=c&&a!==r.x&&t.pointInTriangle(o<f?a:s,o,c,f,o<f?s:a,o,r.x,r.y)&&((l=Math.abs(o-r.y)/(a-r.x))<_||l===_&&r.x>i.x)&&t.locallyInside(r,e)&&(i=r,_=l),r=r.next;return i}},{key:"indexCurve",value:function(e,n,i,r){var a=e;do{null===a.z&&(a.z=t.zOrder(a.x,a.y,n,i,r)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next}while(a!==e);a.prevZ.nextZ=null,a.prevZ=null,t.sortLinked(a)}},{key:"sortLinked",value:function(t){var e,n,i,r,a,o,s,u,l=1;do{for(n=t,t=null,a=null,o=0;n;){for(o++,i=n,s=0,e=0;e<l&&(s++,i=i.nextZ);e++);for(u=l;s>0||u>0&&i;)0!==s&&(0===u||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,u--),a?a.nextZ=r:t=r,r.prevZ=a,a=r;n=i}a.nextZ=null,l*=2}while(o>1);return t}},{key:"zOrder",value:function(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}},{key:"getLeftmost",value:function(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}},{key:"pointInTriangle",value:function(t,e,n,i,r,a,o,s){return(r-o)*(e-s)-(t-o)*(a-s)>=0&&(t-o)*(i-s)-(n-o)*(e-s)>=0&&(n-o)*(a-s)-(r-o)*(i-s)>=0}},{key:"isValidDiagonal",value:function(e,n){return e.next.i!==n.i&&e.prev.i!==n.i&&!t.intersectsPolygon(e,n)&&t.locallyInside(e,n)&&t.locallyInside(n,e)&&t.middleInside(e,n)}},{key:"area",value:function(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}},{key:"equals",value:function(t,e){return t.x===e.x&&t.y===e.y}},{key:"intersects",value:function(e,n,i,r){return!!(t.equals(e,n)&&t.equals(i,r)||t.equals(e,r)&&t.equals(i,n))||t.area(e,n,i)>0!=t.area(e,n,r)>0&&t.area(i,r,e)>0!=t.area(i,r,n)>0}},{key:"intersectsPolygon",value:function(e,n){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==n.i&&i.next.i!==n.i&&t.intersects(i,i.next,e,n))return!0;i=i.next}while(i!==e);return!1}},{key:"locallyInside",value:function(e,n){return t.area(e.prev,e,e.next)<0?t.area(e,n,e.next)>=0&&t.area(e,e.prev,n)>=0:t.area(e,n,e.prev)<0||t.area(e,e.next,n)<0}},{key:"middleInside",value:function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,a=(t.y+e.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&r<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}},{key:"splitPolygon",value:function(t,e){var n=new a.EarcutNode(t.i,t.x,t.y),i=new a.EarcutNode(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}},{key:"insertNode",value:function(t,e,n,i){var r=new a.EarcutNode(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}},{key:"removeNode",value:function(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}},{key:"signedArea",value:function(t,e,n,i){for(var r=0,a=e,o=n-i;a<n;a+=i)r+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return r}}],(n=null)&&s(e.prototype,n),r&&s(e,r),t}();e.Earcut=u},15698:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.EarcutNode=void 0;e.EarcutNode=function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.i=e,this.x=n,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}},36296:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.Submit=void 0;var h=v(n(85507)),c=v(n(21611)),f=n(683),_=n(91700),d=n(70053),p=n(61266),y=n(93055);function v(t){return t&&t.__esModule?t:{default:t}}function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function b(t,e){return b=a||function(t,e){return t.__proto__=e,t},b(t,e)}function T(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=w(t);if(e){var a=w(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return x(this,n)}}function x(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function w(t){return w=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},w(t)}var k=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&b(t,e)}(a,t);var e,n,i,r=T(a);function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y.SubmitBase.TYPE_2D;return g(this,a),r.call(this,t)}return e=a,i=[{key:"create",value:function(t,e,n){var i=a._poolSize?a.POOL[--a._poolSize]:new a;i._ref=1,i._mesh=e,i._key.clear(),i._startIdx=e.indexNum*d.CONST3D2D.BYTES_PIDX,i._numEle=0;var r=t._nBlendType;i._blendFn=t._targets?_.BlendMode.targetFns[r]:_.BlendMode.fns[r],i.shaderValue=n,i.shaderValue.setValue(t._shader2D);var o=t._shader2D.filters;return o&&i.shaderValue.setFilters(o),i}},{key:"createShape",value:function(t,e,n,i){var r=a._poolSize?a.POOL[--a._poolSize]:new a;r._mesh=e,r._numEle=n,r._startIdx=2*e.indexNum,r._ref=1,r.shaderValue=i,r.shaderValue.setValue(t._shader2D);var o=t._nBlendType;return r._key.blendShader=o,r._blendFn=t._targets?_.BlendMode.targetFns[o]:_.BlendMode.fns[o],r}}],(n=[{key:"renderSubmit",value:function(){if(0===this._numEle||!this._mesh||0==this._numEle)return 1;var t=this.shaderValue.textureHost;if(t){var e=t._getSource();if(!e)return 1;this.shaderValue.texture=e}var n=p.WebGLContext.mainContext;return this._mesh.useMesh(n),this.shaderValue.upload(),_.BlendMode.activeBlendFunction!==this._blendFn&&(p.WebGLContext.setBlend(n,!0),this._blendFn(n),_.BlendMode.activeBlendFunction=this._blendFn),n.drawElements(n.TRIANGLES,this._numEle,n.UNSIGNED_SHORT,this._startIdx),f.Stat.renderBatches++,f.Stat.trianglesFaces+=this._numEle/3,1}},{key:"releaseRender",value:function(){y.SubmitBase.RENDERBASE!=this&&--this._ref<1&&(a.POOL[a._poolSize++]=this,this.shaderValue.release(),this.shaderValue=null,this._mesh=null,this._parent&&(this._parent.releaseRender(),this._parent=null))}}])&&m(e.prototype,n),i&&m(e,i),a}(y.SubmitBase);e.Submit=k,k._poolSize=0,k.POOL=[]},93055:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.SubmitBase=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(76993),o=n(22245);function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var l=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.TYPE_2D;s(this,t),this.clipInfoID=-1,this._mesh=null,this._blendFn=null,this._id=0,this._renderType=0,this._parent=null,this._key=new a.SubmitKey,this._startIdx=0,this._numEle=0,this._ref=1,this.shaderValue=null,this._renderType=e,this._id=++t.ID}var e,n,i;return e=t,i=[{key:"__init__",value:function(){var e=t.RENDERBASE=new t(-1);e.shaderValue=new o.Value2D(0,0),e.shaderValue.ALPHA=1,e._ref=4294967295}}],(n=[{key:"getID",value:function(){return this._id}},{key:"getRenderType",value:function(){return this._renderType}},{key:"toString",value:function(){return"ibindex:"+this._startIdx+" num:"+this._numEle+" key="+this._key}},{key:"renderSubmit",value:function(){return 1}},{key:"releaseRender",value:function(){}}])&&u(e.prototype,n),i&&u(e,i),t}();e.SubmitBase=l,l.TYPE_2D=1e4,l.TYPE_CANVAS=10003,l.TYPE_CMDSETRT=10004,l.TYPE_CUSTOM=10005,l.TYPE_BLURRT=10006,l.TYPE_CMDDESTORYPRERT=10007,l.TYPE_DISABLESTENCIL=10008,l.TYPE_OTHERIBVB=10009,l.TYPE_PRIMITIVE=10010,l.TYPE_RT=10011,l.TYPE_BLUR_RT=10012,l.TYPE_TARGET=10013,l.TYPE_CHANGE_VALUE=10014,l.TYPE_SHAPE=10015,l.TYPE_TEXTURE=10016,l.TYPE_FILLTEXTURE=10017,l.KEY_ONCE=-1,l.KEY_FILLRECT=1,l.KEY_DRAWTEXTURE=2,l.KEY_VG=3,l.KEY_TRIANGLES=4,l.ID=1,l.preRender=null},69153:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.SubmitCMD=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(76993);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._ref=1,this._key=new a.SubmitKey}var e,n,i;return e=t,i=[{key:"create",value:function(e,n,i){var r=t.POOL._length?t.POOL[--t.POOL._length]:new t;return r.fun=n,r.args=e,r._this=i,r._ref=1,r._key.clear(),r}}],(n=[{key:"renderSubmit",value:function(){return this.fun.apply(this._this,this.args),1}},{key:"getRenderType",value:function(){return 0}},{key:"releaseRender",value:function(){if(--this._ref<1){var e=t.POOL;e[e._length++]=this}}}])&&o(e.prototype,n),i&&o(e,i),t}();e.SubmitCMD=s,s.POOL=[],s.POOL._length=0},23800:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.SubmitCanvas=void 0;var h=g(n(77766)),c=g(n(85507)),f=g(n(21611)),_=n(18008),d=n(22245),p=n(70053),y=n(56161),v=n(93055);function g(t){return t&&t.__esModule?t:{default:t}}function m(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function b(t,e){return b=a||function(t,e){return t.__proto__=e,t},b(t,e)}function T(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=w(t);if(e){var a=w(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return x(this,n)}}function x(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function w(t){return w=c.default?f.default:function(t){return t.__proto__||(0,f.default)(t)},w(t)}var k=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&b(t,e)}(a,t);var e,n,i,r=T(a);function a(){var t,e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=r.call(this,v.SubmitBase.TYPE_2D))._matrix=new _.Matrix,e._matrix4=(0,h.default)(t=p.CONST3D2D.defaultMatrix4).call(t),e.shaderValue=new d.Value2D(0,0),e}return e=a,i=[{key:"create",value:function(t,e,n){var i=a.POOL._length?a.POOL[--a.POOL._length]:new a;i.canv=t,i._ref=1,i._numEle=0;var r=i.shaderValue;return r.alpha=e,r.defines.setValue(0),n&&n.length&&r.setFilters(n),i}}],(n=[{key:"renderSubmit",value:function(){var t=y.RenderState2D.worldAlpha,e=y.RenderState2D.worldMatrix4,n=y.RenderState2D.worldMatrix,i=y.RenderState2D.worldFilters,r=y.RenderState2D.worldShaderDefines,a=this.shaderValue,o=this._matrix,s=this._matrix4,u=_.Matrix.TEMP;return _.Matrix.mul(o,n,u),s[0]=u.a,s[1]=u.b,s[4]=u.c,s[5]=u.d,s[12]=u.tx,s[13]=u.ty,y.RenderState2D.worldMatrix=u.clone(),y.RenderState2D.worldMatrix4=s,y.RenderState2D.worldAlpha=y.RenderState2D.worldAlpha*a.alpha,a.filters&&a.filters.length&&(y.RenderState2D.worldFilters=a.filters,y.RenderState2D.worldShaderDefines=a.defines),this.canv.flushsubmit(),y.RenderState2D.worldAlpha=t,y.RenderState2D.worldMatrix4=e,y.RenderState2D.worldMatrix.destroy(),y.RenderState2D.worldMatrix=n,y.RenderState2D.worldFilters=i,y.RenderState2D.worldShaderDefines=r,1}},{key:"releaseRender",value:function(){if(--this._ref<1){var t=a.POOL;this._mesh=null,t[t._length++]=this}}},{key:"getRenderType",value:function(){return v.SubmitBase.TYPE_CANVAS}}])&&m(e.prototype,n),i&&m(e,i),a}(v.SubmitBase);e.SubmitCanvas=k,k.POOL=[],k.POOL._length=0},76993:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.SubmitKey=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i};function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.clear()}var e,n,i;return e=t,(n=[{key:"clear",value:function(){this.submitType=-1,this.blendShader=this.other=0}},{key:"copyFrom",value:function(t){this.other=t.other,this.blendShader=t.blendShader,this.submitType=t.submitType}},{key:"copyFrom2",value:function(t,e,n){this.other=n,this.submitType=e}},{key:"equal3_2",value:function(t,e,n){return this.submitType===e&&this.other===n&&this.blendShader===t.blendShader}},{key:"equal4_2",value:function(t,e,n){return this.submitType===e&&this.other===n&&this.blendShader===t.blendShader}},{key:"equal_3",value:function(t){return this.submitType===t.submitType&&this.blendShader===t.blendShader}},{key:"equal",value:function(t){return this.other===t.other&&this.submitType===t.submitType&&this.blendShader===t.blendShader}}])&&a(e.prototype,n),i&&a(e,i),t}();e.SubmitKey=o},40113:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.SubmitTarget=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(76993),o=n(683),s=n(61266),u=n(91700),l=n(70053);function h(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var c=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.blendType=0,this._ref=1,this._key=new a.SubmitKey}var e,n,i;return e=t,i=[{key:"create",value:function(e,n,i,r){var a=t.POOL._length?t.POOL[--t.POOL._length]:new t;if(a._mesh=n,a.srcRT=r,a._startIdx=n.indexNum*l.CONST3D2D.BYTES_PIDX,a._ref=1,a._key.clear(),a._numEle=0,a.blendType=e._nBlendType,a._key.blendShader=a.blendType,a.shaderValue=i,a.shaderValue.setValue(e._shader2D),e._colorFiler){var o=e._colorFiler;i.defines.add(o.type),i.colorMat=o._mat,i.colorAlpha=o._alpha}return a}}],(n=[{key:"renderSubmit",value:function(){var t=s.WebGLContext.mainContext;this._mesh.useMesh(t);var e=this.srcRT;return e&&(this.shaderValue.texture=e._getSource(),this.shaderValue.upload(),this.blend(),o.Stat.renderBatches++,o.Stat.trianglesFaces+=this._numEle/3,t.drawElements(t.TRIANGLES,this._numEle,t.UNSIGNED_SHORT,this._startIdx)),1}},{key:"blend",value:function(){if(u.BlendMode.activeBlendFunction!==u.BlendMode.fns[this.blendType]){var t=s.WebGLContext.mainContext;t.enable(t.BLEND),u.BlendMode.fns[this.blendType](t),u.BlendMode.activeBlendFunction=u.BlendMode.fns[this.blendType]}}},{key:"getRenderType",value:function(){return 0}},{key:"releaseRender",value:function(){if(--this._ref<1){var e=t.POOL;e[e._length++]=this}}}])&&h(e.prototype,n),i&&h(e,i),t}();e.SubmitTarget=c,c.POOL=[],c.POOL._length=0},95055:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.SubmitTexture=void 0;var h=m(n(85507)),c=m(n(21611)),f=n(93055),_=n(683),d=n(61266),p=n(91700),y=n(20541),v=n(43989),g=n(70053);function m(t){return t&&t.__esModule?t:{default:t}}function b(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function x(t,e){return x=a||function(t,e){return t.__proto__=e,t},x(t,e)}function w(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=C(t);if(e){var a=C(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return k(this,n)}}function k(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function C(t){return C=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},C(t)}var E=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&x(t,e)}(a,t);var e,n,i,r=w(a);function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f.SubmitBase.TYPE_2D;return b(this,a),r.call(this,t)}return e=a,i=[{key:"create",value:function(t,e,n){var i=a._poolSize?a.POOL[--a._poolSize]:new a(f.SubmitBase.TYPE_TEXTURE);i._mesh=e,i._key.clear(),i._key.submitType=f.SubmitBase.KEY_DRAWTEXTURE,i._ref=1,i._startIdx=e.indexNum*g.CONST3D2D.BYTES_PIDX,i._numEle=0;var r=t._nBlendType;if(i._key.blendShader=r,i._blendFn=t._targets?p.BlendMode.targetFns[r]:p.BlendMode.fns[r],i.shaderValue=n,t._colorFiler){var o=t._colorFiler;n.defines.add(o.type),n.colorMat=o._mat,n.colorAlpha=o._alpha}return i}}],(n=[{key:"releaseRender",value:function(){--this._ref<1&&(a.POOL[a._poolSize++]=this,this.shaderValue.release(),this._mesh=null,this._parent&&(this._parent.releaseRender(),this._parent=null))}},{key:"renderSubmit",value:function(){if(0===this._numEle)return 1;var t=this.shaderValue.textureHost;if(t){var e=t?t._getSource():null;if(!e)return 1}var n=d.WebGLContext.mainContext;this._mesh.useMesh(n);var i=f.SubmitBase.preRender,r=f.SubmitBase.preRender._key;return 0===this._key.blendShader&&this._key.submitType===r.submitType&&this._key.blendShader===r.blendShader&&y.BaseShader.activeShader&&f.SubmitBase.preRender.clipInfoID==this.clipInfoID&&i.shaderValue.defines._value===this.shaderValue.defines._value&&0==(this.shaderValue.defines._value&v.ShaderDefines2D.NOOPTMASK)?y.BaseShader.activeShader.uploadTexture2D(e):(p.BlendMode.activeBlendFunction!==this._blendFn&&(d.WebGLContext.setBlend(n,!0),this._blendFn(n),p.BlendMode.activeBlendFunction=this._blendFn),this.shaderValue.texture=e,this.shaderValue.upload()),n.drawElements(n.TRIANGLES,this._numEle,n.UNSIGNED_SHORT,this._startIdx),_.Stat.renderBatches++,_.Stat.trianglesFaces+=this._numEle/3,1}}])&&T(e.prototype,n),i&&T(e,i),a}(f.SubmitBase);e.SubmitTexture=E,E._poolSize=0,E.POOL=[]},89308:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.AtlasGrid=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i};function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;a(this,t),this.atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._used=0,this._cells=null,this._rowInfo=null,this.atlasID=i,this._init(e,n)}var e,n,i;return e=t,(n=[{key:"addRect",value:function(t,e,n,i){return!!this._get(e,n,i)&&(this._fill(i.x,i.y,e,n,t),this._texCount++,!0)}},{key:"_release",value:function(){this._cells=null,this._rowInfo=null}},{key:"_init",value:function(t,e){return this._width=t,this._height=e,this._release(),0!=this._width&&(this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=new Uint8Array(this._height),this._used=0,this._clear(),!0)}},{key:"_get",value:function(t,e,n){if(t>this._width||e>this._height)return!1;for(var i=-1,r=-1,a=this._width,o=this._height,s=this._cells,u=0;u<o;u++)if(!(this._rowInfo[u]<t))for(var l=0;l<a;){var h=3*(u*a+l);if(0!=s[h]||s[h+1]<t||s[h+2]<e)l+=s[h+1];else{i=l,r=u;for(var c=0;c<t;c++)if(s[3*c+h+2]<e){i=-1;break}if(!(i<0))return n.x=i,n.y=r,!0;l+=s[h+1]}}return!1}},{key:"_fill",value:function(t,e,n,i,r){var a=this._width,o=this._height;this._check(t+n<=a&&e+i<=o);for(var s=e;s<i+e;++s){this._check(this._rowInfo[s]>=n),this._rowInfo[s]-=n;for(var u=0;u<n;u++){var l=3*(t+s*a+u);this._check(0==this._cells[l]),this._cells[l]=r,this._cells[l+1]=n,this._cells[l+2]=i}}if(t>0)for(s=0;s<i;++s){var h=0;for(u=t-1;u>=0&&0==this._cells[3*((e+s)*a+u)];--u,++h);for(u=h;u>0;--u)this._cells[3*((e+s)*a+t-u)+1]=u,this._check(u>0)}if(e>0)for(u=t;u<t+n;++u){for(h=0,s=e-1;s>=0&&0==this._cells[3*(u+s*a)];--s,h++);for(s=h;s>0;--s)this._cells[3*(u+(e-s)*a)+2]=s,this._check(s>0)}this._used+=n*i/(this._width*this._height)}},{key:"_check",value:function(t){0==t&&console.log("xtexMerger 错误啦")}},{key:"_clear",value:function(){this._texCount=0;for(var t=0;t<this._height;t++)this._rowInfo[t]=this._width;for(var e=0;e<this._height;e++)for(var n=0;n<this._width;n++){var i=3*(e*this._width+n);this._cells[i]=0,this._cells[i+1]=this._width-n,this._cells[i+2]=this._width-e}}}])&&o(e.prototype,n),i&&o(e,i),t}();e.AtlasGrid=s},50078:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.CharRenderInfo=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(12596);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.char="",this.deleted=!1,this.uv=new Array(8),this.pos=0,this.orix=0,this.oriy=0,this.touchTick=0,this.isSpace=!1}var e,n,i;return e=t,(n=[{key:"touch",value:function(){var t=a.RenderInfo.loopCount;this.touchTick!=t&&this.tex.touchRect(this,t),this.touchTick=t}}])&&o(e.prototype,n),i&&o(e,i),t}();e.CharRenderInfo=s},82310:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.CharRender_Canvas=void 0;var h=d(n(85507)),c=d(n(21611)),f=n(2656),_=n(93568);function d(t){return t&&t.__esModule?t:{default:t}}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function v(t,e){return v=a||function(t,e){return t.__proto__=e,t},v(t,e)}function g(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b(t);if(e){var a=b(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return m(this,n)}}function m(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function b(t){return b=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},b(t)}var T=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(a,t);var e,n,i,r=g(a);function a(t,e){var n,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return p(this,a),(n=r.call(this)).ctx=null,n.lastScaleX=1,n.lastScaleY=1,n.maxTexW=0,n.maxTexH=0,n.scaleFontSize=!0,n.showDbgInfo=!1,n.supportImageData=!0,n.maxTexW=t,n.maxTexH=e,n.scaleFontSize=i,n.supportImageData=o,n.showDbgInfo=s,a.canvas||(a.canvas=_.Browser.createElement("canvas"),a.canvas.width=1024,a.canvas.height=512,a.canvas.style.left="-10000px",a.canvas.style.position="absolute",document.body.appendChild(a.canvas),n.ctx=a.canvas.getContext("2d")),n}return e=a,n=[{key:"canvasWidth",get:function(){return a.canvas.width},set:function(t){a.canvas.width!=t&&(a.canvas.width=t,t>2048&&console.warn("画文字设置的宽度太大，超过2048了"),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.scale(this.lastScaleX,this.lastScaleY))}},{key:"getWidth",value:function(t,e){return this.ctx?(this.ctx._lastFont!=t&&(this.ctx.font=t,this.ctx._lastFont=t),this.ctx.measureText(e).width):0}},{key:"scale",value:function(t,e){if(!this.supportImageData)return this.lastScaleX=t,void(this.lastScaleY=e);this.lastScaleX==t&&this.lastScaleY==e||(this.ctx.setTransform(t,0,0,e,0,0),this.lastScaleX=t,this.lastScaleY=e)}},{key:"getCharBmp",value:function(t,e,n,i,r,o,s,u,l,h){var c=arguments.length>10&&void 0!==arguments[10]?arguments[10]:null;if(!this.supportImageData)return this.getCharCanvas(t,e,n,i,r,o,s,u,l,h);var f=this.ctx,_=this.fontsz;f.font!=e&&(f.font=e,f._lastFont=e),o.width=f.measureText(t).width;var d=o.width*this.lastScaleX,p=o.height*this.lastScaleY;d+=(s+l)*this.lastScaleX,p+=(u+h)*this.lastScaleY,d=Math.ceil(d),p=Math.ceil(p);var y=(d=Math.min(d,a.canvas.width))+2*n+1,v=(p=Math.min(p,a.canvas.height))+2*n+1;c&&(y=Math.max(y,c[0]+c[2]+1),v=Math.max(v,c[1]+c[3]+1)),f.clearRect(0,0,y/this.lastScaleX+1,v/this.lastScaleY+1),f.save(),f.textBaseline="middle",n>0&&(f.strokeStyle=r,f.lineWidth=n,f.strokeText(t,s,u+_/2)),i&&(f.fillStyle=i,f.fillText(t,s,u+_/2)),this.showDbgInfo&&(f.strokeStyle="#ff0000",f.strokeRect(1,1,d-2,p-2),f.strokeStyle="#00ff00",f.strokeRect(s,u,o.width,o.height)),c&&(-1==c[2]&&(c[2]=Math.ceil((o.width+2*n)*this.lastScaleX)),c[2]<=0&&(c[2]=1));var g=c?f.getImageData(c[0],c[1],c[2],c[3]+1):f.getImageData(0,0,d,p+1);return f.restore(),o.bmpWidth=g.width,o.bmpHeight=g.height,g}},{key:"getCharCanvas",value:function(t,e,n,i,r,o,s,u,l,h){var c=this.ctx;c.font!=e&&(c.font=e,c._lastFont=e),o.width=c.measureText(t).width;var f=o.width*this.lastScaleX,_=o.height*this.lastScaleY;f+=(s+l)*this.lastScaleX,_+=(u+h)*this.lastScaleY+1,f=Math.min(f,this.maxTexW),_=Math.min(_,this.maxTexH),a.canvas.width=Math.min(f+1,this.maxTexW),a.canvas.height=Math.min(_+1,this.maxTexH),c.font=e,c.clearRect(0,0,f+1+n,_+1+n),c.setTransform(1,0,0,1,0,0),c.save(),this.scaleFontSize&&c.scale(this.lastScaleX,this.lastScaleY),c.translate(s,u),c.textAlign="left";var d=this.fontsz;return c.textBaseline="middle",n>0?(c.strokeStyle=r,c.fillStyle=i,c.lineWidth=n,c.fillAndStrokeText?c.fillAndStrokeText(t,0,d/2):(c.strokeText(t,0,d/2),c.fillText(t,0,d/2))):i&&(c.fillStyle=i,c.fillText(t,0,d/2)),this.showDbgInfo&&(c.strokeStyle="#ff0000",c.strokeRect(0,0,f,_),c.strokeStyle="#00ff00",c.strokeRect(0,0,o.width,o.height)),c.restore(),o.bmpWidth=a.canvas.width,o.bmpHeight=a.canvas.height,a.canvas}}],n&&y(e.prototype,n),i&&y(e,i),a}(f.ICharRender);e.CharRender_Canvas=T,T.canvas=null},10069:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.CharRender_Native=void 0;var h=d(n(85507)),c=d(n(21611)),f=n(2656),_=n(13104);function d(t){return t&&t.__esModule?t:{default:t}}function p(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function y(t,e){return y=a||function(t,e){return t.__proto__=e,t},y(t,e)}function v(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=m(t);if(e){var a=m(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return g(this,n)}}function g(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function m(t){return m=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},m(t)}var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(a,t);var e,n,i,r=v(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this)).lastFont="",t.lastScaleX=1,t.lastScaleY=1,t}return e=a,(n=[{key:"getWidth",value:function(t,e){return window.conchTextCanvas?(window.conchTextCanvas.font=t,this.lastFont=t,window.conchTextCanvas.measureText(e).width):0}},{key:"scale",value:function(t,e){this.lastScaleX=t,this.lastScaleY=e}},{key:"getCharBmp",value:function(t,e,n,i,r,a,o,s,u,l){if(!window.conchTextCanvas)return null;window.conchTextCanvas.font=e,this.lastFont=e,a.width=window.conchTextCanvas.measureText(t).width,a.height,window.conchTextCanvas.scale&&window.conchTextCanvas.scale(this.lastScaleX,this.lastScaleY);var h=_.ColorUtils.create(r),c=h.numColor,f=_.ColorUtils.create(i),d=f.numColor,p=window.conchTextCanvas.getTextBitmapData(t,d,n>2?2:n,c);return a.bmpWidth=p.width,a.bmpHeight=p.height,p}}])&&p(e.prototype,n),i&&p(e,i),a}(f.ICharRender);e.CharRender_Native=b},35266:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.CharSubmitCache=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(18008),o=n(43989),s=n(22245),u=n(95055),l=n(12596);function h(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var c=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._data=[],this._ndata=0,this._clipid=-1,this._clipMatrix=new a.Matrix,this._enable=!1}var e,n,i;return e=t,(n=[{key:"clear",value:function(){this._tex=null,this._imgId=-1,this._ndata=0,this._enable=!1,this._colorFiler=null}},{key:"destroy",value:function(){this.clear(),this._data.length=0,this._data=null}},{key:"add",value:function(t,e,n,i,r,a){this._ndata>0&&(this._tex!=e||this._imgId!=n||this._clipid>=0&&this._clipid!=t._clipInfoID)&&this.submit(t),this._clipid=t._clipInfoID,t._globalClipMatrix.copyTo(this._clipMatrix),this._tex=e,this._imgId=n,this._colorFiler=t._colorFiler,this._data[this._ndata]=i,this._data[this._ndata+1]=r,this._data[this._ndata+2]=a,this._ndata+=3}},{key:"getPos",value:function(){return 0==t.__nPosPool?new Array(8):t.__posPool[--t.__nPosPool]}},{key:"enable",value:function(t,e){t!==this._enable&&(this._enable=t,this._enable||this.submit(e))}},{key:"submit",value:function(e){var n=this._ndata;if(n){var i=e._mesh,r=e._colorFiler;e._colorFiler=this._colorFiler;var a=u.SubmitTexture.create(e,i,s.Value2D.create(o.ShaderDefines2D.TEXTURE2D,0));e._submits[e._submits._length++]=e._curSubmit=a,a.shaderValue.textureHost=this._tex,a._key.other=this._imgId,e._colorFiler=r,e._copyClipInfo(a,this._clipMatrix),a.clipInfoID=this._clipid;for(var h=0;h<n;h+=3)i.addQuad(this._data[h],this._data[h+1],this._data[h+2],!0),t.__posPool[t.__nPosPool++]=this._data[h];n/=3,a._numEle+=6*n,i.indexNum+=6*n,i.vertNum+=4*n,e._drawCount+=n,this._ndata=0,l.RenderInfo.loopCount%100==0&&(this._data.length=0)}}}])&&h(e.prototype,n),i&&h(e,i),t}();e.CharSubmitCache=c,c.__posPool=[],c.__nPosPool=0},2656:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.ICharRender=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i};function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.fontsz=16}var e,n,i;return e=t,(n=[{key:"getWidth",value:function(t,e){return 0}},{key:"scale",value:function(t,e){}},{key:"canvasWidth",get:function(){return 0},set:function(t){}},{key:"getCharBmp",value:function(t,e,n,i,r,a,o,s,u,l){return null}}])&&a(e.prototype,n),i&&a(e,i),t}();e.ICharRender=o},69848:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.TextAtlas=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(89308),o=n(20368),s=n(92493);function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.texWidth=1024,this.texHeight=1024,this.texture=null,this.charMaps={},this.texHeight=this.texWidth=s.ILaya.TextRender.atlasWidth,this.texture=o.TextTexture.getTextTexture(this.texWidth,this.texHeight),this.texWidth/t.atlasGridW>256&&(t.atlasGridW=Math.ceil(this.texWidth/256)),this.atlasgrid=new a.AtlasGrid(this.texWidth/t.atlasGridW,this.texHeight/t.atlasGridW,this.texture.id)}var e,n,i;return e=t,(n=[{key:"setProtecteDist",value:function(t){}},{key:"getAEmpty",value:function(e,n,i){var r=this.atlasgrid.addRect(1,Math.ceil(e/t.atlasGridW),Math.ceil(n/t.atlasGridW),i);return r&&(i.x*=t.atlasGridW,i.y*=t.atlasGridW),r}},{key:"usedRate",get:function(){return this.atlasgrid._used}},{key:"destroy",value:function(){for(var t in this.charMaps)this.charMaps[t].deleted=!0;this.texture.discard()}},{key:"printDebugInfo",value:function(){}}])&&u(e.prototype,n),i&&u(e,i),t}();e.TextAtlas=l,l.atlasGridW=16},30875:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.TextRender=void 0;var i=v(n(81643)),r=v(n(78914)),a=v(n(63978)),o=n(69848),s=n(20368),u=n(85399),l=n(12596),h=n(54598),c=n(75494),f=n(80651),_=n(50078),d=n(82310),p=n(10069),y=n(92493);function v(t){return t&&t.__esModule?t:{default:t}}function g(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,a.default)(t,i.key,i)}}var m=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.fontSizeInfo={},this.mapFont={},this.fontID=0,this.fontScaleX=1,this.fontScaleY=1,this._curStrPos=0,this.textAtlases=[],this.isoTextures=[],this.lastFont=null,this.fontSizeW=0,this.fontSizeH=0,this.fontSizeOffX=0,this.fontSizeOffY=0,this.renderPerChar=!0,this.tmpAtlasPos=new u.Point,this.textureMem=0,y.ILaya.TextAtlas=o.TextAtlas;var e=!1,n=y.ILaya.Laya.MiniAdpter;n&&n.systemInfo&&n.systemInfo.system&&(e="ios 10.1.1"===n.systemInfo.system.toLowerCase()),(y.ILaya.Browser.onMiniGame||y.ILaya.Browser.onTTMiniGame||y.ILaya.Browser.onBLMiniGame||y.ILaya.Browser.onAlipayMiniGame||y.ILaya.Browser.onTBMiniGame)&&!e&&(t.isWan1Wan=!0),this.charRender=y.ILaya.Render.isConchApp?new p.CharRender_Native:new d.CharRender_Canvas(2048,2048,t.scaleFontWithCtx,!t.isWan1Wan,!1),t.textRenderInst=this,y.ILaya.Laya.textRender=this,t.atlasWidth2=t.atlasWidth*t.atlasWidth}var e,n,a;return e=t,n=[{key:"setFont",value:function(e){var n;if(this.lastFont!=e){this.lastFont=e;var r=this.getFontSizeInfo(e._family),a=r>>24,o=r>>16&255,s=r>>8&255,u=255&r,l=e._size/t.standardFontSize;this.fontSizeOffX=Math.ceil(a*l),this.fontSizeOffY=Math.ceil(o*l),this.fontSizeW=Math.ceil(s*l),this.fontSizeH=Math.ceil(u*l),(0,i.default)(n=e._font).call(n,"italic")>=0?this.fontStr=e._font.replace("italic",""):this.fontStr=e._font}}},{key:"getNextChar",value:function(t){var e=t.length,n=this._curStrPos;if(!t.substring)return null;if(n>=e)return null;for(var i=n,r=0;i<e;i++){var a=t.charCodeAt(i);if(a>>>11==27){if(1==r)break;r=1,i++}else if(65038===a||65039===a);else if(8205==a)r=2;else if(0==r)r=1;else if(1==r)break}return this._curStrPos=i,t.substring(n,i)}},{key:"filltext",value:function(t,e,n,i,r,a,o,s,u){var l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0;if(!(e.length<=0)){var h=c.FontInfo.Parse(r),f=0;switch(u){case"center":f=y.ILaya.Context.ENUM_TEXTALIGN_CENTER;break;case"right":f=y.ILaya.Context.ENUM_TEXTALIGN_RIGHT}this._fast_filltext(t,e,null,n,i,h,a,o,s,f,l)}}},{key:"fillWords",value:function(t,e,n,i,r,a,o,s){if(e&&!(e.length<=0)){var u="string"==typeof r?c.FontInfo.Parse(r):r;this._fast_filltext(t,null,e,n,i,u,a,o,s,0,0)}}},{key:"_fast_filltext",value:function(e,n,i,r,a,o,s,u,l,h){if((!n||n.length>=1)&&!(i&&i.length<1)){if(l<0&&(l=0),this.setFont(o),this.fontScaleX=this.fontScaleY=1,t.scaleFontWithCtx){var c=1,_=1;if(y.ILaya.Render.isConchApp&&!window.conchTextCanvas.scale||(c=e.getMatScaleX(),_=e.getMatScaleY()),c<1e-4||_<.1)return;c>1&&(this.fontScaleX=c),_>1&&(this.fontScaleY=_)}o._italic&&(e._italicDeg=13);var d=n,p=!i&&n instanceof f.WordText,v=n&&n.toString(),g=!!i,m=p?d.pageChars:[],b=0;switch(p?(v=d._text,(b=d.width)<0&&(b=d.width=this.charRender.getWidth(this.fontStr,v))):b=v?this.charRender.getWidth(this.fontStr,v):0,h){case y.ILaya.Context.ENUM_TEXTALIGN_CENTER:r-=b/2;break;case y.ILaya.Context.ENUM_TEXTALIGN_RIGHT:r-=b}d&&m&&this.hasFreedText(m)&&(m=d.pageChars=[]);var T=null,x=this.renderPerChar=!p||t.forceSplitRender||g||p&&d.splitRender;if(!m||m.length<1)if(p&&(d.scalex=this.fontScaleX,d.scaley=this.fontScaleY),x){var w,k=0,C=0;for(this._curStrPos=0;;){if(i){var E=i[this._curStrPos++];E?(w=E.char,k=E.x,C=E.y):w=null}else w=this.getNextChar(v);if(!w)break;if(!(T=this.getCharRenderInfo(w,o,s,u,l,!1)))break;if(T.isSpace);else{var S=m[T.tex.id];if(S)S=S.words;else{var M={texgen:T.tex.genID,tex:T.tex,words:new Array};m[T.tex.id]=M,S=M.words}S.push({ri:T,x:k,y:C,w:T.bmpWidth/this.fontScaleX,h:T.bmpHeight/this.fontScaleY}),k+=T.width}}}else{var L=y.ILaya.Render.isConchApp?0:o._size/3|0,R=t.noAtlas||(b+L+L)*this.fontScaleX>t.atlasWidth;T=this.getCharRenderInfo(v,o,s,u,l,R),m[0]={texgen:T.tex.genID,tex:T.tex,words:[{ri:T,x:0,y:0,w:T.bmpWidth/this.fontScaleX,h:T.bmpHeight/this.fontScaleY}]}}this._drawResortedWords(e,r,a,m),e._italicDeg=0}}},{key:"_drawResortedWords",value:function(t,e,n,i){var r=!!t._charSubmitCache&&t._charSubmitCache._enable,a=t._curMat;for(var o in i){var s=i[o];if(s){var u=s.words,l=u.length;if(!(l<=0))for(var h=i[o].tex,c=0;c<l;c++){var f=u[c],_=f.ri;if(!_.isSpace){if(_.touch(),t.drawTexAlign=!0,y.ILaya.Render.isConchApp)t._drawTextureM(h.texture,e+f.x-_.orix,n+f.y-_.oriy,f.w,f.h,null,1,_.uv);else{var d=h;t._inner_drawTexture(d.texture,d.id,e+f.x-_.orix,n+f.y-_.oriy,f.w,f.h,a,_.uv,1,r)}t.touches&&t.touches.push(_)}}}}}},{key:"hasFreedText",value:function(t){for(var e in t){var n=t[e];if(n){var i=n.tex;if(i.__destroyed||i.genID!=n.texgen)return!0}}return!1}},{key:"getCharRenderInfo",value:function(e,n,i,r,a){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=this.mapFont[n._family];null==u&&(this.mapFont[n._family]=u=this.fontID++);var l=e+"_"+u+"_"+n._size+"_"+i;a>0&&(l+="_"+r+a),n._bold&&(l+="P"),1==this.fontScaleX&&1==this.fontScaleY||(l+=(20*this.fontScaleX|0)+"_"+(20*this.fontScaleY|0));var h,c,f=0,d=this.textAtlases.length;if(!o)for(f=0;f<d;f++)if(h=(c=this.textAtlases[f]).charMaps[l])return h.touch(),h;h=new _.CharRenderInfo,this.charRender.scale(this.fontScaleX,this.fontScaleY),h.char=e,h.height=n._size;var p=y.ILaya.Render.isConchApp?0:n._size/3|0,v=null;a||(a=0);var g=Math.ceil((this.charRender.getWidth(this.fontStr,e)+2*a)*this.fontScaleX);if(g>this.charRender.canvasWidth&&(this.charRender.canvasWidth=Math.min(2048,g+2*p)),o){if(this.charRender.fontsz=n._size,v=this.charRender.getCharBmp(e,this.fontStr,a,i,r,h,p,p,p,p,null)){var m=s.TextTexture.getTextTexture(v.width,v.height);m.addChar(v,0,0,h.uv),h.tex=m,h.orix=p,h.oriy=p,m.ri=h,this.isoTextures.push(m)}}else{var b=e.length,T=1*a,x=Math.ceil((this.fontSizeW+2*T)*this.fontScaleX),w=Math.ceil((this.fontSizeH+2*T)*this.fontScaleY);t.imgdtRect[0]=(p-this.fontSizeOffX-T)*this.fontScaleX|0,t.imgdtRect[1]=(p-this.fontSizeOffY-T)*this.fontScaleY|0,this.renderPerChar||1==b?(t.imgdtRect[2]=Math.max(g,x),t.imgdtRect[3]=Math.max(g,w)):(t.imgdtRect[2]=-1,t.imgdtRect[3]=w),this.charRender.fontsz=n._size,(v=this.charRender.getCharBmp(e,this.fontStr,a,i,r,h,p,p,p,p,t.imgdtRect))&&(c=this.addBmpData(v,h),t.isWan1Wan?(h.orix=p,h.oriy=p):(h.orix=this.fontSizeOffX+T,h.oriy=this.fontSizeOffY+T),c.charMaps[l]=h)}return h}},{key:"addBmpData",value:function(t,e){for(var n,i=t.width,r=t.height,a=this.textAtlases.length,s=!1,u=0;u<a&&!(s=(n=this.textAtlases[u]).getAEmpty(i,r,this.tmpAtlasPos));u++);if(!s){if(n=new o.TextAtlas,this.textAtlases.push(n),!(s=n.getAEmpty(i,r,this.tmpAtlasPos)))throw"err1";this.cleanAtlases()}return s&&(n.texture.addChar(t,this.tmpAtlasPos.x,this.tmpAtlasPos.y,e.uv),e.tex=n.texture),n}},{key:"GC",value:function(){for(var e=0,n=this.textAtlases.length,i=t.destroyAtlasDt,r=0,a=l.RenderInfo.loopCount,o=-1,u=0,h=null,c=null;e<n;e++){if(h=(c=this.textAtlases[e]).texture){h.curUsedCovRate,r+=h.curUsedCovRateAtlas;var f=c.usedRate-h.curUsedCovRateAtlas;u<f&&(u=f,o=e)}a-c.texture.lastTouchTm>i&&(t.showLog&&console.log(c.texture.id),c.destroy(),this.textAtlases[e]=this.textAtlases[n-1],n--,e--,o=-1)}for(this.textAtlases.length=n,n=this.isoTextures.length,e=0;e<n;e++)a-(h=this.isoTextures[e]).lastTouchTm>t.destroyUnusedTextureDt&&(h.ri.deleted=!0,h.ri.tex=null,h.destroy(),this.isoTextures[e]=this.isoTextures[n-1],n--,e--);this.isoTextures.length=n;var _=this.textAtlases.length>1&&this.textAtlases.length-r>=2;(t.atlasWidth*t.atlasWidth*4*this.textAtlases.length>t.cleanMem||_||t.simClean)&&(t.simClean=!1,t.showLog&&console.log("清理使用率低的贴图。总使用率:",r,":",this.textAtlases.length,"最差贴图:"+o),o>=0&&((c=this.textAtlases[o]).destroy(),this.textAtlases[o]=this.textAtlases[this.textAtlases.length-1],this.textAtlases.length=this.textAtlases.length-1)),s.TextTexture.clean()}},{key:"cleanAtlases",value:function(){}},{key:"getCharBmp",value:function(t){}},{key:"checkBmpLine",value:function(t,e,n,i){this.bmpData32.buffer!=t.data.buffer&&(this.bmpData32=new Uint32Array(t.data.buffer));for(var r=t.width*e+n,a=n;a<i;a++)if(0!=this.bmpData32[r++])return!0;return!1}},{key:"updateBbx",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=t.width,r=t.height,a=0,o=e[1],s=0,u=o;if(this.checkBmpLine(t,o,0,i))for(;;){if(1+(u=(o+s)/2|0)>=o){e[1]=u;break}this.checkBmpLine(t,u,0,i)?o=u:s=u}if(e[3]>r)e[3]=r;else if(u=o=e[3],s=r,this.checkBmpLine(t,o,0,i))for(;;){if((u=(o+s)/2|0)-1<=o){e[3]=u;break}this.checkBmpLine(t,u,0,i)?o=u:s=u}if(!n){var l=e[0],h=i*e[1];for(u=e[1];u<e[3];u++){for(a=0;a<l;a++)if(0!=this.bmpData32[h+a]){l=a;break}h+=i}e[0]=l;var c=e[2];for(h=i*e[1],u=e[1];u<e[3];u++){for(a=c;a<i;a++)if(0!=this.bmpData32[h+a]){c=a;break}h+=i}e[2]=c}}},{key:"getFontSizeInfo",value:function(e){var n=this.fontSizeInfo[e];if(null!=n)return n;var i="bold "+t.standardFontSize+"px "+e;if(t.isWan1Wan){this.fontSizeW=1.5*this.charRender.getWidth(i,"有"),this.fontSizeH=1.5*t.standardFontSize;var r=this.fontSizeW<<8|this.fontSizeH;return this.fontSizeInfo[e]=r,r}t.pixelBBX[0]=t.standardFontSize/2,t.pixelBBX[1]=t.standardFontSize/2,t.pixelBBX[2]=t.standardFontSize,t.pixelBBX[3]=t.standardFontSize;var a=16,o=16;this.charRender.scale(1,1),t.tmpRI.height=t.standardFontSize,this.charRender.fontsz=t.standardFontSize;var s=this.charRender.getCharBmp("g",i,0,"red",null,t.tmpRI,a,o,16,16);y.ILaya.Render.isConchApp&&(s.data=new Uint8ClampedArray(s.data)),this.bmpData32=new Uint32Array(s.data.buffer),this.updateBbx(s,t.pixelBBX,!1),s=this.charRender.getCharBmp("有",i,0,"red",null,t.tmpRI,o,o,16,16),y.ILaya.Render.isConchApp&&(s.data=new Uint8ClampedArray(s.data)),this.bmpData32=new Uint32Array(s.data.buffer),t.pixelBBX[2]<a+t.tmpRI.width&&(t.pixelBBX[2]=a+t.tmpRI.width),this.updateBbx(s,t.pixelBBX,!1),y.ILaya.Render.isConchApp&&(a=0,o=0);var u=Math.max(a-t.pixelBBX[0],0)<<24|Math.max(o-t.pixelBBX[1],0)<<16|t.pixelBBX[2]-t.pixelBBX[0]<<8|t.pixelBBX[3]-t.pixelBBX[1];return this.fontSizeInfo[e]=u,u}},{key:"printDbgInfo",value:function(){var e,n;for(var i in console.log("图集个数:"+this.textAtlases.length+",每个图集大小:"+t.atlasWidth+"x"+t.atlasWidth," 用canvas:",t.isWan1Wan),console.log("图集占用空间:"+t.atlasWidth*t.atlasWidth*4/1024/1024*this.textAtlases.length+"M"),console.log("缓存用到的字体:"),this.mapFont){var a=this.getFontSizeInfo(i),o=a>>24,s=a>>16&255,u=a>>8&255,h=255&a;console.log("    "+i," off:",o,s," size:",u,h)}var c=0;console.log("缓存数据:");var f=0,_=0;(0,r.default)(e=this.textAtlases).call(e,(function(e){var n=e.texture.id,i=l.RenderInfo.loopCount-e.texture.lastTouchTm,r=i>0?i+"帧以前":"当前帧";for(var a in f+=e.texture.curUsedCovRate,_+=e.texture.curUsedCovRateAtlas,console.log("--图集(id:"+n+",当前使用率:"+(1e3*e.texture.curUsedCovRate|0)+"‰","当前图集使用率:",(100*e.texture.curUsedCovRateAtlas|0)+"%","图集使用率:",100*e.usedRate|0,"%, 使用于:"+r+")--:"),e.charMaps){var o=e.charMaps[a];console.log("     off:",o.orix,o.oriy," bmp宽高:",o.bmpWidth,o.bmpHeight,"无效:",o.deleted,"touchdt:",l.RenderInfo.loopCount-o.touchTick,"位置:",o.uv[0]*t.atlasWidth|0,o.uv[1]*t.atlasWidth|0,"字符:",o.char,"key:",a),c++}})),console.log("独立贴图文字("+this.isoTextures.length+"个):"),(0,r.default)(n=this.isoTextures).call(n,(function(t){console.log("    size:",t._texW,t._texH,"touch间隔:",l.RenderInfo.loopCount-t.lastTouchTm,"char:",t.ri.char)})),console.log("总缓存:",c,"总使用率:",f,"总当前图集使用率:",_)}},{key:"showAtlas",value:function(e,n,i,r,a,o){if(!this.textAtlases[e])return console.log("没有这个图集"),null;var s=new y.ILaya.Sprite,u=this.textAtlases[e].texture,l={width:t.atlasWidth,height:t.atlasWidth,sourceWidth:t.atlasWidth,sourceHeight:t.atlasWidth,offsetX:0,offsetY:0,getIsReady:function(){return!0},_addReference:function(){},_removeReference:function(){},_getSource:function(){return u._getSource()},bitmap:{id:u.id},_uv:h.Texture.DEF_UV};return s.size=function(t,e){return this.width=t,this.height=e,s.graphics.clear(),s.graphics.drawRect(0,0,s.width,s.height,n),s.graphics.drawTexture(l,0,0,s.width,s.height),this},s.graphics.drawRect(0,0,a,o,n),s.graphics.drawTexture(l,0,0,a,o),s.pos(i,r),y.ILaya.stage.addChild(s),s}},{key:"filltext_native",value:function(t,e,n,i,r,a,o,s,u,l){var h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0;if(!(e&&e.length<=0||n&&n.length<1)){var f=c.FontInfo.Parse(a),_=0;switch(l){case"center":_=y.ILaya.Context.ENUM_TEXTALIGN_CENTER;break;case"right":_=y.ILaya.Context.ENUM_TEXTALIGN_RIGHT}return this._fast_filltext(t,e,n,i,r,f,o,s,u,_,h)}}}],n&&g(e.prototype,n),a&&g(e,a),t}();e.TextRender=m,m.useOldCharBook=!1,m.atlasWidth=1024,m.noAtlas=!1,m.forceSplitRender=!1,m.forceWholeRender=!1,m.scaleFontWithCtx=!0,m.standardFontSize=32,m.destroyAtlasDt=10,m.checkCleanTextureDt=2e3,m.destroyUnusedTextureDt=3e3,m.cleanMem=104857600,m.isWan1Wan=!1,m.showLog=!1,m.debugUV=!1,m.tmpRI=new _.CharRenderInfo,m.pixelBBX=[0,0,0,0],m.imgdtRect=[0,0,0,0],m.simClean=!1,s.TextTexture.gTextRender=m},20368:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.TextTexture=void 0;var h=g(n(44494)),c=(g(n(77766)),g(n(85507))),f=g(n(21611)),_=n(33873),d=n(12596),p=n(25883),y=n(61266),v=n(92493);function g(t){return t&&t.__esModule?t:{default:t}}function m(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function b(t,e){return b=a||function(t,e){return t.__proto__=e,t},b(t,e)}function T(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=w(t);if(e){var a=w(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return x(this,n)}}function x(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function w(t){return w=c.default?f.default:function(t){return t.__proto__||(0,f.default)(t)},w(t)}var k=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&b(t,e)}(a,t);var e,n,i,r=T(a);function a(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(n=r.call(this))._texW=0,n._texH=0,n.__destroyed=!1,n._discardTm=0,n.genID=0,n.bitmap={id:0,_glTexture:null},n.curUsedCovRate=0,n.curUsedCovRateAtlas=0,n.lastTouchTm=0,n.ri=null,n._texW=t||a.gTextRender.atlasWidth,n._texH=e||a.gTextRender.atlasWidth,n.bitmap.id=n.id,n.lock=!0,n}return e=a,n=[{key:"recreateResource",value:function(){if(!this._source){var t=_.LayaGL.instance,e=this._source=t.createTexture();this.bitmap._glTexture=e,y.WebGLContext.bindTexture(t,t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this._texW,this._texH,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),a.gTextRender.debugUV&&this.fillWhite()}}},{key:"addChar",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(a.gTextRender.isWan1Wan)return this.addCharCanvas(t,e,n,i);!this._source&&this.recreateResource();var r=_.LayaGL.instance;y.WebGLContext.bindTexture(r,r.TEXTURE_2D,this._source),!v.ILaya.Render.isConchApp&&r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);var o,s,u,l,h=t.data;return t.data instanceof Uint8ClampedArray&&(h=new Uint8Array(h.buffer)),r.texSubImage2D(r.TEXTURE_2D,0,e,n,t.width,t.height,r.RGBA,r.UNSIGNED_BYTE,h),!v.ILaya.Render.isConchApp&&r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),o=e/this._texW,s=n/this._texH,u=(e+t.width)/this._texW,l=(n+t.height)/this._texH,(i=i||new Array(8))[0]=o,i[1]=s,i[2]=u,i[3]=s,i[4]=u,i[5]=l,i[6]=o,i[7]=l,i}},{key:"addCharCanvas",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;!this._source&&this.recreateResource();var r,a,o,s,u=_.LayaGL.instance;return y.WebGLContext.bindTexture(u,u.TEXTURE_2D,this._source),!v.ILaya.Render.isConchApp&&u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),u.texSubImage2D(u.TEXTURE_2D,0,e,n,u.RGBA,u.UNSIGNED_BYTE,t),!v.ILaya.Render.isConchApp&&u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),v.ILaya.Render.isConchApp?(r=e/this._texW,a=n/this._texH,o=(e+t.width)/this._texW,s=(n+t.height)/this._texH):(r=(e+1)/this._texW,a=(n+1)/this._texH,o=(e+t.width-1)/this._texW,s=(n+t.height-1)/this._texH),(i=i||new Array(8))[0]=r,i[1]=a,i[2]=o,i[3]=a,i[4]=o,i[5]=s,i[6]=r,i[7]=s,i}},{key:"fillWhite",value:function(){!this._source&&this.recreateResource();var t=_.LayaGL.instance,e=new Uint8Array(this._texW*this._texH*4);(0,h.default)(e).call(e,255),t.texSubImage2D(t.TEXTURE_2D,0,0,0,this._texW,this._texH,t.RGBA,t.UNSIGNED_BYTE,e)}},{key:"discard",value:function(){v.ILaya.stage.setGlobalRepaint(),this.destroy()}},{key:"destroy",value:function(){this.__destroyed=!0;var t=_.LayaGL.instance;this._source&&t.deleteTexture(this._source),this._source=null}},{key:"touchRect",value:function(t,e){this.lastTouchTm!=e&&(this.curUsedCovRate=0,this.curUsedCovRateAtlas=0,this.lastTouchTm=e);var n=a.gTextRender.atlasWidth*a.gTextRender.atlasWidth,i=v.ILaya.TextAtlas.atlasGridW*v.ILaya.TextAtlas.atlasGridW;this.curUsedCovRate+=t.bmpWidth*t.bmpHeight/n,this.curUsedCovRateAtlas+=Math.ceil(t.bmpWidth/v.ILaya.TextAtlas.atlasGridW)*Math.ceil(t.bmpHeight/v.ILaya.TextAtlas.atlasGridW)/(n/i)}},{key:"texture",get:function(){return this}},{key:"_getSource",value:function(){return this._source}},{key:"drawOnScreen",value:function(t,e){}}],i=[{key:"getTextTexture",value:function(t,e){return new a(t,e)}},{key:"clean",value:function(){var t=d.RenderInfo.loopStTm;if(0===a.cleanTm&&(a.cleanTm=t),t-a.cleanTm>=a.gTextRender.checkCleanTextureDt){for(var e=0;e<a.poolLen;e++){var n=a.pool[e];t-n._discardTm>=a.gTextRender.destroyUnusedTextureDt&&(n.destroy(),a.pool[e]=a.pool[a.poolLen-1],a.poolLen--,e--)}a.cleanTm=t}}}],n&&m(e.prototype,n),i&&m(e,i),a}(p.Resource);e.TextTexture=k,k.gTextRender=null,k.pool=new Array(10),k.poolLen=0,k.cleanTm=0},56758:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Buffer=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(33873);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._byteLength=0,this._glBuffer=a.LayaGL.instance.createBuffer()}var e,n,i;return e=t,(n=[{key:"bufferUsage",get:function(){return this._bufferUsage}},{key:"_bindForVAO",value:function(){}},{key:"bind",value:function(){return!1}},{key:"destroy",value:function(){this._glBuffer&&(a.LayaGL.instance.deleteBuffer(this._glBuffer),this._glBuffer=null)}}])&&o(e.prototype,n),i&&o(e,i),t}();e.Buffer=s},15323:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.Buffer2D=void 0;var h=g(n(3649)),c=g(n(54103)),f=g(n(85507)),_=g(n(21611)),d=n(33873),p=n(12596),y=n(20541),v=n(56758);function g(t){return t&&t.__esModule?t:{default:t}}function m(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function b(t,e){return b=a||function(t,e){return t.__proto__=e,t},b(t,e)}function T(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=w(t);if(e){var a=w(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return x(this,n)}}function x(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function w(t){return w=f.default?_.default:function(t){return t.__proto__||(0,_.default)(t)},w(t)}var k=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&b(t,e)}(a,t);var e,n,i,r=T(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this))._maxsize=0,t._upload=!0,t._uploadSize=0,t._bufferSize=0,t._u8Array=null,t}return e=a,n=[{key:"bufferLength",get:function(){return this._buffer.byteLength}},{key:"byteLength",set:function(t){this.setByteLength(t)}},{key:"setByteLength",value:function(t){this._byteLength!==t&&(t<=this._bufferSize||this._resizeBuffer(2*t+256,!0),this._byteLength=t)}},{key:"needSize",value:function(t){var e=this._byteLength;if(t){var n=this._byteLength+t;n<=this._bufferSize||this._resizeBuffer(n<<1,!0),this._byteLength=n}return e}},{key:"_bufferData",value:function(){var t;(this._maxsize=Math.max(this._maxsize,this._byteLength),p.RenderInfo.loopCount%30==0)&&(this._buffer.byteLength>this._maxsize+64&&(this._buffer=(0,h.default)(t=this._buffer).call(t,0,this._maxsize+64),this._bufferSize=this._buffer.byteLength,this._checkArrayUse()),this._maxsize=this._byteLength);this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,d.LayaGL.instance.bufferData(this._bufferType,this._uploadSize,this._bufferUsage)),d.LayaGL.instance.bufferSubData(this._bufferType,0,new Uint8Array(this._buffer,0,this._byteLength))}},{key:"_bufferSubData",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(this._maxsize=Math.max(this._maxsize,this._byteLength),p.RenderInfo.loopCount%30==0)&&(this._buffer.byteLength>this._maxsize+64&&(this._buffer=(0,h.default)(t=this._buffer).call(t,0,this._maxsize+64),this._bufferSize=this._buffer.byteLength,this._checkArrayUse()),this._maxsize=this._byteLength);if(this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,d.LayaGL.instance.bufferData(this._bufferType,this._uploadSize,this._bufferUsage)),n||i){var r,a=(0,h.default)(r=this._buffer).call(r,n,i);d.LayaGL.instance.bufferSubData(this._bufferType,e,a)}else d.LayaGL.instance.bufferSubData(this._bufferType,e,this._buffer)}},{key:"_checkArrayUse",value:function(){}},{key:"_bind_uploadForVAO",value:function(){return!!this._upload&&(this._upload=!1,this._bindForVAO(),this._bufferData(),!0)}},{key:"_bind_upload",value:function(){return!!this._upload&&(this._upload=!1,(0,c.default)(this).call(this),this._bufferData(),!0)}},{key:"_bind_subUpload",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return!!this._upload&&(this._upload=!1,(0,c.default)(t=this).call(t),this._bufferSubData(e,n,i),!0)}},{key:"_resizeBuffer",value:function(t,e){var n=this._buffer;if(t<=n.byteLength)return this;var i=this._u8Array;if(e&&n&&n.byteLength>0){var r=new ArrayBuffer(t),a=i&&i.buffer==n?i:new Uint8Array(n);(i=this._u8Array=new Uint8Array(r)).set(a,0),n=this._buffer=r}else n=this._buffer=new ArrayBuffer(t),this._u8Array=null;return this._checkArrayUse(),this._upload=!0,this._bufferSize=n.byteLength,this}},{key:"append",value:function(t){var e,n;this._upload=!0,e=t.byteLength,t instanceof Uint8Array?(this._resizeBuffer(this._byteLength+e,!0),n=new Uint8Array(this._buffer,this._byteLength)):t instanceof Uint16Array?(this._resizeBuffer(this._byteLength+e,!0),n=new Uint16Array(this._buffer,this._byteLength)):t instanceof Float32Array&&(this._resizeBuffer(this._byteLength+e,!0),n=new Float32Array(this._buffer,this._byteLength)),n.set(t,0),this._byteLength+=e,this._checkArrayUse()}},{key:"appendU16Array",value:function(t,e){this._resizeBuffer(this._byteLength+2*e,!0);var n=new Uint16Array(this._buffer,this._byteLength,e);if(6==e)n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5];else if(e>=100)n.set(new Uint16Array(t.buffer,0,e));else for(var i=0;i<e;i++)n[i]=t[i];this._byteLength+=2*e,this._checkArrayUse()}},{key:"appendEx",value:function(t,e){var n;this._upload=!0,n=t.byteLength,this._resizeBuffer(this._byteLength+n,!0),new e(this._buffer,this._byteLength).set(t,0),this._byteLength+=n,this._checkArrayUse()}},{key:"appendEx2",value:function(t,e,n){var i,r,a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;for(this._upload=!0,i=n*o,this._resizeBuffer(this._byteLength+i,!0),r=new e(this._buffer,this._byteLength),a=0;a<n;a++)r[a]=t[a];this._byteLength+=i,this._checkArrayUse()}},{key:"getBuffer",value:function(){return this._buffer}},{key:"setNeedUpload",value:function(){this._upload=!0}},{key:"getNeedUpload",value:function(){return this._upload}},{key:"upload",value:function(){var t=d.LayaGL.instance,e=this._bind_upload();return t.bindBuffer(this._bufferType,null),this._bufferType==t.ARRAY_BUFFER&&(v.Buffer._bindedVertexBuffer=null),this._bufferType==t.ELEMENT_ARRAY_BUFFER&&(v.Buffer._bindedIndexBuffer=null),y.BaseShader.activeShader=null,e}},{key:"subUpload",value:function(){var t=d.LayaGL.instance,e=this._bind_subUpload();return t.bindBuffer(this._bufferType,null),this._bufferType==t.ARRAY_BUFFER&&(v.Buffer._bindedVertexBuffer=null),this._bufferType==t.ELEMENT_ARRAY_BUFFER&&(v.Buffer._bindedIndexBuffer=null),y.BaseShader.activeShader=null,e}},{key:"_disposeResource",value:function(){this._upload=!0,this._uploadSize=0}},{key:"clear",value:function(){this._byteLength=0,this._upload=!0}}],i=[{key:"__int__",value:function(t){}}],n&&m(e.prototype,n),i&&m(e,i),a}(v.Buffer);e.Buffer2D=k,k.FLOAT32=4,k.SHORT=2},70053:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.CONST3D2D=void 0;var i=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)};e.CONST3D2D=i,i.BYTES_PE=4,i.BYTES_PIDX=2,i.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],i.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],i._TMPARRAY=[],i._OFFSETX=0,i._OFFSETY=0},86152:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.IndexBuffer2D=void 0;var h=d(n(85507)),c=d(n(21611)),f=n(33873),_=n(56758);function d(t){return t&&t.__esModule?t:{default:t}}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function v(t,e){return v=a||function(t,e){return t.__proto__=e,t},v(t,e)}function g(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b(t);if(e){var a=b(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return m(this,n)}}function m(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function b(t){return b=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},b(t)}var T=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(a,t);var e,n,i,r=g(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:35044;return p(this,a),(t=r.call(this))._bufferUsage=e,t._bufferType=f.LayaGL.instance.ELEMENT_ARRAY_BUFFER,t._buffer=new ArrayBuffer(8),t}return e=a,(n=[{key:"_checkArrayUse",value:function(){this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))}},{key:"getUint16Array",value:function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))}},{key:"_bindForVAO",value:function(){var t=f.LayaGL.instance;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._glBuffer)}},{key:"bind",value:function(){if(_.Buffer._bindedIndexBuffer!==this._glBuffer){var t=f.LayaGL.instance;return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._glBuffer),_.Buffer._bindedIndexBuffer=this._glBuffer,!0}return!1}},{key:"destory",value:function(){this._uint16Array=null,this._buffer=null}},{key:"disposeResource",value:function(){this._disposeResource()}}])&&y(e.prototype,n),i&&y(e,i),a}(n(15323).Buffer2D);e.IndexBuffer2D=T,T.create=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:35044;return new T(t)}},14224:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.InlcudeFile=void 0;var i=o(n(81643)),r=o(n(63978)),a=n(92493);function o(t){return t&&t.__esModule?t:{default:t}}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=e;for(var n,r,o=0;!((o=(0,i.default)(e).call(e,"#begin",o))<0);){for(r=o+5;!((r=(0,i.default)(e).call(e,"#end",r))<0)&&"i"===e.charAt(r+4);)r+=5;if(r<0)throw"add include err,no #end:"+e;n=(0,i.default)(e).call(e,"\n",o);var s=a.ILaya.ShaderCompile.splitToWords(e.substr(o,n-o),null);"code"==s[1]?this.codes[s[2]]=e.substr(n+1,r-n-1):"function"==s[1]&&(n=(0,i.default)(e).call(e,"function",o),n+="function".length,this.funs[s[3]]=e.substr(n+1,r-n-1),this.funnames+=s[3]+";"),o=r+1}}var e,n,r;return e=t,n=[{key:"getWith",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=t?this.codes[t]:this.script;if(!e)throw"get with error:"+t;return e}},{key:"getFunsScript",value:function(t){var e="";for(var n in this.funs)(0,i.default)(t).call(t,n+";")>=0&&(e+=this.funs[n]);return e}}],n&&s(e.prototype,n),r&&s(e,r),t}();e.InlcudeFile=u},14398:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.Mesh2D=void 0;var i=h(n(54103)),r=h(n(63978)),a=n(33873),o=n(32488),s=n(80340),u=n(86152),l=n(53778);function h(t){return t&&t.__esModule?t:{default:t}}function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var f=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._quadNum=0,this.canReuse=!1,this._stride=e,this._vb=new l.VertexBuffer2D(e,a.LayaGL.instance.DYNAMIC_DRAW),n?this._vb._resizeBuffer(n,!1):s.Config.webGL2D_MeshAllocMaxMem&&this._vb._resizeBuffer(65536*e,!1),this._ib=new u.IndexBuffer2D,i&&this._ib._resizeBuffer(i,!1)}var e,n,r;return e=t,(n=[{key:"cloneWithNewVB",value:function(){var e=new t(this._stride,0,0);return e._ib=this._ib,e._quadNum=this._quadNum,e._attribInfo=this._attribInfo,e}},{key:"cloneWithNewVBIB",value:function(){var e=new t(this._stride,0,0);return e._attribInfo=this._attribInfo,e}},{key:"getVBW",value:function(){return this._vb.setNeedUpload(),this._vb}},{key:"getVBR",value:function(){return this._vb}},{key:"getIBR",value:function(){return this._ib}},{key:"getIBW",value:function(){return this._ib.setNeedUpload(),this._ib}},{key:"createQuadIB",value:function(t){this._quadNum=t,this._ib._resizeBuffer(6*t*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var e=this._ib.getUint16Array(),n=0,i=0,r=0;r<t;r++)e[n++]=i,e[n++]=i+2,e[n++]=i+1,e[n++]=i,e[n++]=i+3,e[n++]=i+2,i+=4;this._ib.setNeedUpload()}},{key:"setAttributes",value:function(t){if(this._attribInfo=t,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"}},{key:"configVAO",value:function(t){var e;if(!this._applied){this._applied=!0,this._vao||(this._vao=new o.BufferState2D),(0,i.default)(e=this._vao).call(e),this._vb._bindForVAO(),this._ib.setNeedUpload(),this._ib._bind_uploadForVAO();for(var n=this._attribInfo.length/3,r=0,a=0;a<n;a++){var s=this._attribInfo[r+1],u=this._attribInfo[r],l=this._attribInfo[r+2];t.enableVertexAttribArray(a),t.vertexAttribPointer(a,s,u,!1,this._stride,l),r+=3}this._vao.unBind()}}},{key:"useMesh",value:function(t){var e,n,r,a;this._applied||this.configVAO(t),(0,i.default)(e=this._vao).call(e),(0,i.default)(n=this._vb).call(n),this._ib._bind_upload()||(0,i.default)(r=this._ib).call(r),this._vb._bind_upload()||(0,i.default)(a=this._vb).call(a)}},{key:"getEleNum",value:function(){return this._ib.getBuffer().byteLength/2}},{key:"releaseMesh",value:function(){}},{key:"destroy",value:function(){}},{key:"clearVB",value:function(){this._vb.clear()}}])&&c(e.prototype,n),r&&c(e,r),t}();e.Mesh2D=f,f._gvaoid=0},34415:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.MeshParticle2D=void 0;var h=d(n(85507)),c=d(n(21611)),f=n(14398),_=n(33873);function d(t){return t&&t.__esModule?t:{default:t}}function p(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function y(t,e){return y=a||function(t,e){return t.__proto__=e,t},y(t,e)}function v(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=m(t);if(e){var a=m(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return g(this,n)}}function g(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function m(t){return m=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},m(t)}var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(a,t);var e,n,i,r=v(a);function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=r.call(this,a.const_stride,4*t*a.const_stride,4)).canReuse=!0,e.setAttributes(a._fixattriInfo),e.createQuadIB(t),e._quadNum=t,e}return e=a,i=[{key:"__init__",value:function(){var t=_.LayaGL.instance;a._fixattriInfo=[t.FLOAT,4,0,t.FLOAT,3,16,t.FLOAT,3,28,t.FLOAT,4,40,t.FLOAT,4,56,t.FLOAT,3,72,t.FLOAT,2,84,t.FLOAT,4,92,t.FLOAT,1,108,t.FLOAT,1,112]}},{key:"getAMesh",value:function(t){if(a._POOL.length){var e=a._POOL.pop();return e.setMaxParticleNum(t),e}return new a(t)}}],(n=[{key:"setMaxParticleNum",value:function(t){this._vb._resizeBuffer(4*t*a.const_stride,!1),this.createQuadIB(t)}},{key:"releaseMesh",value:function(){this._vb.setByteLength(0),this.vertNum=0,this.indexNum=0,a._POOL.push(this)}},{key:"destroy",value:function(){this._ib.destroy(),this._vb.destroy(),this._vb.deleteBuffer()}}])&&p(e.prototype,n),i&&p(e,i),a}(f.Mesh2D);e.MeshParticle2D=b,b.const_stride=116,b._POOL=[]},94286:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.MeshQuadTexture=void 0;var h=f(n(85507)),c=f(n(21611));function f(t){return t&&t.__esModule?t:{default:t}}function _(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function d(t,e){return d=a||function(t,e){return t.__proto__=e,t},d(t,e)}function p(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=v(t);if(e){var a=v(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}function y(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function v(t){return v=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},v(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(a,t);var e,n,i,r=p(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,a.const_stride,4,4)).canReuse=!0,t.setAttributes(a._fixattriInfo),a._fixib?(t._ib=a._fixib,t._quadNum=a._maxIB):(t.createQuadIB(a._maxIB),a._fixib=t._ib),t}return e=a,i=[{key:"__int__",value:function(){a._fixattriInfo=[5126,4,0,5121,4,16,5121,4,20]}},{key:"getAMesh",value:function(t){var e=null;return e=a._POOL.length?a._POOL.pop():new a,t&&e._vb._resizeBuffer(65536*a.const_stride,!1),e}}],(n=[{key:"releaseMesh",value:function(){this._vb.setByteLength(0),this.vertNum=0,this.indexNum=0,a._POOL.push(this)}},{key:"destroy",value:function(){this._vb.destroy(),this._vb.deleteBuffer()}},{key:"addQuad",value:function(t,e,n,i){var r=this._vb,o=r._byteLength>>2;r.setByteLength(o+a.const_stride<<2);var s=r._floatArray32||r.getFloat32Array(),u=r._uint32Array,l=o,h=i?255:0;s[l++]=t[0],s[l++]=t[1],s[l++]=e[0],s[l++]=e[1],u[l++]=n,u[l++]=h,s[l++]=t[2],s[l++]=t[3],s[l++]=e[2],s[l++]=e[3],u[l++]=n,u[l++]=h,s[l++]=t[4],s[l++]=t[5],s[l++]=e[4],s[l++]=e[5],u[l++]=n,u[l++]=h,s[l++]=t[6],s[l++]=t[7],s[l++]=e[6],s[l++]=e[7],u[l++]=n,u[l++]=h,r._upload=!0}}])&&_(e.prototype,n),i&&_(e,i),a}(n(14398).Mesh2D);e.MeshQuadTexture=g,g.const_stride=24,g._maxIB=16384,g._POOL=[]},30966:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.MeshTexture=void 0;var h=_(n(85507)),c=_(n(21611)),f=n(33873);function _(t){return t&&t.__esModule?t:{default:t}}function d(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function p(t,e){return p=a||function(t,e){return t.__proto__=e,t},p(t,e)}function y(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=g(t);if(e){var a=g(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return v(this,n)}}function v(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function g(t){return g=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},g(t)}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(a,t);var e,n,i,r=y(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,a.const_stride,4,4)).canReuse=!0,t.setAttributes(a._fixattriInfo),t}return e=a,i=[{key:"__init__",value:function(){f.LayaGL.instance,a._fixattriInfo=[5126,4,0,5121,4,16,5121,4,20]}},{key:"getAMesh",value:function(t){var e;return e=a._POOL.length?a._POOL.pop():new a,t&&e._vb._resizeBuffer(65536*a.const_stride,!1),e}}],(n=[{key:"addData",value:function(t,e,n,i,r){var o=this._vb,s=this._ib,u=t.length>>1,l=o.needSize(u*a.const_stride)>>2,h=o._floatArray32||o.getFloat32Array(),c=o._uint32Array,f=0,_=i.a,d=i.b,p=i.c,y=i.d,v=i.tx,g=i.ty,m=0;for(m=0;m<u;m++){var b=t[f],T=t[f+1];h[l]=b*_+T*p+v,h[l+1]=b*d+T*y+g,h[l+2]=e[f],h[l+3]=e[f+1],c[l+4]=r,c[l+5]=255,l+=6,f+=2}o.setNeedUpload();var x=this.vertNum,w=n.length,k=s.needSize(n.byteLength),C=s.getUint16Array(),E=k>>1;if(x>0){var S=E+w,M=0;for(m=E;m<S;m++,M++)C[m]=n[M]+x}else C.set(n,E);s.setNeedUpload(),this.vertNum+=u,this.indexNum+=n.length}},{key:"releaseMesh",value:function(){this._vb.setByteLength(0),this._ib.setByteLength(0),this.vertNum=0,this.indexNum=0,a._POOL.push(this)}},{key:"destroy",value:function(){this._ib.destroy(),this._vb.destroy(),this._ib.disposeResource(),this._vb.deleteBuffer()}}])&&d(e.prototype,n),i&&d(e,i),a}(n(14398).Mesh2D);e.MeshTexture=m,m.const_stride=24,m._POOL=[]},86044:function(t,e,n){"use strict";function i(t){return i="function"==typeof u&&"symbol"==typeof l?function(t){return typeof t}:function(t){return t&&"function"==typeof u&&t.constructor===u&&t!==u.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(63978),u=n(65420),l=n(98341);s(e,"__esModule",{value:!0}),e.MeshVG=void 0;var h=_(n(85507)),c=_(n(21611)),f=n(33873);function _(t){return t&&t.__esModule?t:{default:t}}function d(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),s(t,i.key,i)}}function p(t,e){return p=a||function(t,e){return t.__proto__=e,t},p(t,e)}function y(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=g(t);if(e){var a=g(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return v(this,n)}}function v(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function g(t){return g=h.default?c.default:function(t){return t.__proto__||(0,c.default)(t)},g(t)}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(a,t);var e,n,i,r=y(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,a.const_stride,4,4)).canReuse=!0,t.setAttributes(a._fixattriInfo),t}return e=a,i=[{key:"__init__",value:function(){f.LayaGL.instance,a._fixattriInfo=[5126,2,0,5121,4,8]}},{key:"getAMesh",value:function(t){var e;return e=a._POOL.length?a._POOL.pop():new a,t&&e._vb._resizeBuffer(65536*a.const_stride,!1),e}}],(n=[{key:"addVertAndIBToMesh",value:function(t,e,n,i){for(var r=this._vb.needSize(e.length/2*a.const_stride)>>2,o=this._vb._floatArray32||this._vb.getFloat32Array(),s=this._vb._uint32Array,u=0,l=e.length/2,h=0;h<l;h++)o[r++]=e[u],o[r++]=e[u+1],u+=2,s[r++]=n;this._vb.setNeedUpload(),this._ib.append(new Uint16Array(i)),this._ib.setNeedUpload(),this.vertNum+=l,this.indexNum+=i.length}},{key:"releaseMesh",value:function(){this._vb.setByteLength(0),this._ib.setByteLength(0),this.vertNum=0,this.indexNum=0,a._POOL.push(this)}},{key:"destroy",value:function(){this._ib.destroy(),this._vb.destroy(),this._ib.disposeResource(),this._vb.deleteBuffer()}}])&&d(e.prototype,n),i&&d(e,i),a}(n(14398).Mesh2D);e.MeshVG=m,m.const_stride=12,m._POOL=[]},56161:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.RenderState2D=void 0;var i,r=(i=n(63978))&&i.__esModule?i:{default:i},a=n(18008);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"mat2MatArray",value:function(e,n){var i=e,r=n;return r[0]=i.a,r[1]=i.b,r[2]=t.EMPTYMAT4_ARRAY[2],r[3]=t.EMPTYMAT4_ARRAY[3],r[4]=i.c,r[5]=i.d,r[6]=t.EMPTYMAT4_ARRAY[6],r[7]=t.EMPTYMAT4_ARRAY[7],r[8]=t.EMPTYMAT4_ARRAY[8],r[9]=t.EMPTYMAT4_ARRAY[9],r[10]=t.EMPTYMAT4_ARRAY[10],r[11]=t.EMPTYMAT4_ARRAY[11],r[12]=i.tx,r[13]=i.ty,r[14]=t.EMPTYMAT4_ARRAY[14],r[15]=t.EMPTYMAT4_ARRAY[15],n}},{key:"restoreTempArray",value:function(){t.TEMPMAT4_ARRAY[0]=1,t.TEMPMAT4_ARRAY[1]=0,t.TEMPMAT4_ARRAY[4]=0,t.TEMPMAT4_ARRAY[5]=1,t.TEMPMAT4_ARRAY[12]=0,t.TEMPMAT4_ARRAY[13]=0}},{key:"clear",value:function(){t.worldScissorTest=!1,t.worldAlpha=1}}],(n=null)&&o(e.prototype,n),i&&o(e,i),t}();e.RenderState2D=s,s._MAXSIZE=99999999,s.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s.worldMatrix4=s.TEMPMAT4_ARRAY,s.worldMatrix=new a.Matrix,s.matWVP=null,s.worldAlpha=1,s.worldScissorTest=!1,s.width=0,s.height=0},97441:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.ShaderCompile=void 0;var i=f(n(11128)),r=f(n(81643)),a=f(n(78580)),o=f(n(94198)),s=f(n(63978)),u=n(33873),l=n(17),h=n(14224),c=n(1648);function f(t){return t&&t.__esModule?t:{default:t}}function _(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,s.default)(t,i.key,i)}}var d=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.defs={};var a=this;function o(e){e=e.replace(t._clearCR,"");var n=[],i=new c.ShaderNode(n);return a._compileToTree(i,e.split("\n"),0,n,a.defs),i}var s=(0,i.default)();this._VS=o(e),this._PS=o(n),this._nameMap=r,(0,i.default)()-s>2&&console.log("ShaderCompile use time:"+((0,i.default)()-s)+"  size:"+e.length+"/"+n.length)}var e,n,s;return e=t,s=[{key:"__init__",value:function(){var e=u.LayaGL.instance;t.shaderParamsMap={float:e.FLOAT,int:e.INT,bool:e.BOOL,vec2:e.FLOAT_VEC2,vec3:e.FLOAT_VEC3,vec4:e.FLOAT_VEC4,ivec2:e.INT_VEC2,ivec3:e.INT_VEC3,ivec4:e.INT_VEC4,bvec2:e.BOOL_VEC2,bvec3:e.BOOL_VEC3,bvec4:e.BOOL_VEC4,mat2:e.FLOAT_MAT2,mat3:e.FLOAT_MAT3,mat4:e.FLOAT_MAT4,sampler2D:e.SAMPLER_2D,samplerCube:e.SAMPLER_CUBE}}},{key:"_parseOne",value:function(e,n,i,r,a,s){var u={type:t.shaderParamsMap[i[r+1]],name:i[r+2],size:isNaN((0,o.default)(i[r+3]))?1:(0,o.default)(i[r+3])};return s&&("attribute"==a?e.push(u):n.push(u)),":"==i[r+3]&&(u.type=i[r+4],r+=2),r+=2}},{key:"addInclude",value:function(e,n){if(!n||0===n.length)throw new Error("add shader include file err:"+e);if((0,a.default)(t)[e])throw new Error("add shader include file err, has add:"+e);(0,a.default)(t)[e]=new h.InlcudeFile(n)}},{key:"preGetParams",value:function(e,n){var i,r,a=[e,n],o={},s=[],u=[],l={},h={};o.attributes=s,o.uniforms=u,o.defines=l;for(var c=0;c<2;c++){a[c]=a[c].replace(t._removeAnnotation,"");var f,_=a[c].match(t._reg);for(i=0,r=_.length;i<r;i++){var d=_[i];if("attribute"==d||"uniform"==d)i=t._parseOne(s,u,_,i,d,!0);else{if("#define"==d){h[d=_[++i]]=1;continue}if("#ifdef"==d)for(l[f=_[++i]]=l[f]||[],i++;i<r;i++)if("attribute"==(d=_[i])||"uniform"==d)i=t._parseOne(s,u,_,i,d,!!h[f]);else if("#else"==d)for(i++;i<r;i++)if("attribute"==(d=_[i])||"uniform"==d)i=t._parseOne(s,u,_,i,d,!h[f]);else if("#endif"==d)break}}}return o}},{key:"splitToWords",value:function(t,e){for(var n,i,a=[],o=-1,s=0,u=t.length;s<u;s++)if(n=t.charAt(s),(0,r.default)(" \t=+-*/&%!<>()'\",;").call(" \t=+-*/&%!<>()'\",;",n)>=0){if(o>=0&&s-o>1&&(i=t.substr(o,s-o),a.push(i)),'"'==n||"'"==n){var l=(0,r.default)(t).call(t,n,s+1);if(l<0)throw"Sharder err:"+t;a.push(t.substr(s+1,l-s-1)),s=l,o=-1;continue}"("==n&&e&&a.length>0&&(i=a[a.length-1]+";",(0,r.default)("vec4;main;").call("vec4;main;",i)<0&&(e.useFuns+=i)),o=-1}else o<0&&(o=s);return o<u&&u-o>1&&(i=t.substr(o,u-o),a.push(i)),a}}],(n=[{key:"_compileToTree",value:function(e,n,i,o,s){var u,l,h,f,_,d,p,y,v,g,m,b;for(g=i;g<n.length;g++)if(!((f=n[g]).length<1)&&0!==(p=(0,r.default)(f).call(f,"//"))){if(p>=0&&(f=f.substr(0,p)),l=v||new c.ShaderNode(o),v=null,l.text=f,l.noCompile=!0,(p=(0,r.default)(f).call(f,"#"))>=0){for(_="#",b=p+1,m=f.length;b<m;b++){var T=f.charAt(b);if(" "===T||"\t"===T||"?"===T)break;_+=T}switch(l.name=_,_){case"#ifdef":case"#ifndef":if(l.src=f,l.noCompile=null!=f.match(/[!&|()=<>]/),l.noCompile?console.log("function():Boolean{return "+f.substr(p+l.name.length)+"}"):(y=f.replace(/^\s*/,"").split(/\s+/),l.setCondition(y[1],"#ifdef"===_?t.IFDEF_YES:t.IFDEF_ELSE),l.text="//"+l.text),l.setParent(e),e=l,s)for(y=f.substr(b).split(t._splitToWordExps3),b=0;b<y.length;b++)(f=y[b]).length&&(s[f]=!0);continue;case"#if":if(l.src=f,l.noCompile=!0,l.setParent(e),e=l,s)for(y=f.substr(b).split(t._splitToWordExps3),b=0;b<y.length;b++)(f=y[b]).length&&"defined"!=f&&(s[f]=!0);continue;case"#else":l.src=f,h=(e=e.parent).childs[e.childs.length-1],l.noCompile=h.noCompile,l.noCompile||(l.condition=h.condition,l.conditionType=h.conditionType==t.IFDEF_YES?t.IFDEF_ELSE:t.IFDEF_YES,l.text="//"+l.text+" "+h.text+" "+l.conditionType),l.setParent(e),e=l;continue;case"#endif":h=(e=e.parent).childs[e.childs.length-1],l.noCompile=h.noCompile,l.noCompile||(l.text="//"+l.text),l.setParent(e);continue;case"#include":y=t.splitToWords(f,null);var x=(0,a.default)(t)[y[1]];if(!x)throw"ShaderCompile error no this include file:"+y[1];if((p=(0,r.default)(u=y[0]).call(u,"?"))<0){l.setParent(e),f=x.getWith("with"==y[2]?y[3]:null),this._compileToTree(l,f.split("\n"),0,o,s),l.text="";continue}l.setCondition(y[0].substr(p+1),t.IFDEF_YES),l.text=x.getWith("with"==y[2]?y[3]:null);break;case"#import":d=(y=t.splitToWords(f,null))[1],o.push({node:l,file:(0,a.default)(t)[d],ofs:l.text.length});continue}}else{if((h=e.childs[e.childs.length-1])&&!h.name){o.length>0&&t.splitToWords(f,h),v=l,h.text+="\n"+f;continue}o.length>0&&t.splitToWords(f,l)}l.setParent(e)}}},{key:"createShader",value:function(t,e,n,i){var r={},a="";if(t)for(var o in t)a+="#define "+o+"\n",r[o]=!0;var s=this._VS.toscript(r,[]),u=this._PS.toscript(r,[]);return(n||l.Shader.create)(a+s.join("\n"),a+u.join("\n"),e,this._nameMap,i)}}])&&_(e.prototype,n),s&&_(e,s),t}();e.ShaderCompile=d,d.IFDEF_NO=0,d.IFDEF_YES=1,d.IFDEF_ELSE=2,d.IFDEF_PARENT=3,d._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),d._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),d._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),d.includes={},d._clearCR=new RegExp("\r","g"),d._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")},1648:function(t,e,n){"use strict";n(63978)(e,"__esModule",{value:!0}),e.ShaderNode=void 0;var i=o(n(78914)),r=o(n(63978)),a=n(92493);function o(t){return t&&t.__esModule?t:{default:t}}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}var u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.childs=[],this.text="",this.useFuns="",this.z=0,this.includefiles=e}var e,n,r;return e=t,(n=[{key:"setParent",value:function(t){t.childs.push(this),this.z=t.z+1,this.parent=t}},{key:"setCondition",value:function(t,e){t&&(this.conditionType=e,t=t.replace(/(\s*$)/g,""),this.condition=function(){return this[t]},this.condition.__condition=t)}},{key:"toscript",value:function(e,n){return this._toscript(e,n,++t.__id)}},{key:"_toscript",value:function(t,e,n){var r;if(this.childs.length<1&&!this.text)return e;if(e.length,this.condition){var o=!!this.condition.call(t);if(this.conditionType===a.ILaya.ShaderCompile.IFDEF_ELSE&&(o=!o),!o)return e}if(this.noCompile&&this.text&&e.push(this.text),this.childs.length>0&&(0,i.default)(r=this.childs).call(r,(function(i,r,a){i._toscript(t,e,n)})),this.includefiles.length>0&&this.useFuns.length>0)for(var s,u=0,l=this.includefiles.length;u<l;u++)this.includefiles[u].curUseID!=n&&(s=this.includefiles[u].file.getFunsScript(this.useFuns)).length>0&&(this.includefiles[u].curUseID=n,e[0]=s+e[0]);return e}}])&&s(e.prototype,n),r&&s(e,r),t}();e.ShaderNode=u,u.__id=1},53778:function(t,e,n){"use strict";function i(t){return i="function"==typeof h&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof h&&t.constructor===h&&t!==h.prototype?"symbol":typeof t},i(t)}var r=n(1068),a=n(85507),o=n(54943),s=n(62734),u=n(34074),l=n(63978),h=n(65420),c=n(98341);l(e,"__esModule",{value:!0}),e.VertexBuffer2D=void 0;var f=v(n(85507)),_=v(n(21611)),d=n(15323),p=n(33873),y=n(56758);function v(t){return t&&t.__esModule?t:{default:t}}function g(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),l(t,i.key,i)}}function m(){return m="undefined"!=typeof Reflect&&s?s:function(t,e,n){var i=b(t,e);if(i){var r=u(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},m.apply(this,arguments)}function b(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=k(t)););return t}function T(t,e){return T=a||function(t,e){return t.__proto__=e,t},T(t,e)}function x(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=k(t);if(e){var a=k(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return w(this,n)}}function w(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function k(t){return k=f.default?_.default:function(t){return t.__proto__||(0,_.default)(t)},k(t)}var C=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&T(t,e)}(a,t);var e,n,i,r=x(a);function a(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(n=r.call(this))._vertexStride=t,n._bufferUsage=e,n._bufferType=p.LayaGL.instance.ARRAY_BUFFER,n._buffer=new ArrayBuffer(8),n._floatArray32=new Float32Array(n._buffer),n._uint32Array=new Uint32Array(n._buffer),n}return e=a,(n=[{key:"vertexStride",get:function(){return this._vertexStride}},{key:"getFloat32Array",value:function(){return this._floatArray32}},{key:"appendArray",value:function(t){var e=this._byteLength>>2;this.setByteLength(this._byteLength+4*t.length),this.getFloat32Array().set(t,e),this._upload=!0}},{key:"_checkArrayUse",value:function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer)),this._uint32Array&&(this._uint32Array=new Uint32Array(this._buffer))}},{key:"deleteBuffer",value:function(){m(k(a.prototype),"_disposeResource",this).call(this)}},{key:"_bindForVAO",value:function(){var t=p.LayaGL.instance;t.bindBuffer(t.ARRAY_BUFFER,this._glBuffer)}},{key:"bind",value:function(){if(y.Buffer._bindedVertexBuffer!==this._glBuffer){var t=p.LayaGL.instance;return t.bindBuffer(t.ARRAY_BUFFER,this._glBuffer),y.Buffer._bindedVertexBuffer=this._glBuffer,!0}return!1}},{key:"destroy",value:function(){m(k(a.prototype),"destroy",this).call(this),this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null}}])&&g(e.prototype,n),i&&g(e,i),a}(d.Buffer2D);e.VertexBuffer2D=C,C.create=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:35048;return new C(t,e)}},46011:function(t){t.exports="precision mediump float;\r\n//precision mediump float;\r\nvarying vec4 color;\r\n//uniform float alpha;\r\nvarying vec2 cliped;\r\nvoid main(){\r\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\r\n\t//a.a*=alpha;\r\n    gl_FragColor= color;// vec4(color.r, color.g, color.b, alpha);\r\n\tgl_FragColor.rgb*=color.a;\r\n\tif(cliped.x<0.) discard;\r\n\tif(cliped.x>1.) discard;\r\n\tif(cliped.y<0.) discard;\r\n\tif(cliped.y>1.) discard;\r\n}"},18962:function(t){t.exports="attribute vec4 position;\r\nattribute vec4 attribColor;\r\n//attribute vec4 clipDir;\r\n//attribute vec2 clipRect;\r\nuniform vec4 clipMatDir;\r\nuniform vec2 clipMatPos;\r\n#ifdef WORLDMAT\r\n\tuniform mat4 mmat;\r\n#endif\r\nuniform mat4 u_mmat2;\r\n//uniform vec2 u_pos;\r\nuniform vec2 size;\r\nvarying vec4 color;\r\n//vec4 dirxy=vec4(0.9,0.1, -0.1,0.9);\r\n//vec4 clip=vec4(100.,30.,300.,600.);\r\nvarying vec2 cliped;\r\nvoid main(){\r\n\t\r\n#ifdef WORLDMAT\r\n\tvec4 pos=mmat*vec4(position.xy,0.,1.);\r\n\tgl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\r\n#else\r\n\tgl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\r\n#endif\t\r\n\tfloat clipw = length(clipMatDir.xy);\r\n\tfloat cliph = length(clipMatDir.zw);\r\n\tvec2 clippos = position.xy - clipMatPos.xy;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\r\n\tif(clipw>20000. && cliph>20000.)\r\n\t\tcliped = vec2(0.5,0.5);\r\n\telse {\r\n\t\t//clipdir是带缩放的方向，由于上面clippos是在缩放后的空间计算的，所以需要把方向先normalize一下\r\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\r\n\t}\r\n  //pos2d.x = dot(clippos,dirx);\r\n  color=attribColor/255.;\r\n}"},1793:function(t){t.exports="/*\r\n\ttexture和fillrect使用的。\r\n*/\r\n#if defined(GL_FRAGMENT_PRECISION_HIGH)// 原来的写法会被我们自己的解析流程处理，而我们的解析是不认内置宏的，导致被删掉，所以改成 if defined 了\r\nprecision highp float;\r\n#else\r\nprecision mediump float;\r\n#endif\r\n\r\nvarying vec4 v_texcoordAlpha;\r\nvarying vec4 v_color;\r\nvarying float v_useTex;\r\nuniform sampler2D texture;\r\nvarying vec2 cliped;\r\n\r\n#ifdef BLUR_FILTER\r\nuniform vec4 strength_sig2_2sig2_gauss1;//TODO模糊的过程中会导致变暗变亮  \r\nuniform vec2 blurInfo;\r\n\r\n#define PI 3.141593\r\n\r\nfloat getGaussian(float x, float y){\r\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\r\n}\r\n\r\nvec4 blur(){\r\n    const float blurw = 9.0;\r\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\r\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \r\n    vec2 startpos=v_texcoordAlpha.xy-halfsz;\r\n    vec2 ctexcoord = startpos;\r\n    vec2 step = 1.0/blurInfo;  //每个像素      \r\n    \r\n    for(float y = 0.0;y<=blurw; ++y){\r\n        ctexcoord.x=startpos.x;\r\n        for(float x = 0.0;x<=blurw; ++x){\r\n            //TODO 纹理坐标的固定偏移应该在vs中处理\r\n            vec4Color += texture2D(texture, ctexcoord)*getGaussian(x-blurw/2.0,y-blurw/2.0);\r\n            ctexcoord.x+=step.x;\r\n        }\r\n        ctexcoord.y+=step.y;\r\n    }\r\n    vec4Color.w=1.0;\r\n    return vec4Color;\r\n}\r\n#endif\r\n\r\n#ifdef COLOR_FILTER\r\nuniform vec4 colorAlpha;\r\nuniform mat4 colorMat;\r\n#endif\r\n\r\n#ifdef GLOW_FILTER\r\nuniform vec4 u_color;\r\nuniform vec4 u_blurInfo1;\r\nuniform vec4 u_blurInfo2;\r\n#endif\r\n\r\n#ifdef COLOR_ADD\r\nuniform vec4 colorAdd;\r\n#endif\r\n\r\n#ifdef FILLTEXTURE\t\r\nuniform vec4 u_TexRange;//startu,startv,urange, vrange\r\n#endif\r\nvoid main() {\r\n\tif(cliped.x<0.) discard;\r\n\tif(cliped.x>1.) discard;\r\n\tif(cliped.y<0.) discard;\r\n\tif(cliped.y>1.) discard;\r\n\t\r\n#ifdef FILLTEXTURE\t\r\n   vec4 color= texture2D(texture, fract(v_texcoordAlpha.xy)*u_TexRange.zw + u_TexRange.xy);\r\n#else\r\n   vec4 color= texture2D(texture, v_texcoordAlpha.xy);\r\n#endif\r\n\r\n   if(v_useTex<=0.)color = vec4(1.,1.,1.,1.);\r\n   color.a*=v_color.w;\r\n   //color.rgb*=v_color.w;\r\n   color.rgb*=v_color.rgb;\r\n   gl_FragColor=color;\r\n   \r\n   #ifdef COLOR_ADD\r\n\tgl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\r\n\tgl_FragColor.xyz *= colorAdd.a;\r\n   #endif\r\n   \r\n   #ifdef BLUR_FILTER\r\n\tgl_FragColor =   blur();\r\n\tgl_FragColor.w*=v_color.w;   \r\n   #endif\r\n   \r\n   #ifdef COLOR_FILTER\r\n\tmat4 alphaMat =colorMat;\r\n\r\n\talphaMat[0][3] *= gl_FragColor.a;\r\n\talphaMat[1][3] *= gl_FragColor.a;\r\n\talphaMat[2][3] *= gl_FragColor.a;\r\n\r\n\tgl_FragColor = gl_FragColor * alphaMat;\r\n\tgl_FragColor += colorAlpha/255.0*gl_FragColor.a;\r\n   #endif\r\n   \r\n   #ifdef GLOW_FILTER\r\n\tconst float c_IterationTime = 10.0;\r\n\tfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\r\n\tvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\r\n\tvec2 vec2FilterDir = vec2(-(u_blurInfo1.z)/u_blurInfo2.x,-(u_blurInfo1.w)/u_blurInfo2.y);\r\n\tvec2 vec2FilterOff = vec2(u_blurInfo1.x/u_blurInfo2.x/c_IterationTime * 2.0,u_blurInfo1.y/u_blurInfo2.y/c_IterationTime * 2.0);\r\n\tfloat maxNum = u_blurInfo1.x * u_blurInfo1.y;\r\n\tvec2 vec2Off = vec2(0.0,0.0);\r\n\tfloat floatOff = c_IterationTime/2.0;\r\n\tfor(float i = 0.0;i<=c_IterationTime; ++i){\r\n\t\tfor(float j = 0.0;j<=c_IterationTime; ++j){\r\n\t\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\r\n\t\t\tvec4Color += texture2D(texture, v_texcoordAlpha.xy + vec2FilterDir + vec2Off)/floatIterationTotalTime;\r\n\t\t}\r\n\t}\r\n\tgl_FragColor = vec4(u_color.rgb,vec4Color.a * u_blurInfo2.z);\r\n\tgl_FragColor.rgb *= gl_FragColor.a;   \r\n   #endif\r\n   \r\n}"},13867:function(t){t.exports="/*\r\n\ttexture和fillrect使用的。\r\n*/\r\nattribute vec4 posuv;\r\nattribute vec4 attribColor;\r\nattribute vec4 attribFlags;\r\n//attribute vec4 clipDir;\r\n//attribute vec2 clipRect;\r\nuniform vec4 clipMatDir;\r\nuniform vec2 clipMatPos;\t\t// 这个是全局的，不用再应用矩阵了。\r\nvarying vec2 cliped;\r\nuniform vec2 size;\r\nuniform vec2 clipOff;\t\t\t// 使用要把clip偏移。cacheas normal用. 只用了[0]\r\n#ifdef WORLDMAT\r\n\tuniform mat4 mmat;\r\n#endif\r\n#ifdef MVP3D\r\n\tuniform mat4 u_MvpMatrix;\r\n#endif\r\nvarying vec4 v_texcoordAlpha;\r\nvarying vec4 v_color;\r\nvarying float v_useTex;\r\n\r\nvoid main() {\r\n\r\n\tvec4 pos = vec4(posuv.xy,0.,1.);\r\n#ifdef WORLDMAT\r\n\tpos=mmat*pos;\r\n#endif\r\n\tvec4 pos1  =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,0.,1.0);\r\n#ifdef MVP3D\r\n\tgl_Position=u_MvpMatrix*pos1;\r\n#else\r\n\tgl_Position=pos1;\r\n#endif\r\n\tv_texcoordAlpha.xy = posuv.zw;\r\n\t//v_texcoordAlpha.z = attribColor.a/255.0;\r\n\tv_color = attribColor/255.0;\r\n\tv_color.xyz*=v_color.w;//反正后面也要预乘\r\n\t\r\n\tv_useTex = attribFlags.r/255.0;\r\n\tfloat clipw = length(clipMatDir.xy);\r\n\tfloat cliph = length(clipMatDir.zw);\r\n\t\r\n\tvec2 clpos = clipMatPos.xy;\r\n\t#ifdef WORLDMAT\r\n\t\t// 如果有mmat，需要修改clipMatPos,因为 这是cacheas normal （如果不是就错了）， clipMatPos被去掉了偏移\r\n\t\tif(clipOff[0]>0.0){\r\n\t\t\tclpos.x+=mmat[3].x;\t//tx\t最简单处理\r\n\t\t\tclpos.y+=mmat[3].y;\t//ty\r\n\t\t}\r\n\t#endif\r\n\tvec2 clippos = pos.xy - clpos;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\r\n\tif(clipw>20000. && cliph>20000.)\r\n\t\tcliped = vec2(0.5,0.5);\r\n\telse {\r\n\t\t//转成0到1之间。/clipw/clipw 表示clippos与normalize之后的clip朝向点积之后，再除以clipw\r\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\r\n\t}\r\n\r\n}"},45301:function(t){t.exports="precision mediump float;\r\nvarying vec2 v_texcoord;\r\nvarying vec4 v_color;\r\nuniform sampler2D texture;\r\nuniform float alpha;\r\nvoid main() {\r\n\tvec4 t_color = texture2D(texture, v_texcoord);\r\n\tgl_FragColor = t_color.rgba * v_color;\r\n\tgl_FragColor *= alpha;\r\n}"},50347:function(t){t.exports="attribute vec2 position;\r\nattribute vec2 texcoord;\r\nattribute vec4 color;\r\nuniform vec2 size;\r\nuniform float offsetX;\r\nuniform float offsetY;\r\nuniform mat4 mmat;\r\nuniform mat4 u_mmat2;\r\nvarying vec2 v_texcoord;\r\nvarying vec4 v_color;\r\nvoid main() {\r\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\r\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\r\n  v_color = color;\r\n  v_color.rgb *= v_color.a;\r\n  v_texcoord = texcoord;  \r\n}"}}]);